# Network Protocols Complete Aggregation

This file contains the complete content from all RST files in:
1. BFD folder (root level)
2. Protocols folder (including all subdirectories)

This comprehensive documentation covers all network protocols including:
- BGP (Border Gateway Protocol)
- OSPF/OSPFv3 (Open Shortest Path First)
- ISIS (Intermediate System to Intermediate System)
- BFD (Bidirectional Forwarding Detection)
- MPLS (Multiprotocol Label Switching)
- LDP (Label Distribution Protocol)
- RSVP (Resource Reservation Protocol)
- PIM (Protocol Independent Multicast)
- IGMP (Internet Group Management Protocol)
- MSDP (Multicast Source Discovery Protocol)
- LACP (Link Aggregation Control Protocol)
- LLDP (Link Layer Discovery Protocol)
- DHCP (Dynamic Host Configuration Protocol)
- VRRP (Virtual Router Redundancy Protocol)
- Segment Routing
- Static Routing

Total files: 1460


---

# SECTION 1: BFD (ROOT LEVEL)

Files in this section: 1

## protocols bfd overview.rst

Bidirectional Forwarding Detection (BFD)
----------------------------------------

The bidirectional forwarding detection (BFD) protocol is a simple hello mechanism to detect faults between two directly connected forwarding devices. BFD operates on top of the data plane. The nodes at the ends of the BFD session exchange BFD hello packets at a configured rate. When a node stops receiving BFD packets from its peer for a specific period, a failure in the bidirectional path between the two nodes is reported and the routing protocol takes action to bypass the failed neighbor.

You can configure BFD sessions individually on members of a bundle interface. These are known as micro BFD (uBFD) sessions. The uBFD sessions verify that each bundle member is capable of forwarding traffic.

DNOS supports BFD for the following protocols:

- BGP, for the protection of a session between BGP neighbors

- RSVP on all RSVP tunnel types (primary, manual bypass, auto bypass and auto mesh)

- OSPF

The following image shows the various supported BFD types:

<INSERT 01_protocols_bfd>

You can control the number of concurrent BFD sessions by setting thresholds to generate system event notifications. Only established sessions are counted. When a threshold is crossed, a system-event notification is generated allowing you to take action, if necessary. The supported number of BFD sessions is based on one session per port for uBFD, plus 500 for all other BFD sessions.

For example, in a cluster with 48 NCP-40C the number of supported sessions will be one per port (48*40=1920) + 500 (for the rest) = 2420.
In order to generate an event when 75% of the maximum number of sessions is reached, set the max-sessions to 2420 and the threshold to 75%. This means that when the number of sessions reaches 1815 (2420x75%), a system-event notification will be generated that the threshold has been exceeded. If you do nothing, you will not receive another notification until the number of sessions reaches 2420, at which point another system event is generated every 30 seconds until the number of sessions drops below the crossed threshold.

For BFD related commands for additional protocols see:

- protocols bgp neighbor bfd
- protocols rsvp tunnel bfd
- protocols ospf instance area bfd

---


# SECTION 2: PROTOCOLS


## SECTION 2.A: BFD

Files in this section: 19

### bfd.rst

protocols bfd
-------------

**Minimum user role:** operator

To start the BFD process and enter BFD configuration mode:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- The BFD protocol is only relevant for default vrf

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)#


**Removing Configuration**

To disable the BFD protocol:
::

    dnRouter(cfg-protocols)# no bfd

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 9.0     | Command removed      |
+---------+----------------------+
| 11.2    | Command reintroduced |
+---------+----------------------+

---

### class-of-service.rst

protocols bfd class-of-service
------------------------------

**Minimum user role:** operator

With class of service (CoS) you can classify traffic to provide different service levels to different 
traffic so that when congestion occurs, you can control which packets receive priority.

To configure the DSCP value for all locally generated BFD packets:

**Command syntax: class-of-service [dscp]**

**Command mode:** config

**Hierarchies**

- protocols bfd

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| dscp      | The DSCP value that is used in the BFD packet to classify it and give it a       | 0-63  | 48      |
|           | priority.                                                                        |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# class-of-service 16


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bfd)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.2    | Command introduced |
+---------+--------------------+

---

### interface/interface.rst

protocols bfd interface
-----------------------

**Minimum user role:** operator

To configure BFD on an interface:


**Command syntax: interface [interface]**

**Command mode:** config

**Hierarchies**

- protocols bfd

**Note**

- This command applies to bundle interfaces only.

- BFD session configurations applies to all bundle member sessions.

- micro-BFD will work on the vrf to which the bundle interface is assigned. If the bundle interface switches between different vrfs, the micro-bfd session will close and reopen.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------------+---------+
| Parameter | Description                                                                      | Range              | Default |
+===========+==================================================================================+====================+=========+
| interface | The name of the interface on which to configure BFD.                             | bundle-<bundle-id> | \-      |
|           | For uBFD to work, the bundle interface must have an IP address and the packets'  |                    |         |
|           | destination-ip must match any interface in the system.                           |                    |         |
+-----------+----------------------------------------------------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# interface bundle-1
    dnRouter(cfg-protocols-bfd-if)#


**Removing Configuration**

To remove the interface BFD configuration:
::

    dnRouter(cfg-protocols-bfd)# no interface bundle-1

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 9.0     | Command removed      |
+---------+----------------------+
| 11.2    | Command reintroduced |
+---------+----------------------+

---

### interface/local-address.rst

protocols bfd interface local-address
-------------------------------------

**Minimum user role:** operator

To set the local address to be used as the IP source of uBFD sessions:

**Command syntax: local-address [ip-address]**

**Command mode:** config

**Hierarchies**

- protocols bfd interface

**Note**

- The local address-family type must match the neighbor address address-family type.

**Parameter table**

+------------+-------------------------------------------------------------------------+--------------+---------------------------------+
| Parameter  | Description                                                             | Range        | Default                         |
+============+=========================================================================+==============+=================================+
| ip-address | The local address that will be used as the IP source for uBFD sessions. | | A.B.C.D    | The IP address of the interface |
|            |                                                                         | | X:X::X:X   |                                 |
+------------+-------------------------------------------------------------------------+--------------+---------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# interface bundle-1
    dnRouter(cfg-protocols-bfd-if)# local-address 1.2.3.3

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# interface bundle-1
    dnRouter(cfg-protocols-bfd-if)# local-address 2001:ab12::2


**Removing Configuration**

To remove BFD support for a specific address-family:
::

    dnRouter(cfg-protocols-bfd-if)# no local-address

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.2    | Command introduced |
+---------+--------------------+

---

### interface/min-rx.rst

protocols bfd interface min-rx
------------------------------

**Minimum user role:** operator

The desired minimum receive interval is the time-frame in which a BFD packet is expected to arrive. 
If a BFD packet is not received within the configured interval, the uBFD session will go down.
The min-rx together with the multiplier, defines the detection time. 
The Local Detection timeout = negotiated Rx interval * remote_multiplier (the multiplier value received on the BFD packet).
The Remote Detection timeout = negotiated Tx interval * local_multiplier (the multiplier value configured locally for the session).

To configure the minimum receive interval:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols bfd interface

**Note**

- All micro BFD sessions for the given bundle member will use the same session parameters

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------+---------+
| Parameter | Description                                                                      | Range  | Default |
+===========+==================================================================================+========+=========+
| min-rx    | The interval (in msec) in which a BFD packet is expected to arrive from the      | 5-1700 | 300     |
|           | remote neighbor.                                                                 |        |         |
+-----------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# interface bundle-1
    dnRouter(cfg-protocols-bfd-if)# min-rx 100


**Removing Configuration**

To return to the default value:
::

    dnRouter(cfg-protocols-bfd-if)# no min-rx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.2    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### interface/min-tx.rst

protocols bfd interface min-tx
------------------------------

**Minimum user role:** operator

The minimum transmission interval is the desired time between consecutive transmissions of BFD packets. Upon negotiation with the remote end.

To configure the transmission rate of BFD packets:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols bfd interface

**Note**

- All micro BFD sessions for the given bundle member will use the same session parameters

- Due to hardware limitation, maximum supported transmit rate is 1700msec, and negotiated transmit interval higher than 1700msec will result in actual transmit rate of 1700msec.

**Parameter table**

+-----------+--------------------------------------------------------------+--------+---------+
| Parameter | Description                                                  | Range  | Default |
+===========+==============================================================+========+=========+
| min-tx    | The interval (in msec) between transmissions of BFD packets. | 5-1700 | 300     |
+-----------+--------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# interface bundle-1
    dnRouter(cfg-protocols-bfd-if)# min-tx 100


**Removing Configuration**

To return to the default value:
::

    dnRouter(cfg-protocols-bfd-if)# no min-tx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.2    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### interface/multiplier.rst

protocols bfd interface multiplier
----------------------------------

**Minimum user role:** operator

The multiplier defines the number of min-rx intervals in which a BFD packet is not received before the uBFD session goes down. 

To configure the multiplier:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols bfd interface

**Note**

- All micro BFD sessions for the given bundle members will use the same session parameters

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| multiplier | The number of min-rx intervals in which no BFD packet is received as expected    | 2-16  | 3       |
|            | (or the number of missing BFD packets) before the uBFD session goes down.        |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# interface bundle-1
    dnRouter(cfg-protocols-bfd-if)#  multiplier 5

    For example, if min-rx is configured to 100 msec and the multiplier is 5, this means that if BFD packets stop arriving, after 500 msec the session goes down.

**Removing Configuration**

To return to the default value:
::

    ddnRouter(cfg-protocols-bfd-if)# no multiplier

**Command History**

+---------+--------------------------+
| Release | Modification             |
+=========+==========================+
| 11.2    | Command introduced       |
+---------+--------------------------+
| 11.4    | Updated multiplier range |
+---------+--------------------------+

---

### interface/neighbor.rst

protocols bfd interface neighbor
--------------------------------

**Minimum user role:** operator

You must set a destination address for the uBFD session. The destination address does not need to be an IP address of the interface you want to protect; it can also be a loopback address, as long as it is a local address of the router that will cause the BFD packets to trap to the CPU.

To set the destination address for the uBFD session:

**Command syntax: neighbor [ip-address]**

**Command mode:** config

**Hierarchies**

- protocols bfd interface

**Note**

- User must set neighbor address in order for the micro BFD sessions to work (commit failure)

- Neighbor address-family type must match local-address address family type

- Only a single neighbor address can be configured per a bundle interface

- BFD session address-family match the neighbor address-family.

**Parameter table**

+------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter  | Description                                                                      | Range        | Default |
+============+==================================================================================+==============+=========+
| ip-address | The IPv4/IPv6 address of the neighbor at the remote end of the bundle interface  | | A.B.C.D    | \-      |
|            | for the uBFD session.                                                            | | X:X::X:X   |         |
+------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# interface bundle-1
    dnRouter(cfg-protocols-bfd-if)# neighbor 1.2.3.3

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# interface bundle-1
    dnRouter(cfg-protocols-bfd-if)# neighbor 2001:ab12::2


**Removing Configuration**

To remove the neighbor address and stop the BFD session:
::

    dnRouter(cfg-protocols-bfd-if)# no neighbor

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.2    | Command introduced |
+---------+--------------------+

---

### maximum-sessions.rst

protocols bfd maximum-sessions threshold
----------------------------------------

**Minimum user role:** operator

You can control the number of concurrent BFD sessions by setting thresholds to generate system event notifications. 
Only established sessions are counted. When a threshold is crossed, a system-event notification is generated allowing you to take action, if necessary. 
Micro-BFD sessions are excluded from this count. System supports micro-BFD sessions on every system port.
Once the threshold is crossed, a warning system-event will be sent (every 30 seconds).

To configure thresholds for BFD sessions:

**Command syntax: maximum-sessions [max-sessions] threshold [threshold]**

**Command mode:** config

**Hierarchies**

- protocols bfd

**Parameter table**

+--------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter    | Description                                                                      | Range   | Default |
+==============+==================================================================================+=========+=========+
| max-sessions | The maximum number of concurrent BFD sessions. When the maximum number of        | 0-65535 | 2000    |
|              | sessions threshold is crossed, a system-event notification is generated every 30 |         |         |
|              | seconds.                                                                         |         |         |
|              | A value of 0 means no limit.                                                     |         |         |
+--------------+----------------------------------------------------------------------------------+---------+---------+
| threshold    | A percentage (%) of max-sessions to give you advance notice that the number of   | 1-100   | 75      |
|              | BFD sessions is reaching the maximum level.                                      |         |         |
|              | When this threshold is crossed, a system event notification is generated.        |         |         |
+--------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bfd
    dnRouter(cfg-protocols-bfd)# maximum-sessions 500 threshold 75

    In the above example, the maximum number of sessions is set to 500 and the threshold is set to 75%.
 This means that when the number of sessions reaches 375 (500x75%), a system-event notification will be generated that the 75% threshold has been crossed.
 If you do nothing, you will not receive another notification until the number of sessions reaches 500. At this point, a system-event notification will start to be generated every 30 seconds.

**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bfd)# no maximum-sessions

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 11.2    | Command introduced                      |
+---------+-----------------------------------------+
| 15.1    | Added support for 2000 maximum sessions |
+---------+-----------------------------------------+

---

### seamless-bfd/reflector/admin-state.rst

protocols bfd seamless-bfd reflector admin-state
------------------------------------------------

**Minimum user role:** operator

To enable or disable the Seamless BFD Reflector

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd reflector

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# reflector reflector1
    dnRouter(cfg-bfd-seamless-reflector)# admin-state enabled
    dnRouter(cfg-bfd-seamless-reflector)#


**Removing Configuration**

To restore the admin-state to its default of disabled.
::

    dnRouter(cfg-bfd-seamless-reflector)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/reflector/description.rst

protocols bfd seamless-bfd reflector description
------------------------------------------------

**Minimum user role:** operator

To add an optional description to the Seamless BFD Reflector

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd reflector

**Parameter table**

+-------------+-----------------------+------------------+---------+
| Parameter   | Description           | Range            | Default |
+=============+=======================+==================+=========+
| description | reflector description | | string         | \-      |
|             |                       | | length 1-255   |         |
+-------------+-----------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# reflector reflector1
    dnRouter(cfg-bfd-seamless-reflector)# description "Seamless BFD Reflector"
    dnRouter(cfg-bfd-seamless-reflector)#


**Removing Configuration**

To remove description
::

    dnRouter(cfg-bfd-seamless-reflector)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/reflector/discriminator.rst

protocols bfd seamless-bfd reflector local-discriminator
--------------------------------------------------------

**Minimum user role:** operator

Configure the Seamless BFD Reflector Discriminator value. This value must be globally unique in the network.

**Command syntax: local-discriminator [local-discriminator]**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd reflector

**Parameter table**

+---------------------+-----------------------------------------------------+------------------+---------+
| Parameter           | Description                                         | Range            | Default |
+=====================+=====================================================+==================+=========+
| local-discriminator | Set the Seamless BFD reflector discriminator value. | | 1-4294967295   | \-      |
|                     |                                                     | | A.B.C.D        |         |
+---------------------+-----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# reflector reflector1
    dnRouter(cfg-bfd-seamless-reflector)# local-discriminator 658709
    dnRouter(cfg-bfd-seamless-reflector)#


**Removing Configuration**

To remove the discriminator configuration
::

    dnRouter(cfg-bfd-seamless-reflector)# no local-discriminator

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/reflector/reflector.rst

protocols bfd seamless-bfd reflector
------------------------------------

**Minimum user role:** operator

Configure a seamless BFD Reflector.

**Command syntax: reflector [reflector-name]**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd

**Parameter table**

+----------------+---------------------------------------------------------------------+------------------+---------+
| Parameter      | Description                                                         | Range            | Default |
+================+=====================================================================+==================+=========+
| reflector-name | The name of the reflector -- used to address the specific reflector | | string         | \-      |
|                |                                                                     | | length 1-255   |         |
+----------------+---------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# reflector reflector1
    dnRouter(cfg-bfd-seamless-reflector)#


**Removing Configuration**

To remove the reflector from the system.
::

    dnRouter(cfg-protocols-bfd-seamless)# no reflector

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/reflector/sbfd-local-state.rst

protocols bfd seamless-bfd reflector sbfd-local-state
-----------------------------------------------------

**Minimum user role:** operator

To set the Seamless BFD Reflector state that is sent in the response message.

**Command syntax: sbfd-local-state [sbfd-local-state]**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd reflector

**Parameter table**

+------------------+--------------------------------------+----------------+---------+
| Parameter        | Description                          | Range          | Default |
+==================+======================================+================+=========+
| sbfd-local-state | set whether bfd protection is in use | | up           | up      |
|                  |                                      | | admin-down   |         |
+------------------+--------------------------------------+----------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# reflector reflector1
    dnRouter(cfg-bfd-seamless-reflector)# sbfd-local-state admin-down
    dnRouter(cfg-bfd-seamless-reflector)#


**Removing Configuration**

To restore the sbfd-local-state to its default of 'up'. 
::

    dnRouter(cfg-bfd-seamless-reflector)# no sbfd-local-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/reflector/source-address-ipv4.rst

protocols bfd seamless-bfd reflector source-address-ipv4
--------------------------------------------------------

**Minimum user role:** operator

To set the IPv4 address of the Reflector that is sent in the response message. If not set the SR-TE policy router-ID is sent as the Source IP address.

**Command syntax: source-address-ipv4 [source-address-ipv4]**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd reflector

**Parameter table**

+---------------------+--------------------------------------------------------------+---------+---------+
| Parameter           | Description                                                  | Range   | Default |
+=====================+==============================================================+=========+=========+
| source-address-ipv4 | The source IP address to be inserted in the reflected packet | A.B.C.D | \-      |
+---------------------+--------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# reflector reflector1
    dnRouter(cfg-bfd-seamless-reflector)# source-address-ipv4 189.91.10.32
    dnRouter(cfg-bfd-seamless-reflector)#


**Removing Configuration**

To remove the source-address-ipv4 configuration
::

    dnRouter(cfg-bfd-seamless-reflector)# no source-address-ipv4

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/remote-map/ipv4/address-discriminator.rst

protocols bfd seamless-bfd remote-map ipv4 address discriminator
----------------------------------------------------------------

**Minimum user role:** operator

Configure the Seamless BFD Reflector pair: IPv4 address of the reflector and its discriminator value. The discriminator value must be globally unique in the network.

**Command syntax: address [reflector-ipv4-address] discriminator [reflector-discriminator]**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd remote-map ipv4

**Parameter table**

+-------------------------+-----------------------------------------------------+------------------+---------+
| Parameter               | Description                                         | Range            | Default |
+=========================+=====================================================+==================+=========+
| reflector-ipv4-address  | ipv4 address of the remote reflector                | A.B.C.D          | \-      |
+-------------------------+-----------------------------------------------------+------------------+---------+
| reflector-discriminator | Set the Seamless BFD reflector discriminator value. | | 1-4294967295   | \-      |
|                         |                                                     | | A.B.C.D        |         |
+-------------------------+-----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# remote-map
    dnRouter(cfg-bfd-seamless-map)# ipv4
    dnRouter(cfg-seamless-map-ipv4)# address 185.32.98.12 discriminator 658709
    dnRouter(cfg-seamless-map-ipv4)# address 112.46.22.76 discriminator 97123
    dnRouter(cfg-seamless-map-ipv4)#


**Removing Configuration**

To remove the ip address and its discriminator pair
::

    dnRouter(cfg-seamless-map-ipv4)# no address 185.32.98.12

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/remote-map/ipv4/ipv4.rst

protocols bfd seamless-bfd remote-map ipv4
------------------------------------------

**Minimum user role:** operator

Configure an iIPv4 remote seamless BFD Reflector map to associate the discriminator with the IPv4-Address.

**Command syntax: ipv4**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd remote-map

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# remote-map
    dnRouter(cfg-bfd-seamless-map)# ipv4
    dnRouter(cfg-seamless-map-ipv4)#


**Removing Configuration**

To remove the ipv4 remote-map from the system.
::

    dnRouter(cfg-bfd-seamless-map)# no ipv4

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/remote-map/remote-map.rst

protocols bfd seamless-bfd remote-map
-------------------------------------

**Minimum user role:** operator

Configure a remote seamless BFD Reflector map to associate the Discriminator with the IP-Address.

**Command syntax: remote-map**

**Command mode:** config

**Hierarchies**

- protocols bfd seamless-bfd

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)# remote-map
    dnRouter(cfg-bfd-seamless-map)#


**Removing Configuration**

To remove the remote-map from the system.
::

    dnRouter(cfg-protocols-bfd-seamless)# no remote-map

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### seamless-bfd/seamless-bfd.rst

protocols bfd seamless-bfd
--------------------------

**Minimum user role:** operator

To enter the Seamless BFD configuration hierarchy.

**Command syntax: seamless-bfd**

**Command mode:** config

**Hierarchies**

- protocols bfd

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# seamless-bfd
    dnRouter(cfg-protocols-bfd-seamless)#


**Removing Configuration**

To disable the Seamless BFD process:
::

    dnRouter(cfg-protocols)# no seamless-bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---


## SECTION 2.B: BGP

Files in this section: 328

### admin-distance.rst

protocols bgp administrative-distance
-------------------------------------

**Minimum user role:** operator

If a router learns of a destination from more than one routing protocol, the administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the BGP administrative distance for all routes:

**Command syntax: administrative-distance {external [external-route-distance], internal [internal-route-distance], local [local-route-distance]}**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- An administrative-distance of 255 will cause the router to remove the route from the routing table.

**Parameter table**

+-------------------------+----------------------------------------------------------------------+-------+---------+
| Parameter               | Description                                                          | Range | Default |
+=========================+======================================================================+=======+=========+
| external-route-distance | Administrative distance for routes learned from external BGP (eBGP). | 1-255 | 20      |
+-------------------------+----------------------------------------------------------------------+-------+---------+
| internal-route-distance | Administrative distance for routes learned from internal BGP (iBGP). | 1-255 | 200     |
+-------------------------+----------------------------------------------------------------------+-------+---------+
| local-route-distance    | Administrative distance for routes learned from local peers          | 1-255 | 110     |
+-------------------------+----------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# administrative-distance external 120 internal 200 local 150
    dnRouter(cfg-protocols-bgp)# administrative-distance local 60


**Removing Configuration**

To revert all distances to their default value:
::

    dnRouter(cfg-protocols-bgp)# no administrative-distance

To revert a specific distance to its default value:
::

    dnRouter(cfg-protocols-bgp)# no administrative-distance local

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 15.1    | Updated command syntax from admin to administrative |
+---------+-----------------------------------------------------+

---

### advertise-update-delay.rst

protocols bgp advertise-update-delay
------------------------------------

**Minimum user role:** operator

You can set the delay time (in seconds) to advertise bgp routes, after bet-path logic finishes. The delay applies to all bgp neighbors and all bgp address-families (does not apply to ipv4-flowspec, ipv6-flowspec and link-state address-families).

When re-configuring advertise-update-delay, the new delay time will apply to all routes ready to be advertised from the reconfig time + old delay timer value.

To set the BGP delay:

**Command syntax: advertise-update-delay [advertise-update-delay]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- A delay value of 0 will not add any additional delay.

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter              | Description                                                                      | Range  | Default |
+========================+==================================================================================+========+=========+
| advertise-update-delay | Set delay time (in seconds) to advertise bgp routes after finishing best-path    | 0-1800 | 240     |
|                        | logic                                                                            |        |         |
+------------------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# advertise-update-delay 180


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-protocols-bgp)# no advertise-update-delay

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 13.2    | Command introduced            |
+---------+-------------------------------+
| 17.1    | Default changed from 0 to 120 |
+---------+-------------------------------+

---

### afi_ipv4-multicast/add-path_receive.rst

protocols bgp address-family ipv4-multicast add-path receive
------------------------------------------------------------

**Minimum user role:** operator

Typically, BGP routers advertise only the best path for each route. The advertisement of a prefix replaces the previous announcement of that prefix.

To allow the device to receive multiple paths for the same route from the same BGP neighbor:

**Command syntax: add-path receive [add-path-receive]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

- This command is only applicable to the default VRF.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter        | Description                                                                      | Range        | Default  |
+==================+==================================================================================+==============+==========+
| add-path-receive | Enables additional paths to be received for the same route from a bgp neighbor.  | | enabled    | disabled |
|                  | Applies for all bgp neighbors with this afi/safi                                 | | disabled   |          |
+------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path receive

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 9.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-multicast/add-path_send/add-path_send.rst

protocols bgp address-family ipv4-multicast add-path send
---------------------------------------------------------

**Minimum user role:** operator

BGP Additional Paths is a BGP extension that provides the ability to advertise multiple paths for the same prefix without the new paths replacing previous paths. 
This helps reduce route repetition, and achieve faster re-convergence as an alternative path is available immediately upon failure of a primary path.
To enter the add-path send configuration level:

**Command syntax: add-path send**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#


**Removing Configuration**

To revert the add-path send configurations to default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path send

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-multicast/add-path_send/admin-state.rst

protocols bgp address-family ipv4-multicast add-path send admin-state
---------------------------------------------------------------------

**Minimum user role:** operator

To enable the add-path send behavior for a specific neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv4-vpn add-path send
- protocols bgp address-family ipv6-vpn add-path send

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+-------------+--------------------------------+--------------+----------+
| Parameter   | Description                    | Range        | Default  |
+=============+================================+==============+==========+
| admin-state | add path send enabled/disabled | | enabled    | disabled |
|             |                                | | disabled   |          |
+-------------+--------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no admin-state

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-multicast/add-path_send/path-count.rst

protocols bgp address-family ipv4-multicast add-path send path-count
--------------------------------------------------------------------

**Minimum user role:** operator

You can set the number of paths to be sent when add-path send is enabled:

**Command syntax: path-count [path-count]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv4-vpn add-path send
- protocols bgp address-family ipv6-vpn add-path send

**Parameter table**

+------------+----------------------------------------+-------+---------+
| Parameter  | Description                            | Range | Default |
+============+========================================+=======+=========+
| path-count | maximum number of path allowed to send | 2-32  | 2       |
+------------+----------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no path-count

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-multicast/afi_ipv4-multicast.rst

protocols bgp address-family ipv4-multicast
-------------------------------------------

**Minimum user role:** operator

To enter the global BGP ipv4 multicast address-family configuration:

**Command syntax: address-family ipv4-multicast**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-multicast
    dnRouter(cfg-protocols-bgp-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp)# no address-family ipv4-multicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-multicast/aggregate-route/aggregate-route.rst

protocols bgp address-family ipv4-multicast aggregate-route
-----------------------------------------------------------

**Minimum user role:** operator

Creates an aggregate (summary) route in a BGP routing table.
An aggregate route will be created if a more specific route exists in the BGP local RIB, and may act as a contributor.
An aggregate route will be installed to the local RIB with nexthop null0 (silent drop).
To create as aggregate route:

**Command syntax: aggregate-route [ip-prefix]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- You can configure multiple aggregate-address prefixes in an address-family.

- Aggregate-route with nexthop self is advertised in labeled-unicast safi, with implicit/explicit null label.

**Parameter table**

+-----------+------------------+-----------+---------+
| Parameter | Description      | Range     | Default |
+===========+==================+===========+=========+
| ip-prefix | aggregate prefix | A.B.C.D/x | \-      |
+-----------+------------------+-----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)#


**Removing Configuration**

To stop all aggregate-address advertisements:
::

    dnRouter(cfg-protocols-bgp-afi)# no aggregate-address

To stop the advertisement of a specific aggregate-address:
::

    dnRouter(cfg-protocols-bgp-afi)# no aggregate-address 12001::66/90

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-multicast/aggregate-route/as-brief-set.rst

protocols bgp address-family ipv4-multicast aggregate-route as-brief-set
------------------------------------------------------------------------

**Minimum user role:** operator

Sets the aggregate route to include the longest common AS PATH information from all contributing routes in its AS PATH.
To configure the aggregate route setting:

**Command syntax: as-brief-set**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast aggregate-route
- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv6-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Note**

- By default, the aggregate route AS PATH only has local AS when advertised.

- If the aggregate route has reduced the attribute information, then for all contributing routes the ATOMIC AGGREGATE attribute will be advertised.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# as-brief-set

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# as-brief-set


**Removing Configuration**

To stop the as-brief-set behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no as-brief-set

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-multicast/aggregate-route/as-set.rst

protocols bgp address-family ipv4-multicast aggregate-route as-set
------------------------------------------------------------------

**Minimum user role:** operator

Sets the aggregate route to include AS PATH information for all contributing routes in its AS PATH.
To configure the aggregate route setting:

**Command syntax: as-set**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast aggregate-route
- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv6-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Note**

- By default, the aggregate route AS PATH only has local AS when advertised.

- If the aggregate route has reduced the attribute information, then for all contributing routes the ATOMIC AGGREGATE attribute will be advertised.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# as-set

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# as-set


**Removing Configuration**

To stop the as-set behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no as-set

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-multicast/aggregate-route/policy.rst

protocols bgp address-family ipv4-multicast aggregate-route policy
------------------------------------------------------------------

**Minimum user role:** operator

Sets a policy to modify the aggregate route attributes.
A user may deny the aggregate route creation when matching a given aggregate route attribute.

**Command syntax: policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast aggregate-route
- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv6-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Parameter table**

+-------------+-----------------------------------------------------+------------------+---------+
| Parameter   | Description                                         | Range            | Default |
+=============+=====================================================+==================+=========+
| policy-name | impose policy to update aggregate prefix attributes | | string         | \-      |
|             |                                                     | | length 1-255   |         |
+-------------+-----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# policy AGGR_POL

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# policy AGGR_POL


**Removing Configuration**

To remove the policy:
::

    dnRouter(cfg-bgp-afi-aggr)# no policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-multicast/aggregate-route/summary-only.rst

protocols bgp address-family ipv4-multicast aggregate-route summary-only
------------------------------------------------------------------------

**Minimum user role:** operator

To Filter for more specific routes from updates:

**Command syntax: summary-only**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast aggregate-route
- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv6-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# summary-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# summary-only


**Removing Configuration**

To stop the summary-only behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no summary-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-multicast/fast-reroute.rst

protocols bgp address-family ipv4-multicast fast-reroute
--------------------------------------------------------

**Minimum user role:** operator

BGP Loop-Free Alternate (LFA) Fast Reroute (FRR) allows BGP to quickly switch to a backup path when a primary path fails. With LFA FRR, BGP pre-computes a backup path and installs the backup next hop in the forwarding table when a multipath solution is not available.

For example, when the NH interface to an NC-Edge fails, a pre-installed alternate path will provide fast rerouting of the traffic. The other NC-Core devices will continue sending traffic as usual.

<INSERT 05_protocols_bgp>

To enable/disable fast reroute for the BGP protocol:

**Command syntax: fast-reroute [fast-reroute]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP fast-reroute applies only to bgp unicast and multicast sessions, and only to default VRF.

- LFA FRR is supported for both directly connected and remote nexthops. It does not apply to nexthops that are learned via BGP.

**Parameter table**

+--------------+-----------------------------------------------------------------------+--------------+----------+
| Parameter    | Description                                                           | Range        | Default  |
+==============+=======================================================================+==============+==========+
| fast-reroute | Enables bgp nexthop fast reroute for directly connected eBGP neighbor | | enabled    | disabled |
|              |                                                                       | | disabled   |          |
+--------------+-----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled



**Removing Configuration**

To revert to the default admin-state:
::

    dnRouter(cfg-protocols-bgp-afi)# no fast-reroute enabled

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 10.0    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-multicast/maximum-paths_ebgp.rst

protocols bgp address-family ipv4-multicast maximum-paths ebgp
--------------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple equal cost paths in the routing table, when some paths are ebgp and others are ibgp:

**Command syntax: maximum-paths ebgp [ebgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP will only advertise one best path to its eBGP neighbors.

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

- ECMP between ebgp and ibgp paths are only possible if all paths are imported from other vrfs.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ebgp-maximum-paths | Maximum number of parallel paths to consider when using BGP multipath. The       | 1-32  | 1       |
|                    | default is use a single path.                                                    |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ebgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-multicast/maximum-paths_ibgp.rst

protocols bgp address-family ipv4-multicast maximum-paths ibgp
--------------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple paths in the routing table:

**Command syntax: maximum-paths ibgp [ibgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast
- network-services evpn instance protocols bgp
- network-services evpn instance interconnect protocols bgp
- network-services evpn-vpws instance protocols bgp

**Note**

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ibgp-maximum-paths | Maximum number of parallel paths to consider when using iBGP multipath. The      | 1-32  | 1       |
|                    | default is to use a single path                                                  |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ibgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-multicast/network.rst

protocols bgp address-family ipv4-multicast network
---------------------------------------------------

**Minimum user role:** operator

This command instructs BGP to advertise a network to all neighbors. The network will be generated according to the "bgp network import-check" on page 2290 settings. If "bgp network import-check" is enabled, the network will be generated only when the route is found on the RIB. If "bgp network import-check" is disabled, the network will be generated regardless of whether or not the route is found in the RIB.

**Command syntax: network [ip-prefix]** policy [policy-name]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- You can configure multiple networks in an address-family.

- The prefix cannot be a link-local address.

- When setting a non /32 prefix, the route installed is the matching subnet network address. For example, for route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same applies for IPv6 prefixes.

**Parameter table**

+-------------+----------------------------------------------------+------------------+---------+
| Parameter   | Description                                        | Range            | Default |
+=============+====================================================+==================+=========+
| ip-prefix   | network ipv4 prefix                                | A.B.C.D/x        | \-      |
+-------------+----------------------------------------------------+------------------+---------+
| policy-name | policy to apply a route-map policy for the network | | string         | \-      |
|             |                                                    | | length 1-255   |         |
+-------------+----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# network 10.108.0.0/24
    dnRouter(cfg-protocols-bgp-afi)# network 10.90.0.0/16 policy RM_POL

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# network 2001::66/90 policy RM_POL


**Removing Configuration**

To stop all network advertisements:
::

    dnRouter(cfg-protocols-bgp-afi)# no network

To stop advertisement of a specific network:
::

    dnRouter(cfg-protocols-bgp-afi)# no network 12001::66/90

To remove policy filtering for the network:
::

    dnRouter(cfg-protocols-bgp-afi)# no network 10.108.0.0/24 policy

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 6.0     | Command introduced                                      |
+---------+---------------------------------------------------------+
| 9.0     | Added option to remove policy filtering for the network |
+---------+---------------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI     |
+---------+---------------------------------------------------------+

---

### afi_ipv4-multicast/next-hop-tracking.rst

protocols bgp address-family ipv4-multicast next-hop-tracking policy
--------------------------------------------------------------------

**Minimum user role:** operator

BGP next-hop tracking monitors changes in the BGP next-hop address in the RIB. When a change is detected, it is immediately reported to the BGP process to adjust the next-hop in the BGP table. This reduces the BGP convergence time. The next-hop tracking policy validates the prefix that solves the BGP next-hop address.

Once the policy is attached, when BGP receives from the RIB the prefix that solves the next-hop address, it checks the validity of this prefix against the next-hop policy.

If the peer's state is "established", but its next-hop is not valid due to the applied next-hop-tracking policy for BGP, then all the received routes from the peer next-hop will not be selected as the best, and those routes will not be advertised further to other peers accordingly.

To configure next-hop-tracking to a routing policy:

**Command syntax: next-hop-tracking policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

**Parameter table**

+-------------+----------------------------------------+------------------+---------+
| Parameter   | Description                            | Range            | Default |
+=============+========================================+==================+=========+
| policy-name | set nexthop tracking validation policy | | string         | \-      |
|             |                                        | | length 1-255   |         |
+-------------+----------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# next-hop-tracking policy BGP-NEXT-HOP-IPV4

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# next-hop-tracking policy BGP-NEXT-HOP-IPV6

    *** Policy configuration example ***
    routing-policy
      policy BGP-NEXT-HOP-IPV4
        rule 10 allow
          match ipv4 prefix IPV4_NHT_PREFIX
        !
      !
      prefix-list ipv4 IPV4_NHT_PREFIX
        rule 1 allow 201.0.0.0/8 matching-len ge 32
        rule 2 allow 100.0.0.11/32
      !
    !

**Removing Configuration**

To remove the policy attachment:
::

    dnRouter(cfg-protocols-bgp-afi)# no next-hop-tracking

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 13.0    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-multicast/redistribute_connected.rst

protocols bgp address-family ipv4-multicast redistribute connected
------------------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise directly connected routes:

**Command syntax: redistribute connected** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected metric 1000 policy My_Policy, My_Policy2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected metric 1000


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute connected

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute connected metric 

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                              |
+=========+===========================================================================================================+
| 6.0     | Command introduced                                                                                        |
+---------+-----------------------------------------------------------------------------------------------------------+
| 13.2    | Updated command syntax to support ISIS                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------+
| 16.1    | Extended command to support redistribution of connected routes from MRPF table to BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                                                           |
+---------+-----------------------------------------------------------------------------------------------------------+

---

### afi_ipv4-multicast/redistribute_isis.rst

protocols bgp address-family ipv4-multicast redistribute isis
-------------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise ISIS routes:

**Command syntax: redistribute isis** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis metric 1000 policy My_Policy, My_Policy2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis metric 1000


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute isis

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute isis metric 

**Command History**

+---------+---------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                        |
+=========+=====================================================================================================================+
| 13.2    | Updated command syntax to support ISIS                                                                              |
+---------+---------------------------------------------------------------------------------------------------------------------+
| 16.1    | Extended command to support redistribution of ISIS multicast SAFI routes from MRPF table to BGP IPv4 multicast SAFI |
+---------+---------------------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                                                                     |
+---------+---------------------------------------------------------------------------------------------------------------------+

---

### afi_ipv4-unicast/add-path_receive.rst

protocols bgp address-family ipv4-unicast add-path receive
----------------------------------------------------------

**Minimum user role:** operator

Typically, BGP routers advertise only the best path for each route. The advertisement of a prefix replaces the previous announcement of that prefix.

To allow the device to receive multiple paths for the same route from the same BGP neighbor:

**Command syntax: add-path receive [add-path-receive]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

- This command is only applicable to the default VRF.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter        | Description                                                                      | Range        | Default  |
+==================+==================================================================================+==============+==========+
| add-path-receive | Enables additional paths to be received for the same route from a bgp neighbor.  | | enabled    | disabled |
|                  | Applies for all bgp neighbors with this afi/safi                                 | | disabled   |          |
+------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path receive

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 9.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-unicast/add-path_send/add-path_send.rst

protocols bgp address-family ipv4-unicast add-path send
-------------------------------------------------------

**Minimum user role:** operator

BGP Additional Paths is a BGP extension that provides the ability to advertise multiple paths for the same prefix without the new paths replacing previous paths. 
This helps reduce route repetition, and achieve faster re-convergence as an alternative path is available immediately upon failure of a primary path.
To enter the add-path send configuration level:

**Command syntax: add-path send**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#


**Removing Configuration**

To revert the add-path send configurations to default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path send

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-unicast/add-path_send/admin-state.rst

protocols bgp address-family ipv4-unicast add-path send admin-state
-------------------------------------------------------------------

**Minimum user role:** operator

To enable the add-path send behavior for a specific neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv4-vpn add-path send
- protocols bgp address-family ipv6-vpn add-path send

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+-------------+--------------------------------+--------------+----------+
| Parameter   | Description                    | Range        | Default  |
+=============+================================+==============+==========+
| admin-state | add path send enabled/disabled | | enabled    | disabled |
|             |                                | | disabled   |          |
+-------------+--------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no admin-state

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-unicast/add-path_send/path-count.rst

protocols bgp address-family ipv4-unicast add-path send path-count
------------------------------------------------------------------

**Minimum user role:** operator

You can set the number of paths to be sent when add-path send is enabled:

**Command syntax: path-count [path-count]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv4-vpn add-path send
- protocols bgp address-family ipv6-vpn add-path send

**Parameter table**

+------------+----------------------------------------+-------+---------+
| Parameter  | Description                            | Range | Default |
+============+========================================+=======+=========+
| path-count | maximum number of path allowed to send | 2-32  | 2       |
+------------+----------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no path-count

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-unicast/advertise-best-external.rst

protocols bgp address-family ipv4-unicast advertise-best-external
-----------------------------------------------------------------

**Minimum user role:** operator

Allows advertising the best eBGP path to iBGP neighbors, even when the locally selected bestpath is from an iBGP neighbor.

Unicast routes maintain normal bgp behavior so that if the bestpath arrives from an iBGP neighbor, it will not be advertised to another iBGP neighbor.

When it is disabled, all best-external advertisements will be withdrawn.

To allow the device to receive multiple paths for the same route from the same BGP neighbor:

**Command syntax: advertise-best-external [advertise-best-external]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast

**Note**

- This command only supports Labeled-Unicast routes. 

**Parameter table**

+-------------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter               | Description                                                                      | Range        | Default  |
+=========================+==================================================================================+==============+==========+
| advertise-best-external | Advertise the best eBGP path to iBGP neighbors, even when the locally selected   | | enabled    | disabled |
|                         | bestpath is from an iBGP neighbor                                                | | disabled   |          |
+-------------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# advertise-best-external enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# advertise-best-external enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no advertise-best-external

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/afi_ipv4-unicast.rst

protocols bgp address-family ipv4-unicast
-----------------------------------------

**Minimum user role:** operator

To enter global BGP ipv4 address-family configuration:

**Command syntax: address-family ipv4-unicast**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp)# no address-family ipv4-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/aggregate-route/aggregate-route.rst

protocols bgp address-family ipv4-unicast aggregate-route
---------------------------------------------------------

**Minimum user role:** operator

Creates an aggregate (summary) route in a BGP routing table.
An aggregate route will be created if a more specific route exists in the BGP local RIB, and may act as a contributor.
An aggregate route will be installed to the local RIB with nexthop null0 (silent drop).
To create as aggregate route:

**Command syntax: aggregate-route [ip-prefix]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- You can configure multiple aggregate-address prefixes in an address-family.

- Aggregate-route with nexthop self is advertised in labeled-unicast safi, with implicit/explicit null label.

**Parameter table**

+-----------+------------------+-----------+---------+
| Parameter | Description      | Range     | Default |
+===========+==================+===========+=========+
| ip-prefix | aggregate prefix | A.B.C.D/x | \-      |
+-----------+------------------+-----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)#


**Removing Configuration**

To stop all aggregate-address advertisements:
::

    dnRouter(cfg-protocols-bgp-afi)# no aggregate-address

To stop the advertisement of a specific aggregate-address:
::

    dnRouter(cfg-protocols-bgp-afi)# no aggregate-address 12001::66/90

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/aggregate-route/as-brief-set.rst

protocols bgp address-family ipv4-unicast aggregate-route as-brief-set
----------------------------------------------------------------------

**Minimum user role:** operator

Sets the aggregate route to include the longest common AS PATH information from all contributing routes in its AS PATH.
To configure the aggregate route setting:

**Command syntax: as-brief-set**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv4-multicast aggregate-route
- protocols bgp address-family ipv6-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Note**

- By default, the aggregate route AS PATH only has local AS when advertised.

- If the aggregate route has reduced the attribute information, then for all contributing routes the ATOMIC AGGREGATE attribute will be advertised.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# as-brief-set

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# as-brief-set


**Removing Configuration**

To stop the as-brief-set behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no as-brief-set

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/aggregate-route/as-set.rst

protocols bgp address-family ipv4-unicast aggregate-route as-set
----------------------------------------------------------------

**Minimum user role:** operator

Sets the aggregate route to include AS PATH information for all contributing routes in its AS PATH.
To configure the aggregate route setting:

**Command syntax: as-set**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv4-multicast aggregate-route
- protocols bgp address-family ipv6-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Note**

- By default, the aggregate route AS PATH only has local AS when advertised.

- If the aggregate route has reduced the attribute information, then for all contributing routes the ATOMIC AGGREGATE attribute will be advertised.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# as-set

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# as-set


**Removing Configuration**

To stop the as-set behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no as-set

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/aggregate-route/policy.rst

protocols bgp address-family ipv4-unicast aggregate-route policy
----------------------------------------------------------------

**Minimum user role:** operator

Sets a policy to modify the aggregate route attributes.
A user may deny the aggregate route creation when matching a given aggregate route attribute.

**Command syntax: policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv4-multicast aggregate-route
- protocols bgp address-family ipv6-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Parameter table**

+-------------+-----------------------------------------------------+------------------+---------+
| Parameter   | Description                                         | Range            | Default |
+=============+=====================================================+==================+=========+
| policy-name | impose policy to update aggregate prefix attributes | | string         | \-      |
|             |                                                     | | length 1-255   |         |
+-------------+-----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# policy AGGR_POL

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# policy AGGR_POL


**Removing Configuration**

To remove the policy:
::

    dnRouter(cfg-bgp-afi-aggr)# no policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/aggregate-route/summary-only.rst

protocols bgp address-family ipv4-unicast aggregate-route summary-only
----------------------------------------------------------------------

**Minimum user role:** operator

To Filter for more specific routes from updates:

**Command syntax: summary-only**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv4-multicast aggregate-route
- protocols bgp address-family ipv6-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# summary-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# summary-only


**Removing Configuration**

To stop the summary-only behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no summary-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/bgp-leak_import-from.rst

protocols bgp address-family ipv4-unicast bgp-leak import-from policy
---------------------------------------------------------------------

**Minimum user role:** operator

BGP route leaking between vrfs is used to have routes learned an one vrf (including default) and to be used and advertised to peers in another vrf.
BGP route leaking is based on routes being copied between the bgp vrf table and is not subject to l3vpn import/export logic.
A leak policy must be specified
Up to 4 leak imports can be set in a given vrf.

**Command syntax: bgp-leak import-from [origin-vrf] policy [policy-name]** [, policy-name, policy-name]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- Up to 4 different VRFs can used as source VRFs for leaking into the single destination VRF

- A leaked route cannot be leaked again, meaning a route with the "leak-origin" attribute will not be leaked

- A leaked route can be exported to vpn safi, meaning a route that was leaked from vrf A to vrf B and exported from vrf B.

- A vpn route that was leaked, cannot be imported to the same vrf as origin. The route that was leaked from vrf A to vrf B and exported from vrf B, cannot not be importet back to vrf A from vpn.

- An imported route cannot be leaked. If it is required to have the imported route in destination vrf, import to that vrf.

**Parameter table**

+-------------+--------------------------------+------------------+---------+
| Parameter   | Description                    | Range            | Default |
+=============+================================+==================+=========+
| origin-vrf  | origin-vrf                     | | string         | \-      |
|             |                                | | length 1-255   |         |
+-------------+--------------------------------+------------------+---------+
| policy-name | impose policy on leaked routes | | string         | \-      |
|             |                                | | length 1-255   |         |
+-------------+--------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# bgp-leak import-from VRF_A policy LEAK_FROM_A1, LEAK_FROM_A2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-netsrv)# vrf
    dnRouter(cfg-netsrv-vrf)# instance A
    dnRouter(cfg-netsrv-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# bgp 1
    dnRouter(cfg-vrf-inst-protocols)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# bgp-leak import-from default policy LEAK_FROM_DEFAULT1, LEAK_FROM_DEFAULT2


**Removing Configuration**

To stop all leakage:
::

    dnRouter(cfg-protocols-bgp-afi)# no bgp-leak import-from

To stop leakage from a specific vrf:
::

    dnRouter(cfg-protocols-bgp-afi)# no bgp-leak import-from VRF_A

To remove policy from a specific vrf:
::

    dnRouter(cfg-protocols-bgp-afi)# no bgp-leak import-from VRF_A policy LEAK_FROM_A1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/dampening-ebgp-only.rst

protocols bgp address-family ipv4-unicast dampening-ebgp-only
-------------------------------------------------------------

**Minimum user role:** operator

To limit dampening logic for routes received from eBGP peers only:

**Command syntax: dampening-ebgp-only**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening-ebgp-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening-ebgp-only


**Removing Configuration**

To revert to the default admin-state with all optional parameters set to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening-ebgp-only

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 19.0    | Add support for dampening-ebgp-only in most address families |
+---------+--------------------------------------------------------------+

---

### afi_ipv4-unicast/dampening.rst

protocols bgp address-family ipv4-unicast dampening
---------------------------------------------------

**Minimum user role:** operator

Route flapping is a condition in BGP in which a peer advertises that a route is available and then that the same route is unavailable within a short period of time. As a result, BGP excessively adds and removes routes from the forwarding table, increasing the processing load on the router.

Route flap dampening suppresses the advertisement of flapping routes until the route becomes more stable, thus reducing the number of advertisements sent between peers from flapping routers and increasing the stability of the BGP network.

To enable route flap dampening per address-family:

**Command syntax: dampening [admin-state]** half-life [half-life] reuse-threshold [reuse-threshold] suppress-threshold [suppress-threshold] max-suppress [max-suppress]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- The basic command (with no arguments) enables the feature with default values for the thresholds. You can configure different threshold values. The thresholds are listed in the Parameter table:

- This command is only applicable to unicast sub-address-families.

- Half-life, reuse-threshold, suppress-threshold, and max-suppress can only be configured for dampening enabled. When dampening is disabled, all optional parameters are set to their default value

- This option uses non-configurable default values for the following parameters:
- Max suppress penalty: 12000
- Min penalty: 375

**Parameter table**

+--------------------+---------------------------------------------------------------+--------------+----------+
| Parameter          | Description                                                   | Range        | Default  |
+====================+===============================================================+==============+==========+
| admin-state        | Enable route flap damping.                                    | | enabled    | disabled |
|                    |                                                               | | disabled   |          |
+--------------------+---------------------------------------------------------------+--------------+----------+
| half-life          | minutes                                                       | 1-45         | 15       |
+--------------------+---------------------------------------------------------------+--------------+----------+
| reuse-threshold    | Minimum penalty below which routes becomes reusable again     | 1-50000      | 750      |
+--------------------+---------------------------------------------------------------+--------------+----------+
| suppress-threshold | Maximum penalty above which route is suppressed by the device | 1-50000      | 2000     |
+--------------------+---------------------------------------------------------------+--------------+----------+
| max-suppress       | minutes                                                       | 1-255        | 60       |
+--------------------+---------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled half-life 20 reuse-threshold 1000  suppress-threshold 1500 max-suppress 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening disabled half-life 30 reuse-threshold 550  suppress-threshold 1500 max-suppress 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled reuse-threshold 1000


**Removing Configuration**

To revert to the default admin-state with all optional parameters set to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening

To revert to the thresholds to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening reuse-threshold 1000

**Command History**

+---------+-------------------------------------------------------+
| Release | Modification                                          |
+=========+=======================================================+
| 7.0     | Command introduced                                    |
+---------+-------------------------------------------------------+
| 19.0    | Remove support for dampening in some address families |
+---------+-------------------------------------------------------+

---

### afi_ipv4-unicast/fast-reroute.rst

protocols bgp address-family ipv4-unicast fast-reroute
------------------------------------------------------

**Minimum user role:** operator

BGP Loop-Free Alternate (LFA) Fast Reroute (FRR) allows BGP to quickly switch to a backup path when a primary path fails. With LFA FRR, BGP pre-computes a backup path and installs the backup next hop in the forwarding table when a multipath solution is not available.

For example, when the NH interface to an NC-Edge fails, a pre-installed alternate path will provide fast rerouting of the traffic. The other NC-Core devices will continue sending traffic as usual.

<INSERT 05_protocols_bgp>

To enable/disable fast reroute for the BGP protocol:

**Command syntax: fast-reroute [fast-reroute]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP fast-reroute applies only to bgp unicast and multicast sessions, and only to default VRF.

- LFA FRR is supported for both directly connected and remote nexthops. It does not apply to nexthops that are learned via BGP.

**Parameter table**

+--------------+-----------------------------------------------------------------------+--------------+----------+
| Parameter    | Description                                                           | Range        | Default  |
+==============+=======================================================================+==============+==========+
| fast-reroute | Enables bgp nexthop fast reroute for directly connected eBGP neighbor | | enabled    | disabled |
|              |                                                                       | | disabled   |          |
+--------------+-----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled



**Removing Configuration**

To revert to the default admin-state:
::

    dnRouter(cfg-protocols-bgp-afi)# no fast-reroute enabled

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 10.0    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-unicast/label-allocation.rst

protocols bgp address-family ipv4-unicast label-allocation
----------------------------------------------------------

**Minimum user role:** operator

BGP label allocation per next-hop mode for IPv4 labeled-unicast and IPv6 labeled-unicast address families has been added. This mode prevents additional lookup in the device's routing table and conserves label space. The label allocation per next-hop feature allows the same label to be used for all the routes advertised from a unique peer device.

- Per-prefix - A unique label is allocated for each bgp advertise labeled prefix . Local prefixes will share the same php/explicit-null label.

- Per-nexthop - All advertised prefixes, that are locally resolved by the same nexthop, will be assigned the same local label.

To configure per-nexthop/per-prefix label allocation:

**Command syntax: label-allocation [label-allocation-mode]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast sub-address-families.

- The nexthop prefix includes all route resolution variations, including ecmp, egress labels and alternate paths.

**Parameter table**

+-----------------------+-----------------------------------------------------------------------+-----------------+------------+
| Parameter             | Description                                                           | Range           | Default    |
+=======================+=======================================================================+=================+============+
| label-allocation-mode | Configure BGP label allocation mode, either per-prefix or per-nexthop | | per-prefix    | per-prefix |
|                       |                                                                       | | per-nexthop   |            |
+-----------------------+-----------------------------------------------------------------------+-----------------+------------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-prefix

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-nexthop


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no label-allocation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/labeled-unicast/entropy-label.rst

protocols bgp address-family ipv4-unicast labeled-unicast entropy-label
-----------------------------------------------------------------------

**Minimum user role:** operator

Entropy Label is added to the MPLS stack to allow P-Routers to effectively load-balance the traffic without having to perform deep packet inspection.
By enabling this knob, BGP will request from the BGP-LU Peer that an Entropy Label be added to the traffic being sent to this router.

**Command syntax: entropy-label [entropy-label]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast labeled-unicast
- protocols bgp address-family ipv6-unicast labeled-unicast

**Note**

- This command only supports Labeled-Unicast routes.

**Parameter table**

+---------------+------------------------------------------------+--------------+----------+
| Parameter     | Description                                    | Range        | Default  |
+===============+================================================+==============+==========+
| entropy-label | Request entropy-label for labeled-unicast safi | | enabled    | disabled |
|               |                                                | | disabled   |          |
+---------------+------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# entropy-label enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# entropy-label enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-lu)# no entropy-label

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/labeled-unicast/explicit-null.rst

protocols bgp address-family ipv4-unicast labeled-unicast explicit-null
-----------------------------------------------------------------------

**Minimum user role:** operator

explicit-null label advertisement for ipv4 labeled-unicast peer allows the option to signal real mpls label (value 0) instead of the default implicit-null label
To enable explicit-null on global level"

**Command syntax: explicit-null [explicit-null]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast labeled-unicast

**Note**

- This command only supports Labeled-Unicast neighbors.

**Parameter table**

+---------------+------------------------------------------------------------------------+--------------+----------+
| Parameter     | Description                                                            | Range        | Default  |
+===============+========================================================================+==============+==========+
| explicit-null | Apply global configuration for explicit-null advertisement on LU peers | | enabled    | disabled |
|               |                                                                        | | disabled   |          |
+---------------+------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# explicit-null enabled



**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-lu)# no explicit-null

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| TBD     | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/labeled-unicast/labeled-unicast.rst

protocols bgp address-family ipv4-unicast labeled-unicast
---------------------------------------------------------

**Minimum user role:** operator

To enter labeled-unicast safi configuration level:

**Command syntax: labeled-unicast**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)#


**Removing Configuration**

To remove the labeled-unicast configuration:
::

    dnRouter(cfg-protocols-bgp-afi)# no labeled-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/labeled-unicast/prefix-sid.rst

protocols bgp address-family ipv4-unicast labeled-unicast prefix-sid
--------------------------------------------------------------------

**Minimum user role:** operator

BGP Prefix-SID Redistribution allows advertising IPv4 and IPv6 BGP Prefix-SID for SR-MPLS IPv4/IPv6-based networks. 
It is possible for BGP to carry the association of an SR-MPLS Node-SID index with an IPv4/IPv6 prefix. 
This is achieved by attaching a prefix-SID BGP path attribute containing the label-index value to an IPv4/IPv6 route belonging to either an IPv4-LU or IPv6-LU address family.
To enable support for the BGP Prefix-SID (RFC 8669) for the labeled-unicast sub-address-family, the BGP local label allocation will assign a label from the Segment-Routing Global Block according to the prefix Label-Index attribute.

**Command syntax: prefix-sid [prefix-sid]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast labeled-unicast
- protocols bgp address-family ipv6-unicast labeled-unicast

**Note**

- This command only supports Labeled-Unicast routes.

- When working with a prefix-sid, the label-allocation-mode must be per prefix.

- When working with a prefix-sid, for ipv6 labeled-unicast, the label-mode must no be all-explicit-null.

**Parameter table**

+------------+--------------------------------------------------------------------------------+--------------+----------+
| Parameter  | Description                                                                    | Range        | Default  |
+============+================================================================================+==============+==========+
| prefix-sid | Support bgp segment-routing prefix-sid under labeled-unicast safi per RFC 8669 | | enabled    | disabled |
|            |                                                                                | | disabled   |          |
+------------+--------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# prefix-sid enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# prefix-sid enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-lu)# no prefix-sid

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/maximum-paths_ebgp.rst

protocols bgp address-family ipv4-unicast maximum-paths ebgp
------------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple equal cost paths in the routing table, when some paths are ebgp and others are ibgp:

**Command syntax: maximum-paths ebgp [ebgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP will only advertise one best path to its eBGP neighbors.

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

- ECMP between ebgp and ibgp paths are only possible if all paths are imported from other vrfs.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ebgp-maximum-paths | Maximum number of parallel paths to consider when using BGP multipath. The       | 1-32  | 1       |
|                    | default is use a single path.                                                    |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ebgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-unicast/maximum-paths_ibgp.rst

protocols bgp address-family ipv4-unicast maximum-paths ibgp
------------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple paths in the routing table:

**Command syntax: maximum-paths ibgp [ibgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast
- network-services evpn instance protocols bgp
- network-services evpn instance interconnect protocols bgp
- network-services evpn-vpws instance protocols bgp

**Note**

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ibgp-maximum-paths | Maximum number of parallel paths to consider when using iBGP multipath. The      | 1-32  | 1       |
|                    | default is to use a single path                                                  |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ibgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-unicast/network.rst

protocols bgp address-family ipv4-unicast network
-------------------------------------------------

**Minimum user role:** operator

This command instructs BGP to advertise a network to all neighbors. The network will be generated according to the "bgp network import-check" on page 2290 settings. If "bgp network import-check" is enabled, the network will be generated only when the route is found on the RIB. If "bgp network import-check" is disabled, the network will be generated regardless of whether or not the route is found in the RIB.

**Command syntax: network [ip-prefix]** policy [policy-name]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- You can configure multiple networks in an address-family.

- The prefix cannot be a link-local address.

- When setting a non /32 prefix, the route installed is the matching subnet network address. For example, for route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same applies for IPv6 prefixes.

**Parameter table**

+-------------+----------------------------------------------------+------------------+---------+
| Parameter   | Description                                        | Range            | Default |
+=============+====================================================+==================+=========+
| ip-prefix   | network ipv4 prefix                                | A.B.C.D/x        | \-      |
+-------------+----------------------------------------------------+------------------+---------+
| policy-name | policy to apply a route-map policy for the network | | string         | \-      |
|             |                                                    | | length 1-255   |         |
+-------------+----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# network 10.108.0.0/24
    dnRouter(cfg-protocols-bgp-afi)# network 10.90.0.0/16 policy RM_POL

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# network 2001::66/90 policy RM_POL


**Removing Configuration**

To stop all network advertisements:
::

    dnRouter(cfg-protocols-bgp-afi)# no network

To stop advertisement of a specific network:
::

    dnRouter(cfg-protocols-bgp-afi)# no network 12001::66/90

To remove policy filtering for the network:
::

    dnRouter(cfg-protocols-bgp-afi)# no network 10.108.0.0/24 policy

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 6.0     | Command introduced                                      |
+---------+---------------------------------------------------------+
| 9.0     | Added option to remove policy filtering for the network |
+---------+---------------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI     |
+---------+---------------------------------------------------------+

---

### afi_ipv4-unicast/next-hop-tracking.rst

protocols bgp address-family ipv4-unicast next-hop-tracking policy
------------------------------------------------------------------

**Minimum user role:** operator

BGP next-hop tracking monitors changes in the BGP next-hop address in the RIB. When a change is detected, it is immediately reported to the BGP process to adjust the next-hop in the BGP table. This reduces the BGP convergence time. The next-hop tracking policy validates the prefix that solves the BGP next-hop address.

Once the policy is attached, when BGP receives from the RIB the prefix that solves the next-hop address, it checks the validity of this prefix against the next-hop policy.

If the peer's state is "established", but its next-hop is not valid due to the applied next-hop-tracking policy for BGP, then all the received routes from the peer next-hop will not be selected as the best, and those routes will not be advertised further to other peers accordingly.

To configure next-hop-tracking to a routing policy:

**Command syntax: next-hop-tracking policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

**Parameter table**

+-------------+----------------------------------------+------------------+---------+
| Parameter   | Description                            | Range            | Default |
+=============+========================================+==================+=========+
| policy-name | set nexthop tracking validation policy | | string         | \-      |
|             |                                        | | length 1-255   |         |
+-------------+----------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# next-hop-tracking policy BGP-NEXT-HOP-IPV4

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# next-hop-tracking policy BGP-NEXT-HOP-IPV6

    *** Policy configuration example ***
    routing-policy
      policy BGP-NEXT-HOP-IPV4
        rule 10 allow
          match ipv4 prefix IPV4_NHT_PREFIX
        !
      !
      prefix-list ipv4 IPV4_NHT_PREFIX
        rule 1 allow 201.0.0.0/8 matching-len ge 32
        rule 2 allow 100.0.0.11/32
      !
    !

**Removing Configuration**

To remove the policy attachment:
::

    dnRouter(cfg-protocols-bgp-afi)# no next-hop-tracking

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 13.0    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-unicast/redistribute_connected.rst

protocols bgp address-family ipv4-unicast redistribute connected
----------------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise directly connected routes:

**Command syntax: redistribute connected** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected metric 1000 policy My_Policy, My_Policy2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected metric 1000


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute connected

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute connected metric 

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                              |
+=========+===========================================================================================================+
| 6.0     | Command introduced                                                                                        |
+---------+-----------------------------------------------------------------------------------------------------------+
| 13.2    | Updated command syntax to support ISIS                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------+
| 16.1    | Extended command to support redistribution of connected routes from MRPF table to BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                                                           |
+---------+-----------------------------------------------------------------------------------------------------------+

---

### afi_ipv4-unicast/redistribute_isis.rst

protocols bgp address-family ipv4-unicast redistribute isis
-----------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise ISIS routes:

**Command syntax: redistribute isis** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis metric 1000 policy My_Policy, My_Policy2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis metric 1000


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute isis

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute isis metric 

**Command History**

+---------+---------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                        |
+=========+=====================================================================================================================+
| 13.2    | Updated command syntax to support ISIS                                                                              |
+---------+---------------------------------------------------------------------------------------------------------------------+
| 16.1    | Extended command to support redistribution of ISIS multicast SAFI routes from MRPF table to BGP IPv4 multicast SAFI |
+---------+---------------------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                                                                     |
+---------+---------------------------------------------------------------------------------------------------------------------+

---

### afi_ipv4-unicast/redistribute_ospf/metric.rst

protocols bgp address-family ipv4-unicast redistribute ospf instance metric
---------------------------------------------------------------------------

**Minimum user role:** operator

To modify the metric of redistributed routes:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast redistribute ospf instance

**Parameter table**

+-----------+---------------------+--------------+---------+
| Parameter | Description         | Range        | Default |
+===========+=====================+==============+=========+
| metric    | update route metric | 0-4294967295 | \-      |
+-----------+---------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute ospf instance MY_OSPF_INSTANCE
    dnRouter(cfg-bgp-afi-rdst-ospf)# metric 100


**Removing Configuration**

To revert metric to default value:
::

    dnRouter(cfg-bgp-afi-rdst-ospf)# no metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-unicast/redistribute_ospf/policy.rst

protocols bgp address-family ipv4-unicast redistribute ospf instance policy
---------------------------------------------------------------------------

**Minimum user role:** operator

Impose a routing policy or policies to filter or modify redistributed routes:

**Command syntax: policy [policy]** [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast redistribute ospf instance

**Note**

- Can set multiple policies. If multiple policies are set the policies are evaluated one after the other according to the user input order.

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute ospf instance MY_OSPF_INSTANCE
    dnRouter(cfg-bgp-afi-rdst-ospf)# policy My_Policy, My_Policy2


**Removing Configuration**

To remove policy:
::

    dnRouter(cfg-bgp-afi-rdst-ospf)# no policy My_Policy

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 18.1    | Added support for multiple policies attachments |
+---------+-------------------------------------------------+

---

### afi_ipv4-unicast/redistribute_ospf/redistribute_ospf.rst

protocols bgp address-family ipv4-unicast redistribute ospf instance
--------------------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise the OSPF routes. 

**Command syntax: redistribute ospf instance [ospf-instance-name]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast

**Note**

- This command is only applicable to unicast sub-address-families.

- Can set multiple policies. If multiple policies are set the policies are evaluated one after the other according to the user input order.

- You can specify the OSPFv2 instance you want to configure.

**Parameter table**

+--------------------+----------------------+-------+---------+
| Parameter          | Description          | Range | Default |
+====================+======================+=======+=========+
| ospf-instance-name | OSPFv2 instance name | \-    | \-      |
+--------------------+----------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute ospf instance MY_OSPF_INSTANCE
    dnRouter(cfg-bgp-afi-rdst-ospf)#


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of OSPFv2 instance routes:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute ospf INSTANCE_NAME

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 18.1    | Added support for multiple policies attachments                |
+---------+----------------------------------------------------------------+
| 18.1    | Command modified to support per OSPFv2 instance redistribution |
+---------+----------------------------------------------------------------+

---

### afi_ipv4-unicast/redistribute_static.rst

protocols bgp address-family ipv4-unicast redistribute static
-------------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise static routes:

**Command syntax: redistribute static** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order.

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute static

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute static metric 1000 policy My_Policy, My_Policy2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute static metric 1000


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute static

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute static metric 

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 6.0     | Command introduced                              |
+---------+-------------------------------------------------+
| 17.2    | Added support for multiple policies attachments |
+---------+-------------------------------------------------+

---

### afi_ipv4-unicast/rib-install-policy.rst

protocols bgp address-family ipv4-unicast rib-install policy
------------------------------------------------------------

**Minimum user role:** operator

Apply policy on BGP installation to RIB to impose route modifications

**Command syntax: rib-install policy [policy-name]** [, policy-name, policy-name]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- A BGP attribute modification done via policy will not be reflected in the advertised routes to peers. i.e policy is towards rib only and after adj-out construction.

- Policy cannot be used to filter routes from RIB - If policy resulted in deny, e.g matched on a deny rule (or ended on the default deny all rule) policy will not impose any action (including any set actions) on the routes.

- Applies for both unicast and label-unicast routes.

- Policy modification may cause BGP route update to RIB.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order.

**Parameter table**

+-------------+-----------------------------------------------------+------------------+---------+
| Parameter   | Description                                         | Range            | Default |
+=============+=====================================================+==================+=========+
| policy-name | Policy for routes updated prior to RIB installation | | string         | \-      |
|             |                                                     | | length 1-255   |         |
+-------------+-----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# rib-install policy TO_RIB_POL, TO_RIB_POL2
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# rib-install policy TO_RIB_POL, TO_RIB_POL2


**Removing Configuration**

To remove policy attachment:
::

    dnRouter(cfg-protocols-bgp-afi)# no rib-install policy

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 17.1    | Command introduced                              |
+---------+-------------------------------------------------+
| 17.2    | Added support for multiple policies attachments |
+---------+-------------------------------------------------+

---

### afi_ipv4-vpn/add-path_receive.rst

protocols bgp address-family ipv4-vpn add-path receive
------------------------------------------------------

**Minimum user role:** operator

Typically, BGP routers advertise only the best path for each route. The advertisement of a prefix replaces the previous announcement of that prefix.

To allow the device to receive multiple paths for the same route from the same BGP neighbor:

**Command syntax: add-path receive [add-path-receive]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

- This command is only applicable to the default VRF.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter        | Description                                                                      | Range        | Default  |
+==================+==================================================================================+==============+==========+
| add-path-receive | Enables additional paths to be received for the same route from a bgp neighbor.  | | enabled    | disabled |
|                  | Applies for all bgp neighbors with this afi/safi                                 | | disabled   |          |
+------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path receive

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 9.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-vpn/add-path_send/add-path_send.rst

protocols bgp address-family ipv4-vpn add-path send
---------------------------------------------------

**Minimum user role:** operator

BGP Additional Paths is a BGP extension that provides the ability to advertise multiple paths for the same prefix without the new paths replacing previous paths. 
This helps reduce route repetition, and achieve faster re-convergence as an alternative path is available immediately upon failure of a primary path.
To enter the add-path send configuration level:

**Command syntax: add-path send**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#


**Removing Configuration**

To revert the add-path send configurations to default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path send

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-vpn/add-path_send/admin-state.rst

protocols bgp address-family ipv4-vpn add-path send admin-state
---------------------------------------------------------------

**Minimum user role:** operator

To enable the add-path send behavior for a specific neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn add-path send
- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv6-vpn add-path send

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+-------------+--------------------------------+--------------+----------+
| Parameter   | Description                    | Range        | Default  |
+=============+================================+==============+==========+
| admin-state | add path send enabled/disabled | | enabled    | disabled |
|             |                                | | disabled   |          |
+-------------+--------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no admin-state

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-vpn/add-path_send/path-count.rst

protocols bgp address-family ipv4-vpn add-path send path-count
--------------------------------------------------------------

**Minimum user role:** operator

You can set the number of paths to be sent when add-path send is enabled:

**Command syntax: path-count [path-count]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn add-path send
- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv6-vpn add-path send

**Parameter table**

+------------+----------------------------------------+-------+---------+
| Parameter  | Description                            | Range | Default |
+============+========================================+=======+=========+
| path-count | maximum number of path allowed to send | 2-32  | 2       |
+------------+----------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no path-count

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-vpn/afi_ipv4-vpn.rst

protocols bgp address-family ipv4-vpn
-------------------------------------

**Minimum user role:** operator

To enter global BGP ipv4-VPN address-family configuration:

**Command syntax: address-family ipv4-vpn**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-vpn
    dnRouter(cfg-protocols-bgp-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp)# no address-family ipv4-vpn

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-vpn/dampening-ebgp-only.rst

protocols bgp address-family ipv4-vpn dampening-ebgp-only
---------------------------------------------------------

**Minimum user role:** operator

To limit dampening logic for routes received from eBGP peers only:

**Command syntax: dampening-ebgp-only**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening-ebgp-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening-ebgp-only


**Removing Configuration**

To revert to the default admin-state with all optional parameters set to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening-ebgp-only

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 19.0    | Add support for dampening-ebgp-only in most address families |
+---------+--------------------------------------------------------------+

---

### afi_ipv4-vpn/dampening.rst

protocols bgp address-family ipv4-vpn dampening
-----------------------------------------------

**Minimum user role:** operator

Route flapping is a condition in BGP in which a peer advertises that a route is available and then that the same route is unavailable within a short period of time. As a result, BGP excessively adds and removes routes from the forwarding table, increasing the processing load on the router.

Route flap dampening suppresses the advertisement of flapping routes until the route becomes more stable, thus reducing the number of advertisements sent between peers from flapping routers and increasing the stability of the BGP network.

To enable route flap dampening per address-family:

**Command syntax: dampening [admin-state]** half-life [half-life] reuse-threshold [reuse-threshold] suppress-threshold [suppress-threshold] max-suppress [max-suppress]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv6-vpn

**Note**

- The basic command (with no arguments) enables the feature with default values for the thresholds. You can configure different threshold values. The thresholds are listed in the Parameter table:

- This command is only applicable to unicast sub-address-families.

- Half-life, reuse-threshold, suppress-threshold, and max-suppress can only be configured for dampening enabled. When dampening is disabled, all optional parameters are set to their default value

- This option uses non-configurable default values for the following parameters:
- Max suppress penalty: 12000
- Min penalty: 375

**Parameter table**

+--------------------+---------------------------------------------------------------+--------------+----------+
| Parameter          | Description                                                   | Range        | Default  |
+====================+===============================================================+==============+==========+
| admin-state        | Enable route flap damping.                                    | | enabled    | disabled |
|                    |                                                               | | disabled   |          |
+--------------------+---------------------------------------------------------------+--------------+----------+
| half-life          | minutes                                                       | 1-45         | 15       |
+--------------------+---------------------------------------------------------------+--------------+----------+
| reuse-threshold    | Minimum penalty below which routes becomes reusable again     | 1-50000      | 750      |
+--------------------+---------------------------------------------------------------+--------------+----------+
| suppress-threshold | Maximum penalty above which route is suppressed by the device | 1-50000      | 2000     |
+--------------------+---------------------------------------------------------------+--------------+----------+
| max-suppress       | minutes                                                       | 1-255        | 60       |
+--------------------+---------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled half-life 20 reuse-threshold 1000  suppress-threshold 1500 max-suppress 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening disabled half-life 30 reuse-threshold 550  suppress-threshold 1500 max-suppress 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled reuse-threshold 1000


**Removing Configuration**

To revert to the default admin-state with all optional parameters set to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening

To revert to the thresholds to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening reuse-threshold 1000

**Command History**

+---------+-------------------------------------------------------+
| Release | Modification                                          |
+=========+=======================================================+
| 7.0     | Command introduced                                    |
+---------+-------------------------------------------------------+
| 19.0    | Remove support for dampening in some address families |
+---------+-------------------------------------------------------+

---

### afi_ipv4-vpn/fast-reroute.rst

protocols bgp address-family ipv4-vpn fast-reroute
--------------------------------------------------

**Minimum user role:** operator

BGP Loop-Free Alternate (LFA) Fast Reroute (FRR) allows BGP to quickly switch to a backup path when a primary path fails. With LFA FRR, BGP pre-computes a backup path and installs the backup next hop in the forwarding table when a multipath solution is not available.

For example, when the NH interface to an NC-Edge fails, a pre-installed alternate path will provide fast rerouting of the traffic. The other NC-Core devices will continue sending traffic as usual.

<INSERT 05_protocols_bgp>

To enable/disable fast reroute for the BGP protocol:

**Command syntax: fast-reroute [fast-reroute]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP fast-reroute applies only to bgp unicast and multicast sessions, and only to default VRF.

- LFA FRR is supported for both directly connected and remote nexthops. It does not apply to nexthops that are learned via BGP.

**Parameter table**

+--------------+-----------------------------------------------------------------------+--------------+----------+
| Parameter    | Description                                                           | Range        | Default  |
+==============+=======================================================================+==============+==========+
| fast-reroute | Enables bgp nexthop fast reroute for directly connected eBGP neighbor | | enabled    | disabled |
|              |                                                                       | | disabled   |          |
+--------------+-----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled



**Removing Configuration**

To revert to the default admin-state:
::

    dnRouter(cfg-protocols-bgp-afi)# no fast-reroute enabled

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 10.0    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-vpn/label-allocation.rst

protocols bgp address-family ipv4-vpn label-allocation
------------------------------------------------------

**Minimum user role:** operator

BGP label allocation per next-hop mode for IPv4 labeled-unicast and IPv6 labeled-unicast address families has been added. This mode prevents additional lookup in the device's routing table and conserves label space. The label allocation per next-hop feature allows the same label to be used for all the routes advertised from a unique peer device.

- Per-prefix - A unique label is allocated for each bgp advertise labeled prefix . Local prefixes will share the same php/explicit-null label.

- Per-nexthop - All advertised prefixes, that are locally resolved by the same nexthop, will be assigned the same local label.

To configure per-nexthop/per-prefix label allocation:

**Command syntax: label-allocation [label-allocation-mode]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast sub-address-families.

- The nexthop prefix includes all route resolution variations, including ecmp, egress labels and alternate paths.

**Parameter table**

+-----------------------+-----------------------------------------------------------------------+-----------------+------------+
| Parameter             | Description                                                           | Range           | Default    |
+=======================+=======================================================================+=================+============+
| label-allocation-mode | Configure BGP label allocation mode, either per-prefix or per-nexthop | | per-prefix    | per-prefix |
|                       |                                                                       | | per-nexthop   |            |
+-----------------------+-----------------------------------------------------------------------+-----------------+------------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-prefix

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-nexthop


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no label-allocation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv4-vpn/maximum-paths_ebgp.rst

protocols bgp address-family ipv4-vpn maximum-paths ebgp
--------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple equal cost paths in the routing table, when some paths are ebgp and others are ibgp:

**Command syntax: maximum-paths ebgp [ebgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP will only advertise one best path to its eBGP neighbors.

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

- ECMP between ebgp and ibgp paths are only possible if all paths are imported from other vrfs.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ebgp-maximum-paths | Maximum number of parallel paths to consider when using BGP multipath. The       | 1-32  | 1       |
|                    | default is use a single path.                                                    |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ebgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv4-vpn/maximum-paths_ibgp.rst

protocols bgp address-family ipv4-vpn maximum-paths ibgp
--------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple paths in the routing table:

**Command syntax: maximum-paths ibgp [ibgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast
- network-services evpn instance protocols bgp
- network-services evpn instance interconnect protocols bgp
- network-services evpn-vpws instance protocols bgp

**Note**

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ibgp-maximum-paths | Maximum number of parallel paths to consider when using iBGP multipath. The      | 1-32  | 1       |
|                    | default is to use a single path                                                  |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ibgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/add-path_receive.rst

protocols bgp address-family ipv6-unicast add-path receive
----------------------------------------------------------

**Minimum user role:** operator

Typically, BGP routers advertise only the best path for each route. The advertisement of a prefix replaces the previous announcement of that prefix.

To allow the device to receive multiple paths for the same route from the same BGP neighbor:

**Command syntax: add-path receive [add-path-receive]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

- This command is only applicable to the default VRF.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter        | Description                                                                      | Range        | Default  |
+==================+==================================================================================+==============+==========+
| add-path-receive | Enables additional paths to be received for the same route from a bgp neighbor.  | | enabled    | disabled |
|                  | Applies for all bgp neighbors with this afi/safi                                 | | disabled   |          |
+------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path receive

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 9.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/add-path_send/add-path_send.rst

protocols bgp address-family ipv6-unicast add-path send
-------------------------------------------------------

**Minimum user role:** operator

BGP Additional Paths is a BGP extension that provides the ability to advertise multiple paths for the same prefix without the new paths replacing previous paths. 
This helps reduce route repetition, and achieve faster re-convergence as an alternative path is available immediately upon failure of a primary path.
To enter the add-path send configuration level:

**Command syntax: add-path send**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#


**Removing Configuration**

To revert the add-path send configurations to default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path send

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/add-path_send/admin-state.rst

protocols bgp address-family ipv6-unicast add-path send admin-state
-------------------------------------------------------------------

**Minimum user role:** operator

To enable the add-path send behavior for a specific neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv4-vpn add-path send
- protocols bgp address-family ipv6-vpn add-path send

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+-------------+--------------------------------+--------------+----------+
| Parameter   | Description                    | Range        | Default  |
+=============+================================+==============+==========+
| admin-state | add path send enabled/disabled | | enabled    | disabled |
|             |                                | | disabled   |          |
+-------------+--------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no admin-state

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/add-path_send/path-count.rst

protocols bgp address-family ipv6-unicast add-path send path-count
------------------------------------------------------------------

**Minimum user role:** operator

You can set the number of paths to be sent when add-path send is enabled:

**Command syntax: path-count [path-count]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv4-vpn add-path send
- protocols bgp address-family ipv6-vpn add-path send

**Parameter table**

+------------+----------------------------------------+-------+---------+
| Parameter  | Description                            | Range | Default |
+============+========================================+=======+=========+
| path-count | maximum number of path allowed to send | 2-32  | 2       |
+------------+----------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no path-count

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/advertise-best-external.rst

protocols bgp address-family ipv6-unicast advertise-best-external
-----------------------------------------------------------------

**Minimum user role:** operator

Allows advertising the best eBGP path to iBGP neighbors, even when the locally selected bestpath is from an iBGP neighbor.

Unicast routes maintain normal bgp behavior so that if the bestpath arrives from an iBGP neighbor, it will not be advertised to another iBGP neighbor.

When it is disabled, all best-external advertisements will be withdrawn.

To allow the device to receive multiple paths for the same route from the same BGP neighbor:

**Command syntax: advertise-best-external [advertise-best-external]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast

**Note**

- This command only supports Labeled-Unicast routes. 

**Parameter table**

+-------------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter               | Description                                                                      | Range        | Default  |
+=========================+==================================================================================+==============+==========+
| advertise-best-external | Advertise the best eBGP path to iBGP neighbors, even when the locally selected   | | enabled    | disabled |
|                         | bestpath is from an iBGP neighbor                                                | | disabled   |          |
+-------------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# advertise-best-external enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# advertise-best-external enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no advertise-best-external

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/afi_ipv6-unicast.rst

protocols bgp address-family ipv6-unicast
-----------------------------------------

**Minimum user role:** operator

To enter global BGP ipv6 address-family configuration:

**Command syntax: address-family ipv6-unicast**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- When using OSPFv3 or IPv6-based BGP peering within a routing instance, you must explicitly configure a router ID (router-id) for that specific instance. The main routing instance's router ID is not inherited by other instances. Even if only IPv6 protocols are used, a 32-bit router ID is still required, as IPv6 routing protocols rely on it for establishing adjacencies. The router ID must be a non-zero 32-bit (4-octet) unsigned integer. While it's common to use an IPv4 address as the router ID, this is not mandatory - it doesnt need to be a valid or routable address, just a unique 32-bit value within the routing domain. Failing to configure a router ID in an IPv6 OSPF or BGP instance will result in the protocol defaulting to 0.0.0.0, which is invalid. This will prevent adjacency formation and BGP session establishment.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp)# no address-family ipv6-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/aggregate-route/aggregate-route.rst

protocols bgp address-family ipv6-unicast aggregate-route
---------------------------------------------------------

**Minimum user role:** operator

Creates an aggregate (summary) route in a BGP routing table.
An aggregate route will be created if a more specific route exists in the BGP local RIB, and may act as a contributor.
An aggregate route will be installed to the local RIB with nexthop null0 (silent drop).
To create as aggregate route:

**Command syntax: aggregate-route [ip-prefix]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- You can configure multiple aggregate-address prefixes in an address-family.

- Aggregate-route with nexthop self is advertised in labeled-unicast safi, with implicit/explicit null label.

**Parameter table**

+-----------+------------------+------------+---------+
| Parameter | Description      | Range      | Default |
+===========+==================+============+=========+
| ip-prefix | aggregate prefix | X:X::X:X/x | \-      |
+-----------+------------------+------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)#


**Removing Configuration**

To stop all aggregate-address advertisements:
::

    dnRouter(cfg-protocols-bgp-afi)# no aggregate-address

To stop the advertisement of a specific aggregate-address:
::

    dnRouter(cfg-protocols-bgp-afi)# no aggregate-address 12001::66/90

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/aggregate-route/as-brief-set.rst

protocols bgp address-family ipv6-unicast aggregate-route as-brief-set
----------------------------------------------------------------------

**Minimum user role:** operator

Sets the aggregate route to include the longest common AS PATH information from all contributing routes in its AS PATH.
To configure the aggregate route setting:

**Command syntax: as-brief-set**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast aggregate-route
- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv4-multicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Note**

- By default, the aggregate route AS PATH only has local AS when advertised.

- If the aggregate route has reduced the attribute information, then for all contributing routes the ATOMIC AGGREGATE attribute will be advertised.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# as-brief-set

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# as-brief-set


**Removing Configuration**

To stop the as-brief-set behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no as-brief-set

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/aggregate-route/as-set.rst

protocols bgp address-family ipv6-unicast aggregate-route as-set
----------------------------------------------------------------

**Minimum user role:** operator

Sets the aggregate route to include AS PATH information for all contributing routes in its AS PATH.
To configure the aggregate route setting:

**Command syntax: as-set**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast aggregate-route
- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv4-multicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Note**

- By default, the aggregate route AS PATH only has local AS when advertised.

- If the aggregate route has reduced the attribute information, then for all contributing routes the ATOMIC AGGREGATE attribute will be advertised.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# as-set

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# as-set


**Removing Configuration**

To stop the as-set behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no as-set

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/aggregate-route/policy.rst

protocols bgp address-family ipv6-unicast aggregate-route policy
----------------------------------------------------------------

**Minimum user role:** operator

Sets a policy to modify the aggregate route attributes.
A user may deny the aggregate route creation when matching a given aggregate route attribute.

**Command syntax: policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast aggregate-route
- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv4-multicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Parameter table**

+-------------+-----------------------------------------------------+------------------+---------+
| Parameter   | Description                                         | Range            | Default |
+=============+=====================================================+==================+=========+
| policy-name | impose policy to update aggregate prefix attributes | | string         | \-      |
|             |                                                     | | length 1-255   |         |
+-------------+-----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# policy AGGR_POL

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# policy AGGR_POL


**Removing Configuration**

To remove the policy:
::

    dnRouter(cfg-bgp-afi-aggr)# no policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/aggregate-route/summary-only.rst

protocols bgp address-family ipv6-unicast aggregate-route summary-only
----------------------------------------------------------------------

**Minimum user role:** operator

To Filter for more specific routes from updates:

**Command syntax: summary-only**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast aggregate-route
- protocols bgp address-family ipv4-unicast aggregate-route
- protocols bgp address-family ipv4-multicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv4-unicast aggregate-route
- network-services vrf instance protocols bgp address-family ipv6-unicast aggregate-route

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 10.108.0.0/16
    dnRouter(cfg-bgp-afi-aggr)# summary-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# aggregate-address 2001::66/90
    dnRouter(cfg-bgp-afi-aggr)# summary-only


**Removing Configuration**

To stop the summary-only behavior:
::

    dnRouter(cfg-bgp-afi-aggr)# no summary-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/bgp-leak_import-from.rst

protocols bgp address-family ipv6-unicast bgp-leak import-from policy
---------------------------------------------------------------------

**Minimum user role:** operator

BGP route leaking between vrfs is used to have routes learned an one vrf (including default) and to be used and advertised to peers in another vrf.
BGP route leaking is based on routes being copied between the bgp vrf table and is not subject to l3vpn import/export logic.
A leak policy must be specified
Up to 4 leak imports can be set in a given vrf.

**Command syntax: bgp-leak import-from [origin-vrf] policy [policy-name]** [, policy-name, policy-name]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- Up to 4 different VRFs can used as source VRFs for leaking into the single destination VRF

- A leaked route cannot be leaked again, meaning a route with the "leak-origin" attribute will not be leaked

- A leaked route can be exported to vpn safi, meaning a route that was leaked from vrf A to vrf B and exported from vrf B.

- A vpn route that was leaked, cannot be imported to the same vrf as origin. The route that was leaked from vrf A to vrf B and exported from vrf B, cannot not be importet back to vrf A from vpn.

- An imported route cannot be leaked. If it is required to have the imported route in destination vrf, import to that vrf.

**Parameter table**

+-------------+--------------------------------+------------------+---------+
| Parameter   | Description                    | Range            | Default |
+=============+================================+==================+=========+
| origin-vrf  | origin-vrf                     | | string         | \-      |
|             |                                | | length 1-255   |         |
+-------------+--------------------------------+------------------+---------+
| policy-name | impose policy on leaked routes | | string         | \-      |
|             |                                | | length 1-255   |         |
+-------------+--------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# bgp-leak import-from VRF_A policy LEAK_FROM_A1, LEAK_FROM_A2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-netsrv)# vrf
    dnRouter(cfg-netsrv-vrf)# instance A
    dnRouter(cfg-netsrv-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# bgp 1
    dnRouter(cfg-vrf-inst-protocols)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# bgp-leak import-from default policy LEAK_FROM_DEFAULT1, LEAK_FROM_DEFAULT2


**Removing Configuration**

To stop all leakage:
::

    dnRouter(cfg-protocols-bgp-afi)# no bgp-leak import-from

To stop leakage from a specific vrf:
::

    dnRouter(cfg-protocols-bgp-afi)# no bgp-leak import-from VRF_A

To remove policy from a specific vrf:
::

    dnRouter(cfg-protocols-bgp-afi)# no bgp-leak import-from VRF_A policy LEAK_FROM_A1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/dampening-ebgp-only.rst

protocols bgp address-family ipv6-unicast dampening-ebgp-only
-------------------------------------------------------------

**Minimum user role:** operator

To limit dampening logic for routes received from eBGP peers only:

**Command syntax: dampening-ebgp-only**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening-ebgp-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening-ebgp-only


**Removing Configuration**

To revert to the default admin-state with all optional parameters set to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening-ebgp-only

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 19.0    | Add support for dampening-ebgp-only in most address families |
+---------+--------------------------------------------------------------+

---

### afi_ipv6-unicast/dampening.rst

protocols bgp address-family ipv6-unicast dampening
---------------------------------------------------

**Minimum user role:** operator

Route flapping is a condition in BGP in which a peer advertises that a route is available and then that the same route is unavailable within a short period of time. As a result, BGP excessively adds and removes routes from the forwarding table, increasing the processing load on the router.

Route flap dampening suppresses the advertisement of flapping routes until the route becomes more stable, thus reducing the number of advertisements sent between peers from flapping routers and increasing the stability of the BGP network.

To enable route flap dampening per address-family:

**Command syntax: dampening [admin-state]** half-life [half-life] reuse-threshold [reuse-threshold] suppress-threshold [suppress-threshold] max-suppress [max-suppress]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- The basic command (with no arguments) enables the feature with default values for the thresholds. You can configure different threshold values. The thresholds are listed in the Parameter table:

- This command is only applicable to unicast sub-address-families.

- Half-life, reuse-threshold, suppress-threshold, and max-suppress can only be configured for dampening enabled. When dampening is disabled, all optional parameters are set to their default value

- This option uses non-configurable default values for the following parameters:
- Max suppress penalty: 12000
- Min penalty: 375

**Parameter table**

+--------------------+---------------------------------------------------------------+--------------+----------+
| Parameter          | Description                                                   | Range        | Default  |
+====================+===============================================================+==============+==========+
| admin-state        | Enable route flap damping.                                    | | enabled    | disabled |
|                    |                                                               | | disabled   |          |
+--------------------+---------------------------------------------------------------+--------------+----------+
| half-life          | minutes                                                       | 1-45         | 15       |
+--------------------+---------------------------------------------------------------+--------------+----------+
| reuse-threshold    | Minimum penalty below which routes becomes reusable again     | 1-50000      | 750      |
+--------------------+---------------------------------------------------------------+--------------+----------+
| suppress-threshold | Maximum penalty above which route is suppressed by the device | 1-50000      | 2000     |
+--------------------+---------------------------------------------------------------+--------------+----------+
| max-suppress       | minutes                                                       | 1-255        | 60       |
+--------------------+---------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled half-life 20 reuse-threshold 1000  suppress-threshold 1500 max-suppress 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening disabled half-life 30 reuse-threshold 550  suppress-threshold 1500 max-suppress 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled reuse-threshold 1000


**Removing Configuration**

To revert to the default admin-state with all optional parameters set to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening

To revert to the thresholds to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening reuse-threshold 1000

**Command History**

+---------+-------------------------------------------------------+
| Release | Modification                                          |
+=========+=======================================================+
| 7.0     | Command introduced                                    |
+---------+-------------------------------------------------------+
| 19.0    | Remove support for dampening in some address families |
+---------+-------------------------------------------------------+

---

### afi_ipv6-unicast/fast-reroute.rst

protocols bgp address-family ipv6-unicast fast-reroute
------------------------------------------------------

**Minimum user role:** operator

BGP Loop-Free Alternate (LFA) Fast Reroute (FRR) allows BGP to quickly switch to a backup path when a primary path fails. With LFA FRR, BGP pre-computes a backup path and installs the backup next hop in the forwarding table when a multipath solution is not available.

For example, when the NH interface to an NC-Edge fails, a pre-installed alternate path will provide fast rerouting of the traffic. The other NC-Core devices will continue sending traffic as usual.

<INSERT 05_protocols_bgp>

To enable/disable fast reroute for the BGP protocol:

**Command syntax: fast-reroute [fast-reroute]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP fast-reroute applies only to bgp unicast and multicast sessions, and only to default VRF.

- LFA FRR is supported for both directly connected and remote nexthops. It does not apply to nexthops that are learned via BGP.

**Parameter table**

+--------------+-----------------------------------------------------------------------+--------------+----------+
| Parameter    | Description                                                           | Range        | Default  |
+==============+=======================================================================+==============+==========+
| fast-reroute | Enables bgp nexthop fast reroute for directly connected eBGP neighbor | | enabled    | disabled |
|              |                                                                       | | disabled   |          |
+--------------+-----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled



**Removing Configuration**

To revert to the default admin-state:
::

    dnRouter(cfg-protocols-bgp-afi)# no fast-reroute enabled

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 10.0    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/label-allocation.rst

protocols bgp address-family ipv6-unicast label-allocation
----------------------------------------------------------

**Minimum user role:** operator

BGP label allocation per next-hop mode for IPv4 labeled-unicast and IPv6 labeled-unicast address families has been added. This mode prevents additional lookup in the device's routing table and conserves label space. The label allocation per next-hop feature allows the same label to be used for all the routes advertised from a unique peer device.

- Per-prefix - A unique label is allocated for each bgp advertise labeled prefix . Local prefixes will share the same php/explicit-null label.

- Per-nexthop - All advertised prefixes, that are locally resolved by the same nexthop, will be assigned the same local label.

To configure per-nexthop/per-prefix label allocation:

**Command syntax: label-allocation [label-allocation-mode]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn

**Note**

- This command is only applicable to unicast sub-address-families.

- The nexthop prefix includes all route resolution variations, including ecmp, egress labels and alternate paths.

**Parameter table**

+-----------------------+-----------------------------------------------------------------------+-----------------+------------+
| Parameter             | Description                                                           | Range           | Default    |
+=======================+=======================================================================+=================+============+
| label-allocation-mode | Configure BGP label allocation mode, either per-prefix or per-nexthop | | per-prefix    | per-prefix |
|                       |                                                                       | | per-nexthop   |            |
+-----------------------+-----------------------------------------------------------------------+-----------------+------------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-prefix

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-nexthop


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no label-allocation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/labeled-unicast/entropy-label.rst

protocols bgp address-family ipv6-unicast labeled-unicast entropy-label
-----------------------------------------------------------------------

**Minimum user role:** operator

Entropy Label is added to the MPLS stack to allow P-Routers to effectively load-balance the traffic without having to perform deep packet inspection.
By enabling this knob, BGP will request from the BGP-LU Peer that an Entropy Label be added to the traffic being sent to this router.

**Command syntax: entropy-label [entropy-label]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast labeled-unicast
- protocols bgp address-family ipv4-unicast labeled-unicast

**Note**

- This command only supports Labeled-Unicast routes.

**Parameter table**

+---------------+------------------------------------------------+--------------+----------+
| Parameter     | Description                                    | Range        | Default  |
+===============+================================================+==============+==========+
| entropy-label | Request entropy-label for labeled-unicast safi | | enabled    | disabled |
|               |                                                | | disabled   |          |
+---------------+------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# entropy-label enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# entropy-label enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-lu)# no entropy-label

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/labeled-unicast/labeled-unicast.rst

protocols bgp address-family ipv6-unicast labeled-unicast
---------------------------------------------------------

**Minimum user role:** operator

To enter labeled-unicast safi configuration level:

**Command syntax: labeled-unicast**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)#


**Removing Configuration**

To remove the labeled-unicast configuration:
::

    dnRouter(cfg-protocols-bgp-afi)# no labeled-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/labeled-unicast/prefix-sid.rst

protocols bgp address-family ipv6-unicast labeled-unicast prefix-sid
--------------------------------------------------------------------

**Minimum user role:** operator

BGP Prefix-SID Redistribution allows advertising IPv4 and IPv6 BGP Prefix-SID for SR-MPLS IPv4/IPv6-based networks. 
It is possible for BGP to carry the association of an SR-MPLS Node-SID index with an IPv4/IPv6 prefix. 
This is achieved by attaching a prefix-SID BGP path attribute containing the label-index value to an IPv4/IPv6 route belonging to either an IPv4-LU or IPv6-LU address family.
To enable support for the BGP Prefix-SID (RFC 8669) for the labeled-unicast sub-address-family, the BGP local label allocation will assign a label from the Segment-Routing Global Block according to the prefix Label-Index attribute.

**Command syntax: prefix-sid [prefix-sid]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast labeled-unicast
- protocols bgp address-family ipv4-unicast labeled-unicast

**Note**

- This command only supports Labeled-Unicast routes.

- When working with a prefix-sid, the label-allocation-mode must be per prefix.

- When working with a prefix-sid, for ipv6 labeled-unicast, the label-mode must no be all-explicit-null.

**Parameter table**

+------------+--------------------------------------------------------------------------------+--------------+----------+
| Parameter  | Description                                                                    | Range        | Default  |
+============+================================================================================+==============+==========+
| prefix-sid | Support bgp segment-routing prefix-sid under labeled-unicast safi per RFC 8669 | | enabled    | disabled |
|            |                                                                                | | disabled   |          |
+------------+--------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# prefix-sid enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# labeled-unicast
    dnRouter(cfg-bgp-afi-lu)# prefix-sid enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-lu)# no prefix-sid

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-unicast/maximum-paths_ebgp.rst

protocols bgp address-family ipv6-unicast maximum-paths ebgp
------------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple equal cost paths in the routing table, when some paths are ebgp and others are ibgp:

**Command syntax: maximum-paths ebgp [ebgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP will only advertise one best path to its eBGP neighbors.

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

- ECMP between ebgp and ibgp paths are only possible if all paths are imported from other vrfs.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ebgp-maximum-paths | Maximum number of parallel paths to consider when using BGP multipath. The       | 1-32  | 1       |
|                    | default is use a single path.                                                    |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ebgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/maximum-paths_ibgp.rst

protocols bgp address-family ipv6-unicast maximum-paths ibgp
------------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple paths in the routing table:

**Command syntax: maximum-paths ibgp [ibgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv4-vpn
- protocols bgp address-family ipv6-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast
- network-services evpn instance protocols bgp
- network-services evpn instance interconnect protocols bgp
- network-services evpn-vpws instance protocols bgp

**Note**

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ibgp-maximum-paths | Maximum number of parallel paths to consider when using iBGP multipath. The      | 1-32  | 1       |
|                    | default is to use a single path                                                  |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ibgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/network.rst

protocols bgp address-family ipv6-unicast network
-------------------------------------------------

**Minimum user role:** operator

This command instructs BGP to advertise a network to all neighbors. The network will be generated according to the "bgp network import-check" on page 2290 settings. If "bgp network import-check" is enabled, the network will be generated only when the route is found on the RIB. If "bgp network import-check" is disabled, the network will be generated regardless of whether or not the route is found in the RIB.

**Command syntax: network [ip-prefix]** policy [policy-name]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- You can configure multiple networks in an address-family.

- The prefix cannot be a link-local address.

- When setting a non /32 prefix, the route installed is the matching subnet network address. For example, for route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same applies for IPv6 prefixes.

**Parameter table**

+-------------+----------------------------------------------------+------------------+---------+
| Parameter   | Description                                        | Range            | Default |
+=============+====================================================+==================+=========+
| ip-prefix   | network ipv6 prefix                                | X:X::X:X/x       | \-      |
+-------------+----------------------------------------------------+------------------+---------+
| policy-name | policy to apply a route-map policy for the network | | string         | \-      |
|             |                                                    | | length 1-255   |         |
+-------------+----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# network 10.108.0.0/24
    dnRouter(cfg-protocols-bgp-afi)# network 10.90.0.0/16 policy RM_POL

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# network 2001::66/90 policy RM_POL


**Removing Configuration**

To stop all network advertisements:
::

    dnRouter(cfg-protocols-bgp-afi)# no network

To stop advertisement of a specific network:
::

    dnRouter(cfg-protocols-bgp-afi)# no network 12001::66/90

To remove policy filtering for the network:
::

    dnRouter(cfg-protocols-bgp-afi)# no network 10.108.0.0/24 policy

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 6.0     | Command introduced                                      |
+---------+---------------------------------------------------------+
| 9.0     | Added option to remove policy filtering for the network |
+---------+---------------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI     |
+---------+---------------------------------------------------------+

---

### afi_ipv6-unicast/next-hop-tracking.rst

protocols bgp address-family ipv6-unicast next-hop-tracking policy
------------------------------------------------------------------

**Minimum user role:** operator

BGP next-hop tracking monitors changes in the BGP next-hop address in the RIB. When a change is detected, it is immediately reported to the BGP process to adjust the next-hop in the BGP table. This reduces the BGP convergence time. The next-hop tracking policy validates the prefix that solves the BGP next-hop address.

Once the policy is attached, when BGP receives from the RIB the prefix that solves the next-hop address, it checks the validity of this prefix against the next-hop policy.

If the peer's state is "established", but its next-hop is not valid due to the applied next-hop-tracking policy for BGP, then all the received routes from the peer next-hop will not be selected as the best, and those routes will not be advertised further to other peers accordingly.

To configure next-hop-tracking to a routing policy:

**Command syntax: next-hop-tracking policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

**Parameter table**

+-------------+----------------------------------------+------------------+---------+
| Parameter   | Description                            | Range            | Default |
+=============+========================================+==================+=========+
| policy-name | set nexthop tracking validation policy | | string         | \-      |
|             |                                        | | length 1-255   |         |
+-------------+----------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# next-hop-tracking policy BGP-NEXT-HOP-IPV4

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# next-hop-tracking policy BGP-NEXT-HOP-IPV6

    *** Policy configuration example ***
    routing-policy
      policy BGP-NEXT-HOP-IPV4
        rule 10 allow
          match ipv4 prefix IPV4_NHT_PREFIX
        !
      !
      prefix-list ipv4 IPV4_NHT_PREFIX
        rule 1 allow 201.0.0.0/8 matching-len ge 32
        rule 2 allow 100.0.0.11/32
      !
    !

**Removing Configuration**

To remove the policy attachment:
::

    dnRouter(cfg-protocols-bgp-afi)# no next-hop-tracking

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 13.0    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-unicast/redistribute_connected.rst

protocols bgp address-family ipv6-unicast redistribute connected
----------------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise directly connected routes:

**Command syntax: redistribute connected** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected metric 1000 policy My_Policy, My_Policy2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute connected metric 1000


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute connected

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute connected metric 

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                              |
+=========+===========================================================================================================+
| 6.0     | Command introduced                                                                                        |
+---------+-----------------------------------------------------------------------------------------------------------+
| 13.2    | Updated command syntax to support ISIS                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------+
| 16.1    | Extended command to support redistribution of connected routes from MRPF table to BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                                                           |
+---------+-----------------------------------------------------------------------------------------------------------+

---

### afi_ipv6-unicast/redistribute_isis.rst

protocols bgp address-family ipv6-unicast redistribute isis
-----------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise ISIS routes:

**Command syntax: redistribute isis** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis metric 1000 policy My_Policy, My_Policy2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute isis metric 1000


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute isis

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute isis metric 

**Command History**

+---------+---------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                        |
+=========+=====================================================================================================================+
| 13.2    | Updated command syntax to support ISIS                                                                              |
+---------+---------------------------------------------------------------------------------------------------------------------+
| 16.1    | Extended command to support redistribution of ISIS multicast SAFI routes from MRPF table to BGP IPv4 multicast SAFI |
+---------+---------------------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                                                                     |
+---------+---------------------------------------------------------------------------------------------------------------------+

---

### afi_ipv6-unicast/redistribute_ospfv3.rst

protocols bgp address-family ipv6-unicast redistribute ospfv3
-------------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise OSPFv3 routes:

**Command syntax: redistribute ospfv3** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order.

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute ospfv3 metric 1000 policy My_Policy, My_Policy2


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute ospfv3

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute ospfv3 metric 

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 13.1    | Command introduced                              |
+---------+-------------------------------------------------+
| 17.2    | Added support for multiple policies attachments |
+---------+-------------------------------------------------+

---

### afi_ipv6-unicast/redistribute_static.rst

protocols bgp address-family ipv6-unicast redistribute static
-------------------------------------------------------------

**Minimum user role:** operator

You can set the router to advertise static routes:

**Command syntax: redistribute static** metric [metric] policy [policy] [, policy, policy]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- This command is only applicable to unicast sub-address-families.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order.

**Parameter table**

+-----------+------------------------------+------------------+---------+
| Parameter | Description                  | Range            | Default |
+===========+==============================+==================+=========+
| metric    | update route metric          | 0-4294967295     | \-      |
+-----------+------------------------------+------------------+---------+
| policy    | redistribute by policy rules | | string         | \-      |
|           |                              | | length 1-255   |         |
+-----------+------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute static

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute static metric 1000 policy My_Policy, My_Policy2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# redistribute static metric 1000


**Removing Configuration**

To stop redistribution of all route types:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute

To stop redistribution of routes by type:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute static

To revert metric to its default value:
::

    dnRouter(cfg-protocols-bgp-afi)# no redistribute static metric 

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 6.0     | Command introduced                              |
+---------+-------------------------------------------------+
| 17.2    | Added support for multiple policies attachments |
+---------+-------------------------------------------------+

---

### afi_ipv6-unicast/rib-install-policy.rst

protocols bgp address-family ipv6-unicast rib-install policy
------------------------------------------------------------

**Minimum user role:** operator

Apply policy on BGP installation to RIB to impose route modifications

**Command syntax: rib-install policy [policy-name]** [, policy-name, policy-name]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- A BGP attribute modification done via policy will not be reflected in the advertised routes to peers. i.e policy is towards rib only and after adj-out construction.

- Policy cannot be used to filter routes from RIB - If policy resulted in deny, e.g matched on a deny rule (or ended on the default deny all rule) policy will not impose any action (including any set actions) on the routes.

- Applies for both unicast and label-unicast routes.

- Policy modification may cause BGP route update to RIB.

- Can set multiple policies. In case multiple policies are set policies are evaluated one after the other according to user input order.

**Parameter table**

+-------------+-----------------------------------------------------+------------------+---------+
| Parameter   | Description                                         | Range            | Default |
+=============+=====================================================+==================+=========+
| policy-name | Policy for routes updated prior to RIB installation | | string         | \-      |
|             |                                                     | | length 1-255   |         |
+-------------+-----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# rib-install policy TO_RIB_POL, TO_RIB_POL2
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# rib-install policy TO_RIB_POL, TO_RIB_POL2


**Removing Configuration**

To remove policy attachment:
::

    dnRouter(cfg-protocols-bgp-afi)# no rib-install policy

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 17.1    | Command introduced                              |
+---------+-------------------------------------------------+
| 17.2    | Added support for multiple policies attachments |
+---------+-------------------------------------------------+

---

### afi_ipv6-vpn/add-path_receive.rst

protocols bgp address-family ipv6-vpn add-path receive
------------------------------------------------------

**Minimum user role:** operator

Typically, BGP routers advertise only the best path for each route. The advertisement of a prefix replaces the previous announcement of that prefix.

To allow the device to receive multiple paths for the same route from the same BGP neighbor:

**Command syntax: add-path receive [add-path-receive]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

- This command is only applicable to the default VRF.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter        | Description                                                                      | Range        | Default  |
+==================+==================================================================================+==============+==========+
| add-path-receive | Enables additional paths to be received for the same route from a bgp neighbor.  | | enabled    | disabled |
|                  | Applies for all bgp neighbors with this afi/safi                                 | | disabled   |          |
+------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path receive

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 9.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-vpn/add-path_send/add-path_send.rst

protocols bgp address-family ipv6-vpn add-path send
---------------------------------------------------

**Minimum user role:** operator

BGP Additional Paths is a BGP extension that provides the ability to advertise multiple paths for the same prefix without the new paths replacing previous paths. 
This helps reduce route repetition, and achieve faster re-convergence as an alternative path is available immediately upon failure of a primary path.
To enter the add-path send configuration level:

**Command syntax: add-path send**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)#


**Removing Configuration**

To revert the add-path send configurations to default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no add-path send

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-vpn/add-path_send/admin-state.rst

protocols bgp address-family ipv6-vpn add-path send admin-state
---------------------------------------------------------------

**Minimum user role:** operator

To enable the add-path send behavior for a specific neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn add-path send
- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv4-vpn add-path send

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+-------------+--------------------------------+--------------+----------+
| Parameter   | Description                    | Range        | Default  |
+=============+================================+==============+==========+
| admin-state | add path send enabled/disabled | | enabled    | disabled |
|             |                                | | disabled   |          |
+-------------+--------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no admin-state

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-vpn/add-path_send/path-count.rst

protocols bgp address-family ipv6-vpn add-path send path-count
--------------------------------------------------------------

**Minimum user role:** operator

You can set the number of paths to be sent when add-path send is enabled:

**Command syntax: path-count [path-count]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn add-path send
- protocols bgp address-family ipv4-unicast add-path send
- protocols bgp address-family ipv4-multicast add-path send
- protocols bgp address-family ipv6-unicast add-path send
- protocols bgp address-family ipv4-vpn add-path send

**Parameter table**

+------------+----------------------------------------+-------+---------+
| Parameter  | Description                            | Range | Default |
+============+========================================+=======+=========+
| path-count | maximum number of path allowed to send | 2-32  | 2       |
+------------+----------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no path-count

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 15.1    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-vpn/afi_ipv6-vpn.rst

protocols bgp address-family ipv6-vpn
-------------------------------------

**Minimum user role:** operator

To enter global BGP ipv6-VPN address-family configuration:

**Command syntax: address-family ipv6-vpn**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-vpn
    dnRouter(cfg-protocols-bgp-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp)# no address-family ipv6-vpn

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-vpn/dampening-ebgp-only.rst

protocols bgp address-family ipv6-vpn dampening-ebgp-only
---------------------------------------------------------

**Minimum user role:** operator

To limit dampening logic for routes received from eBGP peers only:

**Command syntax: dampening-ebgp-only**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening-ebgp-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening-ebgp-only


**Removing Configuration**

To revert to the default admin-state with all optional parameters set to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening-ebgp-only

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 19.0    | Add support for dampening-ebgp-only in most address families |
+---------+--------------------------------------------------------------+

---

### afi_ipv6-vpn/dampening.rst

protocols bgp address-family ipv6-vpn dampening
-----------------------------------------------

**Minimum user role:** operator

Route flapping is a condition in BGP in which a peer advertises that a route is available and then that the same route is unavailable within a short period of time. As a result, BGP excessively adds and removes routes from the forwarding table, increasing the processing load on the router.

Route flap dampening suppresses the advertisement of flapping routes until the route becomes more stable, thus reducing the number of advertisements sent between peers from flapping routers and increasing the stability of the BGP network.

To enable route flap dampening per address-family:

**Command syntax: dampening [admin-state]** half-life [half-life] reuse-threshold [reuse-threshold] suppress-threshold [suppress-threshold] max-suppress [max-suppress]

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn

**Note**

- The basic command (with no arguments) enables the feature with default values for the thresholds. You can configure different threshold values. The thresholds are listed in the Parameter table:

- This command is only applicable to unicast sub-address-families.

- Half-life, reuse-threshold, suppress-threshold, and max-suppress can only be configured for dampening enabled. When dampening is disabled, all optional parameters are set to their default value

- This option uses non-configurable default values for the following parameters:
- Max suppress penalty: 12000
- Min penalty: 375

**Parameter table**

+--------------------+---------------------------------------------------------------+--------------+----------+
| Parameter          | Description                                                   | Range        | Default  |
+====================+===============================================================+==============+==========+
| admin-state        | Enable route flap damping.                                    | | enabled    | disabled |
|                    |                                                               | | disabled   |          |
+--------------------+---------------------------------------------------------------+--------------+----------+
| half-life          | minutes                                                       | 1-45         | 15       |
+--------------------+---------------------------------------------------------------+--------------+----------+
| reuse-threshold    | Minimum penalty below which routes becomes reusable again     | 1-50000      | 750      |
+--------------------+---------------------------------------------------------------+--------------+----------+
| suppress-threshold | Maximum penalty above which route is suppressed by the device | 1-50000      | 2000     |
+--------------------+---------------------------------------------------------------+--------------+----------+
| max-suppress       | minutes                                                       | 1-255        | 60       |
+--------------------+---------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled half-life 20 reuse-threshold 1000  suppress-threshold 1500 max-suppress 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening disabled half-life 30 reuse-threshold 550  suppress-threshold 1500 max-suppress 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled reuse-threshold 1000


**Removing Configuration**

To revert to the default admin-state with all optional parameters set to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening

To revert to the thresholds to their default values:
::

    dnRouter(cfg-protocols-bgp-afi)# no dampening reuse-threshold 1000

**Command History**

+---------+-------------------------------------------------------+
| Release | Modification                                          |
+=========+=======================================================+
| 7.0     | Command introduced                                    |
+---------+-------------------------------------------------------+
| 19.0    | Remove support for dampening in some address families |
+---------+-------------------------------------------------------+

---

### afi_ipv6-vpn/fast-reroute.rst

protocols bgp address-family ipv6-vpn fast-reroute
--------------------------------------------------

**Minimum user role:** operator

BGP Loop-Free Alternate (LFA) Fast Reroute (FRR) allows BGP to quickly switch to a backup path when a primary path fails. With LFA FRR, BGP pre-computes a backup path and installs the backup next hop in the forwarding table when a multipath solution is not available.

For example, when the NH interface to an NC-Edge fails, a pre-installed alternate path will provide fast rerouting of the traffic. The other NC-Core devices will continue sending traffic as usual.

<INSERT 05_protocols_bgp>

To enable/disable fast reroute for the BGP protocol:

**Command syntax: fast-reroute [fast-reroute]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP fast-reroute applies only to bgp unicast and multicast sessions, and only to default VRF.

- LFA FRR is supported for both directly connected and remote nexthops. It does not apply to nexthops that are learned via BGP.

**Parameter table**

+--------------+-----------------------------------------------------------------------+--------------+----------+
| Parameter    | Description                                                           | Range        | Default  |
+==============+=======================================================================+==============+==========+
| fast-reroute | Enables bgp nexthop fast reroute for directly connected eBGP neighbor | | enabled    | disabled |
|              |                                                                       | | disabled   |          |
+--------------+-----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# fast-reroute enabled



**Removing Configuration**

To revert to the default admin-state:
::

    dnRouter(cfg-protocols-bgp-afi)# no fast-reroute enabled

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 10.0    | Command introduced                                  |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-vpn/label-allocation.rst

protocols bgp address-family ipv6-vpn label-allocation
------------------------------------------------------

**Minimum user role:** operator

BGP label allocation per next-hop mode for IPv4 labeled-unicast and IPv6 labeled-unicast address families has been added. This mode prevents additional lookup in the device's routing table and conserves label space. The label allocation per next-hop feature allows the same label to be used for all the routes advertised from a unique peer device.

- Per-prefix - A unique label is allocated for each bgp advertise labeled prefix . Local prefixes will share the same php/explicit-null label.

- Per-nexthop - All advertised prefixes, that are locally resolved by the same nexthop, will be assigned the same local label.

To configure per-nexthop/per-prefix label allocation:

**Command syntax: label-allocation [label-allocation-mode]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn

**Note**

- This command is only applicable to unicast sub-address-families.

- The nexthop prefix includes all route resolution variations, including ecmp, egress labels and alternate paths.

**Parameter table**

+-----------------------+-----------------------------------------------------------------------+-----------------+------------+
| Parameter             | Description                                                           | Range           | Default    |
+=======================+=======================================================================+=================+============+
| label-allocation-mode | Configure BGP label allocation mode, either per-prefix or per-nexthop | | per-prefix    | per-prefix |
|                       |                                                                       | | per-nexthop   |            |
+-----------------------+-----------------------------------------------------------------------+-----------------+------------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-prefix

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-nexthop


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no label-allocation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### afi_ipv6-vpn/maximum-paths_ebgp.rst

protocols bgp address-family ipv6-vpn maximum-paths ebgp
--------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple equal cost paths in the routing table, when some paths are ebgp and others are ibgp:

**Command syntax: maximum-paths ebgp [ebgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast

**Note**

- BGP will only advertise one best path to its eBGP neighbors.

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

- ECMP between ebgp and ibgp paths are only possible if all paths are imported from other vrfs.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ebgp-maximum-paths | Maximum number of parallel paths to consider when using BGP multipath. The       | 1-32  | 1       |
|                    | default is use a single path.                                                    |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ebgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ebgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_ipv6-vpn/maximum-paths_ibgp.rst

protocols bgp address-family ipv6-vpn maximum-paths ibgp
--------------------------------------------------------

**Minimum user role:** operator

To configure BGP to install multiple paths in the routing table:

**Command syntax: maximum-paths ibgp [ibgp-maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family ipv6-vpn
- protocols bgp address-family ipv4-unicast
- protocols bgp address-family ipv4-multicast
- protocols bgp address-family ipv6-unicast
- protocols bgp address-family ipv4-vpn
- network-services vrf instance protocols bgp address-family ipv4-unicast
- network-services vrf instance protocols bgp address-family ipv6-unicast
- network-services evpn instance protocols bgp
- network-services evpn instance interconnect protocols bgp
- network-services evpn-vpws instance protocols bgp

**Note**

- This command is relevant only to unicast and multicast sub-address-families, including label-unicast.

- To view the installed routes, use the various show route commands: "show route", "show route forwarding-table", "show mpls route", and "show mpls forwarding-table".

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ibgp-maximum-paths | Maximum number of parallel paths to consider when using iBGP multipath. The      | 1-32  | 1       |
|                    | default is to use a single path                                                  |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 5

    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# maximum-paths ibgp 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast

::

    dnRouter(cfg-protocols-bgp-afi)# no maximum-paths ibgp

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 13.1    | Updated maximum-paths value to 32                   |
+---------+-----------------------------------------------------+
| 16.1    | Extended command to support BGP IPv4 multicast SAFI |
+---------+-----------------------------------------------------+

---

### afi_l2vpn-evpn/afi_l2vpn-evpn.rst

protocols bgp address-family l2vpn-evpn
---------------------------------------

**Minimum user role:** operator

To enter global BGP l2vpn-evpn address-family configuration:

**Command syntax: address-family l2vpn-evpn**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family l2vpn-evpn
    dnRouter(cfg-protocols-bgp-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp)# no address-family l2vpn-evpn

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_l2vpn-evpn/label-allocation.rst

protocols bgp address-family l2vpn-evpn label-allocation
--------------------------------------------------------

**Minimum user role:** operator


To configure per-nexthop/per-prefix label allocation for l2vpn-evpn so that we do not allocate a label per MAC address.
BGP label allocation per next-hop mode for IPv4 labeled-unicast and IPv6 labeled-unicast address families has been added. This mode prevents additional lookup in the device's routing table and conserves label space. The label allocation per next-hop feature allows the same label to be used for all the routes advertised from a unique peer device.

- Per-prefix - A unique label is allocated for each bgp advertised MAC address. 

- Per-nexthop - All advertised prefixes, that are locally resolved by the same nexthop, will be assigned the same local label.

**Command syntax: label-allocation [label-allocation-mode]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family l2vpn-evpn

**Parameter table**

+-----------------------+-----------------------------------------------------------------------+-----------------+-------------+
| Parameter             | Description                                                           | Range           | Default     |
+=======================+=======================================================================+=================+=============+
| label-allocation-mode | Configure BGP label allocation mode, either per-prefix or per-nexthop | | per-prefix    | per-nexthop |
|                       |                                                                       | | per-nexthop   |             |
+-----------------------+-----------------------------------------------------------------------+-----------------+-------------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family l2vpn-evpn
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-prefix

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family l2vpn-evpn
    dnRouter(cfg-protocols-bgp-afi)# label-allocation per-nexthop


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-afi)# no label-allocation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_link-state/afi_link-state.rst

protocols bgp address-family link-state
---------------------------------------

**Minimum user role:** operator

To enter global BGP link-state address-family configuration:

**Command syntax: address-family link-state**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family link-state
    dnRouter(cfg-protocols-bgp-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp)# no address-family link-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_link-state/bgp-ls-id.rst

protocols bgp address-family link-state bgp-ls-id
-------------------------------------------------

**Minimum user role:** operator

Set the desired BGP-ls identifier to be sent for NODE/LINK/PREFIX link-state updates under sub-tlv 513 (per RFC 7752).
By default, BGP will set its own router-id.

**Command syntax: bgp-ls-id [bgp-ls-id]**

**Command mode:** config

**Hierarchies**

- protocols bgp address-family link-state

**Note**

- Expectation that all BGP speakers advertising the same IGP TE topology will be configured with the same bgp-ls-id

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| bgp-ls-id | bgp link-state identifier. Together with bgp as-number , define the link-state   | A.B.C.D | \-      |
|           | IGP domain. Per RFC7752                                                          |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family link-state
    dnRouter(cfg-protocols-bgp-afi)# bgp-ls-id 65000


**Removing Configuration**

To revert bgp-ls-id to default behavior:
::

    dnRouter(cfg-protocols-bgp-afi)# no bgp-ls-id

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### always-compare-med.rst

protocols bgp always-compare-med
--------------------------------

**Minimum user role:** operator

When two or more links exist between autonomous systems, the multi-exit discriminator (MED) values may be set to give preferences to certain routes. When comparing MED values, the lower value is preferred. By default, this function is disabled, and MED values are compared only if two paths have the same neighbor AS.

To configure the BGP process to always compare the MED metric on routes for best path selection, even when received from different ASs:

**Command syntax: always-compare-med**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# always-compare-med


**Removing Configuration**

To disable the always compare MED function:
::

    dnRouter(cfg-protocols-bgp)# no always-compare-med

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### bestpath_aigp-ignore.rst

protocols bgp bestpath aigp-ignore
----------------------------------

**Minimum user role:** operator

By default, the best path selection algorithm considers the AIGP metric as a tie-breaker between paths, and prefers paths with the AIGP attribute over paths without it. This command forces the system to only consider the AIGP attribute in the best path algorithm if both paths have an AIGP attribute.

To set the system to ignore the AIGP metric in best path calculation:

**Command syntax: bestpath aigp-ignore**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- This configuration is applicable to the default VRF only.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-bgp)# bestpath aigp-ignore


**Removing Configuration**

To disable the configuration:
::

    dnRouter(cfg-bgp)# no bestpath aigp-ignore

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 7.0     | Command introduced |
+---------+--------------------+

---

### bestpath_as-path.rst

protocols bgp bestpath as-path
------------------------------

**Minimum user role:** operator

To configure how BGP treats the AS path in best path selection:

**Command syntax: bestpath as-path {confed, multipath-relax, ignore}**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- These parameter options are not mutually exclusive. You may configure all options. These options are disabled by default.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter       | Description                                                                      | Range   | Default |
+=================+==================================================================================+=========+=========+
| confed          | specifies that the length of confederation path sets and sequences should be     | Boolean | False   |
|                 | taken into account during the BGP best path decision process                     |         |         |
+-----------------+----------------------------------------------------------------------------------+---------+---------+
| multipath-relax | specifies that BGP decision process should consider paths of equal as-path       | Boolean | False   |
|                 | length candidates for multipath computation. Without the set, the entire as-path |         |         |
|                 | must match for multipath computation                                             |         |         |
+-----------------+----------------------------------------------------------------------------------+---------+---------+
| ignore          | Ignore the AS path length when selecting the best path. The default is to use    | Boolean | False   |
|                 | the AS path length and prefer paths with shorter length.                         |         |         |
+-----------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# bestpath as-path confed
    dnRouter(cfg-protocols-bgp)# bestpath as-path multipath-relax
    dnRouter(cfg-protocols-bgp)# bestpath as-path ignore


**Removing Configuration**

To revert the best path AS path instruction to default (disable):
::

    dnRouter(cfg-protocols-bgp)# no bestpath as-path confed

::

    dnRouter(cfg-protocols-bgp)# no bestpath as-path multipath-relax

::

    dnRouter(cfg-protocols-bgp)# no bestpath as-path ignore

::

    dnRouter(cfg-protocols-bgp)# no bestpath as-path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### bestpath_compare-router-id.rst

protocols bgp bestpath compare-router-id
----------------------------------------

**Minimum user role:** operator

When comparing routes, if all metric stages 1-10 are equal, including local preference, AS-path length, IGP cost, and MED, BGP can select the best path based on router-id (stage 11). This command causes BGP to prefer the route with the lower router-id when all other metrics are equal.

To enable this function:

**Command syntax: bestpath compare-router-id**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- If the route contains route reflector attributes, BGP will use the ORIGINATOR_ID as the ROUTER_ID for comparison. Otherwise, the router-id of the neighbor from which the route was received is used.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# bestpath compare-router-id


**Removing Configuration**

To disable the compare-router-id option:
::

    dnRouter(cfg-protocols-bgp)# no bestpath compare-router-id

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### bestpath_delay.rst

protocols bgp bestpath delay
----------------------------

**Minimum user role:** operator

Upon initialization following a restart, the BGP process waits for the configured amount of time before starting to send its updates. During this delay, the router listens to updates coming from the peers without responding. When the peers finish sending updates, or when the timer expires, the BGP calculates the best path for each route and starts advertising to its peers. The best path delay improves convergence because by waiting for all the information before calculating the best paths, less advertisements are required.

The best path delay command sets the maximum time to wait after the first neighbor is established until the BGP starts calculating best paths and sending out advertisements:

**Command syntax: bestpath delay [bestpath-delay]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Parameter table**

+----------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter      | Description                                                                      | Range  | Default |
+================+==================================================================================+========+=========+
| bestpath-delay | Set delay for the first bestpath calculation to all updates to be received from  | 0-3600 | 120     |
|                | all peers                                                                        |        |         |
+----------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# bestpath delay 10


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# no bestpath delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### bestpath_deterministic-med.rst

protocols bgp bestpath deterministic-med
----------------------------------------

**Minimum user role:** operator

When routes are advertised by different peers in the same autonomous system, you can instruct the BGP process to compare the MED variable to select the best path.

To enable this option:

**Command syntax: bestpath deterministic-med**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# bestpath deterministic-med


**Removing Configuration**

To disable this configuration:
::

    dnRouter(cfg-protocols-bgp)# no bestpath deterministic-med

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### bestpath_med.rst

protocols bgp bestpath med
--------------------------

**Minimum user role:** operator

The bestpath-med command instructs BGP what to do with the multi-exit discriminator (MED) metrics. By default, routes originating within the same confederation as the router do not have their MED values compared as part of the best-path selection process. Also BGP best-path selection considers a missing MED value to be 0, so routes with missing MED values will be preferred by default.

To change this behavior:

**Command syntax: bestpath med {confed, missing-as-worst}**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- These parameter options may be configured together or individually. When configured individually, the order is not important.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter        | Description                                                                      | Range   | Default |
+==================+==================================================================================+=========+=========+
| confed           | MEDs are compared for all paths that consist only of AS_CONFED_SEQUENCE. These   | Boolean | False   |
|                  | paths originated within the local confederation                                  |         |         |
+------------------+----------------------------------------------------------------------------------+---------+---------+
| missing-as-worst | path received with no MED paths are assigned a MED of 4,294,967,294              | Boolean | False   |
+------------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# bestpath med confed

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# bestpath med missing-as-worst

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# bestpath med confed missing-as-worst

    dnRouter(cfg-protocols-bgp)# bestpath med missing-as-worst confed


**Removing Configuration**

To disable the bestpath med configuration:
::

    dnRouter(cfg-protocols-bgp)# no bestpath med confed

::

    dnRouter(cfg-protocols-bgp)# no bestpath med missing-as-worst

::

    dnRouter(cfg-protocols-bgp)# no bestpath med

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### bestpath_rpki_allow-invalid.rst

protocols bgp bestpath rpki allow-invalid
-----------------------------------------

**Minimum user role:** operator

You can use this command to enable taking routes with invalid RPKI state into consideration for the BGP bestpath calculation.

To configure the RPKI allow-invalid:

**Command syntax: bestpath rpki allow-invalid**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Example**
::

    dnRouter(cfg-protocols-bgp)# bestpath rpki allow-invalid


**Removing Configuration**

To revert to the default value: 
::

    dnRouter(cfg-protocols-bgp)# no bestpath rpki allow-invalid

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.3    | Command introduced |
+---------+--------------------+

---

### bestpath_rpki_prefix-validate.rst

protocols bgp bestpath rpki prefix-validate
-------------------------------------------

**Minimum user role:** operator

You can use this command to enable taking the RPKI validation states of BGP routes and their preference into consideration for the BGP bestpath calculation.

To configure the RPKI prefix-validation:

**Command syntax: bestpath rpki prefix-validate [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enables the RPKI validity states of BGP paths to affect the path's preference in | | enabled    | disabled |
|             | the BGP bestpath calculation.                                                    | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter(cfg-protocols-bgp)# bestpath rpki prefix-validate enabled


**Removing Configuration**

To revert to the default value: 
::

    dnRouter(cfg-protocols-bgp)# no bestpath rpki prefix-validate

**Command History**

+---------+-------------------------------------------+
| Release | Modification                              |
+=========+===========================================+
| 15.1    | Command introduced                        |
+---------+-------------------------------------------+
| 19.3    | Split allow-invalid to a separate command |
+---------+-------------------------------------------+

---

### bestpath.rst

protocols bgp bestpath
----------------------

**Minimum user role:** operator

The BGP Best Path Selection Algorithm determines the optimal route to a destination when multiple paths are available. BGP evaluates paths based on several attributes in a predefined order. The goal is to select the most efficient and stable path while maintaining policy control. This process ensures that BGP routers consistently choose and advertise the best available route to their peers.
During best-path selection an Equal-Cost Multi-Path (ECMP) path group may be found so that multiple different paths are installed in the routing table. However, BGP still advertises only a single best path to its peers unless additional features like BGP Add-Path. This distinction ensures stable routing behavior while allowing ECMP for traffic distribution within a routers local forwarding plane. 


The DNOS best-path selection process for ip routes is as follows:
1.  RPKI state  when the RPKI state is is maintained - meaning only unicast/LU in default VRF.
1.  RPKI validation is done according to RPKI prefix validation configuration.
1.  Path with better RPKI state: valid > not found > unverified > invalid
2.  If allow invalid is not set, path with invalid will be chosen only if no other exists 
2.  Path with LLGR-Stale community is less preferred
3.  Highest weight
4.  Highest local preferences 
5.  Originate routes (network, redistribute)
6.  AIGP metric
7.  Shortest AS-path
8.  Lowest origin
9.  Lowest MED
10. Path (eBGP over iBGP)
11. Accept-own
12. Nearest IGP neighbor (IGP-metric)
   At this stage ECMP group is selected
10. Prefer Labeled-Unicast path over Unicast path (LU and U share same BGP table)
11. Oldest (stable) route (if compare-router-ID is off)
1.  First check if one of the paths compared is already best, and if so, prefers it.
2.  If both are not best, compares the timer in which those were received in seconds - meaning less than a second will be handled as identical.
11. Neighbor with the lowest ID (using the originator attribute, if exists, or the router-ID if not)
12. Shortest cluster list
13. Neighbor with lowest IP
14. Imported path is preferred over local-aggregate

**EVPN Bestpath**

The EVPN (and the upcoming VPLS SI) bestpath selection is implemented somewhat differently, primarily due to multihoming scenarios.
The main distinction is that for some route types, the BGP process performs standard or slightly modified bestpath selection but installs all valid routes as ECMP to the EVPN-Manager (which functions as the RIB).
For these routes, the EVPN-Manager calculates the installed ECMP paths based on the information received from BGP.

The bestpath behavior varies by route type:

*Type 3  Inclusive Multicast (IM) Route*

- Follows standard BGP bestpath selection.
- Only a single route is installed; ECMP is not used for this route.
- No bestpath selection is performed by the EVPN-Manager.

*Type 2  MAC/IP Route*
- Bestpath logic is applied in both BGP and EVPN-Manager, following this procedure:
- Prefer routes with the MAC Mobility extended community
- Prefer routes with the sticky bit
- Prefer routes with a higher sequence number
- Prefer routes with the lowest IP address

*Type 3  Auto-Discovery (A/D) Route*
Bestpath logic is present in both BGP and the EVPN-Manager.
- In BGP: Follows standard bestpath selection.
- All valid routes are installed as ECMP from BGP to the EVPN-Manager.
- The EVPN-Manager performs multihoming logic, which differs depending on the service (EVPN/EVPN-VPWS).

The EVPN-Managers goal is to determine the valid ECMP paths for each ESI. Some examples:
- If a Type 1 EVI is received without a corresponding Type 1 ESI, the next hop is considered invalid and excluded from ECMP.
- If multiple Type 1 ESI routes are received, they must all belong to the same redundancy mode. In case of a conflict, the entire ESI falls back to single-active mode, and the Designated Forwarder (DF) is calculated accordingly.

*Type 4  Ethernet Segment (ES) Route*
Bestpath logic is handled only by the BGP process and follows standard BGP bestpath rules.
- This route is used for DF election when a local ESI is present.
- DF election is carried out based on the required type (e.g., MOD or highest preference), as specified in [RFC 7432  BGP MPLS-Based Ethernet VPN].

*Type 5  IP Prefix Route*
This route type also goes through the bestpath process within the EVI, but the final bestpath decision is made in the VRF.
In the EVI, a "stitched" route is always preferred over a non-stitched route  meaning the VRF determines the bestpath.

**VPLS Bestpath**

*BGP Process*
- Follows standard BGP bestpath selection (with the VPLS NLRI key being the VE-ID and block offset).
- All routes with the same key are installed as ECMP.

*EVPN-Manager Process*
- Prefer routes without the Down bit
- Prefer routes without the LLGR flag
- Prefer routes with the highest preference
- Prefer routes with the lowest IP address.

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### bgp.rst

protocols bgp
-------------

**Minimum user role:** operator

To start the BGP process:

**Command syntax: bgp [as-number]**

**Command mode:** config

**Hierarchies**

- protocols
- network-services vrf instance protocols

**Note**

- The AS-number cannot be changed. To change it, you need to delete the BGP protocol configuration and configure a new process with a different AS-number.

- Notice the change in prompt.

**Parameter table**

+-----------+------------------------+--------------+---------+
| Parameter | Description            | Range        | Default |
+===========+========================+==============+=========+
| as-number | peer-group unique name | 1-4294967295 | \-      |
+-----------+------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)#


**Removing Configuration**

To disable the BGP process:
::

    dnRouter(cfg-protocols)# no bgp

**Command History**

+---------+--------------------------------------+
| Release | Modification                         |
+=========+======================================+
| 6.0     | Command introduced                   |
+---------+--------------------------------------+
| 9.0     | Changed AS-number range to minimum 1 |
+---------+--------------------------------------+

---

### cluster-id.rst

protocols bgp cluster-id
------------------------

**Minimum user role:** operator

You can use this command to specify a global cluster-id attribute when used as a route-reflector, or per neighbor-group or neighbor if specified explicitly.

Prior to reflecting a route, route reflectors append their cluster-id to the cluster list.

**Command syntax: cluster-id [cluster-id]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor

**Parameter table**

+------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter  | Description                                                                      | Range            | Default |
+============+==================================================================================+==================+=========+
| cluster-id | route-reflector cluster id to use when local router is configured as a route     | | 1-4294967295   | \-      |
|            | reflector.                                                                       | | A.B.C.D        |         |
+------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# cluster-id 65.65.65.65

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65001
    dnRouter(cfg-protocols-bgp)# cluster-id 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65001
    dnRouter(cfg-protocols-bgp)# neighbor 1.1.1.1
    dnRouter(cfg-protocols-bgp-neighbor)# cluster-id 101

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# cluster-id 10.0.0.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# cluster-id 27081


**Removing Configuration**

To revert all BGP cluster-id to the default value:
::

    dnRouter(cfg-protocols-bgp)# no cluster-id

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 15.1    | Command introduced                                           |
+---------+--------------------------------------------------------------+
| 17.1    | Extended support for neighbor and neighbor-group hierarchies |
+---------+--------------------------------------------------------------+

---

### confederation_indentifier.rst

protocols bgp confederation identifier
--------------------------------------

**Minimum user role:** operator

Because iBGP updates are not passed to other iBGP neighbors, every router within the BGP AS must be fully meshed. In large ASs, the number of iBGP peering sessions required can potentially be enormous. The use of confederations reduces the number of iBGP sessions by allowing to split the AS into smaller sub-ASs.

The AS_PATH attribute within routing updates includes the confederation information. To the outside world (i.e. to BGP peers external to the confederation), your network confederation identified by the AS Confederation Identifier appears as a single AS.

On each router in the AS, you define the confederation identifier and its confederation sub-AS. This breaks up the larger AS into smaller sub-ASs. To enable the confederation sub-ASs to communicate, you need to define the confederation neighbors on each sub-AS border router (see "bgp confederation neighbors").

**Command syntax: confederation identifier [identifier]**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Note**

- This command is available to the default VRF instance only.

**Parameter table**

+------------+------------------------------+--------------+---------+
| Parameter  | Description                  | Range        | Default |
+============+==============================+==============+=========+
| identifier | bgp confederation identifier | 1-4294967295 | \-      |
+------------+------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# confederation identifier 8000


**Removing Configuration**

To remove the confederation configuration:
::

    dnRouter(cfg-protocols-bgp)# no confederation identifier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### confederation_neighbors.rst

protocols bgp confederation neighbors
-------------------------------------

**Minimum user role:** operator

When operating in a confederation AS split into multiple sub-ASs, you need to configure the neighbor sub-ASs on the sub-AS border. eBGP sessions will run between the sub-ASs.

To configure the neighbor sub-ASs in the BGP confederation:

**Command syntax: confederation neighbors [neighbors-as]** [, neighbors-as, neighbors-as]

**Command mode:** config

**Hierarchies**

- protocols bgp

**Note**

- This command is available to the default VRF instance only.

- If run another command with different AS-numbers, the new AS-numbers will be added as confederation neighbors. The command does not override existing neighbors.

**Parameter table**

+--------------+------------------------------------+--------------+---------+
| Parameter    | Description                        | Range        | Default |
+==============+====================================+==============+=========+
| neighbors-as | neighbors ASs in BGP confederation | 1-4294967295 | \-      |
+--------------+------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# confederation neighbors 8001, 8002, 8003
    dnRouter(cfg-protocols-bgp)# confederation neighbors 8004, 8005


**Removing Configuration**

To remove all confederation neighbor configuration:
::

    dnRouter(cfg-protocols-bgp)# no confederation neighbors

To remove specific neighbors from the confederation group:
::

    dnRouter(cfg-protocols-bgp)# no confederation neighbors 8002

::

    dnRouter(cfg-protocols-bgp)# no confederation neighbors 8001, 8005

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### default-local-preference.rst

protocols bgp default local-preference
--------------------------------------

**Minimum user role:** operator

Routers in the same AS exchange the local preference attribute in order to indicate to the AS which path is preferred for exiting the AS and reaching a specific network.

A path with a higher local preference is preferred more.

To configure the default local preference for advertised routes:

**Command syntax: default local-preference [default-local-preference]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Parameter table**

+--------------------------+-------------------------------------------+--------------+---------+
| Parameter                | Description                               | Range        | Default |
+==========================+===========================================+==============+=========+
| default-local-preference | Change the default local preference value | 0-4294967295 | 100     |
+--------------------------+-------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# default local-preference 400


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# no default local-preference

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### dynamic-med-interval.rst

protocols bgp dynamic-med-interval
----------------------------------

**Minimum user role:** operator

When using an egress policy with 'set med igp-cost', any change in the MED attribute is advertised.
To configure a delay in the advertisement of updates:

**Command syntax: dynamic-med-interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| interval  | Set delay interval for consecutive updates due to MED attribute change when      | 0-15  | 0       |
|           | using set med igp-cost                                                           |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# dynamic-med-interval 5


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# no dynamic-med-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### enforce-first-as.rst

protocols bgp enforce-first-as
------------------------------

**Minimum user role:** operator

This command forces the BGP router to compare the first AS, in the AS path of eBGP routes received from neighbors, to the configured remote external neighbor AS number. Updates from eBGP neighbors that do not include that AS number as the first item in the AS_PATH attribute will be ignored.

**Command syntax: enforce-first-as**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# enforce-first-as


**Removing Configuration**

To disable the enforcement:
::

    dnRouter(cfg-protocols-bgp)# no enforce-first-as

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### fast-external-failover.rst

protocols bgp fast-external-failover
------------------------------------

**Minimum user role:** operator

This command instructs the BGP process to immediately terminate external BGP peering sessions of directly adjacent neighbors if the link used to reach these neighbors goes down, without waiting for the hold-down timer to expire:

**Command syntax: fast-external-failover [fast-external-failover]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- This option is enabled by default.

**Parameter table**

+------------------------+---------------------------------------------+--------------+---------+
| Parameter              | Description                                 | Range        | Default |
+========================+=============================================+==============+=========+
| fast-external-failover | fast peer termination for unreachable peers | | enabled    | enabled |
|                        |                                             | | disabled   |         |
+------------------------+---------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# fast-external-failover disabled
    dnRouter(cfg-protocols-bgp)# fast-external-failover enabled


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-protocols-bgp)# no fast-external-failover

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### graceful-restart/graceful-restart.rst

protocols bgp graceful-restart
------------------------------

**Minimum user role:** operator

Graceful restart enables a BGP router to indicate its ability to preserve its forwarding state during BGP restart. During session initiation, the BGP router informs its peer that it has graceful restart capability. If the BGP session is lost during the restart, the peers mark all the associated routes as stale. However, they do not remove these routes and temporarily continue to use them to make forwarding decisions. Thus, no packets are lost while the BGP process is waiting for convergence of the routing information with the BGP peers.

When the restarting router is back up, the peers wait for the configured amount of time before they delete the stale routes, allowing the router time to converge. When the restarting router sends an end-of-RIB flag notifying its peers that it has converged, or if no end-of-RIB flag is received, but the timer expires, the peers delete any saved stale routes.

Graceful restart is enabled by default. To configure the graceful-restart parameters, enter the graceful-restart configuration mode:

**Command syntax: graceful-restart**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# graceful-restart
    dnRouter(cfg-protocols-bgp-gr)#


**Removing Configuration**

To revert all BGP graceful-restart parameters to their default values: 
::

    dnRouter(cfg-protocols-bgp)# no graceful-restart

**Command History**

+---------+-------------------------------------+
| Release | Modification                        |
+=========+=====================================+
| 6.0     | Command introduced                  |
+---------+-------------------------------------+
| 10.0    | Added restart-time parameter        |
+---------+-------------------------------------+
| 11.1    | Removed admin-state from the syntax |
+---------+-------------------------------------+
| 11.5    | Applied new hierarchy               |
+---------+-------------------------------------+

---

### graceful-restart/purge-time.rst

protocols bgp graceful-restart purge-time
-----------------------------------------

**Minimum user role:** operator

Graceful restart enables a BGP router to indicate its ability to preserve its forwarding state during BGP restart. During session initiation, the BGP router informs its peer that it has graceful restart capability. If the BGP session is lost during the restart, the peers mark all the associated routes as stale. However, they do not remove these routes and temporarily continue to use them to make forwarding decisions. Thus, no packets are lost while the BGP process is waiting for convergence of the routing information with the BGP peers.

When the restarting router is back up, the peers wait for the configured amount of time before they delete the stale routes, allowing the router time to converge. When the restarting router sends an end-of-RIB flag notifying its peers that it has converged, or if no end-of-RIB flag is received, but the timer expires, the peers delete any saved stale routes.

To configure the graceful-restart purge-time:

**Command syntax: purge-time [purge-time]**

**Command mode:** config

**Hierarchies**

- protocols bgp graceful-restart

**Note**

- The default purge-time is the configured stalepath-time + 60 seconds. When using the default value, reconfiguring the stalepath-time will also update the used purge-time.

**Parameter table**

+------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter  | Description                                                                      | Range  | Default |
+============+==================================================================================+========+=========+
| purge-time | specify the maximum time before stale routes are purged from the routing         | 1-3600 | \-      |
|            | information base (RIB) when the local BGP process restarts                       |        |         |
+------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# graceful-restart
    dnRouter(cfg-protocols-bgp-gr)# purge-time 500


**Removing Configuration**

To revert to the default purge-time value:
::

    dnRouter(cfg-protocols-bgp-gr)# no purge-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### graceful-restart/restart-time.rst

protocols bgp graceful-restart restart-time
-------------------------------------------

**Minimum user role:** operator

Graceful restart enables a BGP router to indicate its ability to preserve its forwarding state during BGP restart. During session initiation, the BGP router informs its peer that it has graceful restart capability. If the BGP session is lost during the restart, the peers mark all the associated routes as stale. However, they do not remove these routes and temporarily continue to use them to make forwarding decisions. Thus, no packets are lost while the BGP process is waiting for convergence of the routing information with the BGP peers.

When the restarting router is back up, the peers wait for the configured amount of time before they delete the stale routes, allowing the router time to converge. When the restarting router sends an end-of-RIB flag notifying its peers that it has converged, or if no end-of-RIB flag is received, but the timer expires, the peers delete any saved stale routes.

To configure the graceful-restart restart-time:

**Command syntax: restart-time [restart-time]**

**Command mode:** config

**Hierarchies**

- protocols bgp graceful-restart
- network-services vrf instance protocols bgp graceful-restart

**Parameter table**

+--------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter    | Description                                                                      | Range | Default |
+==============+==================================================================================+=======+=========+
| restart-time | An upper-bound on the time thate stale routes will be retained by a router after | 0-600 | 120     |
|              | a session is restarted. If bgp the restored bgp session didn't reaches establish |       |         |
|              | state prior to this timer expiring stale-routes will be flushed upon its receipt |       |         |
+--------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# graceful-restart
    dnRouter(cfg-protocols-bgp-gr)# restart-time 100


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp-gr)# no restart-time

**Command History**

+---------+-----------------------+
| Release | Modification          |
+=========+=======================+
| 10.0    | Command introduced    |
+---------+-----------------------+
| 11.5    | Applied new hierarchy |
+---------+-----------------------+

---

### graceful-restart/stalepath-time.rst

protocols bgp graceful-restart stalepath-time
---------------------------------------------

**Minimum user role:** operator

Graceful restart enables a BGP router to indicate its ability to preserve its forwarding state during BGP restart. During session initiation, the BGP router informs its peer that it has graceful restart capability. If the BGP session is lost during the restart, the peers mark all the associated routes as stale. However, they do not remove these routes and temporarily continue to use them to make forwarding decisions. Thus, no packets are lost while the BGP process is waiting for convergence of the routing information with the BGP peers.

When the restarting router is back up, the peers wait for the configured amount of time before they delete the stale routes, allowing the router time to converge. When the restarting router sends an end-of-RIB flag notifying its peers that it has converged, or if no end-of-RIB flag is received, but the timer expires, the peers delete any saved stale routes.

To configure the graceful-restart stalepath-time:

**Command syntax: stalepath-time [stale-path-time]**

**Command mode:** config

**Hierarchies**

- protocols bgp graceful-restart
- network-services vrf instance protocols bgp graceful-restart

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter       | Description                                                                      | Range  | Default |
+=================+==================================================================================+========+=========+
| stale-path-time | An upper-bound on the time thate stale routes will be retained by a router after | 1-3600 | 360     |
|                 | a session is restarted. If an End-of-RIB (EOR) marker is received prior to this  |        |         |
|                 | timer expiring stale-routes will be flushed upon its receipt - if no EOR is      |        |         |
|                 | received, then when this timer expires stale paths will be purged. This timer is |        |         |
|                 | referred to as the Selection_Deferral_Timer in RFC4724                           |        |         |
+-----------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# graceful-restart
    dnRouter(cfg-protocols-bgp-gr)# stalepath-time 400


**Removing Configuration**

To revert to the default stalepath-time value:
::

    dnRouter(cfg-protocols-bgp-gr)# no stalepath-time

**Command History**

+---------+-----------------------+
| Release | Modification          |
+=========+=======================+
| 6.0     | Command introduced    |
+---------+-----------------------+
| 11.5    | Applied new hierarchy |
+---------+-----------------------+

---

### label-retention.rst

protocols bgp label-retention
-----------------------------

**Minimum user role:** operator

There are cases where BGP is required to the change the locally allocated labels for the same prefix:

-	For a label per prefix - when the best-path to a prefix has changed from being second-best (bgp-external) to first-best.

-	For a label per nexthop - when the nexthop has changed.

In both cases, to allow for a smooth label transition in the network, bgp will install a new label and retain the previous label installed in FIB for a defined period. This period is the BGP label retention timer.

To configure the label-retention timer:

**Command syntax: label-retention [label-retention-time]**

**Command mode:** config

**Hierarchies**

- protocols bgp

**Parameter table**

+----------------------+-------------+-------+---------+
| Parameter            | Description | Range | Default |
+======================+=============+=======+=========+
| label-retention-time | Munites     | 3-60  | 5       |
+----------------------+-------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# label-retention 10


**Removing Configuration**

To revert BGP label-retention parameter to its default value:
::

    dnRouter(cfg-protocols-bgp)# no label-retention

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/accept-own.rst

protocols bgp neighbor-group address-family accept-own
------------------------------------------------------

**Minimum user role:** operator

To instruct the router whether or not to handle self-originated VPN routes containing the accept-own community attribute:

**Command syntax: accept-own [accept-own]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is only applicable to vpn address-families.

**Parameter table**

+------------+----------------------------------------------+--------------+----------+
| Parameter  | Description                                  | Range        | Default  |
+============+==============================================+==============+==========+
| accept-own | Enable accept-own handling for this neighbor | | enabled    | disabled |
|            |                                              | | disabled   |          |
+------------+----------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-bgp-neighbor-afi)# accept-own enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# accept-own enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# accept-own enabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# accept-own disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no accept-own

::

    dnRouter(cfg-bgp-group-afi)# no accept-own

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/add-path_receive.rst

protocols bgp neighbor-group address-family add-path receive
------------------------------------------------------------

**Minimum user role:** operator

Typically, BGP routers advertise only the best path for each route. The advertisement of a prefix replaces the previous announcement of that prefix.

To allow the device to receive multiple paths for the same route from the BGP neighbor/group:

**Command syntax: add-path receive [add-path-receive]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family

**Note**

- This command is only applicable to unicast VPN sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter        | Description                                                                      | Range        | Default |
+==================+==================================================================================+==============+=========+
| add-path-receive | Enables additional paths to be received for the same route from a bgp neighbor.  | | enabled    | \-      |
|                  | Applies for peer-group for unicast safi                                          | | disabled   |         |
+------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# add-path receive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path receive disabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# add-path receive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no add-path receive

::

    dnRouter(cfg-bgp-group-afi)# no add-path receive

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 9.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/add-path_send/add-path_send.rst

protocols bgp neighbor-group address-family add-path send
---------------------------------------------------------

**Minimum user role:** operator

BGP Additional Paths is a BGP extension that provides the ability to advertise multiple paths for the same prefix without the new paths replacing previous paths. This helps reduce route repetition, and achieve faster re-convergence as an alternative path is available immediately upon failure of a primary path.

To enter add-path send configuration level:

**Command syntax: add-path send**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family

**Note**

- When all paths share the same next-hop only the single best path will be sent.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-group-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-group-afi-add-path-send)# admin-state disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no add-path send

::

    dnRouter(cfg-bgp-group-afi)# no add-path send

::

    dnRouter(cfg-group-neighbor-afi)# no add-path send

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/add-path_send/admin-state.rst

protocols bgp neighbor-group address-family add-path send admin-state
---------------------------------------------------------------------

**Minimum user role:** operator

To enable the add-path send behavior for a specific neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family add-path send
- protocols bgp neighbor address-family add-path send
- protocols bgp neighbor-group neighbor address-family add-path send

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+-------------+--------------------------------+--------------+---------+
| Parameter   | Description                    | Range        | Default |
+=============+================================+==============+=========+
| admin-state | add path send enabled/disabled | | enabled    | \-      |
|             |                                | | disabled   |         |
+-------------+--------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no admin-state

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/add-path_send/path-count.rst

protocols bgp neighbor-group address-family add-path send path-count
--------------------------------------------------------------------

**Minimum user role:** operator

You can set the number of paths to be sent when add-path send is enabled:

**Command syntax: path-count [path-count]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family add-path send
- protocols bgp neighbor address-family add-path send
- protocols bgp neighbor-group neighbor address-family add-path send

**Parameter table**

+------------+----------------------------------------+-------+---------+
| Parameter  | Description                            | Range | Default |
+============+========================================+=======+=========+
| path-count | maximum number of path allowed to send | 2-32  | \-      |
+------------+----------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no path-count

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/address-family.rst

protocols bgp neighbor-group address-family
-------------------------------------------

**Minimum user role:** operator

The address-family applies to a neighbor, neighbor-group, and a neighbor within a neighbor-group. A neighbor within a neighbor-group inherits all address-families configured for the neighbor-group (a neighbor-group must be configured with at least one address-family, regardless if it has neighbors within it. To configure an address-family to be supported by BGP for the neighbor:

**Command syntax: address-family [neighbor-address-family]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- Changing the configuration will cause the BGP session to restart.

- When FlowSpec SAFI is applied, the received FlowSpec rules are imposed on all FlowSpec enabled interfaces.

- Notice the change in prompt.

- When using OSPFv3 or IPv6-based BGP peering within a routing instance, you must explicitly configure a router ID (router-id) for that specific instance. The main routing instance's router ID is not inherited by other instances. Even if only IPv6 protocols are used, a 32-bit router ID is still required, as IPv6 routing protocols rely on it for establishing adjacencies. The router ID must be a non-zero 32-bit (4-octet) unsigned integer. While it's common to use an IPv4 address as the router ID, this is not mandatory - it doesnt need to be a valid or routable address, just a unique 32-bit value within the routing domain. Failing to configure a router ID in an IPv6 OSPF or BGP instance will result in the protocol defaulting to 0.0.0.0, which is invalid. This will prevent adjacency formation and BGP session establishment.

**Parameter table**

+-------------------------+---------------+--------------------------+---------+
| Parameter               | Description   | Range                    | Default |
+=========================+===============+==========================+=========+
| neighbor-address-family | afi-safi type | | ipv4-unicast           | \-      |
|                         |               | | ipv6-unicast           |         |
|                         |               | | ipv4-labeled-unicast   |         |
|                         |               | | ipv6-labeled-unicast   |         |
|                         |               | | ipv4-vpn               |         |
|                         |               | | ipv6-vpn               |         |
|                         |               | | link-state             |         |
|                         |               | | ipv4-flowspec          |         |
|                         |               | | ipv6-flowspec          |         |
|                         |               | | ipv4-rt-constrains     |         |
|                         |               | | ipv4-multicast         |         |
|                         |               | | l2vpn-evpn             |         |
|                         |               | | l2vpn-vpls             |         |
+-------------------------+---------------+--------------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family link-state
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family link-state
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-flowspec
    dnRouter(cfg-group-neighbor-afi)# exit
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-flowspec
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group FLOWSPEC_V4
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-flowspec
    dnRouter(cfg-group-neighbor-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-flowspec
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-rt-constrains
    dnRouter(cfg-bgp-neighbor-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp-group)# no address-family ipv6-unicast

::

    dnRouter(cfg-protocols-bgp-neighbor)# no address-family ipv4-unicast

::

    dnRouter(cfg-bgp-group-neighbor)# no address-family ipv4-flowspec

**Command History**

+---------+-------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                      |
+=========+===================================================================================================================+
| 6.0     | Command introduced                                                                                                |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 10.0    | Added support for link-state AFI                                                                                  |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 13.0    | Added support for FlowSpec SAFI                                                                                   |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for IPv4 Route Target Constrain SAFI                                                                |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for IPv4 Multicast SAFI. The command is now supported also under the network-services/vrf hierarchy |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for l2vpn-evpn in the range                                                                         |
+---------+-------------------------------------------------------------------------------------------------------------------+
| TBD     | Added ipv4/6-labeled-unicast as separate safi                                                                     |
+---------+-------------------------------------------------------------------------------------------------------------------+
| TBD     | Added support for l2vpn-vpls in the range                                                                         |
+---------+-------------------------------------------------------------------------------------------------------------------+

---

### neighbor-group/address-family/aigp.rst

protocols bgp neighbor-group address-family aigp
------------------------------------------------

**Minimum user role:** operator

When enabled, the system adds for each route the IGP metric from the BGP next-hop to the current value of the AIGP metric before the route is forwarded to the BGP neighbor, unless the AIGP metric attribute does not exist for the route.

Upon receiving routes with the AIGP metric, the AIGP metric will be considered in best path selection.

When disabled, the received AIGP metric values are ignored and are not advertised in the BGP route.

To enable AIGP with the BGP neighbor:

**Command syntax: aigp [aigp]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family

**Note**

- This command is applicable to the default VRF only.

**Parameter table**

+-----------+--------------------------------------------+--------------+----------+
| Parameter | Description                                | Range        | Default  |
+===========+============================================+==============+==========+
| aigp      | set use of AIGP metric with a bgp neighbor | | enabled    | disabled |
|           |                                            | | disabled   |          |
+-----------+--------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# aigp enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# aigp enabled


**Removing Configuration**

To revert to the default admin-state:
::

    dnRouter(cfg-bgp-group-afi)# no aigp

::

    dnRouter(cfg-bgp-neighbor-afi)# no aigp

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 7.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/allow-as-in.rst

protocols bgp neighbor-group address-family allow-as-in
-------------------------------------------------------

**Minimum user role:** operator

The following command instructs the BGP router whether or not to disable the AS PATH check function for routes learned from the specific neighbor, so as not to reject routes that contain the recipient's AS number.

**Command syntax: allow-as-in [admin-state]** duplicate [as-duplicate-number]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is applicable to eBGP and iBGP neighbors.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter           | Description                                                                      | Range        | Default  |
+=====================+==================================================================================+==============+==========+
| admin-state         | enable this configuration                                                        | | enabled    | disabled |
|                     |                                                                                  | | disabled   |          |
+---------------------+----------------------------------------------------------------------------------+--------------+----------+
| as-duplicate-number | Specifies the number of times that the AS path of a received route may contain   | 1-10         | 1        |
|                     | the recipient BGP speaker's AS number and still be accepted                      |              |          |
+---------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# allow-as-in enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-vpn
    dnRouter(cfg-protocols-bgp-neighbor)# allow-as-in enabled duplicate 3

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in enabled duplicate 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in disabled duplicate 10
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# allow-as-in enabled duplicate 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in enabled duplicate 10
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# allow-as-in disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.3
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-flowspec
    dnRouter(cfg-bgp-neighbor-afi)# allow-as-in enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no allow-as-in duplicate

::

    dnRouter(cfg-bgp-group-afi)# no allow-as-in

::

    dnRouter(cfg-group-neighbor-afi)# no allow-as-in

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/announce_rpki-state.rst

protocols bgp neighbor-group address-family announce rpki-state
---------------------------------------------------------------

**Minimum user role:** operator

The following command is used to announce the RPKI state information using an Extended Community.

**Command syntax: announce rpki-state**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# announce rpki-state

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP4:all
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# announce
    dnRouter(cfg-bgp-group-afi)# rpki-state


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no announce

::

    dnRouter(cfg-bgp-neighbor-afi)# no announce rpki-state

**Command History**

+---------+---------------------------------------+
| Release | Modification                          |
+=========+=======================================+
| 15.1    | Command introduced                    |
+---------+---------------------------------------+
| 16.1    | Added support for IPv4-multicast SAFI |
+---------+---------------------------------------+

---

### neighbor-group/address-family/as-loop-check.rst

protocols bgp neighbor-group address-family as-loop-check
---------------------------------------------------------

**Minimum user role:** operator

When BGP updates travel through different Autonomous Systems (AS), each eBGP router prepends its AS number to the AS PATH attribute of the BGP update message. If a router receives an update that includes its own AS number in the AS PATH attribute, it will discard it by default to prevent loops. However, In some cases, you may want to allow such updates.

**Command syntax: as-loop-check [as-loop-check]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- allow-as-in must be enabled on the receiving end of the BGP update, otherwise it will drop any update that contains its own AS number. See "bgp neighbor address-family allow-as-in".

- This command applies only to eBGP neighbors.

- If both as-loop-check and as-override are enabled for the same neighbor, as-loop-check will be ignored as the neighbor AS is expected to be replaced.

**Parameter table**

+---------------+---------------------------------------------------------------------------+--------------+---------+
| Parameter     | Description                                                               | Range        | Default |
+===============+===========================================================================+==============+=========+
| as-loop-check | do not advertise route if neighbor as number is part of the route as-path | | enabled    | enabled |
|               |                                                                           | | disabled   |         |
+---------------+---------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# as-loop-check disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# as-loop-check disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# as-loop-check disabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# as-loop-check enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no as-loop-check

::

    dnRouter(cfg-bgp-neighbor-afi)# no as-loop-check

::

    dnRouter(cfg-group-neighbor-afi)# no as-loop-check

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.0    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/as-override.rst

protocols bgp neighbor-group address-family as-override
-------------------------------------------------------

**Minimum user role:** operator

The following command replaces the AS number of the originating device with the AS number of the sending BGP device.

**Command syntax: as-override**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- AS-override is supported for eBGP and iBGP neighbors

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# as-override
    dnRouter(cfg-bgp-neighbor-afi)# exit
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-flowspec
    dnRouter(cfg-bgp-neighbor-afi)# as-override

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# as-override


**Removing Configuration**

To remove the configuration:
::

    dnRouter(cfg-bgp-neighbor-afi)# no as-override

::

    dnRouter(cfg-bgp-group-afi)# no as-override

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/attribute-unchanged.rst

protocols bgp neighbor-group address-family attribute-unchanged
---------------------------------------------------------------

**Minimum user role:** operator

The following command enables BGP to send updates to eBGP peers with the attribute unchanged.

**Command syntax: attribute-unchanged** next-hop med as-path

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- If you do not specify attributes, all attributes will remain unchanged.

- For flowspec SAFI, the next-hop attribute remains unchanged by default.

**Parameter table**

+-----------+--------------------+---------+---------+
| Parameter | Description        | Range   | Default |
+===========+====================+=========+=========+
| next-hop  | next-hop attribute | Boolean | False   |
+-----------+--------------------+---------+---------+
| med       | med attribute      | Boolean | False   |
+-----------+--------------------+---------+---------+
| as-path   | as-path attribute  | Boolean | False   |
+-----------+--------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# attribute-unchanged

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# attribute-unchanged next-hop med

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# attribute-unchanged next-hop med as-path

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# attribute-unchanged med

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# attribute-unchanged as-path


**Removing Configuration**

To disable this option for all attributes:
::

    dnRouter(cfg-bgp-neighbor-afi)# no attribute-unchanged

::

    dnRouter(cfg-bgp-neighbor-afi)# no attribute-unchanged med next-hop

::

    dnRouter(cfg-protocols-bgp-group)# no attribute-unchanged med next-hop

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 11.0    | Removed the as-path option       |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+
| 17.1    | Added as-path support            |
+---------+----------------------------------+

---

### neighbor-group/address-family/capability_orf.rst

protocols bgp neighbor-group address-family capability orf
----------------------------------------------------------

**Minimum user role:** operator

This command instructs the BGP router whether or not to establish a peering session with a neighbor that does not support capability negotiation, neighbors that are members of a peer group, or with a neighbor in a peer group. To configure this option:

**Command syntax: capability orf [capability-orf]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command cannot be enabled with the strict-capability-match configuration. See "bgp neighbor strict-capability-match"

**Parameter table**

+----------------+----------------------------------------------------------------------------------+------------------+----------+
| Parameter      | Description                                                                      | Range            | Default  |
+================+==================================================================================+==================+==========+
| capability-orf | Advertises outbound route filter (ORF) capabilities to peer routers enabled -    | | enabled        | disabled |
|                | enables the ORF prefix list capability in both receive and send mode             | | disabled       |          |
|                | receive-only - enables the ORF prefix list capability in receive mode only       | | send-only      |          |
|                | send-only - enables the ORF prefix list capability in send mode only disabled -  | | receive-only   |          |
|                | disables ORF capability                                                          |                  |          |
+----------------+----------------------------------------------------------------------------------+------------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# capability orf enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# capability orf receive-only
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# capability orf send-only
    dnRouter(cfg-protocols-bgp-group)# neighbor 2.2.2.2
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# capability orf disabled


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-group-afi)# no capability orf

::

    dnRouter(cfg-bgp-neighbor-afi)# no capability orf

::

    dnRouter(cfg-group-neighbor-afi)# no capability orf

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/dampening.rst

protocols bgp neighbor-group address-family dampening
-----------------------------------------------------

**Minimum user role:** operator

To instruct the router whether or not to enable route flap dampening suppression from neighbor, peer group or a neighbor in a peer group:

**Command syntax: dampening [dampening]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is only relevant if global address-family dampening is enabled. See "bgp address-family dampening"

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| dampening | route flap dampening supersession from neighbor, thus disables the global        | | enabled    | enabled |
|           | dampening configuration for neighbor or group                                    | | disabled   |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# dampening disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# dampening enabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# dampening disabled


**Removing Configuration**

To revert dampening to its default state:
::

    dnRouter(cfg-bgp-group-afi)# no dampening

::

    dnRouter(cfg-bgp-neighbor-afi)# no dampening

::

    dnRouter(cfg-group-neighbor-afi)# no dampening

**Command History**

+---------+---------------------------------------------------------------------------------+
| Release | Modification                                                                    |
+=========+=================================================================================+
| 6.0     | Command introduced                                                              |
+---------+---------------------------------------------------------------------------------+
| 11.4    | Changed the default admin-state from the global AFI configuration to "Enabled". |
+---------+---------------------------------------------------------------------------------+

---

### neighbor-group/address-family/default-originate-policy.rst

protocols bgp neighbor-group address-family default-originate
-------------------------------------------------------------

**Minimum user role:** operator

To enable a BGP router to forward the default route 0.0.0.0 to a BGP neighbor or a BGP peer group:

**Command syntax: default-originate** policy [policy]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- This command is only applicable to unicast sub-address-families.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter | Description                                                                      | Range            | Default |
+===========+==================================================================================+==================+=========+
| policy    | Optionally injects the default route conditionally, depending on the match       | | string         | \-      |
|           | conditions in the route map                                                      | | length 1-255   |         |
+-----------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# default-originate

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# default-originate policy POL_NAME

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-rt-constrains
    dnRouter(cfg-bgp-neighbor-afi)# default-originate


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-group-afi)# no default-originate

::

    dnRouter(cfg-bgp-neighbor-afi)# no default-originate

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 6.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 16.1    | Added support for IPv4 Route Target Constrain SAFI |
+---------+----------------------------------------------------+

---

### neighbor-group/address-family/encapsulate-srv6.rst

protocols bgp neighbor-group address-family encapsulate-srv6
------------------------------------------------------------

**Minimum user role:** operator

"The following command is used to announce the srv6 attr for local routes."

**Command syntax: encapsulate-srv6 [encapsulate-srv6]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family

**Parameter table**

+------------------+-----------------------------------+--------------+----------+
| Parameter        | Description                       | Range        | Default  |
+==================+===================================+==============+==========+
| encapsulate-srv6 | Enable/Disable srv6 encapsulation | | enabled    | disabled |
|                  |                                   | | disabled   |          |
+------------------+-----------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family l2vpn-evpn
    dnRouter(cfg-bgp-neighbor-afi)# encapsulate-srv6 enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family l2vpn-evpn
    dnRouter(cfg-bgp-group-afi)# encapsulate-srv6 disabled


**Removing Configuration**

To revert encapsulate-srv6 to its default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no encapsulate-srv6

::

    dnRouter(cfg-group-neighbor-afi)# no encapsulate-srv6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.3    | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/explicit-null.rst

protocols bgp neighbor-group address-family explicit-null
---------------------------------------------------------

**Minimum user role:** operator

explicit-null label advertisement for ipv4 labeled-unicast peer allows the option to signal real mpls label (value 0) instead of the default implicit-null label
To enable explicit-null label advertisements"

**Command syntax: explicit-null [explicit-null]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family

**Note**

- This command is applicable to the default VRF only

- Configuration valid only for ipv4 address families

- Configuration per neighbor or neighbor group is inherited from global address-family configuration and can be overwritten per neighbor or neighbor group

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

**Parameter table**

+---------------+-----------------------------------------------------------------+--------------+---------+
| Parameter     | Description                                                     | Range        | Default |
+===============+=================================================================+==============+=========+
| explicit-null | Apply configuration for explicit-null advertisement on LU peers | | enabled    | \-      |
|               |                                                                 | | disabled   |         |
+---------------+-----------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-labeled-unicast
    dnRouter(cfg-bgp-neighbor-afi)# explicit-null enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)#  address-family ipv4-labeled-unicast
    dnRouter(cfg-group-group-afi)# explicit-null enabled


**Removing Configuration**

To revertexplicit-null to default behavior:
::

    dnRouter(cfg-group-neighbor-afi)# no explicit-null

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| TBD     | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/extended-next-hop.rst

protocols bgp neighbor-group address-family extended-next-hop
-------------------------------------------------------------

**Minimum user role:** operator

Extended next-hop capability allows usage of an IPv6 address next-hop for IPv4 NLRIs per RFC8950.
If the capability is supported on both ends, the DNOS router will advertise, by default, the IPv6 BGP session source address as the next-hop value for IPv4 routes.
To enable extended next-hop capability:"

**Command syntax: extended-next-hop [extended-next-hop]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Configuration valid only for ipv4 address families

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- Reconfiguration will cause session restart (capability change)

**Parameter table**

+-------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter         | Description                                                                      | Range        | Default  |
+===================+==================================================================================+==============+==========+
| extended-next-hop | Support for extended next-hop capability. Allowing usage of ipv6 address nexthop | | enabled    | disabled |
|                   | for ipv4 NLRIs. RFC 8950                                                         | | disabled   |          |
+-------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# extended-next-hop enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# extended-next-hop enabled
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66


**Removing Configuration**

To revert extended-next-hop to default behavior:
::

    dnRouter(cfg-group-neighbor-afi)# no extended-next-hop

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/long-lived-graceful-restart/admin-state.rst

protocols bgp neighbor-group address-family long-lived-graceful-restart admin-state
-----------------------------------------------------------------------------------

**Minimum user role:** operator

To enable/disable long-lived-graceful-restart feature on a neighbor/neighbor-group

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family long-lived-graceful-restart

**Note**

- The command is applicable to BGP neighbor and neighbor-groups

- The Graceful restart capability must be enabled for the LLGR to be enabled

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state of the long lived graceful restart feature for the      | | enabled    | disabled |
|             | specific neighbor/neighbor-group. When enabled, peer will be configured with     | | disabled   |          |
|             | long lived graceful restart parameters.                                          |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# long-lived-graceful-restart
    dnRouter(cfg-neighbor-afi-llgr)# admin-state enabled


**Removing Configuration**

To revert all BGP long-lived-graceful-restart parameters to their default values: 
::

    dnRouter(cfg-neighbor-afi-llgr)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/long-lived-graceful-restart/long-lived-graceful-restart.rst

protocols bgp neighbor-group address-family long-lived-graceful-restart
-----------------------------------------------------------------------

**Minimum user role:** operator

Long lived graceful restart enables a BGP router to indicate its ability to preserve its forwarding state during BGP restart. During session initiation, the BGP router informs its peer that it has long lived graceful restart capability. If the BGP session is lost during the restart, the peers mark all the associated routes as stale. However, they do not remove these routes and temporarily continue to use them to make forwarding decisions. Thus, no packets are lost while the BGP process is waiting for convergence of the routing information with the BGP peers.

When the restarting router is back up, the peers wait for the configured amount of time before they delete the stale routes, allowing the router time to converge. When the restarting router sends an end-of-RIB flag notifying its peers that it has converged, or if no end-of-RIB flag is received, but the timer expires, the peers delete any saved stale routes.

Long lived graceful restart is disabled by default. To configure the long-lived-graceful-restart parameters, enable the admin-state for a given afi/safi on a neighbor and a global capability flag for a certain BGP

**Command syntax: long-lived-graceful-restart**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# long-lived-graceful-restart
    dnRouter(cfg-neighbor-afi-llgr)#


**Removing Configuration**

To revert to the default long lived graceful restart values:
::

    dnRouter(cfg-bgp-neighbor-afi)# no long-lived-graceful-restart

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19      | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/long-lived-graceful-restart/stalepath-time.rst

protocols bgp neighbor-group address-family long-lived-graceful-restart stalepath-time units
--------------------------------------------------------------------------------------------

**Minimum user role:** operator

Long lived graceful restart enables a BGP router to indicate its ability to preserve its forwarding state during BGP restart. During session initiation, the BGP router informs its peer that it has long lived graceful restart capability. If the BGP session is lost during the restart, the peers mark all the associated routes as stale. However, they do not remove these routes and temporarily continue to use them to make forwarding decisions. Thus, no packets are lost while the BGP process is waiting for convergence of the routing information with the BGP peers.

When the restarting router is back up, the peers wait for the configured amount of time before they delete the stale routes, allowing the router time to converge. When the restarting router sends an end-of-RIB flag notifying its peers that it has converged, or if no end-of-RIB flag is received, but the timer expires, the peers delete any saved stale routes.

To configure the graceful-restart stalepath-time:

**Command syntax: stalepath-time [time] units [units]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family long-lived-graceful-restart

**Parameter table**

+-----------+---------------------------------------------------------------------------------+-------------+---------+
| Parameter | Description                                                                     | Range       | Default |
+===========+=================================================================================+=============+=========+
| time      | 1..16777215 for seconds 1..279620 for minutes 1..4660 for hours 1..194 for days | 1-16777215  | 1       |
+-----------+---------------------------------------------------------------------------------+-------------+---------+
| units     | time resolution                                                                 | | seconds   | hours   |
|           |                                                                                 | | minutes   |         |
|           |                                                                                 | | hours     |         |
|           |                                                                                 | | days      |         |
+-----------+---------------------------------------------------------------------------------+-------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# long-lived-graceful-restart
    dnRouter(cfg-neighbor-afi-llgr)# stalepath-time 400 units seconds


**Removing Configuration**

To revert to the default stalepath-time value:
::

    dnRouter(cfg-neighbor-afi-llgr)# no stalepath-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19      | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/maximum-prefix/exceed-action.rst

protocols bgp neighbor-group address-family maximum-prefix exceed-action
------------------------------------------------------------------------

**Minimum user role:** operator


To instruct BGP what action to take when the maximum allowed number of prefixes has been exceeded.

 - warning only - (Default behavior) maximum-prefix-number exceeded - restart the neighbor session. The session will restart after the restart-interval.
 - restart - maximum-prefix-number exceeded - restart the neighbor session. The session will restart after the restart-interval.

**Command syntax: exceed-action [action]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family maximum-prefix
- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- When the prefix number drops below the maximum prefix- number threshold, a clear message is sent.

**Parameter table**

+-----------+--------------------------------------------------------+------------------+--------------+
| Parameter | Description                                            | Range            | Default      |
+===========+========================================================+==================+==============+
| action    | action to be taken when maximum-prefix-number exceeded | | warning-only   | warning-only |
|           |                                                        | | restart        |              |
+-----------+--------------------------------------------------------+------------------+--------------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# exceed-action warning-only


**Removing Configuration**

To revert to the default action (warning-only):
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no exceed-action

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/maximum-prefix/limit.rst

protocols bgp neighbor-group address-family maximum-prefix limit
----------------------------------------------------------------

**Minimum user role:** operator

"Specifies the maximum number of IP network prefixes (routes) that can be learned from a specified neighbor or neighbor group."

**Command syntax: limit [maximum-prefix-number]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family maximum-prefix
- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

**Parameter table**

+-----------------------+----------------------+--------------+---------+
| Parameter             | Description          | Range        | Default |
+=======================+======================+==============+=========+
| maximum-prefix-number | 0 used for unlimited | 0-4294967295 | 0       |
+-----------------------+----------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# limit 1000000000


**Removing Configuration**

To revert to default:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no limit

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/maximum-prefix/maximum-prefix.rst

protocols bgp neighbor-group address-family maximum-prefix
----------------------------------------------------------

**Minimum user role:** operator

By setting the maximum-prefix attribute, you control the number of prefixes that can be received from a neighbor. This is useful when a router starts receiving more routes than its memory can take.

To limit the number of routes that can be learned from the neighbor, peer group, or neighbor in a peer group:

**Command syntax: maximum-prefix**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)#


**Removing Configuration**

To revert to the default maximum-prefixes:
::

    dnRouter(cfg-bgp-neighbor-afi)# no maximum-prefix

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/maximum-prefix/restart-interval.rst

protocols bgp neighbor-group address-family maximum-prefix restart-interval
---------------------------------------------------------------------------

**Minimum user role:** operator

Defines the restart interval when an exceed-action value is set to 'restart'.

**Command syntax: restart-interval [restart-interval]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family maximum-prefix
- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+------------------+-------------+---------+---------+
| Parameter        | Description | Range   | Default |
+==================+=============+=========+=========+
| restart-interval | minutes     | 1-65535 | \-      |
+------------------+-------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# restart-interval 100


**Removing Configuration**

To remove the restart interval:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no restart-interval

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/maximum-prefix/threshold.rst

protocols bgp neighbor-group address-family maximum-prefix threshold
--------------------------------------------------------------------

**Minimum user role:** operator

Specifies the percentage of the value specified by *maximum-prefix-number* that causes a log message to be generated.

**Command syntax: threshold [syslog-threshold]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family maximum-prefix
- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+------------------+-------------+-------+---------+
| Parameter        | Description | Range | Default |
+==================+=============+=======+=========+
| syslog-threshold | percentage  | 1-100 | 100     |
+------------------+-------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# threshold 75


**Removing Configuration**

To revert to the default maximum-prefixes:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no threshold

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/nexthop_ipv4.rst

protocols bgp neighbor-group address-family nexthop
---------------------------------------------------

**Minimum user role:** operator

This command sets the next-hop of the advertised route to be the BGP router's address.

To set the advertised route's next-hop value to be the BGP router's address:

**Command syntax: nexthop [ipv4-address]** force [force]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Changing the configuration will cause the BGP session to restart.

- For flowspec SAFI, imposing a nexthop change might affect the flowspec action rules. By default, the "nexthop" attribute doesn't change for flowspec NLRI in either eBGP or iBGP sessions.

- For eBGP sessions and any BGP MPLS session, the nexthop value is set to "nexthop self" by default.

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- The address type must match the address family.

**Parameter table**

+--------------+-----------------------------------------------------------+--------------+----------+
| Parameter    | Description                                               | Range        | Default  |
+==============+===========================================================+==============+==========+
| ipv4-address | set specific ip address to be used as the nexthop address | A.B.C.D      | \-       |
+--------------+-----------------------------------------------------------+--------------+----------+
| force        | apply nexthop setting even when acting as route reflector | | enabled    | disabled |
|              |                                                           | | disabled   |          |
+--------------+-----------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1.1.1.1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv6-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1:1::1:1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 0:ffff::120

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 1.2.3.4
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 95.70.1.13


**Removing Configuration**

To remove the nexthop settings:
::

    dnRouter(cfg-group-neighbor-afi)# no nexthop

To revert force to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no nexthop self force

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                          |
+=========+=======================================================================================================================+
| 6.0     | Command introduced                                                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 11.0    | Added option to enter a specific IP address as nexthop Added option to configure nexthop for neighbors within a group |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                                                                                      |
+---------+-----------------------------------------------------------------------------------------------------------------------+

---

### neighbor-group/address-family/nexthop_ipv6.rst

protocols bgp neighbor-group address-family nexthop
---------------------------------------------------

**Minimum user role:** operator

This command sets the next-hop of the advertised route to be the BGP router's address.

To set the advertised route's next-hop value to be the BGP router's address:

**Command syntax: nexthop [ipv6-address]** force [force]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Changing the configuration will cause the BGP session to restart.

- For flowspec SAFI, imposing a nexthop change might affect the flowspec action rules. By default, the "nexthop" attribute doesn't change for flowspec NLRI in either eBGP or iBGP sessions.

- For eBGP sessions and any BGP MPLS session, the nexthop value is set to "nexthop self" by default.

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- The address type must match the address family.

**Parameter table**

+--------------+-----------------------------------------------------------+--------------+----------+
| Parameter    | Description                                               | Range        | Default  |
+==============+===========================================================+==============+==========+
| ipv6-address | set specific ip address to be used as the nexthop address | X:X::X:X     | \-       |
+--------------+-----------------------------------------------------------+--------------+----------+
| force        | apply nexthop setting even when acting as route reflector | | enabled    | disabled |
|              |                                                           | | disabled   |          |
+--------------+-----------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1.1.1.1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv6-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1:1::1:1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 0:ffff::120

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 1.2.3.4
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 95.70.1.13


**Removing Configuration**

To remove the nexthop settings:
::

    dnRouter(cfg-group-neighbor-afi)# no nexthop

To revert force to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no nexthop self force

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                          |
+=========+=======================================================================================================================+
| 6.0     | Command introduced                                                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 11.0    | Added option to enter a specific IP address as nexthop Added option to configure nexthop for neighbors within a group |
+---------+-----------------------------------------------------------------------------------------------------------------------+

---

### neighbor-group/address-family/orf-prefix-list-ipv4.rst

protocols bgp neighbor-group address-family orf-prefix-list-ipv4
----------------------------------------------------------------

**Minimum user role:** operator

The Prefix-list is sent when the ORF send capability is enabled. To configure the prefix list to be sent to the peer to be used as an outbound-route-filter:

**Command syntax: orf-prefix-list-ipv4 [ipv4-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- The prefix-list type (IPv4 / IPv6) must match the address-family type.

- The prefix-list must use a configured prefix-list from the routing-policy. It can be within the same commit.

- This command is only valid for unicast sub-address families.

- Neighbors within a neighbor-group can use the neighbor-group configuration or a configuration from the group.

**Parameter table**

+------------------+---------------------------------------------------+------------------+---------+
| Parameter        | Description                                       | Range            | Default |
+==================+===================================================+==================+=========+
| ipv4-prefix-list | IPv4 ORF prefix list sent to ORF capable neighbor | | string         | \-      |
|                  |                                                   | | length 1-255   |         |
+------------------+---------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6
    dnRouter(cfg-protocols-bgp-group)# neighbor 2:2::2:2
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6


**Removing Configuration**

To remove the prefix-list:
::

    dnRouter(cfg-bgp-neighbor-afi)# no orf-prefix-list

::

    dnRouter(cfg-bgp-group-afi)# no orf-prefix-list

::

    dnRouter(cfg-group-neighbor-afi)# no orf-prefix-list

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/orf-prefix-list-ipv6.rst

protocols bgp neighbor-group address-family orf-prefix-list-ipv6
----------------------------------------------------------------

**Minimum user role:** operator

The Prefix-list is sent when the ORF send capability is enabled. To configure the prefix list to be sent to the peer to be used as an outbound-route-filter:

**Command syntax: orf-prefix-list-ipv6 [ipv6-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- The prefix-list type (IPv4 / IPv6) must match the address-family type.

- The prefix-list must use a configured prefix-list from the routing-policy. It can be within the same commit.

- This command is only valid for unicast sub-address families.

- Neighbors within a neighbor-group can use the neighbor-group configuration or a configuration from the group.

**Parameter table**

+------------------+---------------------------------------------------+------------------+---------+
| Parameter        | Description                                       | Range            | Default |
+==================+===================================================+==================+=========+
| ipv6-prefix-list | IPv4 ORF prefix list sent to ORF capable neighbor | | string         | \-      |
|                  |                                                   | | length 1-255   |         |
+------------------+---------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6
    dnRouter(cfg-protocols-bgp-group)# neighbor 2:2::2:2
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6


**Removing Configuration**

To remove the prefix-list:
::

    dnRouter(cfg-bgp-neighbor-afi)# no orf-prefix-list

::

    dnRouter(cfg-bgp-group-afi)# no orf-prefix-list

::

    dnRouter(cfg-group-neighbor-afi)# no orf-prefix-list

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/policy-in.rst

protocols bgp neighbor-group address-family policy in
-----------------------------------------------------

**Minimum user role:** operator

To apply a route map to a neighbor or peer group:

**Command syntax: policy [policy-in]** [, policy-in, policy-in] **in**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- If a policy is configured for a group, you cannot disable it for a neighbor within the group. You must explicitly set a different policy to achieve a different behavior from the group. You may even attach an empty policy.

- Can set multiple policies. In case multiple policies are set, policies are evaluated one after the other according to the user input order

- When setting a new policy, the policy will be appended to the existing attached policies

- To remove a policy, the user must specify the name of the policy to be remvoed

- To remove all policies, the user must specify all attached policy names

- To replace an attached policy, the user will need to first remove and than add a new policy. Can be performed in the same commit. the policy order imposes the functional behavior.

**Parameter table**

+-----------+---------------------------------------+------------------+---------+
| Parameter | Description                           | Range            | Default |
+===========+=======================================+==================+=========+
| policy-in | applies the filter in incoming routes | | string         | \-      |
|           |                                       | | length 1-255   |         |
+-----------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy in
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# policy MyPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# policy GroupPolicy in
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# policy NeighborPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy_1,MyPolicy_2 in


**Removing Configuration**

To disable the route map policy:
::

    dnRouter(cfg-bgp-group-afi)# no policy MyPolicy in

::

    dnRouter(cfg-bgp-neighbor-afi)# no policy MyPolicy in

::

    dnRouter(cfg-group-neighbor-afi)# no policy NeighborPolicy in

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 11.0    | Added option to configure policy for a neighbor within a group |
+---------+----------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                               |
+---------+----------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                |
+---------+----------------------------------------------------------------+

---

### neighbor-group/address-family/policy-out.rst

protocols bgp neighbor-group address-family policy out
------------------------------------------------------

**Minimum user role:** operator

To apply a route map to a neighbor or peer group:

**Command syntax: policy [policy-out]** [, policy-out, policy-out] **out**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- If a policy is configured for a group, you cannot disable it for a neighbor within the group. You must explicitly set a different policy to achieve a different behavior from the group. You may even attach an empty policy.

- Can set multiple policies. In case multiple policies are set, policies are evaluated one after the other according to the user input order

- When setting a new policy, the policy will be appended to the existing attached policies

- To remove a policy, the user must specify the name of the policy to be remvoed

- To remove all policies, the user must specify all attached policy names

- To replace an attached policy, the user will need to first remove and than add a new policy. Can be performed in the same commit. the policy order imposes the functional behavior.

**Parameter table**

+------------+---------------------------------------+------------------+---------+
| Parameter  | Description                           | Range            | Default |
+============+=======================================+==================+=========+
| policy-out | applies the filter in outgoing routes | | string         | \-      |
|            |                                       | | length 1-255   |         |
+------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# policy MyPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# policy GroupPolicy out
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# policy NeighborPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy_1,MyPolicy_2 out


**Removing Configuration**

To disable the route map policy:
::

    dnRouter(cfg-bgp-group-afi)# no policy MyPolicy out

::

    dnRouter(cfg-bgp-neighbor-afi)# no policy MyPolicy out

::

    dnRouter(cfg-group-neighbor-afi)# no policy NeighborPolicy out

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 11.0    | Added option to configure policy for a neighbor within a group |
+---------+----------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                               |
+---------+----------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                |
+---------+----------------------------------------------------------------+

---

### neighbor-group/address-family/prefix-list-ipv4_in.rst

protocols bgp neighbor-group address-family prefix-list-ipv4 in
---------------------------------------------------------------

**Minimum user role:** operator

The following command filters the route updates for a BGP neighbor or peer group according to IP address and mask length.

**Command syntax: prefix-list-ipv4 [ipv4-prefix-list-in] in**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+---------------------+---------------------------------------+------------------+---------+
| Parameter           | Description                           | Range            | Default |
+=====================+=======================================+==================+=========+
| ipv4-prefix-list-in | applies the filter in incoming routes | | string         | \-      |
|                     |                                       | | length 1-255   |         |
+---------------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# prefix-list-ipv4 PL4_IN in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# prefix-list-ipv4 PL4_IN in


**Removing Configuration**

To disable filtering:
::

    dnRouter(cfg-bgp-group-afi)# no prefix-list-ipv4 PL_IN in"

::

    dnRouter(cfg-bgp-neighbor-afi)# no prefix-list-ipv4 PL_IN in"

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/prefix-list-ipv4_out.rst

protocols bgp neighbor-group address-family prefix-list-ipv4 out
----------------------------------------------------------------

**Minimum user role:** operator

The following command filters the route updates for a BGP neighbor or peer group according to IP address and mask length.

**Command syntax: prefix-list-ipv4 [ipv4-prefix-list-out] out**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+----------------------+---------------------------------------+------------------+---------+
| Parameter            | Description                           | Range            | Default |
+======================+=======================================+==================+=========+
| ipv4-prefix-list-out | applies the filter in outgoing routes | | string         | \-      |
|                      |                                       | | length 1-255   |         |
+----------------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# prefix-list-ipv4 PL4_OUT out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# prefix-list PL4_OUT out


**Removing Configuration**

To disable filtering:
::

    dnRouter(cfg-bgp-group-afi)# no prefix-list-ipv4 PL_OUT out"

::

    dnRouter(cfg-bgp-neighbor-afi)# no prefix-list-ipv4 PL_OUT out"

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/prefix-list-ipv6_in.rst

protocols bgp neighbor-group address-family prefix-list-ipv6 in
---------------------------------------------------------------

**Minimum user role:** operator

The following command filters the route updates for a BGP neighbor or peer group according to IP address and mask length.

**Command syntax: prefix-list-ipv6 [ipv6-prefix-list-in] in**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+---------------------+---------------------------------------+------------------+---------+
| Parameter           | Description                           | Range            | Default |
+=====================+=======================================+==================+=========+
| ipv6-prefix-list-in | applies the filter in incoming routes | | string         | \-      |
|                     |                                       | | length 1-255   |         |
+---------------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# prefix-list-ipv6 PL6_IN in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# prefix-list-ipv6 PL6_IN in


**Removing Configuration**

To disable filtering:
::

    dnRouter(cfg-bgp-group-afi)# no prefix-list-ipv6 PL_IN in"

::

    dnRouter(cfg-bgp-neighbor-afi)# no prefix-list-ipv6 PL_IN in"

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/prefix-list-ipv6_out.rst

protocols bgp neighbor-group address-family prefix-list-ipv6 out
----------------------------------------------------------------

**Minimum user role:** operator

The following command filters the route updates for a BGP neighbor or peer group according to IP address and mask length.

**Command syntax: prefix-list-ipv6 [ipv6-prefix-list-out] out**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+----------------------+---------------------------------------+------------------+---------+
| Parameter            | Description                           | Range            | Default |
+======================+=======================================+==================+=========+
| ipv6-prefix-list-out | applies the filter in outgoing routes | | string         | \-      |
|                      |                                       | | length 1-255   |         |
+----------------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# prefix-list-ipv6 PL6_OUT out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# prefix-list-ipv6 PL6_OUT out


**Removing Configuration**

To disable filtering:
::

    dnRouter(cfg-bgp-group-afi)# no prefix-list-ipv6 PL_OUT out"

::

    dnRouter(cfg-bgp-neighbor-afi)# no prefix-list-ipv6 PL_OUT out"

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/remove-private-as.rst

protocols bgp neighbor-group address-family remove-private-as
-------------------------------------------------------------

**Minimum user role:** operator

To remove private AS numbers from the AS path advertised to the neighbor or peer group:

**Command syntax: remove-private-as** all

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+-----------+--------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                              | Range   | Default |
+===========+==========================================================================+=========+=========+
| all       | remove all private as-numbers regardless if path contains public numbers | Boolean | False   |
+-----------+--------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# remove-private-as
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# remove-private-as

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# remove-private-as all

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# remove-private-as


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-neighbor-afi)# no remove-private-as all

::

    dnRouter(cfg-bgp-group-afi)# no remove-private-as

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/route-reflector-client.rst

protocols bgp neighbor-group address-family route-reflector-client
------------------------------------------------------------------

**Minimum user role:** operator

To configure a neighbor as a route reflector client:

**Command syntax: route-reflector-client**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family

**Note**

- This command is applicable to iBGP neighbors only.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)#)# route-reflector-client

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# route-reflector-client


**Removing Configuration**

To remove the route-reflector configuration:
::

    dnRouter(cfg-bgp-neighbor-afi)# no route-reflector-client

::

    dnRouter(cfg-bgp-group-afi)# no route-reflector-client

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.0    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/send-community.rst

protocols bgp neighbor-group address-family send-community
----------------------------------------------------------

**Minimum user role:** operator

The following command ensures that the community attribute is sent in updates to the specified neighbor or group.

**Command syntax: send-community** community-type [community-type]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- The default behavior of the system is to not send the community attribute.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter      | Description                                                                      | Range        | Default |
+================+==================================================================================+==============+=========+
| community-type | both - Sends both standard and extended attributes extended - Sends extended     | | both       | both    |
|                | attributes standard - Sends standard attributes                                  | | extended   |         |
|                |                                                                                  | | standard   |         |
+----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# send-community
    dnRouter(cfg-bgp-neighbor-afi)# send-community community-type standard

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# send-community community-type both

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-flowspec
    dnRouter(cfg-bgp-group-afi)# send-community community-type both


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-group-afi)# no send-community

::

    dnRouter(cfg-bgp-neighbor-afi)# no send-community community-type standard

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/send-large-community.rst

protocols bgp neighbor-group address-family send-large-community
----------------------------------------------------------------

**Minimum user role:** operator

The following command ensures that the large community attribute is sent in updates to the specified neighbor or group.

**Command syntax: send-large-community [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**
The default behavior of the system is to not send the large-community attribute.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enables sending the large community attribute in updates to the specified BGP    | | enabled    | disabled |
|             | neighbor                                                                         | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# send-large-community enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# send-large-community disabled


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-group-afi)# no send-large-community

::

    dnRouter(cfg-bgp-neighbor-afi)# no send-large-community

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/soft-reconfiguration.rst

protocols bgp neighbor-group address-family soft-reconfiguration inbound
------------------------------------------------------------------------

**Minimum user role:** operator

To set address-family prefixes to be saved in the adj-RIB-in table to support soft rest:

**Command syntax: soft-reconfiguration inbound**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# soft-reconfiguration inbound
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# soft-reconfiguration inbound

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# soft-reconfiguration inbound


**Removing Configuration**

To stop the routes from being saved in the adj-RIB-in table for the neighbor address-family:
::

    dnRouter(cfg-bgp-group-afi)# no soft-reconfiguration inbound

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 10.0    | Command not supported            |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/address-family/sr-labeled-unicast/allow-external-sid.rst

protocols bgp neighbor-group address-family sr-labeled-unicast allow-external-sid
---------------------------------------------------------------------------------

**Minimum user role:** operator

BGP Prefix-SID Redistribution allows advertising IPv4 and IPv6 BGP Prefix-SID for SR-MPLS IPv4/IPv6-based networks. 
It is possible for BGP to carry the association of an SR-MPLS Node-SID index with an IPv4/IPv6 prefix. 
This is achieved by attaching a prefix-SID BGP path attribute containing the label-index value to an IPv4/IPv6 route belonging to either an IPv4-LU or IPv6-LU address family.
This command controls the BGP prefix-SID usage on eBGP sessions between different Autonomous Systems, as required by RFC 8669.

To enable advertisement of the local SRGB in an Originator SRGB TLV as part of the Prefix-SID attributes for locally originated routes:

**Command syntax: allow-external-sid [allow-external-sid]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family sr-labeled-unicast
- protocols bgp neighbor address-family sr-labeled-unicast

**Note**

- This command only supports Labeled-Unicast routes, when the Prefix-SID is enabled.

- Supported for eBGP sessions only.

- To allow usage of BGP prefix-sid on eBGP adjacencies, set the required behavior - <send-only/receive-only/send-receive/disabled>.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter          | Description                                                                      | Range            | Default |
+====================+==================================================================================+==================+=========+
| allow-external-sid | Define exchange behaviour of Prefix-SID attribute with external peers.           | | send-only      | \-      |
|                    | Configuration only relevant for ebgp sessions                                    | | receive-only   |         |
|                    |                                                                                  | | send-receive   |         |
|                    |                                                                                  | | disabled       |         |
+--------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-labeled-unicast
    dnRouter(cfg-bgp-neighbor-afi)# sr-labeled-unicast
    dnRouter(cfg-neighbor-afi-sr-lu)# allow-external-sid send-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-labeled-unicast
    dnRouter(cfg-bgp-group-afi)# sr-labeled-unicast
    dnRouter(cfg-group-afi-sr-lu)# allow-external-sid send-receive


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-group-afi-sr-lu)# no allow-external-sid

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/address-family/sr-labeled-unicast/sr-labeled-unicast.rst

protocols bgp neighbor-group address-family sr-labeled-unicast
--------------------------------------------------------------

**Minimum user role:** operator

To enter sr-labeled-unicast configuration level.

**Command syntax: sr-labeled-unicast**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group address-family
- protocols bgp neighbor address-family

**Note**

- Notice the change in prompt.

- Valid only for the default vrf.

- Supported for both the neighbor and peer group. Not supported for the neighbor within the peer group.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-labeled-unicast
    dnRouter(cfg-bgp-neighbor-afi)# sr-labeled-unicast
    dnRouter(cfg-neighbor-afi-sr-lu)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-labeled-unicast
    dnRouter(cfg-bgp-group-afi)# sr-labeled-unicast
    dnRouter(cfg-group-afi-sr-lu)#


**Removing Configuration**

To remove the sr-labeled-unicast configuration:
::

    dnRouter(cfg-protocols-bgp-afi)# no sr-labeled-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/admin-state.rst

protocols bgp neighbor-group admin-state
----------------------------------------

**Minimum user role:** operator

Use this command to administratively start or shut down the session with the BGP neighbor, BGP neighbors in a group or a specific BGP neighbor within a group (this will override the group setting for this neighbor):

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | Causes a device to shut down the session administratively with its BGP neighbor. | | enabled    | enabled |
|             |                                                                                  | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# admin-state disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# admin-state disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# admin-state disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/adv-interval.rst

protocols bgp neighbor-group advertisement-interval
---------------------------------------------------

**Minimum user role:** operator

To set the interval between BGP routing updates:

**Command syntax: advertisement-interval [advertisement-interval]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter              | Description                                                                      | Range | Default |
+========================+==================================================================================+=======+=========+
| advertisement-interval | Set the interval between BGP routing updates. The default advertisement-interval | 0-600 | \-      |
|                        | between ibgp and ebgp sessions default for ibgp = 0 default for ebgp = 30        |       |         |
+------------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-protocols-bgp-neighbor)# advertisement-interval 20
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-protocols-bgp-neighbor)# advertisement-interval 90
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 7180
    dnRouter(cfg-protocols-bgp-group)# advertisement-interval 2


**Removing Configuration**

To revert to the default interval:
::

    dnRouter(cfg-protocols-bgp-group)# no advertisement-interval

::

    dnRouter(cfg-protocols-bgp-neighbor)# no advertisement-interval

**Command History**

+---------+--------------------------------------------------+
| Release | Modification                                     |
+=========+==================================================+
| 6.0     | Command introduced                               |
+---------+--------------------------------------------------+
| 9.0     | Updated default interval for iBGP neighbors to 0 |
+---------+--------------------------------------------------+

---

### neighbor-group/authentication.rst

protocols bgp neighbor-group authentication md5 password
--------------------------------------------------------

**Minimum user role:** operator

To set a password for authenticating the neighbor, peer group neighbors, or the neighbor in a peer group:

**Command syntax: authentication md5 password [secret]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- Changing the configuration will cause the BGP session to restart.

- If you do not specify a password, enter the password of the neighbor BGP router in clear text. The password is then encrypted and from then on will be displayed as encrypted. You can copy the encrypted password and use it as the enc-password. When typing a clear password, the password is not displayed in the CLI terminal.

- The clear text password provided in the CLI is hashed with the md5 hash. As the md5 hash is not strong enough and can be broken, the FERNET algorithm is applied to the md5 hash before it is stored in the DNOS database.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| secret    | set a password for authentication encrypted secret password string for the       | \-    | \-      |
|           | neighbor bgp. if the user enters a clear-text password, the password is then     |       |         |
|           | encrypted by the system and saved in secret argument. if user specified 'secret' |       |         |
|           | save string in secret                                                            |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# authentication md5 password
    Enter password
    Enter password for verifications

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.2.2
    dnRouter(cfg-protocols-bgp-neighbor)# authentication md5 password enc-!U2FsdGVkX1+

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# authentication md5 password
    Enter password
    Enter password for verification

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# authentication md5 password
    Enter password
    Enter password for verification
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# authentication md5 password enc-!U2FsdGVkX1+qG


**Removing Configuration**

To remove the password configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no authentication md5

::

    dnRouter(cfg-protocols-bgp-group)# no authentication md5

::

    dnRouter(cfg-bgp-group-neighbor)# no authentication md5

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/bfd/admin-state.rst

protocols bgp neighbor-group bfd admin-state
--------------------------------------------

**Minimum user role:** operator

Enable BFD session for BGP session protection and enter BFD configuration level to configure BFD session settings.

To change the BFD administrative state for a specific BGP neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- In the event that there are multiple BFD clients registered to the same BFD session, a single BFD session is established with the strictest session parameters between all clients.

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# admin-state enabled
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no admin-state

::

    dnRouter(cfg-bgp-group-bfd)# no admin-state

::

    dnRouter(cfg-bgp-neighbor-bfd)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### neighbor-group/bfd/bfd-type.rst

protocols bgp neighbor-group bfd bfd-type
-----------------------------------------

**Minimum user role:** operator

Define the requested BFD session type, Single-hop or Multi-hop. By default session type is according to BGP peering type.

To set requested session type:

**Command syntax: bfd-type [session-type]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- For multi-hop session type , update-source must be configured for neighbor

- For single-hop session type , bgp peering must be directly over a connected interface

- Reconfig of bfd-type will result in a new BFD session

**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------------+-----------+
| Parameter    | Description                                                                      | Range          | Default   |
+==============+==================================================================================+================+===========+
| session-type | Define the requested BFD session type, Single-hop or Multi-hop. By default       | | automatic    | automatic |
|              | session type is according to BGP peering type                                    | | single-hop   |           |
|              |                                                                                  | | multi-hop    |           |
+--------------+----------------------------------------------------------------------------------+----------------+-----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# bfd-type single-hop

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# bfd-type enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# bfd-type multi-hop
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# bfd-type automatic


**Removing Configuration**

To revert the bfd-type to its default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no bfd-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### neighbor-group/bfd/bfd.rst

protocols bgp neighbor-group bfd
--------------------------------

**Minimum user role:** operator

The command allows enabling BFD for the protection of a session between a single BGP neighbor or neighbor group and allows you to configure the BFD session settings.
The BFD session type (single-hop or multi-hop) is decided according to the BGP session type. The BFD source address is the BGP source address and the BFD destination address is the BGP peer address.

When a BFD session is down, the BGP session will close and all routes from the neighbor will be withdrawn.

The BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations.

Detection-time = negotiated-received-interval X received multiplier.
This is the maximum amount of time that can elapse without receiving a BFD control packet before the session is declared down.

BFD neighbor can signal session state down and upon receipt, the local BFD session will immediately switch to DOWN state.

To enable or disable the BFD protocol with a single neighbor or a neighbor group:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)#


**Removing Configuration**

To revert the BFD protocol to the default state:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bfd 

::

    dnRouter(cfg-protocols-bgp-group)# no bfd

::

    dnRouter(cfg-bgp-group-neighbor)# no bfd

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 11.4    | Command reintroduced |
+---------+----------------------+

---

### neighbor-group/bfd/min-rx.rst

protocols bgp neighbor-group bfd min-rx
---------------------------------------

**Minimum user role:** operator

Set the desired minimum receive interval for the BFD session for a single neighbor or neighbor group:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | 300     |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# min-rx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-rx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-rx 400
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# min-rx 300


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no min-rx

::

    dnRouter(cfg-bgp-group-bfd)# no min-rx

::

    dnRouter(cfg-group-neighbor-bfd)# no min-rx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.4    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### neighbor-group/bfd/min-tx.rst

protocols bgp neighbor-group bfd min-tx
---------------------------------------

**Minimum user role:** operator

Set the desired minimum transmit interval for the BFD session for a single neighbor or neighbor group:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

- Due to hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | 300     |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# min-tx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-tx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-tx 400
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# min-tx 300


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no min-tx

::

    dnRouter(cfg-bgp-group-bfd)# no min-tx

::

    dnRouter(cfg-group-neighbor-bfd)# no min-tx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.4    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### neighbor-group/bfd/multiplier.rst

protocols bgp neighbor-group bfd multiplier
-------------------------------------------

**Minimum user role:** operator

Set the local BFD multiplier for a single neighbor or neighbor group:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# multiplier 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# multiplier 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# multiplier 2
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# multiplier 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no multiplier

::

    dnRouter(cfg-bgp-group-bfd)# no multiplier

::

    dnRouter(cfg-group-neighbor-bfd)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### neighbor-group/bmp/activate-server.rst

protocols bgp neighbor-group bmp activate-server
------------------------------------------------

**Minimum user role:** operator

To enable exporting bgp neighbor information to a bmp server:

**Command syntax: activate-server [server-id]** [, server-id, server-id]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bmp
- protocols bgp neighbor bmp
- protocols bgp neighbor-group neighbor bmp

**Note**

- The disabled option is only valid for a neighbor within a neighbor group. When configured, neighbor information is not exported to the bmp server, even if one is configured for the neighbor-group.

**Parameter table**

+-----------+-----------------------------------------------------------+-------+---------+
| Parameter | Description                                               | Range | Default |
+===========+===========================================================+=======+=========+
| server-id | Enable exporting bgp neighbor information to a bmp server | 1-5   | \-      |
+-----------+-----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-protocols-bgp-neighbor-bmp)# activate-server 1


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.2.2
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-protocols-bgp-neighbor-bmp)# activate-server 1, 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 1
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 1
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# bmp
    dnRouter(cfg-group-neighbor-bmp)# activate-server 1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# activate-server 1, 2, 3
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp activate-server disabled


**Removing Configuration**

To remove the specific bmp server-id:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bmp activate-server

::

    dnRouter(cfg-protocols-bgp-group)# no bmp activate-server

::

    dnRouter(cfg-bgp-group-neighbor)# no bmp activate-server

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/bmp/bmp.rst

protocols bgp neighbor-group bmp
--------------------------------

**Minimum user role:** operator

The BGP Monitoring Protocol (BMP) allows you to send the BGP route information from the router to a monitoring application on a separate device. The monitoring application is referred to as the BMP monitoring station or BMP station. To deploy BMP in the network, you need to configure BMP on each router, from which you want to gather information, and at least one BMP station.

BGP BMP collects statistics data from the Adjacency-RIB-In routing tables and send that data periodically to a monitoring station, for further analysis.

Some of the use-cases for BMP include:

- Looking Glasses - IPv4, IPv6, and VPN prefixes.
- Route Analytics - Track convergence times, prefix history as they change over time, monitor and track BGP policy changes, etc...
- Traffic Engineering Analytics - Adapt dynamically to change, and know what is the best shift.
- BGP pre-policy - Pre-policy routing information provides insight into all path attributes from various points in the network, allowing non-intrusive what-if topology views for new policy validations.

**Command syntax: bmp**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-bgp-neighbor-bmp)#


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)#


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-bgp-group-bmp-rm)#
    dnRouter(cfg-bgp-group-bmp-rm)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp
    dnRouter(cfg-group-neighbor-bmp)#


**Removing Configuration**

To return all bmp settings to the default:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bmp

::

    dnRouter(cfg-protocols-bgp-group)# no bmp

::

    dnRouter(cfg-bgp-group-neighbor)# no bmp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/bmp/route-monitoring/adj-in_post-policy.rst

protocols bgp neighbor-group bmp route-monitoring adj-in post-policy
--------------------------------------------------------------------

**Minimum user role:** operator

Enable exporting BGP neighbor adjacency-in post-policy tables. The configuration applies to all BGP neighbor address-families.

**Command syntax: adj-in post-policy [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bmp route-monitoring
- protocols bgp neighbor bmp route-monitoring
- protocols bgp neighbor-group neighbor bmp route-monitoring

**Parameter table**

+-------------+--------------------------------+--------------+---------+
| Parameter   | Description                    | Range        | Default |
+=============+================================+==============+=========+
| admin-state | adjecenty in post policy table | | enabled    | \-      |
|             |                                | | disabled   |         |
+-------------+--------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in post-policy disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in post-policy enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in post-policy disabled
    dnRouter(cfg-group-bmp-rm)# exit
    dnRouter(cfg-bgp-group-bmp)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in post-policy enabled


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in post-policy

::

    dnRouter(cfg-group-bmp-rm)# no adj-in post-policy

::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in post-policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/bmp/route-monitoring/adj-in_pre-policy.rst

protocols bgp neighbor-group bmp route-monitoring adj-in pre-policy
-------------------------------------------------------------------

**Minimum user role:** operator

Enable exporting BGP neighbor adjacency-in pre-policy tables. The configuration applies to all BGP neighbor address-families.

**Command syntax: adj-in pre-policy [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bmp route-monitoring
- protocols bgp neighbor bmp route-monitoring
- protocols bgp neighbor-group neighbor bmp route-monitoring

**Note**

- Pre-policy information is exported only when a neighbor is enabled with "soft-reconfiguration inbound", which ensures that the neighbor pre-policy information is kept in BGP.

**Parameter table**

+-------------+-------------------------------+--------------+---------+
| Parameter   | Description                   | Range        | Default |
+=============+===============================+==============+=========+
| admin-state | adjecenty in pre policy table | | enabled    | \-      |
|             |                               | | disabled   |         |
+-------------+-------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in pre-policy disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in pre-policy enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in pre-policy disabled
    dnRouter(cfg-group-bmp-rm)# exit
    dnRouter(cfg-group-bmp)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in pre-policy enabled


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in pre-policy

::

    dnRouter(cfg-group-bmp-rm)# no adj-in pre-policy

::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in pre-policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/bmp/route-monitoring/route-monitoring.rst

protocols bgp neighbor-group bmp route-monitoring
-------------------------------------------------

**Minimum user role:** operator

To enter the BMP server route-monitoring configuration level:

**Command syntax: route-monitoring**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group bmp
- protocols bgp neighbor bmp
- protocols bgp neighbor-group neighbor bmp

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-bgp-neighbor-bmp)# route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# route-monitoring
    dnRouter(cfg-group-bmp-rm)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# route-monitoring
    dnRouter(cfg-group-bmp-rm)#
    dnRouter(cfg-bgp-group-bmp-rm)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)#


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-bgp-neighbor-bmp)# no route-monitoring

::

    dnRouter(cfg-bgp-group-bmp)# no route-monitoring

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/cluster-id.rst

protocols bgp neighbor-group cluster-id
---------------------------------------

**Minimum user role:** operator

You can use this command to specify a global cluster-id attribute when used as a route-reflector, or per neighbor-group or neighbor if specified explicitly.

Prior to reflecting a route, route reflectors append their cluster-id to the cluster list.

If two routers share the same BGP cluster ID, they belong to the same cluster.

**Command syntax: cluster-id [cluster-id]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor

**Parameter table**

+------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter  | Description                                                                      | Range            | Default |
+============+==================================================================================+==================+=========+
| cluster-id | route-reflector cluster id to use when local router is configured as a route     | | 1-4294967295   | \-      |
|            | reflector.                                                                       | | A.B.C.D        |         |
+------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# cluster-id 65.65.65.65

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65001
    dnRouter(cfg-protocols-bgp)# cluster-id 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65001
    dnRouter(cfg-protocols-bgp)# neighbor 1.1.1.1
    dnRouter(cfg-protocols-bgp-neighbor)# cluster-id 101

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# cluster-id 10.0.0.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# cluster-id 27081


**Removing Configuration**

To revert all BGP cluster-id to the default value:
::

    dnRouter(cfg-protocols-bgp)# no cluster-id

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 15.1    | Command introduced                                           |
+---------+--------------------------------------------------------------+
| 17.1    | Extended support for neighbor and neighbor-group hierarchies |
+---------+--------------------------------------------------------------+

---

### neighbor-group/connected-check.rst

protocols bgp neighbor-group connected-check
--------------------------------------------

**Minimum user role:** operator

Typically in eBGP peering, a check is done to confirm that the neighbor is listed in the routing table as being directly connected. eBGP peering will not be attempted with a neighbor that is not directly connected. When the loopback interface is used for peering, then the IP address of the neighbor will not be listed as being directly connected and so peering will not be possible.

The following command instructs the BGP router whether or not to disable the connection verification check for eBGP peering sessions that are directly connected but are configured on a loopback interface or with a non-directly connected IP address.

**Command syntax: connected-check [connected-check]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The option to disable the check is required only when the neighbor ebgp-multihop command is configured with a TTL value of 1. See "bgp neighbor ebgp-multihop".

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| connected-check | disable the connection verification process for eBGP peering sessions that are   | | enabled    | enabled |
|                 | reachable by a single hop but are configured on a loopback interface or          | | disabled   |         |
|                 | otherwise configured with a non-directly connected IP address                    |              |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# connected-check disabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# connected-check disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# connected-check disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# connected-check enabled


**Removing Configuration**

To remove the configuration:
::

    dnRouter(cfg-protocols-bgp-group)# no connected-check

::

    dnRouter(cfg-protocols-bgp-neighbor)# no connected-check

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/description.rst

protocols bgp neighbor-group description
----------------------------------------

**Minimum user role:** operator

To set a description for the BGP neighbor, BGP peer group, or BGP neighbor within a peer group:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-------------+--------------------------+------------------+---------+
| Parameter   | Description              | Range            | Default |
+=============+==========================+==================+=========+
| description | a neighbors' description | | string         | \-      |
|             |                          | | length 1-255   |         |
+-------------+--------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# description my-unique-description


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no description

::

    dnRouter(cfg-protocols-bgp-group)# no description

::

    dnRouter(cfg-bgp-group-neighbor)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/ebgp-multihop.rst

protocols bgp neighbor-group ebgp-multihop
------------------------------------------

**Minimum user role:** operator

To configure a maximum number of hops to an eBGP neighbor, to an eBGP peer group, or to a neighbor within a peer group:

**Command syntax: ebgp-multihop [ebgp-multihop]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- If you set a value greater than 1, the neighbor will always be considered as an indirectly connected neighbor, regardless of the actual reachability.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter     | Description                                                                      | Range | Default |
+===============+==================================================================================+=======+=========+
| ebgp-multihop | set eBGP neighbors that are not on directly connected networks and sets an       | 1-255 | 1       |
|               | optional maximum hop count                                                       |       |         |
+---------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# ebgp-multihop

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# ebgp-multihop 20

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# ebgp-multihop 20

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# ebgp-multihop 16


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ebgp-multihop

::

    dnRouter(cfg-protocols-bgp-group)# no ebgp-multihop

::

    dnRouter(cfg-bgp-group-neighbor)# no ebgp-multihop

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/graceful-restart.rst

protocols bgp neighbor-group graceful-restart
---------------------------------------------

**Minimum user role:** operator

To configure the BGP graceful restart capability for a specific neighbor, a peer group, or for a neighbor in a peer group:

**Command syntax: graceful-restart [graceful-restart-admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- When bgp graceful-restart is disabled, no graceful-restart is done regardless of the bgp neighbor graceful-restart state.

- Disabled: disables graceful-restart for the neighbor.

**Parameter table**

+------------------------------+------------------------------------------+-----------------+---------+
| Parameter                    | Description                              | Range           | Default |
+==============================+==========================================+=================+=========+
| graceful-restart-admin-state | global graceful-restart capability state | | enabled       | enabled |
|                              |                                          | | disabled      |         |
|                              |                                          | | helper-only   |         |
+------------------------------+------------------------------------------+-----------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001:3::65
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart helper-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001:3::65
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# graceful-restart enabled
    dnRouter(cfg-protocols-bgp-group)# graceful-restart helper-only
    dnRouter(cfg-protocols-bgp-group)# graceful-restart disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no graceful-restart

::

    dnRouter(cfg-protocols-bgp-group)# no graceful-restart

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/local-as_type.rst

protocols bgp neighbor-group local-as
-------------------------------------

**Minimum user role:** operator

If, for whatever reason, you need to change the AS number of your network, you will need to reconfigure the AS number on all the BGP peers. By specifying an alternate AS for this BGP process when interacting with the specified peer, you allow the peer to appear to simultaneously belong to both the former AS and the new AS, without changing the peering arrangements.

To configure a local AS number for the neighbor:

**Command syntax: local-as [local-as-number]** type [as-path-prepend-type]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group

**Note**

- This command is relevant to BGP peers only.

- The configuration will reset the BGP session.

- The local-as-number must be different from the router AS.

- When changing the local-as-number, the as-path-prepend-type will return to the default value.

- When the local-as-number is identical to the neighbor AS, you cannot configure the as-path-prepend-type

**Parameter table**

+----------------------+----------------------------------------------------------------------------------+---------------------------+---------+
| Parameter            | Description                                                                      | Range                     | Default |
+======================+==================================================================================+===========================+=========+
| local-as-number      | as-number for peer session, must be different from local-AS and peer-AS          | 1-4294967295              | \-      |
+----------------------+----------------------------------------------------------------------------------+---------------------------+---------+
| as-path-prepend-type | prepend type for as-path when adding local-as perpend - default config. prepend  | | prepend                 | prepend |
|                      | the local-as as well as the bgp as-n no-perpend - the supplied local-as is not   | | no-prepend              |         |
|                      | prepended to the received as-path no-prepend-replace-as - only the supplied      | | no-prepend-replace-as   |         |
|                      | local-as is prepended to the as-path when transmitting local-route updates to    |                           |         |
|                      | this peer                                                                        |                           |         |
+----------------------+----------------------------------------------------------------------------------+---------------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# local-as 1000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# local-as 1000 type no-prepend

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# local-as 1000 type no-prepend-replace-as

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 8000
    dnRouter(cfg-protocols-bgp-neighbor)# local-as 8000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65001
    dnRouter(cfg-protocols-bgp-group)# local-as 65001


**Removing Configuration**

To delete the local AS configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no local-as

::

    dnRouter(cfg-protocols-bgp-group)# no local-as

**Command History**

+---------+---------------------------------+
| Release | Modification                    |
+=========+=================================+
| 6.0     | Command introduced              |
+---------+---------------------------------+
| 11.0    | Removed "type" from the syntax. |
+---------+---------------------------------+

---

### neighbor-group/min-hold-time.rst

protocols bgp neighbor-group minimum-hold-time
----------------------------------------------

**Minimum user role:** operator

To adjust the threshold for the minimum-hold-time:

**Command syntax: minimum-hold-time [minimum-hold-time]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group

**Note**

- The value of the set minimum-hold-time must be less or equal to the hold-time set value.

**Parameter table**

+-------------------+-------------------+---------+---------+
| Parameter         | Description       | Range   | Default |
+===================+===================+=========+=========+
| minimum-hold-time | minimum-hold-time | 3-65535 | 3       |
+-------------------+-------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# minimum-hold-time 7

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# minimum-hold-time 11


**Removing Configuration**

To revert minimum-hold-time value to their default values:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no minimum-hold-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor-group.rst

protocols bgp neighbor-group
----------------------------

**Minimum user role:** operator

Groups allow you to share configuration among the group members. Some neighbor configuration may override the group configuration.

Once the neighbor group is created, assign neighbors to the group. See \"bgp neighbor\". To override the group configuration for a neighbor, configure the neighbor in the group.

To create a neighbor group:

**Command syntax: neighbor-group [peer-group]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- Notice the change in prompt.

**Parameter table**

+------------+------------------------+------------------+---------+
| Parameter  | Description            | Range            | Default |
+============+========================+==================+=========+
| peer-group | peer-group unique name | | string         | \-      |
|            |                        | | length 1-255   |         |
+------------+------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group IBGP:pe2core
    dnRouter(cfg-protocols-bgp-group)#


**Removing Configuration**

To delete a BGP group:
::

    dnRouter(cfg-protocols-bgp)# no neighbor-group IBGP:pe2core

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/address-family/accept-own.rst

protocols bgp neighbor-group neighbor address-family accept-own
---------------------------------------------------------------

**Minimum user role:** operator

To instruct the router whether or not to handle self-originated VPN routes containing the accept-own community attribute:

**Command syntax: accept-own [accept-own]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is only applicable to vpn address-families.

**Parameter table**

+------------+----------------------------------------------+--------------+----------+
| Parameter  | Description                                  | Range        | Default  |
+============+==============================================+==============+==========+
| accept-own | Enable accept-own handling for this neighbor | | enabled    | disabled |
|            |                                              | | disabled   |          |
+------------+----------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-bgp-neighbor-afi)# accept-own enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# accept-own enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# accept-own enabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# accept-own disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no accept-own

::

    dnRouter(cfg-bgp-group-afi)# no accept-own

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/address-family/add-path_receive.rst

protocols bgp neighbor-group neighbor address-family add-path receive
---------------------------------------------------------------------

**Minimum user role:** operator

Typically, BGP routers advertise only the best path for each route. The advertisement of a prefix replaces the previous announcement of that prefix.

To allow the device to receive multiple paths for the same route from the BGP neighbor/group:

**Command syntax: add-path receive [add-path-receive]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Note**

- This command is only applicable to unicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter        | Description                                                                      | Range        | Default |
+==================+==================================================================================+==============+=========+
| add-path-receive | Enables additional paths to be received for the same route from a bgp neighbor.  | | enabled    | \-      |
|                  | Applies default vrf neighbor with in group for unicast safi                      | | disabled   |         |
+------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# add-path receive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path receive disabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# add-path receive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no add-path receive

::

    dnRouter(cfg-bgp-group-afi)# no add-path receive

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 9.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/add-path_send/add-path_send.rst

protocols bgp neighbor-group neighbor address-family add-path send
------------------------------------------------------------------

**Minimum user role:** operator

BGP Additional Paths is a BGP extension that provides the ability to advertise multiple paths for the same prefix without the new paths replacing previous paths. This helps reduce route repetition, and achieve faster re-convergence as an alternative path is available immediately upon failure of a primary path.

To enter add-path send configuration level:

**Command syntax: add-path send**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Note**

- When all paths share the same next-hop only the single best path will be sent.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-group-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-group-afi-add-path-send)# admin-state disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no add-path send

::

    dnRouter(cfg-bgp-group-afi)# no add-path send

::

    dnRouter(cfg-group-neighbor-afi)# no add-path send

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/add-path_send/admin-state.rst

protocols bgp neighbor-group neighbor address-family add-path send admin-state
------------------------------------------------------------------------------

**Minimum user role:** operator

To enable the add-path send behavior for a specific neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family add-path send
- protocols bgp neighbor address-family add-path send
- protocols bgp neighbor-group address-family add-path send

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+-------------+--------------------------------+--------------+---------+
| Parameter   | Description                    | Range        | Default |
+=============+================================+==============+=========+
| admin-state | add path send enabled/disabled | | enabled    | \-      |
|             |                                | | disabled   |         |
+-------------+--------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no admin-state

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/add-path_send/path-count.rst

protocols bgp neighbor-group neighbor address-family add-path send path-count
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can set the number of paths to be sent when add-path send is enabled:

**Command syntax: path-count [path-count]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family add-path send
- protocols bgp neighbor address-family add-path send
- protocols bgp neighbor-group address-family add-path send

**Parameter table**

+------------+----------------------------------------+-------+---------+
| Parameter  | Description                            | Range | Default |
+============+========================================+=======+=========+
| path-count | maximum number of path allowed to send | 2-32  | \-      |
+------------+----------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no path-count

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/address-family.rst

protocols bgp neighbor-group neighbor address-family
----------------------------------------------------

**Minimum user role:** operator

The address-family applies to a neighbor, neighbor-group, and a neighbor within a neighbor-group. A neighbor within a neighbor-group inherits all address-families configured for the neighbor-group (a neighbor-group must be configured with at least one address-family, regardless if it has neighbors within it. To configure an address-family to be supported by BGP for the neighbor:

**Command syntax: address-family [neighbor-address-family]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- Changing the configuration will cause the BGP session to restart.

- When FlowSpec SAFI is applied, the received FlowSpec rules are imposed on all FlowSpec enabled interfaces.

- Notice the change in prompt.

- When using OSPFv3 or IPv6-based BGP peering within a routing instance, you must explicitly configure a router ID (router-id) for that specific instance. The main routing instance's router ID is not inherited by other instances. Even if only IPv6 protocols are used, a 32-bit router ID is still required, as IPv6 routing protocols rely on it for establishing adjacencies. The router ID must be a non-zero 32-bit (4-octet) unsigned integer. While it's common to use an IPv4 address as the router ID, this is not mandatory - it doesnt need to be a valid or routable address, just a unique 32-bit value within the routing domain. Failing to configure a router ID in an IPv6 OSPF or BGP instance will result in the protocol defaulting to 0.0.0.0, which is invalid. This will prevent adjacency formation and BGP session establishment.

**Parameter table**

+-------------------------+---------------+--------------------------+---------+
| Parameter               | Description   | Range                    | Default |
+=========================+===============+==========================+=========+
| neighbor-address-family | afi-safi type | | ipv4-unicast           | \-      |
|                         |               | | ipv6-unicast           |         |
|                         |               | | ipv4-labeled-unicast   |         |
|                         |               | | ipv6-labeled-unicast   |         |
|                         |               | | ipv4-vpn               |         |
|                         |               | | ipv6-vpn               |         |
|                         |               | | link-state             |         |
|                         |               | | ipv4-flowspec          |         |
|                         |               | | ipv6-flowspec          |         |
|                         |               | | ipv4-rt-constrains     |         |
|                         |               | | ipv4-multicast         |         |
|                         |               | | l2vpn-evpn             |         |
|                         |               | | l2vpn-vpls             |         |
+-------------------------+---------------+--------------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family link-state
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family link-state
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-flowspec
    dnRouter(cfg-group-neighbor-afi)# exit
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-flowspec
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group FLOWSPEC_V4
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-flowspec
    dnRouter(cfg-group-neighbor-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-flowspec
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-rt-constrains
    dnRouter(cfg-bgp-neighbor-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp-group)# no address-family ipv6-unicast

::

    dnRouter(cfg-protocols-bgp-neighbor)# no address-family ipv4-unicast

::

    dnRouter(cfg-bgp-group-neighbor)# no address-family ipv4-flowspec

**Command History**

+---------+-------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                      |
+=========+===================================================================================================================+
| 6.0     | Command introduced                                                                                                |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 10.0    | Added support for link-state AFI                                                                                  |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 13.0    | Added support for FlowSpec SAFI                                                                                   |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for IPv4 Route Target Constrain SAFI                                                                |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for IPv4 Multicast SAFI. The command is now supported also under the network-services/vrf hierarchy |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for l2vpn-evpn in the range                                                                         |
+---------+-------------------------------------------------------------------------------------------------------------------+
| TBD     | Added ipv4/6-labeled-unicast as separate safi                                                                     |
+---------+-------------------------------------------------------------------------------------------------------------------+
| TBD     | Added support for l2vpn-vpls in the range                                                                         |
+---------+-------------------------------------------------------------------------------------------------------------------+

---

### neighbor-group/neighbor/address-family/allow-as-in.rst

protocols bgp neighbor-group neighbor address-family allow-as-in
----------------------------------------------------------------

**Minimum user role:** operator

The following command instructs the BGP router whether or not to disable the AS PATH check function for routes learned from the specific neighbor, so as not to reject routes that contain the recipient's AS number.

**Command syntax: allow-as-in [admin-state]** duplicate [as-duplicate-number]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is applicable to eBGP and iBGP neighbors.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter           | Description                                                                      | Range        | Default  |
+=====================+==================================================================================+==============+==========+
| admin-state         | enable this configuration                                                        | | enabled    | disabled |
|                     |                                                                                  | | disabled   |          |
+---------------------+----------------------------------------------------------------------------------+--------------+----------+
| as-duplicate-number | Specifies the number of times that the AS path of a received route may contain   | 1-10         | 1        |
|                     | the recipient BGP speaker's AS number and still be accepted                      |              |          |
+---------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# allow-as-in enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-vpn
    dnRouter(cfg-protocols-bgp-neighbor)# allow-as-in enabled duplicate 3

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in enabled duplicate 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in disabled duplicate 10
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# allow-as-in enabled duplicate 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in enabled duplicate 10
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# allow-as-in disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.3
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-flowspec
    dnRouter(cfg-bgp-neighbor-afi)# allow-as-in enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no allow-as-in duplicate

::

    dnRouter(cfg-bgp-group-afi)# no allow-as-in

::

    dnRouter(cfg-group-neighbor-afi)# no allow-as-in

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/as-loop-check.rst

protocols bgp neighbor-group neighbor address-family as-loop-check
------------------------------------------------------------------

**Minimum user role:** operator

When BGP updates travel through different Autonomous Systems (AS), each eBGP router prepends its AS number to the AS PATH attribute of the BGP update message. If a router receives an update that includes its own AS number in the AS PATH attribute, it will discard it by default to prevent loops. However, In some cases, you may want to allow such updates.

**Command syntax: as-loop-check [as-loop-check]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- allow-as-in must be enabled on the receiving end of the BGP update, otherwise it will drop any update that contains its own AS number. See "bgp neighbor address-family allow-as-in".

- This command applies only to eBGP neighbors.

- If both as-loop-check and as-override are enabled for the same neighbor, as-loop-check will be ignored as the neighbor AS is expected to be replaced.

**Parameter table**

+---------------+---------------------------------------------------------------------------+--------------+---------+
| Parameter     | Description                                                               | Range        | Default |
+===============+===========================================================================+==============+=========+
| as-loop-check | do not advertise route if neighbor as number is part of the route as-path | | enabled    | \-      |
|               |                                                                           | | disabled   |         |
+---------------+---------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# as-loop-check disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# as-loop-check disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# as-loop-check disabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# as-loop-check enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no as-loop-check

::

    dnRouter(cfg-bgp-neighbor-afi)# no as-loop-check

::

    dnRouter(cfg-group-neighbor-afi)# no as-loop-check

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.0    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/capability_orf.rst

protocols bgp neighbor-group neighbor address-family capability orf
-------------------------------------------------------------------

**Minimum user role:** operator

This command instructs the BGP router whether or not to establish a peering session with a neighbor that does not support capability negotiation, neighbors that are members of a peer group, or with a neighbor in a peer group. To configure this option:

**Command syntax: capability orf [capability-orf]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command cannot be enabled with the strict-capability-match configuration. See "bgp neighbor strict-capability-match"

**Parameter table**

+----------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter      | Description                                                                      | Range            | Default |
+================+==================================================================================+==================+=========+
| capability-orf | Advertises outbound route filter (ORF) capabilities to peer routers enabled -    | | enabled        | \-      |
|                | enables the ORF prefix list capability in both receive and send mode             | | disabled       |         |
|                | receive-only - enables the ORF prefix list capability in receive mode only       | | send-only      |         |
|                | send-only - enables the ORF prefix list capability in send mode only disabled -  | | receive-only   |         |
|                | disables ORF capability                                                          |                  |         |
+----------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# override-capability enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# override-capability disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match disabled
    dnRouter(cfg-bgp-group-neighbor)# override-capability enabled


**Removing Configuration**

To remove this configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no override-capability 

::

    dnRouter(cfg-protocols-bgp-group)# no override-capability

::

    dnRouter(cfg-bgp-group-neighbor)# no override-capability

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/address-family/dampening.rst

protocols bgp neighbor-group neighbor address-family dampening
--------------------------------------------------------------

**Minimum user role:** operator

To instruct the router whether or not to enable route flap dampening suppression from neighbor, peer group or a neighbor in a peer group:

**Command syntax: dampening [dampening]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is only relevant if global address-family dampening is enabled. See "bgp address-family dampening"

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| dampening | route flap dampening supersession from neighbor, thus disables the global        | | enabled    | \-      |
|           | dampening configuration for neighbor or group                                    | | disabled   |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# dampening disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# dampening enabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# dampening disabled


**Removing Configuration**

To revert dampening to its default state:
::

    dnRouter(cfg-bgp-group-afi)# no dampening

::

    dnRouter(cfg-bgp-neighbor-afi)# no dampening

::

    dnRouter(cfg-group-neighbor-afi)# no dampening

**Command History**

+---------+---------------------------------------------------------------------------------+
| Release | Modification                                                                    |
+=========+=================================================================================+
| 6.0     | Command introduced                                                              |
+---------+---------------------------------------------------------------------------------+
| 11.4    | Changed the default admin-state from the global AFI configuration to "Enabled". |
+---------+---------------------------------------------------------------------------------+

---

### neighbor-group/neighbor/address-family/extended-next-hop.rst

protocols bgp neighbor-group neighbor address-family extended-next-hop
----------------------------------------------------------------------

**Minimum user role:** operator

Extended next-hop capability allows usage of an IPv6 address next-hop for IPv4 NLRIs per RFC8950.
If the capability is supported on both ends, the DNOS router will advertise, by default, the IPv6 BGP session source address as the next-hop value for IPv4 routes.
To enable extended next-hop capability:"

**Command syntax: extended-next-hop [extended-next-hop]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Configuration valid only for ipv4 address families

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- Reconfiguration will cause session restart (capability change)

**Parameter table**

+-------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter         | Description                                                                      | Range        | Default |
+===================+==================================================================================+==============+=========+
| extended-next-hop | Support for extended next-hop capability. Allowing usage of ipv6 address nexthop | | enabled    | \-      |
|                   | for ipv4 NLRIs. RFC 8950                                                         | | disabled   |         |
+-------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# extended-next-hop enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# extended-next-hop enabled
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66


**Removing Configuration**

To revert extended-next-hop to default behavior:
::

    dnRouter(cfg-group-neighbor-afi)# no extended-next-hop

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/address-family/maximum-prefix/exceed-action.rst

protocols bgp neighbor-group neighbor address-family maximum-prefix exceed-action
---------------------------------------------------------------------------------

**Minimum user role:** operator


To instruct BGP what action to take when the maximum allowed number of prefixes has been exceeded.

 - warning only - (Default behavior) maximum-prefix-number exceeded - restart the neighbor session. The session will restart after the restart-interval.
 - restart - maximum-prefix-number exceeded - restart the neighbor session. The session will restart after the restart-interval.

**Command syntax: exceed-action [action]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family maximum-prefix
- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- When the prefix number drops below the maximum prefix- number threshold, a clear message is sent.

**Parameter table**

+-----------+--------------------------------------------------------+------------------+--------------+
| Parameter | Description                                            | Range            | Default      |
+===========+========================================================+==================+==============+
| action    | action to be taken when maximum-prefix-number exceeded | | warning-only   | warning-only |
|           |                                                        | | restart        |              |
+-----------+--------------------------------------------------------+------------------+--------------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# exceed-action warning-only


**Removing Configuration**

To revert to the default action (warning-only):
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no exceed-action

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/maximum-prefix/limit.rst

protocols bgp neighbor-group neighbor address-family maximum-prefix limit
-------------------------------------------------------------------------

**Minimum user role:** operator

"Specifies the maximum number of IP network prefixes (routes) that can be learned from a specified neighbor or neighbor group."

**Command syntax: limit [maximum-prefix-number]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family maximum-prefix
- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

**Parameter table**

+-----------------------+----------------------+--------------+---------+
| Parameter             | Description          | Range        | Default |
+=======================+======================+==============+=========+
| maximum-prefix-number | 0 used for unlimited | 0-4294967295 | 0       |
+-----------------------+----------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# limit 1000000000


**Removing Configuration**

To revert to default:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no limit

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/maximum-prefix/maximum-prefix.rst

protocols bgp neighbor-group neighbor address-family maximum-prefix
-------------------------------------------------------------------

**Minimum user role:** operator

By setting the maximum-prefix attribute, you control the number of prefixes that can be received from a neighbor. This is useful when a router starts receiving more routes than its memory can take.

To limit the number of routes that can be learned from the neighbor, peer group, or neighbor in a peer group:

**Command syntax: maximum-prefix**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)#


**Removing Configuration**

To revert to the default maximum-prefixes:
::

    dnRouter(cfg-bgp-neighbor-afi)# no maximum-prefix

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/maximum-prefix/restart-interval.rst

protocols bgp neighbor-group neighbor address-family maximum-prefix restart-interval
------------------------------------------------------------------------------------

**Minimum user role:** operator

Defines the restart interval when an exceed-action value is set to 'restart'.

**Command syntax: restart-interval [restart-interval]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family maximum-prefix
- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+------------------+-------------+---------+---------+
| Parameter        | Description | Range   | Default |
+==================+=============+=========+=========+
| restart-interval | minutes     | 1-65535 | \-      |
+------------------+-------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# restart-interval 100


**Removing Configuration**

To remove the restart interval:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no restart-interval

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/maximum-prefix/threshold.rst

protocols bgp neighbor-group neighbor address-family maximum-prefix threshold
-----------------------------------------------------------------------------

**Minimum user role:** operator

Specifies the percentage of the value specified by *maximum-prefix-number* that causes a log message to be generated.

**Command syntax: threshold [syslog-threshold]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family maximum-prefix
- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+------------------+-------------+-------+---------+
| Parameter        | Description | Range | Default |
+==================+=============+=======+=========+
| syslog-threshold | percentage  | 1-100 | 100     |
+------------------+-------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# threshold 75


**Removing Configuration**

To revert to the default maximum-prefixes:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no threshold

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor-group/neighbor/address-family/nexthop_ipv4.rst

protocols bgp neighbor-group neighbor address-family nexthop
------------------------------------------------------------

**Minimum user role:** operator

This command sets the next-hop of the advertised route to be the BGP router's address.

To set the advertised route's next-hop value to be the BGP router's address:

**Command syntax: nexthop [ipv4-address]** force [force]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Changing the configuration will cause the BGP session to restart.

- For flowspec SAFI, imposing a nexthop change might affect the flowspec action rules. By default, the "nexthop" attribute doesn't change for flowspec NLRI in either eBGP or iBGP sessions.

- For eBGP sessions and any BGP MPLS session, the nexthop value is set to "nexthop self" by default.

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- The address type must match the address family.

**Parameter table**

+--------------+-----------------------------------------------------------+--------------+---------+
| Parameter    | Description                                               | Range        | Default |
+==============+===========================================================+==============+=========+
| ipv4-address | set specific ip address to be used as the nexthop address | A.B.C.D      | \-      |
+--------------+-----------------------------------------------------------+--------------+---------+
| force        | apply nexthop setting even when acting as route reflector | | enabled    | \-      |
|              |                                                           | | disabled   |         |
+--------------+-----------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1.1.1.1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv6-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1:1::1:1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 0:ffff::120

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 1.2.3.4
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 95.70.1.13


**Removing Configuration**

To remove the nexthop settings:
::

    dnRouter(cfg-group-neighbor-afi)# no nexthop

To revert force to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no nexthop self force

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                          |
+=========+=======================================================================================================================+
| 6.0     | Command introduced                                                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 11.0    | Added option to enter a specific IP address as nexthop Added option to configure nexthop for neighbors within a group |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                                                                                      |
+---------+-----------------------------------------------------------------------------------------------------------------------+

---

### neighbor-group/neighbor/address-family/nexthop_ipv6.rst

protocols bgp neighbor-group neighbor address-family nexthop
------------------------------------------------------------

**Minimum user role:** operator

This command sets the next-hop of the advertised route to be the BGP router's address.

To set the advertised route's next-hop value to be the BGP router's address:

**Command syntax: nexthop [ipv6-address]** force [force]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Changing the configuration will cause the BGP session to restart.

- For flowspec SAFI, imposing a nexthop change might affect the flowspec action rules. By default, the "nexthop" attribute doesn't change for flowspec NLRI in either eBGP or iBGP sessions.

- For eBGP sessions and any BGP MPLS session, the nexthop value is set to "nexthop self" by default.

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- The address type must match the address family.

**Parameter table**

+--------------+-----------------------------------------------------------+--------------+---------+
| Parameter    | Description                                               | Range        | Default |
+==============+===========================================================+==============+=========+
| ipv6-address | set specific ip address to be used as the nexthop address | X:X::X:X     | \-      |
+--------------+-----------------------------------------------------------+--------------+---------+
| force        | apply nexthop setting even when acting as route reflector | | enabled    | \-      |
|              |                                                           | | disabled   |         |
+--------------+-----------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1.1.1.1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv6-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1:1::1:1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 0:ffff::120

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 1.2.3.4
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 95.70.1.13


**Removing Configuration**

To remove the nexthop settings:
::

    dnRouter(cfg-group-neighbor-afi)# no nexthop

To revert force to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no nexthop self force

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                          |
+=========+=======================================================================================================================+
| 6.0     | Command introduced                                                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 11.0    | Added option to enter a specific IP address as nexthop Added option to configure nexthop for neighbors within a group |
+---------+-----------------------------------------------------------------------------------------------------------------------+

---

### neighbor-group/neighbor/address-family/orf-prefix-list-ipv4.rst

protocols bgp neighbor-group neighbor address-family orf-prefix-list-ipv4
-------------------------------------------------------------------------

**Minimum user role:** operator

The Prefix-list is sent when the ORF send capability is enabled. To configure the prefix list to be sent to the peer to be used as an outbound-route-filter:

**Command syntax: orf-prefix-list-ipv4 [ipv4-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- The prefix-list type (IPv4 / IPv6) must match the address-family type.

- The prefix-list must use a configured prefix-list from the routing-policy. It can be within the same commit.

- This command is only valid for unicast sub-address families.

- Neighbors within a neighbor-group can use the neighbor-group configuration or a configuration from the group.

**Parameter table**

+------------------+---------------------------------------------------+------------------+---------+
| Parameter        | Description                                       | Range            | Default |
+==================+===================================================+==================+=========+
| ipv4-prefix-list | IPv4 ORF prefix list sent to ORF capable neighbor | | string         | \-      |
|                  |                                                   | | length 1-255   |         |
+------------------+---------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6
    dnRouter(cfg-protocols-bgp-group)# neighbor 2:2::2:2
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6


**Removing Configuration**

To remove the prefix-list:
::

    dnRouter(cfg-bgp-neighbor-afi)# no orf-prefix-list

::

    dnRouter(cfg-bgp-group-afi)# no orf-prefix-list

::

    dnRouter(cfg-group-neighbor-afi)# no orf-prefix-list

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/address-family/orf-prefix-list-ipv6.rst

protocols bgp neighbor-group neighbor address-family orf-prefix-list-ipv6
-------------------------------------------------------------------------

**Minimum user role:** operator

The Prefix-list is sent when the ORF send capability is enabled. To configure the prefix list to be sent to the peer to be used as an outbound-route-filter:

**Command syntax: orf-prefix-list-ipv6 [ipv6-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- The prefix-list type (IPv4 / IPv6) must match the address-family type.

- The prefix-list must use a configured prefix-list from the routing-policy. It can be within the same commit.

- This command is only valid for unicast sub-address families.

- Neighbors within a neighbor-group can use the neighbor-group configuration or a configuration from the group.

**Parameter table**

+------------------+---------------------------------------------------+------------------+---------+
| Parameter        | Description                                       | Range            | Default |
+==================+===================================================+==================+=========+
| ipv6-prefix-list | IPv4 ORF prefix list sent to ORF capable neighbor | | string         | \-      |
|                  |                                                   | | length 1-255   |         |
+------------------+---------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6
    dnRouter(cfg-protocols-bgp-group)# neighbor 2:2::2:2
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6


**Removing Configuration**

To remove the prefix-list:
::

    dnRouter(cfg-bgp-neighbor-afi)# no orf-prefix-list

::

    dnRouter(cfg-bgp-group-afi)# no orf-prefix-list

::

    dnRouter(cfg-group-neighbor-afi)# no orf-prefix-list

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/address-family/policy-in.rst

protocols bgp neighbor-group neighbor address-family policy in
--------------------------------------------------------------

**Minimum user role:** operator

To apply a route map to a neighbor or peer group:

**Command syntax: policy [policy-in]** [, policy-in, policy-in] **in**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- If a policy is configured for a group, you cannot disable it for a neighbor within the group. You must explicitly set a different policy to achieve a different behavior from the group. You may even attach an empty policy.

- Can set multiple policies. In case multiple policies are set, policies are evaluated one after the other according to the user input order

- When setting a new policy, the policy will be appended to the existing attached policies

- To remove a policy, the user must specify the name of the policy to be remvoed

- To remove all policies, the user must specify all attached policy names

- To replace an attached policy, the user will need to first remove and than add a new policy. Can be performed in the same commit. the policy order imposes the functional behavior.

**Parameter table**

+-----------+---------------------------------------+------------------+---------+
| Parameter | Description                           | Range            | Default |
+===========+=======================================+==================+=========+
| policy-in | applies the filter in incoming routes | | string         | \-      |
|           |                                       | | length 1-255   |         |
+-----------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy in
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# policy MyPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# policy GroupPolicy in
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# policy NeighborPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy_1,MyPolicy_2 in


**Removing Configuration**

To disable the route map policy:
::

    dnRouter(cfg-bgp-group-afi)# no policy MyPolicy in

::

    dnRouter(cfg-bgp-neighbor-afi)# no policy MyPolicy in

::

    dnRouter(cfg-group-neighbor-afi)# no policy NeighborPolicy in

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 11.0    | Added option to configure policy for a neighbor within a group |
+---------+----------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                               |
+---------+----------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                |
+---------+----------------------------------------------------------------+

---

### neighbor-group/neighbor/address-family/policy-out.rst

protocols bgp neighbor-group neighbor address-family policy out
---------------------------------------------------------------

**Minimum user role:** operator

To apply a route map to a neighbor or peer group:

**Command syntax: policy [policy-out]** [, policy-out, policy-out] **out**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- If a policy is configured for a group, you cannot disable it for a neighbor within the group. You must explicitly set a different policy to achieve a different behavior from the group. You may even attach an empty policy.

- Can set multiple policies. In case multiple policies are set, policies are evaluated one after the other according to the user input order

- When setting a new policy, the policy will be appended to the existing attached policies

- To remove a policy, the user must specify the name of the policy to be remvoed

- To remove all policies, the user must specify all attached policy names

- To replace an attached policy, the user will need to first remove and than add a new policy. Can be performed in the same commit. the policy order imposes the functional behavior.

**Parameter table**

+------------+---------------------------------------+------------------+---------+
| Parameter  | Description                           | Range            | Default |
+============+=======================================+==================+=========+
| policy-out | applies the filter in outgoing routes | | string         | \-      |
|            |                                       | | length 1-255   |         |
+------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# policy MyPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# policy GroupPolicy out
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# policy NeighborPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy_1,MyPolicy_2 out


**Removing Configuration**

To disable the route map policy:
::

    dnRouter(cfg-bgp-group-afi)# no policy MyPolicy out

::

    dnRouter(cfg-bgp-neighbor-afi)# no policy MyPolicy out

::

    dnRouter(cfg-group-neighbor-afi)# no policy NeighborPolicy out

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 11.0    | Added option to configure policy for a neighbor within a group |
+---------+----------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                               |
+---------+----------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                |
+---------+----------------------------------------------------------------+

---

### neighbor-group/neighbor/admin-state.rst

protocols bgp neighbor-group neighbor admin-state
-------------------------------------------------

**Minimum user role:** operator

Use this command to administratively start or shut down the session with the BGP neighbor, BGP neighbors in a group or a specific BGP neighbor within a group (this will override the group setting for this neighbor):

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | Causes a device to shut down the session administratively with its BGP neighbor. | | enabled    | \-      |
|             |                                                                                  | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# admin-state disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# admin-state disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# admin-state disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/authentication.rst

protocols bgp neighbor-group neighbor authentication md5 password
-----------------------------------------------------------------

**Minimum user role:** operator

To set a password for authenticating the neighbor, peer group neighbors, or the neighbor in a peer group:

**Command syntax: authentication md5 password [secret]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- Changing the configuration will cause the BGP session to restart.

- If you do not specify a password, enter the password of the neighbor BGP router in clear text. The password is then encrypted and from then on will be displayed as encrypted. You can copy the encrypted password and use it as the enc-password. When typing a clear password, the password is not displayed in the CLI terminal.

- The clear text password provided in the CLI is hashed with the md5 hash. As the md5 hash is not strong enough and can be broken, the FERNET algorithm is applied to the md5 hash before it is stored in the DNOS database.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| secret    | set a password for authentication encrypted secret password string for the       | \-    | \-      |
|           | neighbor bgp. if the user enters a clear-text password, the password is then     |       |         |
|           | encrypted by the system and saved in secret argument. if the user specified      |       |         |
|           | 'secret' (already encrypted string) save the string in secret                    |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# authentication md5 password
    Enter password
    Enter password for verifications

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.2.2
    dnRouter(cfg-protocols-bgp-neighbor)# authentication md5 password enc-!U2FsdGVkX1+

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# authentication md5 password
    Enter password
    Enter password for verification

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# authentication md5 password
    Enter password
    Enter password for verification
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# authentication md5 password enc-!U2FsdGVkX1+qG


**Removing Configuration**

To remove the password configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no authentication md5

::

    dnRouter(cfg-protocols-bgp-group)# no authentication md5

::

    dnRouter(cfg-bgp-group-neighbor)# no authentication md5

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bfd/admin-state.rst

protocols bgp neighbor-group neighbor bfd admin-state
-----------------------------------------------------

**Minimum user role:** operator

Enable BFD session for BGP session protection and enter BFD configuration level to configure BFD session settings.

To change the BFD administrative state for a specific BGP neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- In the event that there are multiple BFD clients registered to the same BFD session, a single BFD session is established with the strictest session parameters between all clients.

**Parameter table**

+-------------+--------------------------------------+--------------+---------+
| Parameter   | Description                          | Range        | Default |
+=============+======================================+==============+=========+
| admin-state | set whether bfd protection is in use | | enabled    | \-      |
|             |                                      | | disabled   |         |
+-------------+--------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# admin-state enabled
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no admin-state

::

    dnRouter(cfg-bgp-group-bfd)# no admin-state

::

    dnRouter(cfg-bgp-neighbor-bfd)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bfd/bfd-type.rst

protocols bgp neighbor-group neighbor bfd bfd-type
--------------------------------------------------

**Minimum user role:** operator

Define the requested BFD session type, Single-hop or Multi-hop. By default session type is according to BGP peering type.

To set requested session type:

**Command syntax: bfd-type [session-type]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- For multi-hop session type , update-source must be configured for neighbor

- For single-hop session type , bgp peering must be directly over a connected interface

- Reconfig of bfd-type will result in a new BFD session

**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------------+---------+
| Parameter    | Description                                                                      | Range          | Default |
+==============+==================================================================================+================+=========+
| session-type | Define the requested BFD session type, Single-hop or Multi-hop. By default       | | automatic    | \-      |
|              | session type is according to BGP peering type                                    | | single-hop   |         |
|              |                                                                                  | | multi-hop    |         |
+--------------+----------------------------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# bfd-type single-hop

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# bfd-type enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# bfd-type multi-hop
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# bfd-type automatic


**Removing Configuration**

To revert the bfd-type to its default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no bfd-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bfd/bfd.rst

protocols bgp neighbor-group neighbor bfd
-----------------------------------------

**Minimum user role:** operator

The command allows enabling BFD for the protection of a session between a single BGP neighbor or neighbor group and allows you to configure the BFD session settings.
The BFD session type (single-hop or multi-hop) is decided according to the BGP session type. The BFD source address is the BGP source address and the BFD destination address is the BGP peer address.

When a BFD session is down, the BGP session will close and all routes from the neighbor will be withdrawn.

The BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations.

Detection-time = negotiated-received-interval X received multiplier.
This is the maximum amount of time that can elapse without receiving a BFD control packet before the session is declared down.

BFD neighbor can signal session state down and upon receipt, the local BFD session will immediately switch to DOWN state.

To enable or disable the BFD protocol with a single neighbor or a neighbor group:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)#


**Removing Configuration**

To revert the BFD protocol to the default state:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bfd 

::

    dnRouter(cfg-protocols-bgp-group)# no bfd

::

    dnRouter(cfg-bgp-group-neighbor)# no bfd

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 11.4    | Command reintroduced |
+---------+----------------------+

---

### neighbor-group/neighbor/bfd/min-rx.rst

protocols bgp neighbor-group neighbor bfd min-rx
------------------------------------------------

**Minimum user role:** operator

Set the desired minimum receive interval for the BFD session for a single neighbor or neighbor group:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | \-      |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# min-rx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-rx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-rx 400
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# min-rx 300


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no min-rx

::

    dnRouter(cfg-bgp-group-bfd)# no min-rx

::

    dnRouter(cfg-group-neighbor-bfd)# no min-rx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.4    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### neighbor-group/neighbor/bfd/min-tx.rst

protocols bgp neighbor-group neighbor bfd min-tx
------------------------------------------------

**Minimum user role:** operator

Set the desired minimum transmit interval for the BFD session for a single neighbor or neighbor group:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

- Due to hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | \-      |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# min-tx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-tx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-tx 400
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# min-tx 300


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no min-tx

::

    dnRouter(cfg-bgp-group-bfd)# no min-tx

::

    dnRouter(cfg-group-neighbor-bfd)# no min-tx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.4    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### neighbor-group/neighbor/bfd/multiplier.rst

protocols bgp neighbor-group neighbor bfd multiplier
----------------------------------------------------

**Minimum user role:** operator

Set the local BFD multiplier for a single neighbor or neighbor group:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bfd
- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | \-      |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# multiplier 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# multiplier 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# multiplier 2
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# multiplier 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no multiplier

::

    dnRouter(cfg-bgp-group-bfd)# no multiplier

::

    dnRouter(cfg-group-neighbor-bfd)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bmp/activate-server_disabled.rst

protocols bgp neighbor-group neighbor bmp activate-server disabled
------------------------------------------------------------------

**Minimum user role:** operator

Disable exporting bgp neighbor information to a bmp server, while group is set to export bgp information

**Command syntax: activate-server disabled**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bmp

**Note**

- Configuration valid for neighbor, neighbor-group and neighbor within a neighbor group

- For neighbor within a group, by default inherit group behavior, if activate server is configure, only support the specific configured servers for that neighbor (i.e do not union with group

- Only a configured bmp server can be set (require auto-complete from configured servers

- Cannot removed server config if there is a neighbor configured to i

- server-id will follow leaf-list behavior, i.e:

- can configured multiple server-ids for a given neighbo

- configuring a server-id will be added to already configured server-id (will not overwrite

- deleting server-id is either per specific id, or removing all servers

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# activate-server 0, 2, 3
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp activate-server disabled


**Removing Configuration**

To remove the specific bmp server:
::

    dnRouter(cfg-bgp-group-neighbor)# no bmp activate-server

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bmp/activate-server.rst

protocols bgp neighbor-group neighbor bmp activate-server
---------------------------------------------------------

**Minimum user role:** operator

Enable exporting bgp neighbor information to a bmp server 

 server-id - set to which bmp server table infromation will be exported 

 Can set up to 5 different bmps servers for a given neighbor

 Configuration applies for all bgp neighbor address-families

**Command syntax: activate-server [server-id]** [, server-id, server-id]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bmp
- protocols bgp neighbor bmp
- protocols bgp neighbor-group bmp

**Note**

- Configuration valid for neighbor, neighbor-group and neighbor within a neighbor group

- For neighbor within a group, by default inherit group behavior, if activate server is configure, only support the specific configured servers for that neighbor (i.e do not union with group

- Only a configured bmp server can be set (require auto-complete from configured servers

- Cannot removed server config if there is a neighbor configured to i

- server-id will follow leaf-list behavior, i.e:

- can configured multiple server-ids for a given neighbo

- configuring a server-id will be added to already configured server-id (will not overwrite

- deleting server-id is either per specific id, or removing all servers

**Parameter table**

+-----------+-----------------------------------------------------------+-------+---------+
| Parameter | Description                                               | Range | Default |
+===========+===========================================================+=======+=========+
| server-id | Enable exporting bgp neighbor information to a bmp server | 1-5   | \-      |
+-----------+-----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-protocols-bgp-neighbor-bmp)# activate-server 0


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.2.2
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-protocols-bgp-neighbor-bmp)# activate-server 1, 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 4
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 2


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 1
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# bmp
    dnRouter(cfg-group-neighbor-bmp)# activate-server 1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# activate-server 1, 2, 3
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp activate-server disabled


**Removing Configuration**

To remove the specific bmp server:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bmp activate-server

::

    dnRouter(cfg-protocols-bgp-group)# no bmp activate-server

::

    dnRouter(cfg-bgp-group-neighbor)# no bmp activate-server

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bmp/bmp.rst

protocols bgp neighbor-group neighbor bmp
-----------------------------------------

**Minimum user role:** operator

The BGP Monitoring Protocol (BMP) allows you to send the BGP route information from the router to a monitoring application on a separate device. The monitoring application is referred to as the BMP monitoring station or BMP station. To deploy BMP in the network, you need to configure BMP on each router, from which you want to gather information, and at least one BMP station.

BGP BMP collects statistics data from the Adjacency-RIB-In routing tables and send that data periodically to a monitoring station, for further analysis.

Some of the use-cases for BMP include:

- Looking Glasses - IPv4, IPv6, and VPN prefixes.
- Route Analytics - Track convergence times, prefix history as they change over time, monitor and track BGP policy changes, etc...
- Traffic Engineering Analytics - Adapt dynamically to change, and know what is the best shift.
- BGP pre-policy - Pre-policy routing information provides insight into all path attributes from various points in the network, allowing non-intrusive what-if topology views for new policy validations.

**Command syntax: bmp**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-bgp-neighbor-bmp)#


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)#


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-bgp-group-bmp-rm)#
    dnRouter(cfg-bgp-group-bmp-rm)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp
    dnRouter(cfg-group-neighbor-bmp)#


**Removing Configuration**

To return all bmp settings to the default:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bmp

::

    dnRouter(cfg-protocols-bgp-group)# no bmp

::

    dnRouter(cfg-bgp-group-neighbor)# no bmp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bmp/route-monitoring/adj-in_post-policy.rst

protocols bgp neighbor-group neighbor bmp route-monitoring adj-in post-policy
-----------------------------------------------------------------------------

**Minimum user role:** operator

Enable exporting BGP neighbor adjacency-in post-policy tables. The configuration applies to all BGP neighbor address-families.

**Command syntax: adj-in post-policy [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bmp route-monitoring
- protocols bgp neighbor bmp route-monitoring
- protocols bgp neighbor-group bmp route-monitoring

**Parameter table**

+-------------+--------------------------------+--------------+---------+
| Parameter   | Description                    | Range        | Default |
+=============+================================+==============+=========+
| admin-state | adjecenty in post policy table | | enabled    | \-      |
|             |                                | | disabled   |         |
+-------------+--------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in post-policy disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in post-policy enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in post-policy disabled
    dnRouter(cfg-group-bmp-rm)# exit
    dnRouter(cfg-bgp-group-bmp)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in post-policy enabled


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in post-policy

::

    dnRouter(cfg-group-bmp-rm)# no adj-in post-policy

::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in post-policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bmp/route-monitoring/adj-in_pre-policy.rst

protocols bgp neighbor-group neighbor bmp route-monitoring adj-in pre-policy
----------------------------------------------------------------------------

**Minimum user role:** operator

Enable exporting BGP neighbor adjacency-in pre-policy tables. The configuration applies to all BGP neighbor address-families.

**Command syntax: adj-in pre-policy [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bmp route-monitoring
- protocols bgp neighbor bmp route-monitoring
- protocols bgp neighbor-group bmp route-monitoring

**Note**

- Pre-policy information is exported only when a neighbor is enabled with "soft-reconfiguration inbound", which ensures that the neighbor pre-policy information is kept in BGP.

**Parameter table**

+-------------+-------------------------------+--------------+---------+
| Parameter   | Description                   | Range        | Default |
+=============+===============================+==============+=========+
| admin-state | adjecenty in pre policy table | | enabled    | \-      |
|             |                               | | disabled   |         |
+-------------+-------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in pre-policy disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in pre-policy enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in pre-policy disabled
    dnRouter(cfg-group-bmp-rm)# exit
    dnRouter(cfg-group-bmp)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in pre-policy enabled


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in pre-policy

::

    dnRouter(cfg-group-bmp-rm)# no adj-in pre-policy

::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in pre-policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/bmp/route-monitoring/route-monitoring.rst

protocols bgp neighbor-group neighbor bmp route-monitoring
----------------------------------------------------------

**Minimum user role:** operator

To enter the BMP server route-monitoring configuration level:

**Command syntax: route-monitoring**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor bmp
- protocols bgp neighbor bmp
- protocols bgp neighbor-group bmp

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-bgp-neighbor-bmp)# route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# route-monitoring
    dnRouter(cfg-group-bmp-rm)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# route-monitoring
    dnRouter(cfg-group-bmp-rm)#
    dnRouter(cfg-bgp-group-bmp-rm)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)#


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-bgp-neighbor-bmp)# no route-monitoring

::

    dnRouter(cfg-bgp-group-bmp)# no route-monitoring

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/cluster-id.rst

protocols bgp neighbor-group neighbor cluster-id
------------------------------------------------

**Minimum user role:** operator

You can use this command to specify a global cluster-id attribute when used as a route-reflector, or per neighbor-group or neighbor if specified explicitly.

Prior to reflecting a route, route reflectors append their cluster-id to the cluster list.

If two routers share the same BGP cluster ID, they belong to the same cluster.

**Command syntax: cluster-id [cluster-id]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp
- protocols bgp neighbor
- protocols bgp neighbor-group

**Parameter table**

+------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter  | Description                                                                      | Range            | Default |
+============+==================================================================================+==================+=========+
| cluster-id | route-reflector cluster id to use when local router is configured as a route     | | 1-4294967295   | \-      |
|            | reflector.                                                                       | | A.B.C.D        |         |
+------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# cluster-id 65.65.65.65

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65001
    dnRouter(cfg-protocols-bgp)# cluster-id 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65001
    dnRouter(cfg-protocols-bgp)# neighbor 1.1.1.1
    dnRouter(cfg-protocols-bgp-neighbor)# cluster-id 101

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# cluster-id 10.0.0.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# cluster-id 27081


**Removing Configuration**

To revert all BGP cluster-id to the default value:
::

    dnRouter(cfg-protocols-bgp)# no cluster-id

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 15.1    | Command introduced                                           |
+---------+--------------------------------------------------------------+
| 17.1    | Extended support for neighbor and neighbor-group hierarchies |
+---------+--------------------------------------------------------------+

---

### neighbor-group/neighbor/connected-check.rst

protocols bgp neighbor-group neighbor connected-check
-----------------------------------------------------

**Minimum user role:** operator

Typically in eBGP peering, a check is done to confirm that the neighbor is listed in the routing table as being directly connected. eBGP peering will not be attempted with a neighbor that is not directly connected. When the loopback interface is used for peering, then the IP address of the neighbor will not be listed as being directly connected and so peering will not be possible.

The following command instructs the BGP router whether or not to disable the connection verification check for eBGP peering sessions that are directly connected but are configured on a loopback interface or with a non-directly connected IP address.

**Command syntax: connected-check [connected-check]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The option to disable the check is required only when the neighbor ebgp-multihop command is configured with a TTL value of 1. See "bgp neighbor ebgp-multihop".

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| connected-check | disable the connection verification process for eBGP peering sessions that are   | | enabled    | \-      |
|                 | reachable by a single hop but are configured on a loopback interface or          | | disabled   |         |
|                 | otherwise configured with a non-directly connected IP address                    |              |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# connected-check disabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# connected-check disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# connected-check disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# connected-check enabled


**Removing Configuration**

To remove the configuration:
::

    dnRouter(cfg-protocols-bgp-group)# no connected-check

::

    dnRouter(cfg-protocols-bgp-neighbor)# no connected-check

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/description.rst

protocols bgp neighbor-group neighbor description
-------------------------------------------------

**Minimum user role:** operator

To set a description for the BGP neighbor, BGP peer group, or BGP neighbor within a peer group:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-------------+--------------------------+------------------+---------+
| Parameter   | Description              | Range            | Default |
+=============+==========================+==================+=========+
| description | a neighbors' description | | string         | \-      |
|             |                          | | length 1-255   |         |
+-------------+--------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# description my-unique-description


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no description

::

    dnRouter(cfg-protocols-bgp-group)# no description

::

    dnRouter(cfg-bgp-group-neighbor)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/ebgp-multihop.rst

protocols bgp neighbor-group neighbor ebgp-multihop
---------------------------------------------------

**Minimum user role:** operator

To configure a maximum number of hops to an eBGP neighbor, to an eBGP peer group, or to a neighbor within a peer group:

**Command syntax: ebgp-multihop [ebgp-multihop]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- If you set a value greater than 1, the neighbor will always be considered as an indirectly connected neighbor, regardless of the actual reachability.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter     | Description                                                                      | Range | Default |
+===============+==================================================================================+=======+=========+
| ebgp-multihop | set eBGP neighbors that are not on directly connected networks and sets an       | 1-255 | \-      |
|               | optional maximum hop count                                                       |       |         |
+---------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# ebgp-multihop

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# ebgp-multihop 20

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# ebgp-multihop 20

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# ebgp-multihop 16


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ebgp-multihop

::

    dnRouter(cfg-protocols-bgp-group)# no ebgp-multihop

::

    dnRouter(cfg-bgp-group-neighbor)# no ebgp-multihop

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/graceful-restart.rst

protocols bgp neighbor-group neighbor graceful-restart
------------------------------------------------------

**Minimum user role:** operator

To configure the BGP graceful restart capability for a specific neighbor, a peer group, or for a neighbor in a peer group:

**Command syntax: graceful-restart [graceful-restart-admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- When bgp graceful-restart is disabled, no graceful-restart is done regardless of the bgp neighbor graceful-restart state.

- Disabled: disables graceful-restart for the neighbor.

**Parameter table**

+------------------------------+------------------------------------------+-----------------+---------+
| Parameter                    | Description                              | Range           | Default |
+==============================+==========================================+=================+=========+
| graceful-restart-admin-state | global graceful-restart capability state | | enabled       | \-      |
|                              |                                          | | disabled      |         |
|                              |                                          | | helper-only   |         |
+------------------------------+------------------------------------------+-----------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001:3::65
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart helper-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001:3::65
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# graceful-restart enabled
    dnRouter(cfg-protocols-bgp-group)# graceful-restart helper-only
    dnRouter(cfg-protocols-bgp-group)# graceful-restart disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no graceful-restart

::

    dnRouter(cfg-protocols-bgp-group)# no graceful-restart

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/neighbor.rst

protocols bgp neighbor-group neighbor
-------------------------------------

**Minimum user role:** operator

When configuring a BGP neighbor, you must first define it using one of the following commands.

To define a BGP neighbor and enter its configuration mode:

When configuring neighbors within a peer group, the neighbors inherit the settings from the group.

**Command syntax: neighbor [neighbor-ip-address]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp
- network-services vrf instance protocols bgp
- network-services vrf instance protocols bgp neighbor-group

**Note**

- Notice the change in prompt.

- When configuring neighbors within a peer group, the neighbors inherit the settings from the group.

**Parameter table**

+---------------------+-------------------------------------------------+--------------+---------+
| Parameter           | Description                                     | Range        | Default |
+=====================+=================================================+==============+=========+
| neighbor-ip-address | Address of the BGP peer, either in IPv4 or IPv6 | | A.B.C.D    | \-      |
|                     |                                                 | | X:X::X:X   |         |
+---------------------+-------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)#


**Removing Configuration**

To remove a neighbor:
::

    dnRouter(cfg-protocols-bgp)# no neighbor 12.170.4.1

To remove a neighbor from the group:
::

    dnRouter(cfg-protocols-bgp-group)# no neighbor 2001::66

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/override-capability.rst

protocols bgp neighbor-group neighbor override-capability
---------------------------------------------------------

**Minimum user role:** operator

This command instructs the BGP router whether or not to establish a peering session with a neighbor that does not support capability negotiation, neighbors that are members of a peer group, or with a neighbor in a peer group. To configure this option:

**Command syntax: override-capability [override-capability]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command cannot be enabled with the strict-capability-match configuration. See "bgp neighbor strict-capability-match"

**Parameter table**

+---------------------+---------------------------------------------------+--------------+---------+
| Parameter           | Description                                       | Range        | Default |
+=====================+===================================================+==============+=========+
| override-capability | allow peer session without capability negotiation | | enabled    | \-      |
|                     |                                                   | | disabled   |         |
+---------------------+---------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# override-capability enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# override-capability disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match disabled
    dnRouter(cfg-bgp-group-neighbor)# override-capability enabled


**Removing Configuration**

To remove this configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no override-capability 

::

    dnRouter(cfg-protocols-bgp-group)# no override-capability

::

    dnRouter(cfg-bgp-group-neighbor)# no override-capability

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/passive.rst

protocols bgp neighbor-group neighbor passive
---------------------------------------------

**Minimum user role:** operator

In passive mode, the router will not initiate open messages to the peer. It will wait for the peer to issue an open request before a message is sent. To configure passive mode for a neighbor, peer group, or a neighbor in a peer group:

**Command syntax: passive [passive]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------+----------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                | Range        | Default |
+===========+============================================================================+==============+=========+
| passive   | Configure the router so that active open messages are not sent to the peer | | enabled    | \-      |
|           |                                                                            | | disabled   |         |
+-----------+----------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# passive enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# passive disabled


**Removing Configuration**

To remove passive mode:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no passive

::

    dnRouter(cfg-protocols-bgp-group)# no passive

::

    dnRouter(cfg-bgp-group-neighbor)# no passive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/remote-as.rst

protocols bgp neighbor-group neighbor remote-as
-----------------------------------------------

**Minimum user role:** operator

The neighbor (not under neighbor-group) must be configured with remote-as.
For neighbor-groups:
A group can be configured with or without remote-as. If the group is not configured with remote-as, it is mandatory for each of the neighbors under the group to have remote-as.
The group and the neighbor remote-as must be from the same type, meaning iBGP, eBGP or Confederation.

To configure the remote AS number for the neighbor or peer group:

**Command syntax: remote-as [remote-as]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The AS number of the neighbor. BGP uses the AS number for identifying the BGP connection as internal (iBGP) or external (eBGP).

**Parameter table**

+-----------+------------------------+--------------+---------+
| Parameter | Description            | Range        | Default |
+===========+========================+==============+=========+
| remote-as | AS number of the peer. | 1-4294967295 | \-      |
+-----------+------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.2.3.4
    dnRouter(cfg-bgp-group-neighbor)# remote-as 123


**Removing Configuration**

It is not possible to delete the remote-as of a neighbor or group. You need to remove the neighbor or the group. You can change the assigned remote-as.
::


**Command History**

+---------+--------------------------------------------------+
| Release | Modification                                     |
+=========+==================================================+
| 6.0     | Command introduced                               |
+---------+--------------------------------------------------+
| 18.0    | Added remote-as under neighbor of neighbor-group |
+---------+--------------------------------------------------+

---

### neighbor-group/neighbor/strict-capability-match.rst

protocols bgp neighbor-group neighbor strict-capability-match
-------------------------------------------------------------

**Minimum user role:** operator

This command directs the router to strictly match remote capabilities and local capabilities. If the capabilities are different, the router will issue an "Unsupported Capability" error and will reset the connection.

To set strict capability match:

**Command syntax: strict-capability-match [strict-capability-match]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command cannot be set together with the override-capability configuration. See "bgp neighbor override-capability"

**Parameter table**

+-------------------------+--------------------------------------------------------------+--------------+---------+
| Parameter               | Description                                                  | Range        | Default |
+=========================+==============================================================+==============+=========+
| strict-capability-match | Strictly compares remote capabilities and local capabilities | | enabled    | \-      |
|                         |                                                              | | disabled   |         |
+-------------------------+--------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# strict-capability-match enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# override-capability disabled
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match enabled


**Removing Configuration**

To remove the strict capability match configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no strict-capability-match

::

    dnRouter(cfg-bgp-group-neighbor)# no strict-capability-match

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/ttl-security.rst

protocols bgp neighbor-group neighbor ttl-security
--------------------------------------------------

**Minimum user role:** operator

Imposes ebgp ttl security per rfc5082.
When ttl-security is set for an EBGP neighbor, the following is expected for the given neighbor bgp IP/TCP session:
- Any egress packet is set with TTL 255.
- Any ingress packet is checked for TTL validity. Only packets with a TTL greater or equal to min-ttl are accepted, otherwise dropped.

The default system behavior is min-ttl = 255, imposing that eBGP neighbor must be directly connected (one hop apart).

The user may impose a different min-ttl value to support the eBGP neighbors that are not directly connected.
If min-ttl = 255 the ttl-security keeps assumption of the eBGP neighbor being directly connected, regardless of the min-ttl value, as such:
- The neighbor address is expected to be a connected route.
- The egress interface is imposed per the neighbor address.
- In case BFD is requested, a single-hop BFD session is requested (unless a specific BFD-type is set).
In case min-ttl < 255 MH-EBGP the session is assumed resulting:
- An update-source is required.
- The neighbor address is not bound to be a connected route.
- The egress interface is selected per the neighbor address routing solution.
- In case BFD is requested, a multi-hop BFD session is requested (unless specific BFD-type is set).

**Command syntax: ttl-security [admin-state]** min-ttl [min-ttl]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The expected behavior is that both the BGP session sides are configured with ttl-security.

- The configuration is valid only for eBGP neighbors. Commit validation is required (same as impose for eBGP-multihop).

- Configuration is only possible with eBGP-multihop = 1. Commit validation is required.

- Applies for both IPv4 neighbors and IPv6 neighbors. The hop-count is handled instead of TTL for IPv6.

- When applied on a group, this property is inherited by all the group members. Applying this property on a neighbor within a group overrides the group setting.

- Neighbors within a neighbor-group derive the neighbor-group configuration (i.e has no default config) or can have a unique setting from the group.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | Enable ttl security for a given eBGP neighbor                                    | | enabled    | \-      |
|             |                                                                                  | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+
| min-ttl     | Allow received ttl lower than 255, the allowed received ttl will be              | 1-255        | \-      |
|             | greater-equal to (255-range)                                                     |              |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# ttl-security enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP_GROUP
    dnRouter(cfg-protocols-bgp-group)# ttl-security enabled min-ttl 254

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP_GROUP
    dnRouter(cfg-protocols-bgp-group)# ttl-security enabled min-ttl 252
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-protocols-bgp-neighbor)# ttl-security enabled min-ttl 255


**Removing Configuration**

To revert configuration to default behavior the configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ttl-security

To revert min-ttl to default behavior
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ttl-security enabled min-ttl 255

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/update-source.rst

protocols bgp neighbor-group neighbor update-source
---------------------------------------------------

**Minimum user role:** operator

The update-source parameter is a mandatory configuration for every multihop BGP session. This includes both iBGP and MH-eBGP.

To specify the source address to use for the BGP session to a neighbor, peer group, or neighbor within the peer group:

**Command syntax: update-source [source-address]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- Changing the configuration will cause the BGP session to restart.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                                      | Range | Default |
+================+==================================================================================+=======+=========+
| source-address | specify the source address to use for the BGP session to this neighbor Can       | \-    | \-      |
|                | either be an ipv4|6-address or an interface name when using loopback interface   |       |         |
|                | name, bgp uses the lo ip address                                                 |       |         |
+----------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# update-source lo0

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# update-source 1.1.1.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source 2001:2::65

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source lo1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source ge100-1/2/1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source bundle-2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source bundle-1.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source 2001:2::65
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# update-source 1.1.1.1


**Removing Configuration**

To revert the source address to the default value (the BGP router-id):
::

    dnRouter(cfg-protocols-bgp-neighbor)# no update-source

::

    dnRouter(cfg-protocols-bgp-group)# no update-source

::

    dnRouter(cfg-bgp-group-neighbor)# no update-source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/neighbor/weight.rst

protocols bgp neighbor-group neighbor weight
--------------------------------------------

**Minimum user role:** operator

To specify a weight that the BGP router will add to routes that are received from the specified BGP neighbor, BGP peer group, or BGP neighbor in a peer group:

**Command syntax: weight [weight]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group neighbor
- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- To apply new neighbor weight settings, restart the bgp neighbor session. A user can invoke clear soft to avoid any traffic impact.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| weight    | Specifies a weight that the device will add to routes that are received from the | 0-65535 | \-      |
|           | specified BGP neighbor.                                                          |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# weight 50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# weight 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# weight 10
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# weight 50


**Removing Configuration**

To revert to the default weight value:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no weight

::

    dnRouter(cfg-protocols-bgp-group)# no weight

::

    dnRouter(cfg-bgp-group-neighbor)# no weight

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/override-capability.rst

protocols bgp neighbor-group override-capability
------------------------------------------------

**Minimum user role:** operator

This command instructs the BGP router whether or not to establish a peering session with a neighbor that does not support capability negotiation, neighbors that are members of a peer group, or with a neighbor in a peer group. To configure this option:

**Command syntax: override-capability [override-capability]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command cannot be enabled with the strict-capability-match configuration. See "bgp neighbor strict-capability-match"

**Parameter table**

+---------------------+---------------------------------------------------+--------------+----------+
| Parameter           | Description                                       | Range        | Default  |
+=====================+===================================================+==============+==========+
| override-capability | allow peer session without capability negotiation | | enabled    | disabled |
|                     |                                                   | | disabled   |          |
+---------------------+---------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# override-capability enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# override-capability disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match disabled
    dnRouter(cfg-bgp-group-neighbor)# override-capability enabled


**Removing Configuration**

To remove this configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no override-capability 

::

    dnRouter(cfg-protocols-bgp-group)# no override-capability

::

    dnRouter(cfg-bgp-group-neighbor)# no override-capability

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/passive.rst

protocols bgp neighbor-group passive
------------------------------------

**Minimum user role:** operator

In passive mode, the router will not initiate open messages to the peer. It will wait for the peer to issue an open request before a message is sent. To configure passive mode for a neighbor, peer group, or a neighbor in a peer group:

**Command syntax: passive [passive]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------+----------------------------------------------------------------------------+--------------+----------+
| Parameter | Description                                                                | Range        | Default  |
+===========+============================================================================+==============+==========+
| passive   | Configure the router so that active open messages are not sent to the peer | | enabled    | disabled |
|           |                                                                            | | disabled   |          |
+-----------+----------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# passive enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# passive disabled


**Removing Configuration**

To remove passive mode:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no passive

::

    dnRouter(cfg-protocols-bgp-group)# no passive

::

    dnRouter(cfg-bgp-group-neighbor)# no passive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/remote-as.rst

protocols bgp neighbor-group remote-as
--------------------------------------

**Minimum user role:** operator

The neighbor (not under neighbor-group) must be configured with remote-as.
For neighbor-groups:
A group can be configured with or without remote-as. If the group is not configured with remote-as, it is mandatory for each of the neighbors under the group to have remote-as.
The group and the neighbor remote-as must be from the same type, meaning iBGP, eBGP or Confederation.

To configure the remote AS number for the neighbor or peer group:

**Command syntax: remote-as [remote-as]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The AS number of the neighbor. BGP uses the AS number for identifying the BGP connection as internal (iBGP) or external (eBGP).

**Parameter table**

+-----------+------------------------+--------------+---------+
| Parameter | Description            | Range        | Default |
+===========+========================+==============+=========+
| remote-as | AS number of the peer. | 1-4294967295 | \-      |
+-----------+------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.2.3.4
    dnRouter(cfg-bgp-group-neighbor)# remote-as 123


**Removing Configuration**

It is not possible to delete the remote-as of a neighbor or group. You need to remove the neighbor or the group. You can change the assigned remote-as.
::


**Command History**

+---------+--------------------------------------------------+
| Release | Modification                                     |
+=========+==================================================+
| 6.0     | Command introduced                               |
+---------+--------------------------------------------------+
| 18.0    | Added remote-as under neighbor of neighbor-group |
+---------+--------------------------------------------------+

---

### neighbor-group/strict-capability-match.rst

protocols bgp neighbor-group strict-capability-match
----------------------------------------------------

**Minimum user role:** operator

This command directs the router to strictly match remote capabilities and local capabilities. If the capabilities are different, the router will issue an "Unsupported Capability" error and will reset the connection.

To set strict capability match:

**Command syntax: strict-capability-match [strict-capability-match]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command cannot be set together with the override-capability configuration. See "bgp neighbor override-capability"

**Parameter table**

+-------------------------+--------------------------------------------------------------+--------------+----------+
| Parameter               | Description                                                  | Range        | Default  |
+=========================+==============================================================+==============+==========+
| strict-capability-match | Strictly compares remote capabilities and local capabilities | | enabled    | disabled |
|                         |                                                              | | disabled   |          |
+-------------------------+--------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# strict-capability-match enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# override-capability disabled
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match enabled


**Removing Configuration**

To remove the strict capability match configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no strict-capability-match

::

    dnRouter(cfg-bgp-group-neighbor)# no strict-capability-match

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/timers.rst

protocols bgp neighbor-group timers
-----------------------------------

**Minimum user role:** operator

To adjust the interval at which BGP keep-alive and hold-time messages are sent to the neighbor or peer group:

**Command syntax: timers {keep-alive [keep-alive-timer], hold-time [hold-time-timer]}**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group

**Note**

- Setting the timer value to 0 disables the timer.

**Parameter table**

+------------------+------------------+------------+---------+
| Parameter        | Description      | Range      | Default |
+==================+==================+============+=========+
| keep-alive-timer | keep-alive-timer | 0-65535    | 60      |
+------------------+------------------+------------+---------+
| hold-time-timer  | hold-time-timer  | 0, 3-65535 | 180     |
+------------------+------------------+------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# timers keep-alive 30 hold-time 90

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# timers hold-time 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# timers hold-time 400 keep-alive 100


**Removing Configuration**

To revert all timers to their default values:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no timers

To revert the specified timer to its default value:
::

    dnRouter(cfg-protocols-bgp-group)# no timers keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/ttl-security.rst

protocols bgp neighbor-group ttl-security
-----------------------------------------

**Minimum user role:** operator

Imposes eBGP TTL security per rfc5082.
When ttl-security is set for an EBGP neighbor, the following is expected for the given neighbor BGP IP/TCP session:
- Any egress packet is set with a TTL 255.
- Any ingress packet is checked for a TTL validity. Only packets with a TTL greater or equal to min-ttl are accepted, otherwise dropped.

The default system behavior is min-ttl = 255, imposing that eBGP neighbor must be directly connected (one hop apart).

Te user may impose a different min-ttl value to support the eBGP neighbors that are not directly connected.
In case min-ttl = 255 ttl-security keeps assumption of the eBGP neighbor being directly connected, regardless of the min-ttl value, as such:
- The neighbor address is expected to be a connected route.
- The egress interface is imposes per the neighbor address.
- In case BFD is requested, a single-hop BFD session is requested (unless a specific BFD-type is set).
In case min-ttl < 255 MH-EBGP session is assumed resulting:
- An update-source is required.
- The neighbor address is not bound to be a connected route.
- The egress interface is selected per the neighbor address routing solution.
- In case BFD is requested, a multi-hop BFD session is requested (unless a specific BFD-type is set).

**Command syntax: ttl-security [admin-state]** min-ttl [min-ttl]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The expected behavior is that both the BGP session sides are configured with ttl-security.

- Configuration is only valid for the eBGP neighbor. Commit validation is required (same as imposed for eBGP-multihop).

- Configuration is possible only with eBGP-multihop = 1. Commit validation is required.

- Applies for both IPv4 neighbors and IPv6 neighbors. The hop-count is handled instead of TTL for IPv6.

- When applied on a group, this property is inherited by all the group members. Applying this property on a neighbor within a group overrides the group settings.

- Neighbors within a neighbor-group derive the neighbor-group configuration (i.e has no default config) or can have a unique setting from the group.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enable ttl security for a given eBGP neighbor                                    | | enabled    | disabled |
|             |                                                                                  | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+
| min-ttl     | Allow received ttl lower than 255, the allowed received ttl will be              | 1-255        | 255      |
|             | greater-equal to (255-range)                                                     |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# ttl-security enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP_GROUP
    dnRouter(cfg-protocols-bgp-group)# ttl-security enabled min-ttl 254

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP_GROUP
    dnRouter(cfg-protocols-bgp-group)# ttl-security enabled min-ttl 252
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-protocols-bgp-neighbor)# ttl-security enabled min-ttl 255


**Removing Configuration**

To revert configuration to default behavior the configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ttl-security

To revert min-ttl to default behavior
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ttl-security enabled min-ttl 255

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### neighbor-group/update-source.rst

protocols bgp neighbor-group update-source
------------------------------------------

**Minimum user role:** operator

The update-source parameter is a mandatory configuration for every multihop BGP session. This includes both iBGP and MH-eBGP.

To specify the source address to use for the BGP session to a neighbor, peer group, or neighbor within the peer group:

**Command syntax: update-source [source-address]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- Changing the configuration will cause the BGP session to restart.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                                      | Range | Default |
+================+==================================================================================+=======+=========+
| source-address | specify the source address to use for the BGP session to this neighbor Can       | \-    | \-      |
|                | either be an ipv4|6-address or a loopback interface name when using loopback     |       |         |
|                | interface name, bgp uses the lo ip address                                       |       |         |
+----------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# update-source lo0

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# update-source 1.1.1.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source 2001:2::65

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source lo1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source ge100-1/2/1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source bundle-2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source bundle-1.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source 2001:2::65
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# update-source 1.1.1.1


**Removing Configuration**

To revert the source address to the default value (the BGP router-id):
::

    dnRouter(cfg-protocols-bgp-neighbor)# no update-source

::

    dnRouter(cfg-protocols-bgp-group)# no update-source

::

    dnRouter(cfg-bgp-group-neighbor)# no update-source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor-group/weight.rst

protocols bgp neighbor-group weight
-----------------------------------

**Minimum user role:** operator

To specify a weight that the BGP router will add to routes that are received from the specified BGP neighbor, BGP peer group, or BGP neighbor in a peer group:

**Command syntax: weight [weight]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor-group
- protocols bgp neighbor
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- To apply new neighbor weight settings, restart the bgp neighbor session. A user can invoke clear soft to avoid any traffic impact.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| weight    | Specifies a weight that the device will add to routes that are received from the | 0-65535 | 0       |
|           | specified BGP neighbor.                                                          |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# weight 50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# weight 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# weight 10
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# weight 50


**Removing Configuration**

To revert to the default weight value:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no weight

::

    dnRouter(cfg-protocols-bgp-group)# no weight

::

    dnRouter(cfg-bgp-group-neighbor)# no weight

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/accept-own.rst

protocols bgp neighbor address-family accept-own
------------------------------------------------

**Minimum user role:** operator

To instruct the router whether or not to handle self-originated VPN routes containing the accept-own community attribute:

**Command syntax: accept-own [accept-own]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is only applicable to vpn address-families.

**Parameter table**

+------------+----------------------------------------------+--------------+----------+
| Parameter  | Description                                  | Range        | Default  |
+============+==============================================+==============+==========+
| accept-own | Enable accept-own handling for this neighbor | | enabled    | disabled |
|            |                                              | | disabled   |          |
+------------+----------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-bgp-neighbor-afi)# accept-own enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# accept-own enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# accept-own enabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# accept-own disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no accept-own

::

    dnRouter(cfg-bgp-group-afi)# no accept-own

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/add-path_receive.rst

protocols bgp neighbor address-family add-path receive
------------------------------------------------------

**Minimum user role:** operator

Typically, BGP routers advertise only the best path for each route. The advertisement of a prefix replaces the previous announcement of that prefix.

To allow the device to receive multiple paths for the same route from the BGP neighbor/group:

**Command syntax: add-path receive [add-path-receive]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family

**Note**

- This command is only applicable to unicast, VPN and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter        | Description                                                                      | Range        | Default |
+==================+==================================================================================+==============+=========+
| add-path-receive | Enables additional paths to be received for the same route from a bgp neighbor.  | | enabled    | \-      |
|                  | Applies for  neighbors with unicast safi                                         | | disabled   |         |
+------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# add-path receive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path receive enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path receive disabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# add-path receive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no add-path receive

::

    dnRouter(cfg-bgp-group-afi)# no add-path receive

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 9.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/add-path_send/add-path_send.rst

protocols bgp neighbor address-family add-path send
---------------------------------------------------

**Minimum user role:** operator

BGP Additional Paths is a BGP extension that provides the ability to advertise multiple paths for the same prefix without the new paths replacing previous paths.
This helps reduce route repetition, and achieve faster re-convergence as an alternative path is available immediately upon failure of a primary path.
To enter add-path send configuration level:

**Command syntax: add-path send**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family

**Note**

- When all paths share the same next-hop only the single best path will be sent.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-group-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-group-afi-add-path-send)# admin-state disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# add-path send
    dnRouter(cfg-neighbor-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no add-path send

::

    dnRouter(cfg-bgp-group-afi)# no add-path send

::

    dnRouter(cfg-group-neighbor-afi)# no add-path send

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/add-path_send/admin-state.rst

protocols bgp neighbor address-family add-path send admin-state
---------------------------------------------------------------

**Minimum user role:** operator

To enable the add-path send behavior for a specific neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family add-path send
- protocols bgp neighbor-group address-family add-path send
- protocols bgp neighbor-group neighbor address-family add-path send

**Note**

- This command is only applicable to unicast and multicast sub-address-families.

- This command is only applicable to the default VRF and only for iBGP neighbors.

**Parameter table**

+-------------+--------------------------------+--------------+---------+
| Parameter   | Description                    | Range        | Default |
+=============+================================+==============+=========+
| admin-state | add path send enabled/disabled | | enabled    | \-      |
|             |                                | | disabled   |         |
+-------------+--------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no admin-state

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/add-path_send/path-count.rst

protocols bgp neighbor address-family add-path send path-count
--------------------------------------------------------------

**Minimum user role:** operator

You can set the number of paths to be sent when add-path send is enabled:

**Command syntax: path-count [path-count]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family add-path send
- protocols bgp neighbor-group address-family add-path send
- protocols bgp neighbor-group neighbor address-family add-path send

**Parameter table**

+------------+----------------------------------------+-------+---------+
| Parameter  | Description                            | Range | Default |
+============+========================================+=======+=========+
| path-count | maximum number of path allowed to send | 2-32  | \-      |
+------------+----------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# add-path send
    dnRouter(cfg-bgp-afi-add-path-send)# path-count 10


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-afi-add-path-send)# no path-count

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/address-family.rst

protocols bgp neighbor address-family
-------------------------------------

**Minimum user role:** operator

The address-family applies to a neighbor, neighbor-group, and a neighbor within a neighbor-group. A neighbor within a neighbor-group inherits all address-families configured for the neighbor-group (a neighbor-group must be configured with at least one address-family, regardless if it has neighbors within it. To configure an address-family to be supported by BGP for the neighbor:

**Command syntax: address-family [neighbor-address-family]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- Changing the configuration will cause the BGP session to restart.

- When FlowSpec SAFI is applied, the received FlowSpec rules are imposed on all FlowSpec enabled interfaces.

- Notice the change in prompt.

- When using OSPFv3 or IPv6-based BGP peering within a routing instance, you must explicitly configure a router ID (router-id) for that specific instance. The main routing instance's router ID is not inherited by other instances. Even if only IPv6 protocols are used, a 32-bit router ID is still required, as IPv6 routing protocols rely on it for establishing adjacencies. The router ID must be a non-zero 32-bit (4-octet) unsigned integer. While it's common to use an IPv4 address as the router ID, this is not mandatory - it doesnt need to be a valid or routable address, just a unique 32-bit value within the routing domain. Failing to configure a router ID in an IPv6 OSPF or BGP instance will result in the protocol defaulting to 0.0.0.0, which is invalid. This will prevent adjacency formation and BGP session establishment.

**Parameter table**

+-------------------------+---------------+--------------------------+---------+
| Parameter               | Description   | Range                    | Default |
+=========================+===============+==========================+=========+
| neighbor-address-family | afi-safi type | | ipv4-unicast           | \-      |
|                         |               | | ipv6-unicast           |         |
|                         |               | | ipv4-labeled-unicast   |         |
|                         |               | | ipv6-labeled-unicast   |         |
|                         |               | | ipv4-vpn               |         |
|                         |               | | ipv6-vpn               |         |
|                         |               | | link-state             |         |
|                         |               | | ipv4-flowspec          |         |
|                         |               | | ipv6-flowspec          |         |
|                         |               | | ipv4-rt-constrains     |         |
|                         |               | | ipv4-multicast         |         |
|                         |               | | l2vpn-evpn             |         |
|                         |               | | l2vpn-vpls             |         |
+-------------------------+---------------+--------------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family link-state
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family link-state
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-flowspec
    dnRouter(cfg-group-neighbor-afi)# exit
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-flowspec
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group FLOWSPEC_V4
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-flowspec
    dnRouter(cfg-group-neighbor-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-flowspec
    dnRouter(cfg-group-neighbor-afi)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-rt-constrains
    dnRouter(cfg-bgp-neighbor-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-bgp-group)# no address-family ipv6-unicast

::

    dnRouter(cfg-protocols-bgp-neighbor)# no address-family ipv4-unicast

::

    dnRouter(cfg-bgp-group-neighbor)# no address-family ipv4-flowspec

**Command History**

+---------+-------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                      |
+=========+===================================================================================================================+
| 6.0     | Command introduced                                                                                                |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 10.0    | Added support for link-state AFI                                                                                  |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 13.0    | Added support for FlowSpec SAFI                                                                                   |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for IPv4 Route Target Constrain SAFI                                                                |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for IPv4 Multicast SAFI. The command is now supported also under the network-services/vrf hierarchy |
+---------+-------------------------------------------------------------------------------------------------------------------+
| 17.2    | Added support for l2vpn-evpn in the range                                                                         |
+---------+-------------------------------------------------------------------------------------------------------------------+
| TBD     | Added ipv4/6-labeled-unicast as separate safi                                                                     |
+---------+-------------------------------------------------------------------------------------------------------------------+
| TBD     | Added support for l2vpn-vpls in the range                                                                         |
+---------+-------------------------------------------------------------------------------------------------------------------+

---

### neighbor/address-family/aigp.rst

protocols bgp neighbor address-family aigp
------------------------------------------

**Minimum user role:** operator

When enabled, the system adds for each route the IGP metric from the BGP next-hop to the current value of the AIGP metric before the route is forwarded to the BGP neighbor, unless the AIGP metric attribute does not exist for the route.

Upon receiving routes with the AIGP metric, the AIGP metric will be considered in best path selection.

When disabled, the received AIGP metric values are ignored and are not advertised in the BGP route.

To enable AIGP with the BGP neighbor:

**Command syntax: aigp [aigp]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Note**

- This command is applicable to the default VRF only.

**Parameter table**

+-----------+--------------------------------------------+--------------+----------+
| Parameter | Description                                | Range        | Default  |
+===========+============================================+==============+==========+
| aigp      | set use of AIGP metric with a bgp neighbor | | enabled    | disabled |
|           |                                            | | disabled   |          |
+-----------+--------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# aigp enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# aigp enabled


**Removing Configuration**

To revert to the default admin-state:
::

    dnRouter(cfg-bgp-group-afi)# no aigp

::

    dnRouter(cfg-bgp-neighbor-afi)# no aigp

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 7.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/allow-as-in.rst

protocols bgp neighbor address-family allow-as-in
-------------------------------------------------

**Minimum user role:** operator

The following command instructs the BGP router whether or not to disable the AS PATH check function for routes learned from the specific neighbor, so as not to reject routes that contain the recipient's AS number.

**Command syntax: allow-as-in [admin-state]** duplicate [as-duplicate-number]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is applicable to eBGP and iBGP neighbors.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter           | Description                                                                      | Range        | Default  |
+=====================+==================================================================================+==============+==========+
| admin-state         | enable this configuration                                                        | | enabled    | disabled |
|                     |                                                                                  | | disabled   |          |
+---------------------+----------------------------------------------------------------------------------+--------------+----------+
| as-duplicate-number | Specifies the number of times that the AS path of a received route may contain   | 1-10         | 1        |
|                     | the recipient BGP speaker's AS number and still be accepted                      |              |          |
+---------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# allow-as-in enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-vpn
    dnRouter(cfg-protocols-bgp-neighbor)# allow-as-in enabled duplicate 3

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in enabled duplicate 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in disabled duplicate 10
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# allow-as-in enabled duplicate 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# allow-as-in enabled duplicate 10
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# allow-as-in disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.3
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-flowspec
    dnRouter(cfg-bgp-neighbor-afi)# allow-as-in enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no allow-as-in duplicate

::

    dnRouter(cfg-bgp-group-afi)# no allow-as-in

::

    dnRouter(cfg-group-neighbor-afi)# no allow-as-in

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/announce_rpki-state.rst

protocols bgp neighbor address-family announce rpki-state
---------------------------------------------------------

**Minimum user role:** operator

The following command is used to announce the RPKI state information using an Extended Community.

**Command syntax: announce rpki-state**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# announce rpki-state

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP4:all
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# announce
    dnRouter(cfg-bgp-group-afi)# rpki-state


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no announce

::

    dnRouter(cfg-bgp-neighbor-afi)# no announce rpki-state

**Command History**

+---------+---------------------------------------+
| Release | Modification                          |
+=========+=======================================+
| 15.1    | Command introduced                    |
+---------+---------------------------------------+
| 16.1    | Added support for IPv4-multicast SAFI |
+---------+---------------------------------------+

---

### neighbor/address-family/as-loop-check.rst

protocols bgp neighbor address-family as-loop-check
---------------------------------------------------

**Minimum user role:** operator

When BGP updates travel through different Autonomous Systems (AS), each eBGP router prepends its AS number to the AS PATH attribute of the BGP update message. If a router receives an update that includes its own AS number in the AS PATH attribute, it will discard it by default to prevent loops. However, In some cases, you may want to allow such updates.

<INSERT 06_protocols_bgp>

In the example above, the autonomous system at the edge is split. Therefore, when R1 advertises network 172.16.1.0/8, it prepends its AS number (65000) to the AS PATH attribute of the update message and forwards it to R3. R3 adds its AS number (65010) and forwards the update to R5. R5, however, sees that the AS number (65000) of its BGP neighbor is in the AS PATH of the update message and will refrain from sending the update to R7. To prevent this from happening, you may want to disable the AS check on R5 and allow it to send the update to R7. However, R7 will see its own AS number (65000) in the update message and it will discard the update.

NOTE: allow-as-in must be enabled on the receiving end of the BGP update (i.e. on R7 in the above example), otherwise it will drop any update that contains its own AS number. See bgp neighbor address-family allow-as-in.

**Command syntax: as-loop-check [as-loop-check]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- allow-as-in must be enabled on the receiving end of the BGP update, otherwise it will drop any update that contains its own AS number. See "bgp neighbor address-family allow-as-in".

- This command applies only to eBGP neighbors.

- If both as-loop-check and as-override are enabled for the same neighbor, as-loop-check will be ignored as the neighbor AS is expected to be replaced.

**Parameter table**

+---------------+---------------------------------------------------------------------------+--------------+---------+
| Parameter     | Description                                                               | Range        | Default |
+===============+===========================================================================+==============+=========+
| as-loop-check | do not advertise route if neighbor as number is part of the route as-path | | enabled    | enabled |
|               |                                                                           | | disabled   |         |
+---------------+---------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# as-loop-check disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# as-loop-check disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# as-loop-check disabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# as-loop-check enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no as-loop-check

::

    dnRouter(cfg-bgp-neighbor-afi)# no as-loop-check

::

    dnRouter(cfg-group-neighbor-afi)# no as-loop-check

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.0    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/as-override.rst

protocols bgp neighbor address-family as-override
-------------------------------------------------

**Minimum user role:** operator

The following command replaces the AS number of the originating device with the AS number of the sending BGP device.

**Command syntax: as-override**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- AS-override is supported for eBGP and iBGP neighbors

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# as-override
    dnRouter(cfg-bgp-neighbor-afi)# exit
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-flowspec
    dnRouter(cfg-bgp-neighbor-afi)# as-override

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# as-override


**Removing Configuration**

To remove the configuration:
::

    dnRouter(cfg-bgp-neighbor-afi)# no as-override

::

    dnRouter(cfg-bgp-group-afi)# no as-override

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/attribute-unchanged.rst

protocols bgp neighbor address-family attribute-unchanged
---------------------------------------------------------

**Minimum user role:** operator

The following command enables BGP to send updates to eBGP peers with the attribute unchanged.

**Command syntax: attribute-unchanged** next-hop med as-path

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- If you do not specify attributes, all attributes will remain unchanged.

- For flowspec SAFI, the next-hop attribute remains unchanged by default.

**Parameter table**

+-----------+--------------------+---------+---------+
| Parameter | Description        | Range   | Default |
+===========+====================+=========+=========+
| next-hop  | next-hop attribute | Boolean | False   |
+-----------+--------------------+---------+---------+
| med       | med attribute      | Boolean | False   |
+-----------+--------------------+---------+---------+
| as-path   | as-path attribute  | Boolean | False   |
+-----------+--------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# attribute-unchanged

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# attribute-unchanged next-hop med

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# attribute-unchanged next-hop med as-path

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# attribute-unchanged med

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# attribute-unchanged as-path


**Removing Configuration**

To disable this option for all attributes:
::

    dnRouter(cfg-bgp-neighbor-afi)# no attribute-unchanged

::

    dnRouter(cfg-bgp-neighbor-afi)# no attribute-unchanged med next-hop

::

    dnRouter(cfg-protocols-bgp-group)# no attribute-unchanged med next-hop

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 11.0    | Removed the as-path option       |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+
| 17.1    | Added as-path support            |
+---------+----------------------------------+

---

### neighbor/address-family/capability_orf.rst

protocols bgp neighbor address-family capability orf
----------------------------------------------------

**Minimum user role:** operator

To configure the BGP router to advertise outbound route filter (ORF) capabilities to a neighbor or a peer group:

**Command syntax: capability orf [capability-orf]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- This command applies to unicast sub-address-family only.

- Reconfiguring capability orf state will result in bgp session reset

**Parameter table**

+----------------+----------------------------------------------------------------------------------+------------------+----------+
| Parameter      | Description                                                                      | Range            | Default  |
+================+==================================================================================+==================+==========+
| capability-orf | Advertises outbound route filter (ORF) capabilities to peer routers enabled -    | | enabled        | disabled |
|                | enables the ORF prefix list capability in both receive and send mode             | | disabled       |          |
|                | receive-only - enables the ORF prefix list capability in receive mode only       | | send-only      |          |
|                | send-only - enables the ORF prefix list capability in send mode only disabled -  | | receive-only   |          |
|                | disables ORF capability                                                          |                  |          |
+----------------+----------------------------------------------------------------------------------+------------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# capability orf enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# capability orf receive-only
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# capability orf send-only
    dnRouter(cfg-protocols-bgp-group)# neighbor 2.2.2.2
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# capability orf disabled


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-group-afi)# no capability orf

::

    dnRouter(cfg-bgp-neighbor-afi)# no capability orf

::

    dnRouter(cfg-group-neighbor-afi)# no capability orf

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/dampening.rst

protocols bgp neighbor address-family dampening
-----------------------------------------------

**Minimum user role:** operator

To instruct the router whether or not to enable route flap dampening suppression from neighbor, peer group or a neighbor in a peer group:

**Command syntax: dampening [dampening]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command is only relevant if global address-family dampening is enabled. See "bgp address-family dampening"

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| dampening | route flap dampening supersession from neighbor, thus disables the global        | | enabled    | enabled |
|           | dampening configuration for neighbor or group                                    | | disabled   |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# address-family ipv6-unicast
    dnRouter(cfg-protocols-bgp-afi)# dampening enabled
    dnRouter(cfg-protocols-bgp-afi)# exit
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# dampening disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# dampening enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# dampening enabled
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# dampening disabled


**Removing Configuration**

To revert dampening to its default state:
::

    dnRouter(cfg-bgp-group-afi)# no dampening

::

    dnRouter(cfg-bgp-neighbor-afi)# no dampening

::

    dnRouter(cfg-group-neighbor-afi)# no dampening

**Command History**

+---------+---------------------------------------------------------------------------------+
| Release | Modification                                                                    |
+=========+=================================================================================+
| 6.0     | Command introduced                                                              |
+---------+---------------------------------------------------------------------------------+
| 11.4    | Changed the default admin-state from the global AFI configuration to "Enabled". |
+---------+---------------------------------------------------------------------------------+

---

### neighbor/address-family/default-originate-policy.rst

protocols bgp neighbor address-family default-originate
-------------------------------------------------------

**Minimum user role:** operator

To enable a BGP router to forward the default route 0.0.0.0 to a BGP neighbor or a BGP peer group:

**Command syntax: default-originate** policy [policy]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- This command is only applicable to unicast sub-address-families.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter | Description                                                                      | Range            | Default |
+===========+==================================================================================+==================+=========+
| policy    | Optionally injects the default route conditionally, depending on the match       | | string         | \-      |
|           | conditions in the route map                                                      | | length 1-255   |         |
+-----------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# default-originate

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# default-originate policy POL_NAME

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-rt-constrains
    dnRouter(cfg-bgp-neighbor-afi)# default-originate


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-group-afi)# no default-originate

::

    dnRouter(cfg-bgp-neighbor-afi)# no default-originate

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 6.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 16.1    | Added support for IPv4 Route Target Constrain SAFI |
+---------+----------------------------------------------------+

---

### neighbor/address-family/encapsulate-srv6.rst

protocols bgp neighbor address-family encapsulate-srv6
------------------------------------------------------

**Minimum user role:** operator

"The following command is used to announce the srv6 attr for local routes."

**Command syntax: encapsulate-srv6 [encapsulate-srv6]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Parameter table**

+------------------+-----------------------------------+--------------+----------+
| Parameter        | Description                       | Range        | Default  |
+==================+===================================+==============+==========+
| encapsulate-srv6 | Enable/Disable srv6 encapsulation | | enabled    | disabled |
|                  |                                   | | disabled   |          |
+------------------+-----------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family l2vpn-evpn
    dnRouter(cfg-bgp-neighbor-afi)# encapsulate-srv6 enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family l2vpn-evpn
    dnRouter(cfg-bgp-group-afi)# encapsulate-srv6 disabled


**Removing Configuration**

To revert encapsulate-srv6 to its default state:
::

    dnRouter(cfg-bgp-neighbor-afi)# no encapsulate-srv6

::

    dnRouter(cfg-group-neighbor-afi)# no encapsulate-srv6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.3    | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/explicit-null.rst

protocols bgp neighbor address-family explicit-null
---------------------------------------------------

**Minimum user role:** operator

When enabled, the label that will be signaled to neighbor will be explicit null (and not implicit)

To enable explicit-null with the BGP neighbor:

**Command syntax: explicit-null [explicit-null]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Note**

- This command is applicable to the default VRF only

- Configuration valid only for ipv4 address families

- Configuration per neighbor or neighbor group is inherited from global address-family configuration and can be overwritten per neighbor or neighbor group

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

**Parameter table**

+---------------+-----------------------------------------------------------------+--------------+---------+
| Parameter     | Description                                                     | Range        | Default |
+===============+=================================================================+==============+=========+
| explicit-null | Apply configuration for explicit-null advertisement on LU peers | | enabled    | \-      |
|               |                                                                 | | disabled   |         |
+---------------+-----------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# explicit-null enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# explicit-null enabled


**Removing Configuration**

To revert to the default admin-state:
::

    dnRouter(cfg-bgp-group-afi)# no  explicit-null

::

    dnRouter(cfg-bgp-neighbor-afi)# no  explicit-null

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| TBD     | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/extended-next-hop.rst

protocols bgp neighbor address-family extended-next-hop
-------------------------------------------------------

**Minimum user role:** operator

Extended next-hop capability allows usage of an IPv6 address next-hop for IPv4 NLRIs per RFC8950.
If the capability is supported on both ends, the DNOS router will advertise, by default, the IPv6 BGP session source address as the next-hop value for IPv4 routes.
To enable extended next-hop capability:"

**Command syntax: extended-next-hop [extended-next-hop]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Configuration valid only for ipv4 address families

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- Reconfiguration will cause session restart (capability change)

**Parameter table**

+-------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter         | Description                                                                      | Range        | Default  |
+===================+==================================================================================+==============+==========+
| extended-next-hop | Support for extended next-hop capability. Allowing usage of ipv6 address nexthop | | enabled    | disabled |
|                   | for ipv4 NLRIs. RFC 8950                                                         | | disabled   |          |
+-------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# extended-next-hop enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# extended-next-hop enabled
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66


**Removing Configuration**

To revert extended-next-hop to default behavior:
::

    dnRouter(cfg-group-neighbor-afi)# no extended-next-hop

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.1    | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/long-lived-graceful-restart/admin-state.rst

protocols bgp neighbor address-family long-lived-graceful-restart admin-state
-----------------------------------------------------------------------------

**Minimum user role:** operator

To enable/disable long-lived-graceful-restart feature on a neighbor/neighbor-group

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family long-lived-graceful-restart

**Note**

- The command is applicable to BGP neighbor and neighbor-groups

- The Graceful restart capability must be enabled for the LLGR to be enabled

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state of the long lived graceful restart feature for the      | | enabled    | disabled |
|             | specific neighbor/neighbor-group. When enabled, peer will be configured with     | | disabled   |          |
|             | long lived graceful restart parameters.                                          |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# long-lived-graceful-restart
    dnRouter(cfg-neighbor-afi-llgr)# admin-state enabled


**Removing Configuration**

To revert all BGP long-lived-graceful-restart parameters to their default values: 
::

    dnRouter(cfg-neighbor-afi-llgr)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/long-lived-graceful-restart/long-lived-graceful-restart.rst

protocols bgp neighbor address-family long-lived-graceful-restart
-----------------------------------------------------------------

**Minimum user role:** operator

Long lived graceful restart enables a BGP router to indicate its ability to preserve its forwarding state during BGP restart. During session initiation, the BGP router informs its peer that it has long lived graceful restart capability. If the BGP session is lost during the restart, the peers mark all the associated routes as stale. However, they do not remove these routes and temporarily continue to use them to make forwarding decisions. Thus, no packets are lost while the BGP process is waiting for convergence of the routing information with the BGP peers.

When the restarting router is back up, the peers wait for the configured amount of time before they delete the stale routes, allowing the router time to converge. When the restarting router sends an end-of-RIB flag notifying its peers that it has converged, or if no end-of-RIB flag is received, but the timer expires, the peers delete any saved stale routes.

Long lived graceful restart is disabled by default. To configure the long-lived-graceful-restart parameters, enable the admin-state for a given afi/safi on a neighbor and a global capability flag for a certain BGP

**Command syntax: long-lived-graceful-restart**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# long-lived-graceful-restart
    dnRouter(cfg-neighbor-afi-llgr)#


**Removing Configuration**

To revert to the default long lived graceful restart values:
::

    dnRouter(cfg-bgp-neighbor-afi)# no long-lived-graceful-restart

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19      | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/long-lived-graceful-restart/stalepath-time.rst

protocols bgp neighbor address-family long-lived-graceful-restart stalepath-time units
--------------------------------------------------------------------------------------

**Minimum user role:** operator

Long lived graceful restart enables a BGP router to indicate its ability to preserve its forwarding state during BGP restart. During session initiation, the BGP router informs its peer that it has long lived graceful restart capability. If the BGP session is lost during the restart, the peers mark all the associated routes as stale. However, they do not remove these routes and temporarily continue to use them to make forwarding decisions. Thus, no packets are lost while the BGP process is waiting for convergence of the routing information with the BGP peers.

When the restarting router is back up, the peers wait for the configured amount of time before they delete the stale routes, allowing the router time to converge. When the restarting router sends an end-of-RIB flag notifying its peers that it has converged, or if no end-of-RIB flag is received, but the timer expires, the peers delete any saved stale routes.

To configure the graceful-restart stalepath-time:

**Command syntax: stalepath-time [time] units [units]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family long-lived-graceful-restart

**Parameter table**

+-----------+---------------------------------------------------------------------------------+-------------+---------+
| Parameter | Description                                                                     | Range       | Default |
+===========+=================================================================================+=============+=========+
| time      | 1..16777215 for seconds 1..279620 for minutes 1..4660 for hours 1..194 for days | 1-16777215  | 1       |
+-----------+---------------------------------------------------------------------------------+-------------+---------+
| units     | time resolution                                                                 | | seconds   | hours   |
|           |                                                                                 | | minutes   |         |
|           |                                                                                 | | hours     |         |
|           |                                                                                 | | days      |         |
+-----------+---------------------------------------------------------------------------------+-------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# long-lived-graceful-restart
    dnRouter(cfg-neighbor-afi-llgr)# stalepath-time 400 units seconds


**Removing Configuration**

To revert to the default stalepath-time value:
::

    dnRouter(cfg-neighbor-afi-llgr)# no stalepath-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19      | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/maximum-prefix/exceed-action.rst

protocols bgp neighbor address-family maximum-prefix exceed-action
------------------------------------------------------------------

**Minimum user role:** operator


To instruct BGP what action to take when the maximum allowed number of prefixes has been exceeded.

 - warning only - (Default behavior) maximum-prefix-number exceeded - restart the neighbor session. The session will restart after the restart-interval.
 - restart - maximum-prefix-number exceeded - restart the neighbor session. The session will restart after the restart-interval.

**Command syntax: exceed-action [action]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group address-family maximum-prefix
- protocols bgp neighbor-group neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- When the prefix number drops below the maximum prefix- number threshold, a clear message is sent.

**Parameter table**

+-----------+--------------------------------------------------------+------------------+--------------+
| Parameter | Description                                            | Range            | Default      |
+===========+========================================================+==================+==============+
| action    | action to be taken when maximum-prefix-number exceeded | | warning-only   | warning-only |
|           |                                                        | | restart        |              |
+-----------+--------------------------------------------------------+------------------+--------------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# exceed-action warning-only


**Removing Configuration**

To revert to the default action (warning-only):
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no exceed-action

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/maximum-prefix/limit.rst

protocols bgp neighbor address-family maximum-prefix limit
----------------------------------------------------------

**Minimum user role:** operator

"Specifies the maximum number of IP network prefixes (routes) that can be learned from a specified neighbor or neighbor group."

**Command syntax: limit [maximum-prefix-number]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group address-family maximum-prefix
- protocols bgp neighbor-group neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

**Parameter table**

+-----------------------+----------------------+--------------+---------+
| Parameter             | Description          | Range        | Default |
+=======================+======================+==============+=========+
| maximum-prefix-number | 0 used for unlimited | 0-4294967295 | 0       |
+-----------------------+----------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# limit 1000000000


**Removing Configuration**

To revert to default:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no limit

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/maximum-prefix/maximum-prefix.rst

protocols bgp neighbor address-family maximum-prefix
----------------------------------------------------

**Minimum user role:** operator

By setting the maximum-prefix attribute, you control the number of prefixes that can be received from a neighbor. This is useful when a router starts receiving more routes than its memory can take.

To limit the number of routes that can be learned from the neighbor, peer group, or neighbor in a peer group:

**Command syntax: maximum-prefix**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)#


**Removing Configuration**

To revert to the default maximum-prefixes:
::

    dnRouter(cfg-bgp-neighbor-afi)# no maximum-prefix

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/maximum-prefix/restart-interval.rst

protocols bgp neighbor address-family maximum-prefix restart-interval
---------------------------------------------------------------------

**Minimum user role:** operator

Defines the restart interval when an exceed-action value is set to 'restart'.

**Command syntax: restart-interval [restart-interval]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group address-family maximum-prefix
- protocols bgp neighbor-group neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+------------------+-------------+---------+---------+
| Parameter        | Description | Range   | Default |
+==================+=============+=========+=========+
| restart-interval | minutes     | 1-65535 | \-      |
+------------------+-------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# restart-interval 100


**Removing Configuration**

To remove the restart interval:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no restart-interval

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/maximum-prefix/threshold.rst

protocols bgp neighbor address-family maximum-prefix threshold
--------------------------------------------------------------

**Minimum user role:** operator

Specifies the percentage of the value specified by *maximum-prefix-number* that causes a log message to be generated.

**Command syntax: threshold [syslog-threshold]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family maximum-prefix
- protocols bgp neighbor-group address-family maximum-prefix
- protocols bgp neighbor-group neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group address-family maximum-prefix
- network-services vrf instance protocols bgp neighbor-group neighbor address-family maximum-prefix

**Note**
When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+------------------+-------------+-------+---------+
| Parameter        | Description | Range | Default |
+==================+=============+=======+=========+
| syslog-threshold | percentage  | 1-100 | 100     |
+------------------+-------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# maximum-prefix
    dnRouter(cfg-neighbor-afi-maximum-prefix)# threshold 75


**Removing Configuration**

To revert to the default maximum-prefixes:
::

    dnRouter(cfg-neighbor-afi-maximum-prefix)# no threshold

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/nexthop_ipv4.rst

protocols bgp neighbor address-family nexthop
---------------------------------------------

**Minimum user role:** operator

This command sets the next-hop of the advertised route to be the BGP router's address.

To set the advertised route's next-hop value to be the BGP router's address:

**Command syntax: nexthop [ipv4-address]** force [force]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Changing the configuration will cause the BGP session to restart.

- For flowspec SAFI, imposing a nexthop change might affect the flowspec action rules. By default, the "nexthop" attribute doesn't change for flowspec NLRI in either eBGP or iBGP sessions.

- For eBGP sessions and any BGP MPLS session, the nexthop value is set to "nexthop self" by default.

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- The address type must match the address family.

**Parameter table**

+--------------+-----------------------------------------------------------+--------------+----------+
| Parameter    | Description                                               | Range        | Default  |
+==============+===========================================================+==============+==========+
| ipv4-address | set specific ip address to be used as the nexthop address | A.B.C.D      | \-       |
+--------------+-----------------------------------------------------------+--------------+----------+
| force        | apply nexthop setting even when acting as route reflector | | enabled    | disabled |
|              |                                                           | | disabled   |          |
+--------------+-----------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1.1.1.1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv6-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1:1::1:1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 0:ffff::120

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 1.2.3.4
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 95.70.1.13


**Removing Configuration**

To remove the nexthop settings:
::

    dnRouter(cfg-group-neighbor-afi)# no nexthop

To revert force to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no nexthop self force

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                          |
+=========+=======================================================================================================================+
| 6.0     | Command introduced                                                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 11.0    | Added option to enter a specific IP address as nexthop Added option to configure nexthop for neighbors within a group |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                                                                                      |
+---------+-----------------------------------------------------------------------------------------------------------------------+

---

### neighbor/address-family/nexthop_ipv6.rst

protocols bgp neighbor address-family nexthop
---------------------------------------------

**Minimum user role:** operator

This command sets the next-hop of the advertised route to be the BGP router's address.

To set the advertised route's next-hop value to be the BGP router's address:

**Command syntax: nexthop [ipv6-address]** force [force]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- Changing the configuration will cause the BGP session to restart.

- For flowspec SAFI, imposing a nexthop change might affect the flowspec action rules. By default, the "nexthop" attribute doesn't change for flowspec NLRI in either eBGP or iBGP sessions.

- For eBGP sessions and any BGP MPLS session, the nexthop value is set to "nexthop self" by default.

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- The address type must match the address family.

**Parameter table**

+--------------+-----------------------------------------------------------+--------------+----------+
| Parameter    | Description                                               | Range        | Default  |
+==============+===========================================================+==============+==========+
| ipv6-address | set specific ip address to be used as the nexthop address | X:X::X:X     | \-       |
+--------------+-----------------------------------------------------------+--------------+----------+
| force        | apply nexthop setting even when acting as route reflector | | enabled    | disabled |
|              |                                                           | | disabled   |          |
+--------------+-----------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv4-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1.1.1.1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 120.92.1.50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-group-group-afi)# address-family ipv6-unicast
    dnRouter(cfg-group-group-afi)# nexthop 1:1::1:1
    dnRouter(cfg-group-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# nexthop 0:ffff::120

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 1.2.3.4
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# nexthop 95.70.1.13


**Removing Configuration**

To remove the nexthop settings:
::

    dnRouter(cfg-group-neighbor-afi)# no nexthop

To revert force to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no nexthop self force

**Command History**

+---------+-----------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                          |
+=========+=======================================================================================================================+
| 6.0     | Command introduced                                                                                                    |
+---------+-----------------------------------------------------------------------------------------------------------------------+
| 11.0    | Added option to enter a specific IP address as nexthop Added option to configure nexthop for neighbors within a group |
+---------+-----------------------------------------------------------------------------------------------------------------------+

---

### neighbor/address-family/nexthop_self.rst

network-services vrf instance protocols bgp neighbor-group neighbor address-family nexthop self
-----------------------------------------------------------------------------------------------

**Minimum user role:** operator

This command sets the next-hop of the advertised route to be the BGP router's address.

To set the advertised route's next-hop value to be the BGP router's address:

**Command syntax: nexthop self** force [force]

**Command mode:** config

**Hierarchies**

- network-services vrf instance protocols bgp neighbor-group neighbor address-family
- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- Changing the configuration will cause the BGP session to restart.

- For flowspec SAFI, imposing a nexthop change might affect the flowspec action rules. By default, the "nexthop" attribute doesn't change for flowspec NLRI in either eBGP or iBGP sessions.

- For eBGP sessions and any BGP MPLS session, the nexthop value is set to "nexthop self" by default.

- For neighbors within a group, the "no" command reverts the neighbor to the group setting.

- self uses the BGP session source address:

- For IPv4 over IPv6 sessions - the BGP router-id is used

- For IPv6 over IPv4 sessions - ::ffff:<session-ipv4-source-address> is used

- For BGP 6PE (IPv6 labeled-unicast), ::ffff:<session-ipv4-source-address> is used.

**Parameter table**

+-----------+-----------------------------------------------------------+--------------+---------+
| Parameter | Description                                               | Range        | Default |
+===========+===========================================================+==============+=========+
| force     | apply nexthop setting even when acting as route reflector | | enabled    | \-      |
|           |                                                           | | disabled   |         |
+-----------+-----------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# nexthop self

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65000
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)#)# route-reflector-client
    dnRouter(cfg-bgp-group-afi)# nexthop self force enabled


**Removing Configuration**

To remove the nexthop settings:
::

    dnRouter(cfg-group-neighbor-afi)# no nexthop

To revert force to the default state:
::

    dnRouter(cfg-bgp-group-afi)# no nexthop self force

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 11.0    | Added option to configure nexthop for neighbors within a group |
+---------+----------------------------------------------------------------+

---

### neighbor/address-family/orf-prefix-list-ipv4.rst

protocols bgp neighbor address-family orf-prefix-list-ipv4
----------------------------------------------------------

**Minimum user role:** operator

The Prefix-list is sent when the ORF send capability is enabled. To configure the prefix list to be sent to the peer to be used as an outbound-route-filter:

**Command syntax: orf-prefix-list-ipv4 [ipv4-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- The prefix-list type (IPv4 / IPv6) must match the address-family type.

- The prefix-list must use a configured prefix-list from the routing-policy. It can be within the same commit.

- This command is only valid for unicast sub-address families.

- Neighbors within a neighbor-group can use the neighbor-group configuration or a configuration from the group.

**Parameter table**

+------------------+---------------------------------------------------+------------------+---------+
| Parameter        | Description                                       | Range            | Default |
+==================+===================================================+==================+=========+
| ipv4-prefix-list | IPv4 ORF prefix list sent to ORF capable neighbor | | string         | \-      |
|                  |                                                   | | length 1-255   |         |
+------------------+---------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6
    dnRouter(cfg-protocols-bgp-group)# neighbor 2:2::2:2
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6


**Removing Configuration**

To remove the prefix-list:
::

    dnRouter(cfg-bgp-neighbor-afi)# no orf-prefix-list

::

    dnRouter(cfg-bgp-group-afi)# no orf-prefix-list

::

    dnRouter(cfg-group-neighbor-afi)# no orf-prefix-list

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/orf-prefix-list-ipv6.rst

protocols bgp neighbor address-family orf-prefix-list-ipv6
----------------------------------------------------------

**Minimum user role:** operator

The Prefix-list is sent when the ORF send capability is enabled. To configure the prefix list to be sent to the peer to be used as an outbound-route-filter:

**Command syntax: orf-prefix-list-ipv6 [ipv6-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- The prefix-list type (IPv4 / IPv6) must match the address-family type.

- The prefix-list must use a configured prefix-list from the routing-policy. It can be within the same commit.

- This command is only valid for unicast sub-address families.

- Neighbors within a neighbor-group can use the neighbor-group configuration or a configuration from the group.

**Parameter table**

+------------------+---------------------------------------------------+------------------+---------+
| Parameter        | Description                                       | Range            | Default |
+==================+===================================================+==================+=========+
| ipv6-prefix-list | IPv4 ORF prefix list sent to ORF capable neighbor | | string         | \-      |
|                  |                                                   | | length 1-255   |         |
+------------------+---------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-unicast
    dnRouter(cfg-bgp-group-afi)# orf-prefix-list ORF_PL_IPv4
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6
    dnRouter(cfg-protocols-bgp-group)# neighbor 2:2::2:2
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-group-neighbor-afi)# orf-prefix-list ORF_PL_IPv6


**Removing Configuration**

To remove the prefix-list:
::

    dnRouter(cfg-bgp-neighbor-afi)# no orf-prefix-list

::

    dnRouter(cfg-bgp-group-afi)# no orf-prefix-list

::

    dnRouter(cfg-group-neighbor-afi)# no orf-prefix-list

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/policy-in.rst

protocols bgp neighbor address-family policy in
-----------------------------------------------

**Minimum user role:** operator

To apply a route map to a neighbor or peer group:

**Command syntax: policy [policy-in]** [, policy-in, policy-in] **in**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- If a policy is configured for a group, you cannot disable it for a neighbor within the group. You must explicitly set a different policy to achieve a different behavior from the group. You may even attach an empty policy.

- Can set multiple policies. In case multiple policies are set, policies are evaluated one after the other according to the user input order

- When setting a new policy, the policy will be appended to the existing attached policies

- To remove a policy, the user must specify the name of the policy to be remvoed

- To remove all policies, the user must specify all attached policy names

- To replace an attached policy, the user will need to first remove and than add a new policy. Can be performed in the same commit. the policy order imposes the functional behavior.

**Parameter table**

+-----------+---------------------------------------+------------------+---------+
| Parameter | Description                           | Range            | Default |
+===========+=======================================+==================+=========+
| policy-in | applies the filter in incoming routes | | string         | \-      |
|           |                                       | | length 1-255   |         |
+-----------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy in
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# policy MyPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# policy GroupPolicy in
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# policy NeighborPolicy in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy_1,MyPolicy_2 in


**Removing Configuration**

To disable the route map policy:
::

    dnRouter(cfg-bgp-group-afi)# no policy MyPolicy in

::

    dnRouter(cfg-bgp-neighbor-afi)# no policy MyPolicy in

::

    dnRouter(cfg-group-neighbor-afi)# no policy NeighborPolicy in

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 11.0    | Added option to configure policy for a neighbor within a group |
+---------+----------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                               |
+---------+----------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                |
+---------+----------------------------------------------------------------+

---

### neighbor/address-family/policy-out.rst

protocols bgp neighbor address-family policy out
------------------------------------------------

**Minimum user role:** operator

To apply a route map to a neighbor or peer group:

**Command syntax: policy [policy-out]** [, policy-out, policy-out] **out**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- protocols bgp neighbor-group neighbor address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor-group neighbor address-family

**Note**

- If a policy is configured for a group, you cannot disable it for a neighbor within the group. You must explicitly set a different policy to achieve a different behavior from the group. You may even attach an empty policy.

- Can set multiple policies. In case multiple policies are set, policies are evaluated one after the other according to the user input order

- When setting a new policy, the policy will be appended to the existing attached policies

- To remove a policy, the user must specify the name of the policy to be remvoed

- To remove all policies, the user must specify all attached policy names

- To replace an attached policy, the user will need to first remove and than add a new policy. Can be performed in the same commit. the policy order imposes the functional behavior.

**Parameter table**

+------------+---------------------------------------+------------------+---------+
| Parameter  | Description                           | Range            | Default |
+============+=======================================+==================+=========+
| policy-out | applies the filter in outgoing routes | | string         | \-      |
|            |                                       | | length 1-255   |         |
+------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-unicast
    dnRouter(cfg-bgp-group-afi)# policy MyPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# policy GroupPolicy out
    dnRouter(cfg-bgp-group-afi)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# address-family ipv6-vpn
    dnRouter(cfg-group-neighbor-afi)# policy NeighborPolicy out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# policy MyPolicy_1,MyPolicy_2 out


**Removing Configuration**

To disable the route map policy:
::

    dnRouter(cfg-bgp-group-afi)# no policy MyPolicy out

::

    dnRouter(cfg-bgp-neighbor-afi)# no policy MyPolicy out

::

    dnRouter(cfg-group-neighbor-afi)# no policy NeighborPolicy out

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 11.0    | Added option to configure policy for a neighbor within a group |
+---------+----------------------------------------------------------------+
| 16.1    | Added support for multicast SAFI                               |
+---------+----------------------------------------------------------------+
| 17.2    | Added support for multiple policies attachments                |
+---------+----------------------------------------------------------------+

---

### neighbor/address-family/prefix-list-ipv4_in.rst

protocols bgp neighbor address-family prefix-list-ipv4 in
---------------------------------------------------------

**Minimum user role:** operator

The following command filters the route updates for a BGP neighbor or peer group according to IP address and mask length.

**Command syntax: prefix-list-ipv4 [ipv4-prefix-list-in] in**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+---------------------+---------------------------------------+------------------+---------+
| Parameter           | Description                           | Range            | Default |
+=====================+=======================================+==================+=========+
| ipv4-prefix-list-in | applies the filter in incoming routes | | string         | \-      |
|                     |                                       | | length 1-255   |         |
+---------------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# prefix-list-ipv4 PL4_IN in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# prefix-list-ipv4 PL4_IN in


**Removing Configuration**

To disable filtering:
::

    dnRouter(cfg-bgp-group-afi)# no prefix-list-ipv4 PL_IN in"

::

    dnRouter(cfg-bgp-neighbor-afi)# no prefix-list-ipv4 PL_IN in"

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/prefix-list-ipv4_out.rst

protocols bgp neighbor address-family prefix-list-ipv4 out
----------------------------------------------------------

**Minimum user role:** operator

The following command filters the route updates for a BGP neighbor or peer group according to IP address and mask length.

**Command syntax: prefix-list-ipv4 [ipv4-prefix-list-out] out**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+----------------------+---------------------------------------+------------------+---------+
| Parameter            | Description                           | Range            | Default |
+======================+=======================================+==================+=========+
| ipv4-prefix-list-out | applies the filter in outgoing routes | | string         | \-      |
|                      |                                       | | length 1-255   |         |
+----------------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# prefix-list-ipv4 PL4_OUT out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# prefix-list PL4_OUT out


**Removing Configuration**

To disable filtering:
::

    dnRouter(cfg-bgp-group-afi)# no prefix-list-ipv4 PL_OUT out"

::

    dnRouter(cfg-bgp-neighbor-afi)# no prefix-list-ipv4 PL_OUT out"

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/prefix-list-ipv6_in.rst

protocols bgp neighbor address-family prefix-list-ipv6 in
---------------------------------------------------------

**Minimum user role:** operator

The following command filters the route updates for a BGP neighbor or peer group according to IP address and mask length.

**Command syntax: prefix-list-ipv6 [ipv6-prefix-list-in] in**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+---------------------+---------------------------------------+------------------+---------+
| Parameter           | Description                           | Range            | Default |
+=====================+=======================================+==================+=========+
| ipv6-prefix-list-in | applies the filter in incoming routes | | string         | \-      |
|                     |                                       | | length 1-255   |         |
+---------------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# prefix-list-ipv6 PL6_IN in

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# prefix-list-ipv6 PL6_IN in


**Removing Configuration**

To disable filtering:
::

    dnRouter(cfg-bgp-group-afi)# no prefix-list-ipv6 PL_IN in"

::

    dnRouter(cfg-bgp-neighbor-afi)# no prefix-list-ipv6 PL_IN in"

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/prefix-list-ipv6_out.rst

protocols bgp neighbor address-family prefix-list-ipv6 out
----------------------------------------------------------

**Minimum user role:** operator

The following command filters the route updates for a BGP neighbor or peer group according to IP address and mask length.

**Command syntax: prefix-list-ipv6 [ipv6-prefix-list-out] out**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+----------------------+---------------------------------------+------------------+---------+
| Parameter            | Description                           | Range            | Default |
+======================+=======================================+==================+=========+
| ipv6-prefix-list-out | applies the filter in outgoing routes | | string         | \-      |
|                      |                                       | | length 1-255   |         |
+----------------------+---------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# prefix-list-ipv6 PL6_OUT out

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# prefix-list-ipv6 PL6_OUT out


**Removing Configuration**

To disable filtering:
::

    dnRouter(cfg-bgp-group-afi)# no prefix-list-ipv6 PL_OUT out"

::

    dnRouter(cfg-bgp-neighbor-afi)# no prefix-list-ipv6 PL_OUT out"

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/remove-private-as.rst

protocols bgp neighbor address-family remove-private-as
-------------------------------------------------------

**Minimum user role:** operator

To remove private AS numbers from the AS path advertised to the neighbor or peer group:

**Command syntax: remove-private-as** all

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Parameter table**

+-----------+--------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                              | Range   | Default |
+===========+==========================================================================+=========+=========+
| all       | remove all private as-numbers regardless if path contains public numbers | Boolean | False   |
+-----------+--------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# remove-private-as
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# remove-private-as

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv6-unicast
    dnRouter(cfg-bgp-neighbor-afi)# remove-private-as all

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# remove-private-as


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-neighbor-afi)# no remove-private-as all

::

    dnRouter(cfg-bgp-group-afi)# no remove-private-as

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/route-reflector-client.rst

protocols bgp neighbor address-family route-reflector-client
------------------------------------------------------------

**Minimum user role:** operator

To configure a neighbor as a route reflector client:

**Command syntax: route-reflector-client**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Note**

- This command is applicable to iBGP neighbors only.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)#)# route-reflector-client

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# route-reflector-client


**Removing Configuration**

To remove the route-reflector configuration:
::

    dnRouter(cfg-bgp-neighbor-afi)# no route-reflector-client

::

    dnRouter(cfg-bgp-group-afi)# no route-reflector-client

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.0    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/send-community.rst

protocols bgp neighbor address-family send-community
----------------------------------------------------

**Minimum user role:** operator

The following command ensures that the community attribute is sent in updates to the specified neighbor or group.

**Command syntax: send-community** community-type [community-type]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**

- The default behavior of the system is to not send the community attribute.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter      | Description                                                                      | Range        | Default |
+================+==================================================================================+==============+=========+
| community-type | both - Sends both standard and extended attributes extended - Sends extended     | | both       | both    |
|                | attributes standard - Sends standard attributes                                  | | extended   |         |
|                |                                                                                  | | standard   |         |
+----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# send-community
    dnRouter(cfg-bgp-neighbor-afi)# send-community community-type standard

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# send-community community-type both

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-flowspec
    dnRouter(cfg-bgp-group-afi)# send-community community-type both


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-group-afi)# no send-community

::

    dnRouter(cfg-bgp-neighbor-afi)# no send-community community-type standard

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/send-large-community.rst

protocols bgp neighbor address-family send-large-community
----------------------------------------------------------

**Minimum user role:** operator

The following command ensures that the large community attribute is sent in updates to the specified neighbor or group.

**Command syntax: send-large-community [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Note**
The default behavior of the system is to not send the large-community attribute.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enables sending the large community attribute in updates to the specified BGP    | | enabled    | disabled |
|             | neighbor                                                                         | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# send-large-community enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-vpn
    dnRouter(cfg-bgp-group-afi)# send-large-community disabled


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-bgp-group-afi)# no send-large-community

::

    dnRouter(cfg-bgp-neighbor-afi)# no send-large-community

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.1    | Command introduced               |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/soft-reconfiguration.rst

protocols bgp neighbor address-family soft-reconfiguration inbound
------------------------------------------------------------------

**Minimum user role:** operator

To set address-family prefixes to be saved in the adj-RIB-in table to support soft rest:

**Command syntax: soft-reconfiguration inbound**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family
- network-services vrf instance protocols bgp neighbor address-family
- network-services vrf instance protocols bgp neighbor-group address-family

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-unicast
    dnRouter(cfg-bgp-neighbor-afi)# soft-reconfiguration inbound
    dnRouter(cfg-protocols-bgp-neighbor)# address-family flowspec
    dnRouter(cfg-bgp-neighbor-afi)# soft-reconfiguration inbound

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv4-vpn
    dnRouter(cfg-bgp-group-afi)# soft-reconfiguration inbound


**Removing Configuration**

To stop the routes from being saved in the adj-RIB-in table for the neighbor address-family:
::

    dnRouter(cfg-bgp-group-afi)# no soft-reconfiguration inbound

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 6.0     | Command introduced               |
+---------+----------------------------------+
| 10.0    | Command not supported            |
+---------+----------------------------------+
| 16.1    | Added support for multicast SAFI |
+---------+----------------------------------+

---

### neighbor/address-family/sr-labeled-unicast/allow-external-sid.rst

protocols bgp neighbor address-family sr-labeled-unicast allow-external-sid
---------------------------------------------------------------------------

**Minimum user role:** operator

BGP Prefix-SID Redistribution allows advertising IPv4 and IPv6 BGP Prefix-SID for SR-MPLS IPv4/IPv6-based networks. 
It is possible for BGP to carry the association of an SR-MPLS Node-SID index with an IPv4/IPv6 prefix. 
This is achieved by attaching a prefix-SID BGP path attribute containing the label-index value to an IPv4/IPv6 route belonging to either an IPv4-LU or IPv6-LU address family.
This command controls the BGP prefix-SID usage on eBGP sessions between different Autonomous Systems, as required by RFC 8669.

To enable advertisement of the local SRGB in an Originator SRGB TLV as part of the Prefix-SID attributes for locally originated routes:

**Command syntax: allow-external-sid [allow-external-sid]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family sr-labeled-unicast
- protocols bgp neighbor-group address-family sr-labeled-unicast

**Note**

- This command only supports Labeled-Unicast routes, when the Prefix-SID is enabled.

- Supported for eBGP sessions only.

- To allow usage of BGP prefix-sid on eBGP adjacencies, set the required behavior - <send-only/receive-only/send-receive/disabled>.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter          | Description                                                                      | Range            | Default |
+====================+==================================================================================+==================+=========+
| allow-external-sid | Define exchange behaviour of Prefix-SID attribute with external peers.           | | send-only      | \-      |
|                    | Configuration only relevant for ebgp sessions                                    | | receive-only   |         |
|                    |                                                                                  | | send-receive   |         |
|                    |                                                                                  | | disabled       |         |
+--------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-labeled-unicast
    dnRouter(cfg-bgp-neighbor-afi)# sr-labeled-unicast
    dnRouter(cfg-neighbor-afi-sr-lu)# allow-external-sid send-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-labeled-unicast
    dnRouter(cfg-bgp-group-afi)# sr-labeled-unicast
    dnRouter(cfg-group-afi-sr-lu)# allow-external-sid send-receive


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-group-afi-sr-lu)# no allow-external-sid

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### neighbor/address-family/sr-labeled-unicast/sr-labeled-unicast.rst

protocols bgp neighbor address-family sr-labeled-unicast
--------------------------------------------------------

**Minimum user role:** operator

To enter sr-labeled-unicast configuration level.

**Command syntax: sr-labeled-unicast**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor address-family
- protocols bgp neighbor-group address-family

**Note**

- Notice the change in prompt.

- Valid only for the default vrf.

- Supported for both the neighbor and peer group. Not supported for the neighbor within the peer group.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# address-family ipv4-labeled-unicast
    dnRouter(cfg-bgp-neighbor-afi)# sr-labeled-unicast
    dnRouter(cfg-neighbor-afi-sr-lu)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# address-family ipv6-labeled-unicast
    dnRouter(cfg-bgp-group-afi)# sr-labeled-unicast
    dnRouter(cfg-group-afi-sr-lu)#


**Removing Configuration**

To remove the sr-labeled-unicast configuration:
::

    dnRouter(cfg-protocols-bgp-afi)# no sr-labeled-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### neighbor/admin-state.rst

protocols bgp neighbor admin-state
----------------------------------

**Minimum user role:** operator

Use this command to administratively start or shut down the session with the BGP neighbor, BGP neighbors in a group or a specific BGP neighbor within a group (this will override the group setting for this neighbor):

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | Causes a device to shut down the session administratively with its BGP neighbor. | | enabled    | enabled |
|             |                                                                                  | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# admin-state disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# admin-state disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# admin-state disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/adv-interval.rst

protocols bgp neighbor advertisement-interval
---------------------------------------------

**Minimum user role:** operator

To set the interval between BGP routing updates:

**Command syntax: advertisement-interval [advertisement-interval]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter              | Description                                                                      | Range | Default |
+========================+==================================================================================+=======+=========+
| advertisement-interval | Set the interval between BGP routing updates. The default advertisement-interval | 0-600 | \-      |
|                        | between ibgp and ebgp sessions default for ibgp = 0 default for ebgp = 30        |       |         |
+------------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-protocols-bgp-neighbor)# advertisement-interval 20
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000
    dnRouter(cfg-protocols-bgp-neighbor)# advertisement-interval 90
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 7180
    dnRouter(cfg-protocols-bgp-group)# advertisement-interval 2


**Removing Configuration**

To revert to the default interval:
::

    dnRouter(cfg-protocols-bgp-group)# no advertisement-interval

::

    dnRouter(cfg-protocols-bgp-neighbor)# no advertisement-interval

**Command History**

+---------+--------------------------------------------------+
| Release | Modification                                     |
+=========+==================================================+
| 6.0     | Command introduced                               |
+---------+--------------------------------------------------+
| 9.0     | Updated default interval for iBGP neighbors to 0 |
+---------+--------------------------------------------------+

---

### neighbor/authentication.rst

protocols bgp neighbor authentication md5 password
--------------------------------------------------

**Minimum user role:** operator

To set a password for authenticating the neighbor, peer group neighbors, or the neighbor in a peer group:

**Command syntax: authentication md5 password [secret]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- Changing the configuration will cause the BGP session to restart.

- If you do not specify a password, enter the password of the neighbor BGP router in clear text. The password is then encrypted and from then on will be displayed as encrypted. You can copy the encrypted password and use it as the enc-password. When typing a clear password, the password is not displayed in the CLI terminal.

- The clear text password provided in the CLI is hashed with the md5 hash. As the md5 hash is not strong enough and can be broken, the FERNET algorithm is applied to the md5 hash before it is stored in the DNOS database.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| secret    | set a password for authentication encrypted secret password string for the       | \-    | \-      |
|           | neighbor bgp. if the user enters a clear-text password, the password is then     |       |         |
|           | encrypted by the system and saved in secret argument. if user specified 'secret' |       |         |
|           | save string in secret                                                            |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# authentication md5 password
    Enter password
    Enter password for verifications

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.2.2
    dnRouter(cfg-protocols-bgp-neighbor)# authentication md5 password enc-!U2FsdGVkX1+

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# authentication md5 password
    Enter password
    Enter password for verification

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# authentication md5 password
    Enter password
    Enter password for verification
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# authentication md5 password enc-!U2FsdGVkX1+qG


**Removing Configuration**

To remove the password configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no authentication md5

::

    dnRouter(cfg-protocols-bgp-group)# no authentication md5

::

    dnRouter(cfg-bgp-group-neighbor)# no authentication md5

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/bfd/admin-state.rst

protocols bgp neighbor bfd admin-state
--------------------------------------

**Minimum user role:** operator

Enable BFD session for BGP session protection and enter BFD configuration level to configure BFD session settings.

To change the BFD administrative state for a specific BGP neighbor:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- In the event that there are multiple BFD clients registered to the same BFD session, a single BFD session is established with the strictest session parameters between all clients.

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# admin-state enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# admin-state enabled
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no admin-state

::

    dnRouter(cfg-bgp-group-bfd)# no admin-state

::

    dnRouter(cfg-bgp-neighbor-bfd)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### neighbor/bfd/bfd-type.rst

protocols bgp neighbor bfd bfd-type
-----------------------------------

**Minimum user role:** operator

Define the requested BFD session type, Single-hop or Multi-hop. By default session type is according to BGP peering type.

To set requested session type:

**Command syntax: bfd-type [session-type]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- For multi-hop session type , update-source must be configured for neighbor

- For single-hop session type , bgp peering must be directly over a connected interface

- Reconfig of bfd-type will result in a new BFD session

**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------------+-----------+
| Parameter    | Description                                                                      | Range          | Default   |
+==============+==================================================================================+================+===========+
| session-type | Define the requested BFD session type, Single-hop or Multi-hop. By default       | | automatic    | automatic |
|              | session type is according to BGP peering type                                    | | single-hop   |           |
|              |                                                                                  | | multi-hop    |           |
+--------------+----------------------------------------------------------------------------------+----------------+-----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# bfd-type single-hop

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# bfd-type enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# bfd-type multi-hop
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# bfd-type automatic


**Removing Configuration**

To revert the bfd-type to its default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no bfd-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### neighbor/bfd/bfd.rst

protocols bgp neighbor bfd
--------------------------

**Minimum user role:** operator

The command allows enabling BFD for the protection of a session between a single BGP neighbor or neighbor group and allows you to configure the BFD session settings.
The BFD session type (single-hop or multi-hop) is decided according to the BGP session type. The BFD source address is the BGP source address and the BFD destination address is the BGP peer address.

When a BFD session is down, the BGP session will close and all routes from the neighbor will be withdrawn.

The BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations.

Detection-time = negotiated-received-interval X received multiplier.
This is the maximum amount of time that can elapse without receiving a BFD control packet before the session is declared down.

BFD neighbor can signal session state down and upon receipt, the local BFD session will immediately switch to DOWN state.

To enable or disable the BFD protocol with a single neighbor or a neighbor group:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)#


**Removing Configuration**

To revert the BFD protocol to the default state:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bfd 

::

    dnRouter(cfg-protocols-bgp-group)# no bfd

::

    dnRouter(cfg-bgp-group-neighbor)# no bfd

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 11.4    | Command reintroduced |
+---------+----------------------+

---

### neighbor/bfd/min-rx.rst

protocols bgp neighbor bfd min-rx
---------------------------------

**Minimum user role:** operator

Set the desired minimum receive interval for the BFD session for a single neighbor or neighbor group:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | 300     |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# min-rx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-rx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-rx 400
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# min-rx 300


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no min-rx

::

    dnRouter(cfg-bgp-group-bfd)# no min-rx

::

    dnRouter(cfg-group-neighbor-bfd)# no min-rx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.4    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### neighbor/bfd/min-tx.rst

protocols bgp neighbor bfd min-tx
---------------------------------

**Minimum user role:** operator

Set the desired minimum transmit interval for the BFD session for a single neighbor or neighbor group:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

- Due to hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | 300     |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# min-tx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-tx 400
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# min-tx 400
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# min-tx 300


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no min-tx

::

    dnRouter(cfg-bgp-group-bfd)# no min-tx

::

    dnRouter(cfg-group-neighbor-bfd)# no min-tx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 11.4    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### neighbor/bfd/multiplier.rst

protocols bgp neighbor bfd multiplier
-------------------------------------

**Minimum user role:** operator

Set the local BFD multiplier for a single neighbor or neighbor group:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bfd
- protocols bgp neighbor-group bfd
- protocols bgp neighbor-group neighbor bfd
- network-services vrf instance protocols bgp neighbor bfd
- network-services vrf instance protocols bgp neighbor-group bfd
- network-services vrf instance protocols bgp neighbor-group neighbor bfd

**Note**

- This could be invoked inside a neighbor-group or as a single neighbor.

- Neighbors within a neighbor-group derive the neighbor-group configuration or can have a unique setting from the group.

- For neighbors within a neighbor-group, the default value is the group's parameter value.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bfd
    dnRouter(cfg-bgp-neighbor-bfd)# multiplier 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# multiplier 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 7018
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bfd
    dnRouter(cfg-bgp-group-bfd)# multiplier 2
    dnRouter(cfg-bgp-group-bfd)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# bfd
    dnRouter(cfg-group-neighbor-bfd)# multiplier 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-bgp-neighbor-bfd)# no multiplier

::

    dnRouter(cfg-bgp-group-bfd)# no multiplier

::

    dnRouter(cfg-group-neighbor-bfd)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### neighbor/bmp/activate-server.rst

protocols bgp neighbor bmp activate-server
------------------------------------------

**Minimum user role:** operator

To enable exporting bgp neighbor information to a bmp server:

**Command syntax: activate-server [server-id]** [, server-id, server-id]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bmp
- protocols bgp neighbor-group bmp
- protocols bgp neighbor-group neighbor bmp

**Note**

- The disabled option is only valid for a neighbor within a neighbor group. When configured, neighbor information is not exported to the bmp server, even if one is configured for the neighbor-group.

**Parameter table**

+-----------+-----------------------------------------------------------+-------+---------+
| Parameter | Description                                               | Range | Default |
+===========+===========================================================+=======+=========+
| server-id | Enable exporting bgp neighbor information to a bmp server | 1-5   | \-      |
+-----------+-----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-protocols-bgp-neighbor-bmp)# activate-server 1


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.2.2
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-protocols-bgp-neighbor-bmp)# activate-server 1, 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 1
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-protocols-bgp-group-bmp)# activate-server 1
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# bmp
    dnRouter(cfg-group-neighbor-bmp)# activate-server 1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group GROUP_1
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# activate-server 1, 2, 3
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp activate-server disabled


**Removing Configuration**

To remove the specific bmp server-id:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bmp activate-server

::

    dnRouter(cfg-protocols-bgp-group)# no bmp activate-server

::

    dnRouter(cfg-bgp-group-neighbor)# no bmp activate-server

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor/bmp/bmp.rst

protocols bgp neighbor bmp
--------------------------

**Minimum user role:** operator

The BGP Monitoring Protocol (BMP) allows you to send the BGP route information from the router to a monitoring application on a separate device. The monitoring application is referred to as the BMP monitoring station or BMP station. To deploy BMP in the network, you need to configure BMP on each router, from which you want to gather information, and at least one BMP station.

BGP BMP collects statistics data from the Adjacency-RIB-In routing tables and send that data periodically to a monitoring station, for further analysis.

Some of the use-cases for BMP include:

- Looking Glasses - IPv4, IPv6, and VPN prefixes.
- Route Analytics - Track convergence times, prefix history as they change over time, monitor and track BGP policy changes, etc...
- Traffic Engineering Analytics - Adapt dynamically to change, and know what is the best shift.
- BGP pre-policy - Pre-policy routing information provides insight into all path attributes from various points in the network, allowing non-intrusive what-if topology views for new policy validations.

**Command syntax: bmp**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-bgp-neighbor-bmp)#


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)#


    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-bgp-group-bmp-rm)#
    dnRouter(cfg-bgp-group-bmp-rm)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp
    dnRouter(cfg-group-neighbor-bmp)#


**Removing Configuration**

To return all bmp settings to the default:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no bmp

::

    dnRouter(cfg-protocols-bgp-group)# no bmp

::

    dnRouter(cfg-bgp-group-neighbor)# no bmp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor/bmp/route-monitoring/adj-in_post-policy.rst

protocols bgp neighbor bmp route-monitoring adj-in post-policy
--------------------------------------------------------------

**Minimum user role:** operator

Enable exporting BGP neighbor adjacency-in post-policy tables. The configuration applies to all BGP neighbor address-families.

**Command syntax: adj-in post-policy [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bmp route-monitoring
- protocols bgp neighbor-group bmp route-monitoring
- protocols bgp neighbor-group neighbor bmp route-monitoring

**Parameter table**

+-------------+--------------------------------+--------------+---------+
| Parameter   | Description                    | Range        | Default |
+=============+================================+==============+=========+
| admin-state | adjecenty in post policy table | | enabled    | \-      |
|             |                                | | disabled   |         |
+-------------+--------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in post-policy disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in post-policy enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in post-policy disabled
    dnRouter(cfg-group-bmp-rm)# exit
    dnRouter(cfg-bgp-group-bmp)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in post-policy enabled


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in post-policy

::

    dnRouter(cfg-group-bmp-rm)# no adj-in post-policy

::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in post-policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor/bmp/route-monitoring/adj-in_pre-policy.rst

protocols bgp neighbor bmp route-monitoring adj-in pre-policy
-------------------------------------------------------------

**Minimum user role:** operator

Enable exporting BGP neighbor adjacency-in pre-policy tables. The configuration applies to all BGP neighbor address-families.

**Command syntax: adj-in pre-policy [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bmp route-monitoring
- protocols bgp neighbor-group bmp route-monitoring
- protocols bgp neighbor-group neighbor bmp route-monitoring

**Note**

- Pre-policy information is exported only when a neighbor is enabled with "soft-reconfiguration inbound", which ensures that the neighbor pre-policy information is kept in BGP.

**Parameter table**

+-------------+-------------------------------+--------------+---------+
| Parameter   | Description                   | Range        | Default |
+=============+===============================+==============+=========+
| admin-state | adjecenty in pre policy table | | enabled    | \-      |
|             |                               | | disabled   |         |
+-------------+-------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in pre-policy disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in pre-policy enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp route-monitoring
    dnRouter(cfg-group-bmp-rm)# adj-in pre-policy disabled
    dnRouter(cfg-group-bmp-rm)# exit
    dnRouter(cfg-group-bmp)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)# adj-in pre-policy enabled


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in pre-policy

::

    dnRouter(cfg-group-bmp-rm)# no adj-in pre-policy

::

    dnRouter(cfg-neighbor-bmp-rm)# no adj-in pre-policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor/bmp/route-monitoring/route-monitoring.rst

protocols bgp neighbor bmp route-monitoring
-------------------------------------------

**Minimum user role:** operator

To enter the BMP server route-monitoring configuration level:

**Command syntax: route-monitoring**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor bmp
- protocols bgp neighbor-group bmp
- protocols bgp neighbor-group neighbor bmp

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# bmp
    dnRouter(cfg-bgp-neighbor-bmp)# route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# route-monitoring
    dnRouter(cfg-group-bmp-rm)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# bmp
    dnRouter(cfg-bgp-group-bmp)# route-monitoring
    dnRouter(cfg-group-bmp-rm)#
    dnRouter(cfg-bgp-group-bmp-rm)# exit
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.1.1.1
    dnRouter(cfg-bgp-group-neighbor)# bmp route-monitoring
    dnRouter(cfg-neighbor-bmp-rm)#


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-bgp-neighbor-bmp)# no route-monitoring

::

    dnRouter(cfg-bgp-group-bmp)# no route-monitoring

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### neighbor/cluster-id.rst

protocols bgp neighbor cluster-id
---------------------------------

**Minimum user role:** operator

You can use this command to specify a global cluster-id attribute when used as a route-reflector, or per neighbor-group or neighbor if specified explicitly.

Prior to reflecting a route, route reflectors append their cluster-id to the cluster list.

If two routers share the same BGP cluster ID, they belong to the same cluster.

**Command syntax: cluster-id [cluster-id]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor

**Parameter table**

+------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter  | Description                                                                      | Range            | Default |
+============+==================================================================================+==================+=========+
| cluster-id | route-reflector cluster id to use when local router is configured as a route     | | 1-4294967295   | \-      |
|            | reflector.                                                                       | | A.B.C.D        |         |
+------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# cluster-id 65.65.65.65

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65001
    dnRouter(cfg-protocols-bgp)# cluster-id 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65001
    dnRouter(cfg-protocols-bgp)# neighbor 1.1.1.1
    dnRouter(cfg-protocols-bgp-neighbor)# cluster-id 101

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# cluster-id 10.0.0.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# cluster-id 27081


**Removing Configuration**

To revert all BGP cluster-id to the default value:
::

    dnRouter(cfg-protocols-bgp)# no cluster-id

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 15.1    | Command introduced                                           |
+---------+--------------------------------------------------------------+
| 17.1    | Extended support for neighbor and neighbor-group hierarchies |
+---------+--------------------------------------------------------------+

---

### neighbor/connected-check.rst

protocols bgp neighbor connected-check
--------------------------------------

**Minimum user role:** operator

Typically in eBGP peering, a check is done to confirm that the neighbor is listed in the routing table as being directly connected. eBGP peering will not be attempted with a neighbor that is not directly connected. When the loopback interface is used for peering, then the IP address of the neighbor will not be listed as being directly connected and so peering will not be possible.

The following command instructs the BGP router whether or not to disable the connection verification check for eBGP peering sessions that are directly connected but are configured on a loopback interface or with a non-directly connected IP address.

**Command syntax: connected-check [connected-check]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The option to disable the check is required only when the neighbor ebgp-multihop command is configured with a TTL value of 1. See "bgp neighbor ebgp-multihop".

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| connected-check | disable the connection verification process for eBGP peering sessions that are   | | enabled    | enabled |
|                 | reachable by a single hop but are configured on a loopback interface or          | | disabled   |         |
|                 | otherwise configured with a non-directly connected IP address                    |              |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# connected-check disabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# connected-check disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# connected-check disabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# connected-check enabled


**Removing Configuration**

To remove the configuration:
::

    dnRouter(cfg-protocols-bgp-group)# no connected-check

::

    dnRouter(cfg-protocols-bgp-neighbor)# no connected-check

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/description.rst

protocols bgp neighbor description
----------------------------------

**Minimum user role:** operator

To set a description for the BGP neighbor, BGP peer group, or BGP neighbor within a peer group:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-------------+--------------------------+------------------+---------+
| Parameter   | Description              | Range            | Default |
+=============+==========================+==================+=========+
| description | a neighbors' description | | string         | \-      |
|             |                          | | length 1-255   |         |
+-------------+--------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# description my-description

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# description my-unique-description


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no description

::

    dnRouter(cfg-protocols-bgp-group)# no description

::

    dnRouter(cfg-bgp-group-neighbor)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/ebgp-multihop.rst

protocols bgp neighbor ebgp-multihop
------------------------------------

**Minimum user role:** operator

To configure a maximum number of hops to an eBGP neighbor, to an eBGP peer group, or to a neighbor within a peer group:

**Command syntax: ebgp-multihop [ebgp-multihop]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- If you set a value greater than 1, the neighbor will always be considered as an indirectly connected neighbor, regardless of the actual reachability.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter     | Description                                                                      | Range | Default |
+===============+==================================================================================+=======+=========+
| ebgp-multihop | set eBGP neighbors that are not on directly connected networks and sets an       | 1-255 | 1       |
|               | optional maximum hop count                                                       |       |         |
+---------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# ebgp-multihop

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# ebgp-multihop 20

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# ebgp-multihop 20

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# ebgp-multihop 16


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ebgp-multihop

::

    dnRouter(cfg-protocols-bgp-group)# no ebgp-multihop

::

    dnRouter(cfg-bgp-group-neighbor)# no ebgp-multihop

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/graceful-restart.rst

protocols bgp neighbor graceful-restart
---------------------------------------

**Minimum user role:** operator

To configure the BGP graceful restart capability for a specific neighbor, a peer group, or for a neighbor in a peer group:

**Command syntax: graceful-restart [graceful-restart-admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- When bgp graceful-restart is disabled, no graceful-restart is done regardless of the bgp neighbor graceful-restart state.

- Disabled: disables graceful-restart for the neighbor.

**Parameter table**

+------------------------------+------------------------------------------+-----------------+---------+
| Parameter                    | Description                              | Range           | Default |
+==============================+==========================================+=================+=========+
| graceful-restart-admin-state | global graceful-restart capability state | | enabled       | enabled |
|                              |                                          | | disabled      |         |
|                              |                                          | | helper-only   |         |
+------------------------------+------------------------------------------+-----------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001:3::65
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart helper-only

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001:3::65
    dnRouter(cfg-protocols-bgp-neighbor)# graceful-restart disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# graceful-restart enabled
    dnRouter(cfg-protocols-bgp-group)# graceful-restart helper-only
    dnRouter(cfg-protocols-bgp-group)# graceful-restart disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no graceful-restart

::

    dnRouter(cfg-protocols-bgp-group)# no graceful-restart

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/local-as_type.rst

protocols bgp neighbor local-as
-------------------------------

**Minimum user role:** operator

If, for whatever reason, you need to change the AS number of your network, you will need to reconfigure the AS number on all the BGP peers. By specifying an alternate AS for this BGP process when interacting with the specified peer, you allow the peer to appear to simultaneously belong to both the former AS and the new AS, without changing the peering arrangements.

To configure a local AS number for the neighbor:

**Command syntax: local-as [local-as-number]** type [as-path-prepend-type]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group

**Note**

- This command is relevant to BGP peers only.

- The configuration will reset the BGP session.

- The local-as-number must be different from the router AS.

- When changing the local-as-number, the as-path-prepend-type will return to the default value.

- When the local-as-number is identical to the neighbor AS, you cannot configure the as-path-prepend-type

**Parameter table**

+----------------------+----------------------------------------------------------------------------------+---------------------------+---------+
| Parameter            | Description                                                                      | Range                     | Default |
+======================+==================================================================================+===========================+=========+
| local-as-number      | as-number for peer session, must be different from local-AS and peer-AS          | 1-4294967295              | \-      |
+----------------------+----------------------------------------------------------------------------------+---------------------------+---------+
| as-path-prepend-type | prepend type for as-path when adding local-as perpend - default config. prepend  | | prepend                 | prepend |
|                      | the local-as as well as the bgp as-n no-perpend - the supplied local-as is not   | | no-prepend              |         |
|                      | prepended to the received as-path no-prepend-replace-as - only the supplied      | | no-prepend-replace-as   |         |
|                      | local-as is prepended to the as-path when transmitting local-route updates to    |                           |         |
|                      | this peer                                                                        |                           |         |
+----------------------+----------------------------------------------------------------------------------+---------------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# local-as 1000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# local-as 1000 type no-prepend

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# local-as 1000 type no-prepend-replace-as

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 8000
    dnRouter(cfg-protocols-bgp-neighbor)# local-as 8000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 65001
    dnRouter(cfg-protocols-bgp-group)# local-as 65001


**Removing Configuration**

To delete the local AS configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no local-as

::

    dnRouter(cfg-protocols-bgp-group)# no local-as

**Command History**

+---------+---------------------------------+
| Release | Modification                    |
+=========+=================================+
| 6.0     | Command introduced              |
+---------+---------------------------------+
| 11.0    | Removed "type" from the syntax. |
+---------+---------------------------------+

---

### neighbor/min-hold-time.rst

protocols bgp neighbor minimum-hold-time
----------------------------------------

**Minimum user role:** operator

To adjust the threshold for minimum-hold-time:

**Command syntax: minimum-hold-time [minimum-hold-time]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group

**Note**

- The value of the set minimum-hold-time must be less or equal to the hold-time set value.

**Parameter table**

+-------------------+-------------------+---------+---------+
| Parameter         | Description       | Range   | Default |
+===================+===================+=========+=========+
| minimum-hold-time | minimum-hold-time | 3-65535 | 3       |
+-------------------+-------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# minimum-hold-time 7

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# minimum-hold-time 11


**Removing Configuration**

To revert minimum-hold-time value to their default values:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no minimum-hold-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### neighbor/neighbor.rst

protocols bgp neighbor
----------------------

**Minimum user role:** operator

When configuring a BGP neighbor, you must first define it using one of the following commands.

To define a BGP neighbor and enter its configuration mode:

When configuring neighbors within a peer group, the neighbors inherit the settings from the group.

**Command syntax: neighbor [neighbor-ip-address]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp
- network-services vrf instance protocols bgp neighbor-group

**Note**

- Notice the change in prompt.

- When configuring neighbors within a peer group, the neighbors inherit the settings from the group.

**Parameter table**

+---------------------+-------------------------------------------------+--------------+---------+
| Parameter           | Description                                     | Range        | Default |
+=====================+=================================================+==============+=========+
| neighbor-ip-address | Address of the BGP peer, either in IPv4 or IPv6 | | A.B.C.D    | \-      |
|                     |                                                 | | X:X::X:X   |         |
+---------------------+-------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 2001::66
    dnRouter(cfg-bgp-group-neighbor)#


**Removing Configuration**

To remove a neighbor:
::

    dnRouter(cfg-protocols-bgp)# no neighbor 12.170.4.1

To remove a neighbor from the group:
::

    dnRouter(cfg-protocols-bgp-group)# no neighbor 2001::66

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/override-capability.rst

protocols bgp neighbor override-capability
------------------------------------------

**Minimum user role:** operator

This command instructs the BGP router whether or not to establish a peering session with a neighbor that does not support capability negotiation, neighbors that are members of a peer group, or with a neighbor in a peer group. To configure this option:

**Command syntax: override-capability [override-capability]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command cannot be enabled with the strict-capability-match configuration. See "bgp neighbor strict-capability-match"

**Parameter table**

+---------------------+---------------------------------------------------+--------------+----------+
| Parameter           | Description                                       | Range        | Default  |
+=====================+===================================================+==============+==========+
| override-capability | allow peer session without capability negotiation | | enabled    | disabled |
|                     |                                                   | | disabled   |          |
+---------------------+---------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# override-capability enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# override-capability disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match disabled
    dnRouter(cfg-bgp-group-neighbor)# override-capability enabled


**Removing Configuration**

To remove this configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no override-capability 

::

    dnRouter(cfg-protocols-bgp-group)# no override-capability

::

    dnRouter(cfg-bgp-group-neighbor)# no override-capability

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/passive.rst

protocols bgp neighbor passive
------------------------------

**Minimum user role:** operator

In passive mode, the router will not initiate open messages to the peer. It will wait for the peer to issue an open request before a message is sent. To configure passive mode for a neighbor, peer group, or a neighbor in a peer group:

**Command syntax: passive [passive]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------+----------------------------------------------------------------------------+--------------+----------+
| Parameter | Description                                                                | Range        | Default  |
+===========+============================================================================+==============+==========+
| passive   | Configure the router so that active open messages are not sent to the peer | | enabled    | disabled |
|           |                                                                            | | disabled   |          |
+-----------+----------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# passive enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# passive enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 12.170.4.1
    dnRouter(cfg-bgp-group-neighbor)# passive disabled


**Removing Configuration**

To remove passive mode:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no passive

::

    dnRouter(cfg-protocols-bgp-group)# no passive

::

    dnRouter(cfg-bgp-group-neighbor)# no passive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/remote-as.rst

protocols bgp neighbor remote-as
--------------------------------

**Minimum user role:** operator

The neighbor (not under neighbor-group) must be configured with remote-as.
For neighbor-groups:
A group can be configured with or without remote-as. If the group is not configured with remote-as, it is mandatory for each of the neighbors under the group to have remote-as.
The group and the neighbor remote-as must be from the same type, meaning iBGP, eBGP or Confederation.

To configure the remote AS number for the neighbor or peer group:

**Command syntax: remote-as [remote-as]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The AS number of the neighbor. BGP uses the AS number for identifying the BGP connection as internal (iBGP) or external (eBGP).

**Parameter table**

+-----------+------------------------+--------------+---------+
| Parameter | Description            | Range        | Default |
+===========+========================+==============+=========+
| remote-as | AS number of the peer. | 1-4294967295 | \-      |
+-----------+------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# remote-as 5000

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# remote-as 5000
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# neighbor 1.2.3.4
    dnRouter(cfg-bgp-group-neighbor)# remote-as 123


**Removing Configuration**

It is not possible to delete the remote-as of a neighbor or group. You need to remove the neighbor or the group. You can change the assigned remote-as.
::


**Command History**

+---------+--------------------------------------------------+
| Release | Modification                                     |
+=========+==================================================+
| 6.0     | Command introduced                               |
+---------+--------------------------------------------------+
| 18.0    | Added remote-as under neighbor of neighbor-group |
+---------+--------------------------------------------------+

---

### neighbor/strict-capability-match.rst

protocols bgp neighbor strict-capability-match
----------------------------------------------

**Minimum user role:** operator

This command directs the router to strictly match remote capabilities and local capabilities. If the capabilities are different, the router will issue an "Unsupported Capability" error and will reset the connection.

To set strict capability match:

**Command syntax: strict-capability-match [strict-capability-match]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

- This command cannot be set together with the override-capability configuration. See "bgp neighbor override-capability"

**Parameter table**

+-------------------------+--------------------------------------------------------------+--------------+----------+
| Parameter               | Description                                                  | Range        | Default  |
+=========================+==============================================================+==============+==========+
| strict-capability-match | Strictly compares remote capabilities and local capabilities | | enabled    | disabled |
|                         |                                                              | | disabled   |          |
+-------------------------+--------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# strict-capability-match enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# strict-capability-match enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# override-capability enabled
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# override-capability disabled
    dnRouter(cfg-bgp-group-neighbor)# strict-capability-match enabled


**Removing Configuration**

To remove the strict capability match configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no strict-capability-match

::

    dnRouter(cfg-bgp-group-neighbor)# no strict-capability-match

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/timers.rst

protocols bgp neighbor timers
-----------------------------

**Minimum user role:** operator

To adjust the interval at which BGP keep-alive and hold-time messages are sent to the neighbor or peer group:

**Command syntax: timers {keep-alive [keep-alive-timer], hold-time [hold-time-timer]}**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group

**Note**

- Setting the timer value to 0 disables the timer.

**Parameter table**

+------------------+------------------+------------+---------+
| Parameter        | Description      | Range      | Default |
+==================+==================+============+=========+
| keep-alive-timer | keep-alive-timer | 0-65535    | 60      |
+------------------+------------------+------------+---------+
| hold-time-timer  | hold-time-timer  | 0, 3-65535 | 180     |
+------------------+------------------+------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# timers keep-alive 30 hold-time 90

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# timers hold-time 100

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# timers hold-time 400 keep-alive 100


**Removing Configuration**

To revert all timers to their default values:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no timers

To revert the specified timer to its default value:
::

    dnRouter(cfg-protocols-bgp-group)# no timers keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/ttl-security.rst

protocols bgp neighbor ttl-security
-----------------------------------

**Minimum user role:** operator

Imposes ebgp ttl security per rfc5082.
When ttl-security is set for an EBGP neighbor, the following is expected for the given neighbor bgp IP/TCP session:
- Any egress packet is set with TTL 255.
- Any ingress packet is checked for TTL validity. Only packets with a TTL greater or equal to min-ttl are accepted, otherwise dropped.

The default system behavior is min-ttl = 255, imposing that eBGP neighbor must be directly connected (one hop apart).

The user may impose a different min-ttl value to support the eBGP neighbors that are not directly connected.
If min-ttl = 255 the ttl-security keeps assumption of the eBGP neighbor being directly connected, regardless of the min-ttl value, as such:
- The neighbor address is expected to be a connected route.
- The egress interface is imposed per the neighbor address.
- In case BFD is requested, a single-hop BFD session is requested (unless a specific BFD-type is set).
In case min-ttl < 255 MH-EBGP the session is assumed resulting:
- An update-source is required.
- The neighbor address is not bound to be a connected route.
- The egress interface is selected per the neighbor address routing solution.
- In case BFD is requested, a multi-hop BFD session is requested (unless specific BFD-type is set).

**Command syntax: ttl-security [admin-state]** min-ttl [min-ttl]

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- The expected behavior is that both the BGP session sides are configured with ttl-security.

- The configuration is valid only for eBGP neighbors. Commit validation is required (same as impose for eBGP-multihop).

- Configuration is only possible with eBGP-multihop = 1. Commit validation is required.

- Applies for both IPv4 neighbors and IPv6 neighbors. The hop-count is handled instead of TTL for IPv6.

- When applied on a group, this property is inherited by all the group members. Applying this property on a neighbor within a group overrides the group setting.

- Neighbors within a neighbor-group derive the neighbor-group configuration (i.e has no default config) or can have a unique setting from the group.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enable ttl security for a given eBGP neighbor                                    | | enabled    | disabled |
|             |                                                                                  | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+
| min-ttl     | Allow received ttl lower than 255, the allowed received ttl will be              | 1-255        | 255      |
|             | greater-equal to (255-range)                                                     |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# ttl-security enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP_GROUP
    dnRouter(cfg-protocols-bgp-group)# ttl-security enabled min-ttl 254

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP_GROUP
    dnRouter(cfg-protocols-bgp-group)# ttl-security enabled min-ttl 252
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-protocols-bgp-neighbor)# ttl-security enabled min-ttl 255


**Removing Configuration**

To revert configuration to default behavior the configuration:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ttl-security

To revert min-ttl to default behavior
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ttl-security enabled min-ttl 255

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### neighbor/update-source.rst

protocols bgp neighbor update-source
------------------------------------

**Minimum user role:** operator

The update-source parameter is a mandatory configuration for every multihop BGP session. This includes both iBGP and MH-eBGP.

To specify the source address to use for the BGP session to a neighbor, peer group, or neighbor within the peer group:

**Command syntax: update-source [source-address]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- Changing the configuration will cause the BGP session to restart.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                                      | Range | Default |
+================+==================================================================================+=======+=========+
| source-address | specify the source address to use for the BGP session to this neighbor Can       | \-    | \-      |
|                | either be an ipv4|6-address or a loopback interface name when using loopback     |       |         |
|                | interface name, bgp uses the lo ip address                                       |       |         |
+----------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# update-source lo0

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# update-source 1.1.1.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source 100.70.1.45

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source 2001:2::65

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source lo1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source ge100-1/2/1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source bundle-2

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 2001::66
    dnRouter(cfg-protocols-bgp-neighbor)# update-source bundle-1.1

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# update-source 2001:2::65
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# update-source 1.1.1.1


**Removing Configuration**

To revert the source address to the default value (the BGP router-id):
::

    dnRouter(cfg-protocols-bgp-neighbor)# no update-source

::

    dnRouter(cfg-protocols-bgp-group)# no update-source

::

    dnRouter(cfg-bgp-group-neighbor)# no update-source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### neighbor/weight.rst

protocols bgp neighbor weight
-----------------------------

**Minimum user role:** operator

To specify a weight that the BGP router will add to routes that are received from the specified BGP neighbor, BGP peer group, or BGP neighbor in a peer group:

**Command syntax: weight [weight]**

**Command mode:** config

**Hierarchies**

- protocols bgp neighbor
- protocols bgp neighbor-group
- protocols bgp neighbor-group neighbor
- network-services vrf instance protocols bgp neighbor
- network-services vrf instance protocols bgp neighbor-group
- network-services vrf instance protocols bgp neighbor-group neighbor

**Note**

- To apply new neighbor weight settings, restart the bgp neighbor session. A user can invoke clear soft to avoid any traffic impact.

- When applied on a group, this property is inherited by all group members. Applying this property on a neighbor within a group overrides the group setting.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| weight    | Specifies a weight that the device will add to routes that are received from the | 0-65535 | 0       |
|           | specified BGP neighbor.                                                          |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor 12.170.4.1
    dnRouter(cfg-protocols-bgp-neighbor)# weight 50

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# weight 10

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# neighbor-group BGP6:pe2ce:internet
    dnRouter(cfg-protocols-bgp-group)# weight 10
    dnRouter(cfg-protocols-bgp-group)# neighbor 30:128::107
    dnRouter(cfg-bgp-group-neighbor)# weight 50


**Removing Configuration**

To revert to the default weight value:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no weight

::

    dnRouter(cfg-protocols-bgp-group)# no weight

::

    dnRouter(cfg-bgp-group-neighbor)# no weight

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### network_import-check.rst

protocols bgp network import-check
----------------------------------

**Minimum user role:** operator

This command instructs the BGP process to validate that the BGP route exists in the routing table (RIB) before injecting it into BGP and advertising it to the BGP neighbors.

**Command syntax: network import-check [network-import-check]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Parameter table**

+----------------------+---------------------------------------+--------------+---------+
| Parameter            | Description                           | Range        | Default |
+======================+=======================================+==============+=========+
| network-import-check | Check BGP network route exists in IGP | | enabled    | enabled |
|                      |                                       | | disabled   |         |
+----------------------+---------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# network import-check disabled


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-bgp)# no network import-check

**Command History**

+---------+--------------------------------------------+
| Release | Modification                               |
+=========+============================================+
| 6.0     | Command introduced                         |
+---------+--------------------------------------------+
| 9.0     | Added Enabled/Disabled value to the syntax |
+---------+--------------------------------------------+

---

### nexthop-trigger-delay.rst

protocols bgp nexthop-trigger-delay
-----------------------------------

**Minimum user role:** operator

If BGP reacts prematurely to IGP updates, traffic may be lost. This command allows you to set a delay in BGP's reaction to IGP updates when IGP convergence is slow.

You can change the delay interval for triggering next-hop calculations when a next-hop address tracking event occurs.

To set the delay:

**Command syntax: nexthop-trigger-delay [nexthop-trigger-delay]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- Setting the delay to 0 disables the delay.

**Parameter table**

+-----------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter             | Description                                                                      | Range | Default |
+=======================+==================================================================================+=======+=========+
| nexthop-trigger-delay | Change the delay interval that will trigger the scheduling of next-hop-tracking  | 0-100 | 5       |
|                       | feature                                                                          |       |         |
+-----------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# nexthop-trigger-delay 3


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-bgp)# no nexthop-trigger-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### protocols bgp overview.rst

BGP Overview
-------------

Border Gateway Protocol (BGP) is the main routing protocol for exchanging routing and reachability information among autonomous systems. BGP is also used for routing within an AS. An external BGP (E-BGP) is used to exchange routing information between ASs and internal BGP (I-BGP) is used to distribute learned routes within an AS.

To prevent looping of routing information within an AS, routes learned from an I-BGP peer are not redistributed to other I-BGP peers. Therefore, every I-BGP router in an AS must establish a BGP session with all other I-BGP peers in the AS, creating a full BGP mesh, as shown in the following image.

<INSERT 02_protocols_bgp>

To prevent looping of routing information between ASs, E-BGP peers do not redistribute information received from within their AS. Routes received via I-BGP are not stored in the RIB.

BGP neighbors (peers) are established using manual configuration commands (static peers) and they communicate through a TCP session.

During established BGP sessions, routers exchange update messages about the destinations to which they offer connectivity. The route description includes the destination prefix, prefix length, autonomous systems in the path, the next hop, and information that affects the acceptance policy of the receiving router. Update messages also list destinations to which the router no longer offers connectivity.
---

### route-reflection-policy-out-attribute-change.rst

protocols bgp route-reflection policy-out attribute-change
----------------------------------------------------------

**Minimum user role:** operator

Support modification of the following BGP path attributes by the policy out when acting as a Route-reflector:

NEXT_HOP
AS_PATH
LOCAL_PREF
MED

By default, per RFC4456#10, when acting as a Route-Reflector, for iBGP advertisement, DNOS will not apply any modification for the attributes provided above if the path is an iBGP path. Even if it was explicitly required by the neighbor policy out.
By default, per RFC4456#10, when acting as a Route-Reflector for iBGP advertisement, DNOS will not apply any modification for the attributes provided above if the path is an iBGP path. Even if it was explicitly required by the neighbor policy out.

To enable route-reflector policy-out attribute-change:


**Command syntax: route-reflection policy-out attribute-change [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**
- "Supported for default VRF and non-default VRF"
- "The behavior will apply for any neighbor there is a case of route reflection for and any address-family.
- "Configuration can co-exist with the self-force option of policy set ipv4 next-hop / policy set ipv6 next-hop.
-- When the route-reflector policy-out attribute-change is enabled, the any next-hop modification option of policy set ipv4 next-hop / policy set ipv6 next-hop is imposed.
-- When the route-reflector policy-out attribute-change is disabled (default), only self-force) the next-hop modification option of policy set ipv4 next-hop / policy set ipv6 next-hop is imposed when the reflecting routes act as the route-reflector.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Support modification of NEXT_HOP, AS_PATH, LOCAL_PREF and MED path attributes by | | enabled    | disabled |
|             | policy out when reflecting paths as Route-reflector                              | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# route-reflection policy-out attribute-change enabled


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-protocols-bgp)# no route-reflection policy-out attribute-change

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### router-id.rst

protocols bgp router-id
-----------------------

**Minimum user role:** operator

To set the router-ID of the BGP process:

**Command syntax: router-id [router-id]**

**Command mode:** config

**Hierarchies**

- protocols bgp
- network-services vrf instance protocols bgp

**Note**

- Changing the router-id will cause all BGP sessions to restart.

- When using OSPFv3 or IPv6-based BGP peering within a routing instance, you must explicitly configure a router ID (router-id) for that specific instance. The main routing instance's router ID is not inherited by other instances. Even if only IPv6 protocols are used, a 32-bit router ID is still required, as IPv6 routing protocols rely on it for establishing adjacencies. The router ID must be a non-zero 32-bit (4-octet) unsigned integer. While it's common to use an IPv4 address as the router ID, this is not mandatory - it doesnt need to be a valid or routable address, just a unique 32-bit value within the routing domain. Failing to configure a router ID in an IPv6 OSPF or BGP instance will result in the protocol defaulting to 0.0.0.0, which is invalid. This will prevent adjacency formation and BGP session establishment.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| router-id | Router id of the router - an unsigned 32-bit integer expressed in dotted quad    | A.B.C.D | \-      |
|           | notation. By default - the ipv4 address of lo0 interface                         |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp 65000
    dnRouter(cfg-protocols-bgp)# router-id 100.70.1.45


**Removing Configuration**

To revert the router-id to default:
::

    dnRouter(cfg-protocols-bgp)# no router-id

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---


## SECTION 2.C: DHCP

Files in this section: 2

### class-of-service.rst

protocols dhcp class-of-service
-------------------------------

**Minimum user role:** operator

With class of service (CoS) you can classify traffic to provide different service levels to different traffic so that when congestion occurs, you can control which packets receive priority.

To configure the DSCP value for all locally generated DHCP packets:

**Command syntax: class-of-service [dscp]**

**Command mode:** config

**Hierarchies**

- protocols dhcp

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| dscp      | The DSCP value that is used in the DHCP packet to classify it and give it a      | 0-56  | 48      |
|           | priority.                                                                        |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# dhcp
    dnRouter(cfg-protocols-dhcp)# class-of-service 16


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-dhcp)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| TBD     | Command introduced |
+---------+--------------------+

---

### dhcp.rst

protocols dhcp
--------------

**Minimum user role:** operator

To configure the DHCP process and enter DHCP configuration mode:

**Command syntax: dhcp**

**Command mode:** config

**Hierarchies**

- protocols

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# dhcp
    dnRouter(cfg-protocols-dhcp)#


**Removing Configuration**

To revert to the default configuration of the DHCP protocol:
::

    dnRouter(cfg-protocols)# no dhcp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---


## SECTION 2.D: IGMP

Files in this section: 2

### class-of-service.rst

protocols igmp class-of-service
-------------------------------

**Minimum user role:** operator

You can use the following command to set the DSCP value for outgoing IGMP Mtrace packets class of service.

**Command syntax: class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols igmp

**Note**
- IPP is set according to the DSCP value for outgoing packets, for example, DSCP 48 is mapped to 6.

**Parameter table**

+------------------+-------------------------------+-------+---------+
| Parameter        | Description                   | Range | Default |
+==================+===============================+=======+=========+
| class-of-service | IGMP packets class of service | 0-56  | 48      |
+------------------+-------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# igmp
    dnRouter(cfg-protocols-igmp)# class-of-service 50


**Removing Configuration**

To return the dscp-value to the default:
::

    dnRouter(cfg-protocols-igmp)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### igmp.rst

protocols igmp
--------------

**Minimum user role:** operator

To start the IGMP process:

**Command syntax: igmp**

**Command mode:** config

**Hierarchies**

- protocols

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# igmp
    dnRouter(cfg-protocols-igmp)#


**Removing Configuration**

To disable the igmp process:
::

    dnRouter(cfg-protocols)# no igmp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---


## SECTION 2.E: ISIS

Files in this section: 267

### graceful-restart.rst

protocols isis graceful-restart
-------------------------------

**Minimum user role:** operator

Typically when a router restarts, all its peers detect that the device is not available and update their routing tables accordingly. To avoid routing flaps, graceful restart maintains the data-path behavior for a grace period to allow the device to restart. In this way, graceful restart allows the device to restart with minimal effect on the network. When enabled, the restarting routing device is not removed from the network topology during the restart period and the adjacencies are reestablished after restart is complete.

All graceful restart parameter values must be identical for all IS-IS instances.

To configure graceful restart:

**Command syntax: graceful-restart [admin-state]** grace-interval [grace-interval] helper [helper-state]

**Command mode:** config

**Hierarchies**

- protocols isis

**Parameter table**

+----------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter      | Description                                                                      | Range        | Default  |
+================+==================================================================================+==============+==========+
| admin-state    | The administrative state of the graceful restart feature.                        | | enabled    | disabled |
|                |                                                                                  | | disabled   |          |
+----------------+----------------------------------------------------------------------------------+--------------+----------+
| grace-interval | Specifies how long (in seconds) the restarting device and its helpers continue   | 5-600        | 120      |
|                | to forward packets without disrupting network performance.                       |              |          |
+----------------+----------------------------------------------------------------------------------+--------------+----------+
| helper-state   | The administrative state of the graceful restart capability on the helper        | | enabled    | enabled  |
|                | device.                                                                          | | disabled   |          |
+----------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# graceful-restart disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# graceful-restart enabled
    dnRouter(cfg-protocols-isis)# graceful-restart enabled grace-interval 500 helper enabled
    dnRouter(cfg-protocols-isis)# graceful-restart enabled helper disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# graceful-restart disabled
    dnRouter(cfg-protocols-isis)# graceful-restart disabled grace-interval 500 helper enabled
    dnRouter(cfg-protocols-isis)# graceful-restart disabled helper disabled


**Removing Configuration**

To revert all graceful restart parameters to their default values:
::

    dnRouter(cfg-protocols-isis)# no graceful-restart

To revert the helper capability to the default state:
::

    dnRouter(cfg-protocols-isis)# no graceful-restart disabled helper

To revert the grace-interval to the default value:
::

    dnRouter(cfg-protocols-isis)# no graceful-restart enabled grace-interval

**Command History**

+---------+----------------------------------------------------------------------+
| Release | Modification                                                         |
+=========+======================================================================+
| 6.0     | Command introduced                                                   |
+---------+----------------------------------------------------------------------+
| 9.0     | Changed default admin-state and helper-state, changed interval range |
+---------+----------------------------------------------------------------------+
| 10.0    | Removed requirement to specify admin-state in "no" commands          |
+---------+----------------------------------------------------------------------+

---

### instance/admin-state.rst

protocols isis instance admin-state
-----------------------------------

**Minimum user role:** operator

Setting an IS-IS instance to disable mode. The IS-IS instance will not send or receive IS-IS packets.

To set the IS-IS instance disable mode:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+-------------+--------------------------------------+--------------+---------+
| Parameter   | Description                          | Range        | Default |
+=============+======================================+==============+=========+
| admin-state | Administratively set the IS-IS state | | enabled    | enabled |
|             |                                      | | disabled   |         |
+-------------+--------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-isis-inst)# no admin-state disabled

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/administrative-distance.rst

protocols isis instance administrative-distance
-----------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

The administrative distance must be different for all IS-IS instances. The default value is configured for the first IS-IS instance only. For all other instances, you must configure it manually.

To configure the administrative distance for IS-IS:


**Command syntax: administrative-distance [admin-distance]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- When reconfiguring the administrative-distance, clear the IS-IS routes using the "run clear isis routes" command.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                                      | Range | Default |
+================+==================================================================================+=======+=========+
| admin-distance | Sets the administrative distance for IS-IS. A value of 255 will cause the router | 1-255 | 115     |
|                | to remove the route from the forwarding table.                                   |       |         |
+----------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# administrative-distance 90


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no administrative-distance

**Command History**

+---------+---------------------------------------+
| Release | Modification                          |
+=========+=======================================+
| 6.0     | Command introduced                    |
+---------+---------------------------------------+
| 9.0     | Removed filtering for external routes |
+---------+---------------------------------------+
| 10.0    | Added rules for multiple instances    |
+---------+---------------------------------------+

---

### instance/advertise-max-metric.rst

protocols isis instance advertise max-metric
--------------------------------------------

**Minimum user role:** operator

The advertise max-metric command enables to administratively set IS-IS to advertise the maximum metric value for for all instance links to the value of the configured max-metric. When the value is set to 16777214 it will be considered as the least preferable in path calculations (but may still be chosen). When the value is set to 16777215 the router will be excluded from path calculations.

To advertise a max-metric value:


**Command syntax: advertise max-metric [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- The behavior is independent of the IS-IS overload behavior. max-metric will be advertised as long as the configuration is enabled.

- Metric-style must be set to "wide".

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Administrative setting IS-IS to advertise a max-metric value. See "isis instance | | enabled    | disabled |
|             | max-metric"                                                                      | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# advertise max-metric enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no advertise max-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### instance/advertise-overload-bit.rst

protocols isis instance advertise overload-bit
----------------------------------------------

**Minimum user role:** operator

Administratively set IS-IS to advertise the overload bit. By setting the overload bit in its LSPs, the IS router signals other routers not to use it as an intermediate hop in their SPF calculations.

To administratively advertise the overload bit:


**Command syntax: advertise overload-bit [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- This option is disabled by default and is only supported if metric-style is "wide".

- The behavior is independent of the IS-IS overload behavior. The overload-bit will be advertised as long as the configuration is enabled.

**Parameter table**

+-------------+---------------------------------------------+--------------+----------+
| Parameter   | Description                                 | Range        | Default  |
+=============+=============================================+==============+==========+
| admin-state | Administratively advertise the overload bit | | enabled    | disabled |
|             |                                             | | disabled   |          |
+-------------+---------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# advertise overload-bit enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no advertise overload-bit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### instance/authentication_keychain-invalid-action.rst

protocols isis instance authentication keychain-invalid-action
--------------------------------------------------------------

**Minimum user role:** operator

Set the default action for the system to take with regard to transmission of Hello, LSP and SNP packets when there are no active send keys in the associated keychains (no valid keys or a default send key set).

To set the system behavior when there is no active send key:

**Command syntax: authentication keychain-invalid-action [action]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------------------+----------------------+
| Parameter | Description                                                                      | Range                    | Default              |
+===========+==================================================================================+==========================+======================+
| action    | The system behavior for handling the transmission of Hello, LSP and SNP packets  | | send-unauthenticated   | send-unauthenticated |
|           | when the associated keychain does not have any valid send key or a default send  | | discard                |                      |
|           | key.                                                                             |                          |                      |
+-----------+----------------------------------------------------------------------------------+--------------------------+----------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication keychain-invalid-action discard


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication keychain-invalid-action

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/authentication-level-1_keychain.rst

protocols isis instance authentication level level-1 type keychain
------------------------------------------------------------------

**Minimum user role:** operator

LSP packets are not authenticated by default. You can configure authentication for LSP and SNP packets, so that unauthenticated packets will be dropped.

To configure authentication:


**Command syntax: authentication level level-1 type keychain [keychain-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+---------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter     | Description                                                                      | Range            | Default |
+===============+==================================================================================+==================+=========+
| keychain-name | Reference to the keychain that should be used for authenticating IS-IS packets - | | string         | \-      |
|               | the keychain may contain either a simple password, or HMAC-MD5 key that is used  | | length 1-255   |         |
|               | for authenticating CSNP, PSNP and LSP packets within the specified IS-IS level.  |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-1 type keychain ISIS-keys


**Removing Configuration**

To stop authentication for a specific level:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication level level-1

**Command History**

+---------+--------------------------------------------+
| Release | Modification                               |
+=========+============================================+
| 9.0     | Command introduced                         |
+---------+--------------------------------------------+
| 10.0    | Removed "no authentication" for all levels |
+---------+--------------------------------------------+
| 25.2    | Added support for keychains                |
+---------+--------------------------------------------+

---

### instance/authentication-level-1-impose-poi.rst

protocols isis instance authentication level level-1 impose-poi
---------------------------------------------------------------

**Minimum user role:** operator

ISIS Purge Originator Identification (POI) tlv should be imposed on purge LSPs with care when using LSP authentication.
Per RFC-6232 and RFC-6233 POI should be used with LSP authentication, only when the entire network supports POI, otherwise routers may reject the received purge with poi tlv within it
To control if to impose and add poi for authenticated purge lsps:


**Command syntax: authentication level level-1 impose-poi [impose-poi]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**
* By default local system accept purge with poi regardless if authentication is enabled or not, and regardless of 'impose-poi' settings. 
* 'impose-poi enabled' has no functional effect if authentication is not enabled
* Reconfiguration of 'impose-poi' effect only new transmitted purge
* Support regardless of authentication type

**Parameter table**

+------------+---------------------------------------------------------------------+--------------+----------+
| Parameter  | Description                                                         | Range        | Default  |
+============+=====================================================================+==============+==========+
| impose-poi | Add Purge Originator Identification TLV for authenticated purge LSP | | enabled    | disabled |
|            |                                                                     | | disabled   |          |
+------------+---------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level-2 impose-poi enabled

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-1 impose-poi disabled


**Removing Configuration**

To revert impose-poi to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication level level-2 impose-poi

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/authentication-level-1-snp-auth.rst

protocols isis instance authentication level level-1 snp-auth
-------------------------------------------------------------

**Minimum user role:** operator

SNP packets are not authenticated by default. You can enable SNP packet authentication, so that unauthenticated packets will be dropped.

To configure authentication:


**Command syntax: authentication level level-1 snp-auth [snp-auth]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**
- SNP packet authentication is only possible if IS-IS authentication for LSP packets is enabled for the same level.


**Parameter table**

+-----------+--------------------------------------------+---------------------------------------------------------------------------------+----------+
| Parameter | Description                                | Range                                                                           | Default  |
+===========+============================================+=================================================================================+==========+
| snp-auth  | Set the authentication mode of SNP packets | | disabled - no SNP authentication                                              | disabled |
|           |                                            | | sign - only sign outgoing SNP packets                                         |          |
|           |                                            | | sign-validate - sign outgoing SNP packets and validate incoming SNP packets   |          |
+-----------+--------------------------------------------+---------------------------------------------------------------------------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level-2 snp-auth sign

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-1 snp-auth sign-validate

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-2 snp-auth sign-validate


**Removing Configuration**

To revert SNP-auth to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication level level-2 snp-auth
    dnRouter(cfg-protocols-isis-inst)# no authentication level level-1 snp-auth

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 9.0     | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/authentication-level-1.rst

protocols isis instance authentication level level-1 type password
------------------------------------------------------------------

**Minimum user role:** operator

LSP packets are not authenticated by default. You can configure authentication for LSP and NSP packets, so that unauthenticated packets will be dropped.

To configure authentication:


**Command syntax: authentication level level-1 type [type] password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**
- When typing a clear password, the password **won't** be displayed in the CLI terminal.
- A clear password length cannot exceed 254 charachters.
- Interface authentication is not applicable to loopback interfaces.
..- The password is saved encrypted and always displayed as a secret


**Parameter table**

+--------------+----------------------------------------------------------------------------------+-------------------------------+---------+
| Parameter    | Description                                                                      | Range                         | Default |
+==============+==================================================================================+===============================+=========+
| type         | The type of authentication used.                                                 | | md5                         | \-      |
|              |                                                                                  | | clear-text                  |         |
|              |                                                                                  | | keychain                    |         |
+--------------+----------------------------------------------------------------------------------+-------------------------------+---------+
| enc-password | Enter the encrypted password string for the area. The password must be a valid   | clear-text: 1..254 characters | \-      |
|              | encrypted password (the password was encrypted by a dnRouter).                   |                               |         |
|              | When typing a clear password, the password will not be displayed in the CLI      |                               |         |
|              | terminal. The password format must match the encrypted format as displayed in    |                               |         |
|              | "show config".                                                                   |                               |         |
+--------------+----------------------------------------------------------------------------------+-------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-1 type md5 password
    Enter password
    Enter password for verifications
    dnRouter(cfg-protocols-isis-inst)# authentication level level-1 type md5 password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==


**Removing Configuration**

To stop authentication for a specific level:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication level level-1

**Command History**

+---------+--------------------------------------------+
| Release | Modification                               |
+=========+============================================+
| 9.0     | Command introduced                         |
+---------+--------------------------------------------+
| 10.0    | Removed "no authentication" for all levels |
+---------+--------------------------------------------+
| 25.2    | Added support for keychains                |
+---------+--------------------------------------------+

---

### instance/authentication-level-2_keychain.rst

protocols isis instance authentication level level-2 type keychain
------------------------------------------------------------------

**Minimum user role:** operator

LSP packets are not authenticated by default. You can configure authentication for LSP and SNP packets, so that unauthenticated packets will be dropped.

To configure authentication:


**Command syntax: authentication level level-2 type keychain [keychain-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+---------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter     | Description                                                                      | Range            | Default |
+===============+==================================================================================+==================+=========+
| keychain-name | Reference to the keychain that should be used for authenticating IS-IS packets - | | string         | \-      |
|               | the keychain may contain either a simple password, or HMAC-MD5 key that is used  | | length 1-255   |         |
|               | for authenticating CSNP, PSNP and LSP packets within the specified IS-IS level.  |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-2 type keychain ISIS-keys


**Removing Configuration**

To stop authentication for a specific level:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication level level-2

**Command History**

+---------+--------------------------------------------+
| Release | Modification                               |
+=========+============================================+
| 9.0     | Command introduced                         |
+---------+--------------------------------------------+
| 10.0    | Removed "no authentication" for all levels |
+---------+--------------------------------------------+
| 25.2    | Added support for keychains                |
+---------+--------------------------------------------+

---

### instance/authentication-level-2-impose-poi.rst

protocols isis instance authentication level level-2 impose-poi
---------------------------------------------------------------

**Minimum user role:** operator

ISIS Purge Originator Identification (POI) tlv should be imposed on purge LSPs with care when using LSP authentication.
Per RFC-6232 and RFC-6233 POI should be used with LSP authentication , only once all network support POI, otherwise routers may reject the received purge with poi tlv within it
To control if to impose and add poi for authenticated purge lsps:


**Command syntax: authentication level level-2 impose-poi [impose-poi]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**
* By default local system accept purge with poi regardless if authentication is enabled or not, and regardless of 'impose-poi' settings. 
* 'impose-poi enabled' has no functional effect if authentication is not enabled
* Reconfiguration of 'impose-poi' effect only new transmitted purge
* Support regardless of authentication type

**Parameter table**

+------------+---------------------------------------------------------------------+--------------+----------+
| Parameter  | Description                                                         | Range        | Default  |
+============+=====================================================================+==============+==========+
| impose-poi | Add Purge Originator Identification TLV for authenticated purge LSP | | enabled    | disabled |
|            |                                                                     | | disabled   |          |
+------------+---------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level-1 impose-poi enabled

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-2 impose-poi disabled


**Removing Configuration**

To revert impose-poi to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication level level-2 impose-poi

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/authentication-level-2-snp-auth.rst

protocols isis instance authentication level level-2 snp-auth
-------------------------------------------------------------

**Minimum user role:** operator

SNP packets are not authenticated by default. You can enable SNP packet authentication, so that unauthenticated packets will be dropped.

To configure authentication:


**Command syntax: authentication level level-2 snp-auth [snp-auth]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**
- SNP packet authentication is only possible if IS-IS authentication for LSP packets is enabled for the same level.


**Parameter table**

+-----------+--------------------------------------------+---------------------------------------------------------------------------------+----------+
| Parameter | Description                                | Range                                                                           | Default  |
+===========+============================================+=================================================================================+==========+
| snp-auth  | Set the authentication mode of SNP packets | | disabled - no SNP authentication                                              | disabled |
|           |                                            | | sign - only sign outgoing SNP packets                                         |          |
|           |                                            | | sign-validate - sign outgoing SNP packets and validate incoming SNP packets   |          |
+-----------+--------------------------------------------+---------------------------------------------------------------------------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level-2 snp-auth sign

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-1 snp-auth sign-validate

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-2 snp-auth sign-validate


**Removing Configuration**

To revert SNP-auth to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication level level-2 snp-auth
    dnRouter(cfg-protocols-isis-inst)# no authentication level level-1 snp-auth

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 9.0     | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/authentication-level-2.rst

protocols isis instance authentication level level-2 type password
------------------------------------------------------------------

**Minimum user role:** operator

LSP packets are not authenticated by default. You can configure authentication for LSP and NSP packets, so that unauthenticated packets will be dropped.

To configure authentication:


**Command syntax: authentication level level-2 type [type] password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**
- When typing a clear password, the password **won't** be displayed in the CLI terminal.
- A clear password length cannot exceed 254 charachters.
- Interface authentication is not applicable to loopback interfaces.
..- The password is saved encrypted and always displayed as a secret


**Parameter table**

+--------------+----------------------------------------------------------------------------------+-------------------------------+---------+
| Parameter    | Description                                                                      | Range                         | Default |
+==============+==================================================================================+===============================+=========+
| type         | The type of authentication used.                                                 | | md5                         | \-      |
|              |                                                                                  | | clear-text                  |         |
|              |                                                                                  | | keychain                    |         |
+--------------+----------------------------------------------------------------------------------+-------------------------------+---------+
| enc-password | Enter the encrypted password string for the area. The password must be a valid   | clear-text: 1..254 characters | \-      |
|              | encrypted password (the password was encrypted by a dnRouter).                   |                               |         |
|              | When typing a clear password, the password will not be displayed in the CLI      |                               |         |
|              | terminal. The password format must match the encrypted format as displayed in    |                               |         |
|              | "show config".                                                                   |                               |         |
+--------------+----------------------------------------------------------------------------------+-------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# authentication level level-2 type md5 password
    Enter password
    Enter password for verifications
    dnRouter(cfg-protocols-isis-inst)# authentication level level-2 type md5 password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==


**Removing Configuration**

To stop authentication for a specific level:
::

    dnRouter(cfg-protocols-isis-inst)# no authentication level level-2

**Command History**

+---------+--------------------------------------------+
| Release | Modification                               |
+=========+============================================+
| 9.0     | Command introduced                         |
+---------+--------------------------------------------+
| 10.0    | Removed "no authentication" for all levels |
+---------+--------------------------------------------+
| 25.2    | Added support for keychains                |
+---------+--------------------------------------------+

---

### instance/description.rst

protocols isis instance description
-----------------------------------

**Minimum user role:** operator

When configuring multiple IS-IS instances, it may be helpful to add a description for each configured instance.

To configure a description for the IS-IS instance:


**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                                      | Range            | Default |
+=============+==================================================================================+==================+=========+
| description | Add a description for the IS-IS instance.                                        | | string         | \-      |
|             | Enter free-text description with spaces in between quotation marks. If you do    | | length 1-255   |         |
|             | not use quotation marks, do not use spaces. For example:                         |                  |         |
|             | ... description "My long description"                                            |                  |         |
|             | ... description My_long_description                                              |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# description "IS-IS metro region 1"


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-protocols-isis-inst)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### instance/distribute.rst

protocols isis instance distribute bgp-link-state id
----------------------------------------------------

**Minimum user role:** operator

This command is part of the BGP-LS feature for Traffic Engineering. In order to support Traffic engineering tunnel delegation to a centralize entity, the network must provide the centralized entity an ongoing full view of the network TE link state. BGP-LS is used to send IGP-TE link information to a remote controller. The remote controller, known as PCE, will in turn use this information to create, update and remove TE tunnels in the network.

This command instructs the system to export the IS-IS-TE database to BGP-LS. The network information, topology, bandwidth, and link cost are all sent to the path computation element through BGP.

To distribute the IS-IS database to BGP-LS:

**Command syntax: distribute bgp-link-state [level] id [bgp-link-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**
- The IS-IS is not exported to BGP-LS by default.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------------+---------+
| Parameter      | Description                                                                      | Range       | Default |
+================+==================================================================================+=============+=========+
| level          | The IS-IS routing level database to distribute                                   | | level-1   | \-      |
|                |                                                                                  | | level-2   |         |
+----------------+----------------------------------------------------------------------------------+-------------+---------+
| bgp-link-state | A unique identifier to distinguish the IS-IS instance in BGP-LS updates. Must be | 0-65535     | \-      |
|                | unique for all IS-IS instances.                                                  |             |         |
+----------------+----------------------------------------------------------------------------------+-------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# distribute bgp-link-state level-2 id 1


**Removing Configuration**

To stop exporting the IS-IS database to BGP-LS:
::

    dnRouter(cfg-protocols-isis-inst)# no distribute bgp-link-state

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 10.0    | Command introduced                      |
+---------+-----------------------------------------+
| 11.0    | Removed option to include ipv6 prefixes |
+---------+-----------------------------------------+
| 16.2    | Added support for Level-1               |
+---------+-----------------------------------------+

---

### instance/dynamic-hostname.rst

protocols isis instance dynamic-hostname
----------------------------------------

**Minimum user role:** operator

IS-IS uses a 6 byte system ID to represent a node in the network (in hexadecimal values). Hexadecimal representations are not as clear as device names, and so you may want to map these system IDs to their device names for monitoring, operation, and troubleshooting tasks.

Enabling the dynamic hostname feature allows the IS-IS routers to include the name-to-systemID mapping data in their link-state PDUs (LSPs).

To enable the support for dynamic hostname:


**Command syntax: dynamic-hostname [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+-------------+-----------------------------------------------------------+--------------+---------+
| Parameter   | Description                                               | Range        | Default |
+=============+===========================================================+==============+=========+
| admin-state | The administrative state of the dynamic hostname feature. | | enabled    | enabled |
|             |                                                           | | disabled   |         |
+-------------+-----------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# dynamic-hostname enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no dynamic-hostname

**Command History**

+---------+-----------------------------------------------------------------------+
| Release | Modification                                                          |
+=========+=======================================================================+
| 6.0     | Command introduced                                                    |
+---------+-----------------------------------------------------------------------+
| 9.0     | Changed argument syntax from "hostname dynamic" to "dynamic-hostname" |
+---------+-----------------------------------------------------------------------+

---

### instance/flex-algo/flex-algo.rst

protocols isis instance flex-algo
---------------------------------

**Minimum user role:** operator

Flex-Algo allows IGP constraint-based computation and creates separate IGP algorithms according to the defined set of constraints and metric types.
It compliments the SR-TE solution by adding new prefix segments with specific optimization objectives and constraints. 
* Metric types: Minimize IGP-metric, te-metric, or delay. 
* Exclude certain SRLGs, include/exclude link admin groups. 
To have the DNOS Router join Flex-Algo within the IS-IS instance, configure the Flex-Algo participation.

To configure the flexible algorithm, enter the Flex-Algo configuration mode:

**Command syntax: flex-algo**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- Flex-Algo routes are ISIS-SR routes with matching IS-IS segment-routing administrative-distance.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-inst-sr-flex-algo)#


**Removing Configuration**

To revert all flex-algo configurations to default:
::

    dnRouter(cfg-isis-inst-sr)# no segment-routing flex-algo

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/advertise.rst

protocols isis instance flex-algo participate advertise
-------------------------------------------------------

**Minimum user role:** operator

To configure the flexible algorithm profile definition to be advertised within the Flex-Algo domain:

**Command syntax: advertise [flex-algo definition name]** priority [priority]

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo participate

**Note**

- Priority is used to define the router priority among the Flex-Algo domain as the selected router to set the Flex-Algo definition.

- The FAD of the router with the highest priority is selected. If there are multiple routers with the same priority, the router with the highest IS-IS system-id is selected.

**Parameter table**

+---------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter                 | Description                                                                      | Range            | Default |
+===========================+==================================================================================+==================+=========+
| flex-algo definition name | The local flex algo profile to be advertise for a specific flex algo id          | | string         | \-      |
|                           | participation                                                                    | | length 1-255   |         |
+---------------------------+----------------------------------------------------------------------------------+------------------+---------+
| priority                  | Indicates the priority for this algorithm                                        | 0-255            | 128     |
+---------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# advertise MIN_DELAY_130

    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# advertise MIN_DELAY_130 priority 1


**Removing Configuration**

To revert advertisment priority to default value:
::

    dnRouter(cfg-flex-algo-participate)# no advertise MIN_DELAY_130 priority

To remove advertise configuration:
::

    dnRouter(cfg-flex-algo-participate)# no advertise

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/color-no-fallback.rst

protocols isis instance flex-algo participate color no-fallback
---------------------------------------------------------------

**Minimum user role:** operator


By default, participation in the Flex-Algo domain will result in MPLS routes (ILM) for the algorithm known prefix-sids. When the color is set, associate an SR-TE color definition for the Flex-Algo routing domain. 
Flex-algo domain routes will be installed in color-mpls-nh table with the configured color, allowing usage to resolve services over the desired color. 
Once no fallback is set, it creates a default-route (0.0.0.0/0) with matching color in the color-mpls-nh table. The default-route will be changed to null0, intended for traffic drop. 
As a result traffic matching required color, will be dropped if no better solution exists in the mpls-nh table. No fallback to other colors or mpls-nh table will be possible.
Once disqualify-color-routes is set, the no-fallback route in color-mpls-nh or color-mpls-nh-ipv6 table will be considered unreachable.
As result, colored bgp routes resolved over matching color nexthop will be considered unreachable and will not be accepted

To configure color:

**Command syntax: color [color] no-fallback** disqualify-color-routes

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo participate

**Note**

- The color must be unique between all Flex-Algo participation of the same IS-IS instance.

**Parameter table**

+-------------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter               | Description                                                                      | Range        | Default |
+=========================+==================================================================================+==============+=========+
| color                   | The sr-te color to be assosiated with segment-routing flex-algo routes installed | 0-4294967295 | \-      |
|                         | in color-mpls-nh table.                                                          |              |         |
+-------------------------+----------------------------------------------------------------------------------+--------------+---------+
| disqualify-color-routes | Set policy to disqualify color routes matching this no-fallback route.           | boolean      | \-      |
+-------------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# color 130

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 100
    dnRouter(cfg-flex-algo-participate)# color 100 no-fallback
    dnRouter(cfg-flex-algo-participate)# color 100 no-fallback disqualify-color-routes


**Removing Configuration**

To remove color:
::

    dnRouter(cfg-flex-algo-participate)# no color

To remove color no-fallback:
::

    dnRouter(cfg-flex-algo-participate)# no color 100 no-fallback

To remove color no-fallback and disqualify-color-routes:
::

    dnRouter(cfg-flex-algo-participate)# no color 100 no-fallback disqualify-color-routes

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 18.0    | Command introduced            |
+---------+-------------------------------+
| TBD     | disqualify-color-routes added |
+---------+-------------------------------+

---

### instance/flex-algo/participate/color.rst

protocols isis instance flex-algo participate color
---------------------------------------------------

**Minimum user role:** operator


By default, participation in the Flex-Algo domain will result in MPLS routes (ILM) for the algorithm known prefix-sids. When the color is set, associate an SR-TE color definition for the Flex-Algo routing domain. 
Flex-algo domain routes will be installed in color-mpls-nh table with the configured color, allowing usage to resolve services over the desired color. 

To configure color:

**Command syntax: color [color]**

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo participate

**Note**

- The color must be unique between all Flex-Algo participation of the same IS-IS instance.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| color     | The sr-te color to be assosiated with segment-routing flex-algo routes installed | 0-4294967295 | \-      |
|           | in color-mpls-nh table.                                                          |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# color 130


**Removing Configuration**

To remove color:
::

    dnRouter(cfg-flex-algo-participate)# no color

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/description.rst

protocols isis instance flex-algo participate description
---------------------------------------------------------

**Minimum user role:** operator

When configuring multiple IS-IS Flex-Algo participations, it may be helpful to add a description for each participation.

To configure a description for the IS-IS Flex-Algo:


**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo participate

**Parameter table**

+-------------+----------------------------------------------+-------+---------+
| Parameter   | Description                                  | Range | Default |
+=============+==============================================+=======+=========+
| description | Add a description for the IS-IS flex-algo.   | \-    | \-      |
+-------------+----------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# description "Min Delay Flex-Algo"


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-flex-algo-participate)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/ipv4-unicast/ipv4-unicast.rst

protocols isis instance flex-algo participate address-family ipv4-unicast
-------------------------------------------------------------------------

**Minimum user role:** operator

The enter the isis address-family ipv4 unicast configuration:

**Command syntax: address-family ipv4-unicast**

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo participate

**Note**

- The configuration within this address-family only takes effect once the topology is enabled.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# address-family ipv4-unicast
    dnRouter(cfg-flex-algo-participate-afi)#


**Removing Configuration**

To revert all ipv4 unicast configuration to default:
::

    dnRouter(cfg-flex-algo-participate)# no address-family ipv4-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/ipv4-unicast/maximum-paths.rst

protocols isis instance flex-algo participate address-family ipv4-unicast maximum-paths
---------------------------------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to install multiple paths with equal cost per flex-algo route in the routing table:

**Command syntax: maximum-paths [maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo participate address-family ipv4-unicast

**Note**

- Default maximum-paths behavior is per isis instance address-family config

**Parameter table**

+---------------+-------------------------------------------------------+-------+---------+
| Parameter     | Description                                           | Range | Default |
+===============+=======================================================+=======+=========+
| maximum-paths | The number of routes to install in the routing table. | 1-64  | \-      |
+---------------+-------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# address-family ipv4-unicast
    dnRouter(cfg-flex-algo-participate-afi)# maximum-paths 12
    dnRouter(cfg-flex-algo-participate-afi)# exit
    dnRouter(cfg-flex-algo-participate)# address-family ipv6-unicast
    dnRouter(cfg-flex-algo-participate-afi)# maximum-paths 12


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-flex-algo-participate-afi)# no maximum-paths

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/ipv6-unicast/ipv6-unicast.rst

protocols isis instance flex-algo participate address-family ipv6-unicast
-------------------------------------------------------------------------

**Minimum user role:** operator

The enter the isis address-family ipv6 unicast configuration:

**Command syntax: address-family ipv6-unicast**

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo participate

**Note**

- The configuration within this address-family only takes effect once the topology is enabled.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# address-family ipv6-unicast
    dnRouter(cfg-flex-algo-participate-afi)#


**Removing Configuration**

To revert all ipv6 unicast configuration to default:
::

    dnRouter(cfg-flex-algo-participate)# no address-family ipv6-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/ipv6-unicast/maximum-paths.rst

protocols isis instance flex-algo participate address-family ipv6-unicast maximum-paths
---------------------------------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to install multiple paths with equal cost per flex-algo route in the routing table:

**Command syntax: maximum-paths [maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo participate address-family ipv6-unicast

**Note**

- Default maximum-paths behavior is per isis instance address-family config

**Parameter table**

+---------------+-------------------------------------------------------+-------+---------+
| Parameter     | Description                                           | Range | Default |
+===============+=======================================================+=======+=========+
| maximum-paths | The number of routes to install in the routing table. | 1-64  | \-      |
+---------------+-------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# address-family ipv4-unicast
    dnRouter(cfg-flex-algo-participate-afi)# maximum-paths 12
    dnRouter(cfg-flex-algo-participate-afi)# exit
    dnRouter(cfg-flex-algo-participate)# address-family ipv6-unicast
    dnRouter(cfg-flex-algo-participate-afi)# maximum-paths 12


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-flex-algo-participate-afi)# no maximum-paths

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/participate.rst

protocols isis instance flex-algo participate
---------------------------------------------

**Minimum user role:** operator

To have the DNOS Router join the Flex-Algo within the IS-IS instance, configure the Flex-Algo participation for the desired Flex-Algo identifier:

**Command syntax: participate [Flex-Algo ID]**

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo

**Parameter table**

+--------------+---------------------------+---------+---------+
| Parameter    | Description               | Range   | Default |
+==============+===========================+=========+=========+
| Flex-Algo ID | flex algorithm identifier | 128-255 | \-      |
+--------------+---------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-isis-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)#


**Removing Configuration**

To remove participation configuration:
::

    dnRouter(cfg-inst-flex-algo)# no participate 130

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/use-legacy-te.rst

protocols isis instance flex-algo use-legacy-te
-----------------------------------------------

**Minimum user role:** operator

User will have the option of leveraging Legacy TLVs for distributing Traffic-Engineering information which will also serve SR Flex-algo, instead of dedicated Application-Specific Link Attributes (ASLA) TLVs (RFC 8919)
When enabled: If ASLA information is required to be advertise due to participation in one (or more) SR Flex-Algo,  L-flag (Legacy) will be set in SABM TLV and no dedicated sub-tlvs will be required for ASLA TE information. Information is carried in legacy ISIS TE tlvs
When disabled:  If ASLA information is required to be advertise due to participation in one (or more) SR Flex-Algo,  L-flag (Legacy) will not be set in SABM TLV. Any required TE information, such as admin-groups, extended-admin-groups, te-metric, srlg and link delay, will be advertise with dedicated ASLA sub-tlv.
To set usage of legacy te:

**Command syntax: use-legacy-te [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance flex-algo

**Note**

- Reconfiguring will trigger LSP update

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Set if Legacy tlvs should be used to advertise flex-algo application specific    | | enabled    | disabled |
|             | traffic-engineering tlvs                                                         | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# flex-algo
    dnRouter(cfg-inst-sr-flex-algo)# use-legacy-te disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-inst-sr-flex-algo)# no use-legacy-te

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/forwarding-adjacency/address-family/address-family.rst

protocols isis instance forwarding-adjacency address-family
-----------------------------------------------------------

**Minimum user role:** operator

Use this command to enable forwarding adjacency for a specific address family. For ipv4-unicast, a forwarding-adjacency link will be added to the default IS-IS topology (topology #0). You must configure at least one address-family to enable forwarding-adjacency for the relevant topology.

To enable forwarding adjacency for a specific address family:

**Command syntax: address-family [address-family]**

**Command mode:** config

**Hierarchies**

- protocols isis instance forwarding-adjacency

**Note**

- There is no default address-family.

**Parameter table**

+----------------+-----------------------------------------------------------------------+--------------+---------+
| Parameter      | Description                                                           | Range        | Default |
+================+=======================================================================+==============+=========+
| address-family | The address-family (AFI-SAFI) on which to enable forwarding adjacency | ipv4-unicast | \-      |
+----------------+-----------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# forwarding-adjacency TUNNEL_1
    dnRouter(cfg-isis-inst-fa)# address-family ipv4-unicast
    dnRouter(cfg-inst-fa-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-isis-inst-fa)# no address-family ipv4-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### instance/forwarding-adjacency/address-family/metric_max-metric.rst

protocols isis instance forwarding-adjacency address-family metric max-metric
-----------------------------------------------------------------------------

**Minimum user role:** operator

This command sets the forwarding-adjacency link metric to be the configured max-metric value in \"isis max-metric\". When disabled, the configured metric value will be used for the link.

To set 'max-metric' as the metric value for the forwarding-adjacency link:

**Command syntax: metric max-metric**

**Command mode:** config

**Hierarchies**

- protocols isis instance forwarding-adjacency address-family

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# forwarding-adjacency TUNNEL_2
    dnRouter(cfg-isis-inst-fa)# address-family ipv4-unicast
    dnRouter(cfg-inst-fa-afi)# metric max-metric


**Removing Configuration**

To revert the metric to the configured metric value:
::

    dnRouter(cfg-inst-fa-afi)# no metric max-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### instance/forwarding-adjacency/address-family/metric.rst

protocols isis instance forwarding-adjacency address-family metric
------------------------------------------------------------------

**Minimum user role:** operator

To configure the forwarding-adjacency link metric in the relevant topology:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance forwarding-adjacency address-family

**Parameter table**

+-----------+---------------------------------------------------------+------------+---------+
| Parameter | Description                                             | Range      | Default |
+===========+=========================================================+============+=========+
| metric    | The metric value to be set for the forwarding-adjacency | 1-16777215 | 10      |
+-----------+---------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# forwarding-adjacency TUNNEL_1
    dnRouter(cfg-isis-inst-fa)# address-family ipv4-unicast
    dnRouter(cfg-inst-fa-afi)# metric 60


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-fa-afi)# no metric 60

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### instance/forwarding-adjacency/forwarding-adjacency.rst

protocols isis instance forwarding-adjacency
--------------------------------------------

**Minimum user role:** operator

Forwarding adjacency allows steering traffic into an existing RSVP-TE tunnel by using a primary tunnel as a forwarding adjacency in the IS-IS instance, allowing IS-IS traffic to be forwarded over the RSVP tunnel. The tunnel is added as a regular link to the IS-IS topology. The formed adjacency exists as long as the RSVP LSP is up.

To enter the forwarding-adjacency configuration hierarchy:

**Command syntax: forwarding-adjacency [tunnel-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- The RSVP tunnel must be an existing primary tunnel name.

- The tunnel must be configured in the same IS-IS instance.

- The same tunnel cannot be set as a forwarding-adjacency in multiple IS-IS instances.

- The tunnel cannot be enabled with shortcut, either explicitly or inherit.

**Parameter table**

+-------------+--------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                        | Range            | Default |
+=============+====================================================================+==================+=========+
| tunnel-name | The RSVP tunnel name over which forwarding-adjacency is configured | | string         | \-      |
|             |                                                                    | | length 1-255   |         |
+-------------+--------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# forwarding-adjacency TUNNEL_1
    dnRouter(cfg-isis-inst-fa)#


**Removing Configuration**

To remove the specific tunnel forwarding-adjacency configuration:
::

    dnRouter(cfg-protocols-isis-inst)# no forwarding-adjacency TUNNEL_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### instance/forwarding-adjacency/level.rst

protocols isis instance forwarding-adjacency level
--------------------------------------------------

**Minimum user role:** operator

When using forwarding-adjacency, you must configure the level for which the forwarding-adjacency will be added: level-1 or level-2.

To configure the level for forwarding-adjacency:

**Command syntax: level [level]**

**Command mode:** config

**Hierarchies**

- protocols isis instance forwarding-adjacency

**Note**

- The tunnel must be configured to the same IS-IS instance.

- The same tunnel cannot be set as forwarding-adjacency in multiple IS-IS instances.

- The tunnel cannot be enabled with shortcut, either explicitly or inherit.

**Parameter table**

+-----------+-------------------------------------------------------------------+-------------+---------+
| Parameter | Description                                                       | Range       | Default |
+===========+===================================================================+=============+=========+
| level     | The IS-IS level for which the forwarding-adjacency will be added. | | level-1   | \-      |
|           |                                                                   | | level-2   |         |
+-----------+-------------------------------------------------------------------+-------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# forwarding-adjacency TUNNEL_1
    dnRouter(cfg-isis-inst-fa)# level level-2


**Removing Configuration**

To remove the level configuration:
::

    dnRouter(cfg-isis-inst-fa)# no level

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### instance/ignore-attached-bit.rst

protocols isis instance ignore-attached-bit
-------------------------------------------

**Minimum user role:** operator

When this setting is enabled, if the attached bit is set on an incoming Level-1 IS-IS, the local system ignores it.
In this case the local system does not set a default route to the Level-1-2 router, advertising the PDU with the attached bit set.

**Command syntax: ignore-attached-bit [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+-------------+---------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                         | Range        | Default  |
+=============+=====================================================================+==============+==========+
| admin-state | Configure IS-IS to ignore attched bit when acting as level-1 router | | enabled    | disabled |
|             |                                                                     | | disabled   |          |
+-------------+---------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# ignore-attached-bit enabled


**Removing Configuration**

To revert the ignore-attached-bit to its default value:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no ignore-attached-bit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/instance.rst

protocols isis instance
-----------------------

**Minimum user role:** operator

IS-IS instances allow you to set different IS-IS configuration per instance, using the same system-id and loopback interfaces. However, each instance must be configured with a different administrative-distance. You can configure up to 5 IS-IS instances, each with a unique name.

To start an IS-IS instance, set its ISO routing area tag and enter its configuration hierarchy

**Command syntax: instance [isis-instance-name]**

**Command mode:** config

**Hierarchies**

- protocols isis

**Note**

- IS-IS works with metric style wide by default.

- The IS-IS router-id is identical in all isis instances.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter          | Description                                                                      | Range            | Default |
+====================+==================================================================================+==================+=========+
| isis-instance-name | The IS-IS instance name identifies the specific IS-IS protocol instance. The     | | string         | \-      |
|                    | name cannot be changed. If you need to change it, you must delete the IS-IS      | | length 1-255   |         |
|                    | protocol instance using the no instance [isis-instance-name] command and         |                  |         |
|                    | reconfigure with a different name.                                               |                  |         |
+--------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance area_2
    dnRouter(cfg-protocols-isis-inst)#


**Removing Configuration**

To remove all IS-IS protocol instances:
::

    dnRouter(cfg-protocols-isis)# no instance

To remove a specific IS-IS protocol instance:
::

    dnRouter(cfg-protocols-isis)# no instance area_2

**Command History**

+---------+--------------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                             |
+=========+==========================================================================================================================+
| 6.0     | Command introduced                                                                                                       |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 9.0     | Changed "area-tag" to "isis-instance-name"                                                                               |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 10.0    | Added support for multiple instances                                                                                     |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 11.0    | Moved command underneath the isis hierarchy (instead of directly under the protocols hierarchy) and changed the syntax   |
|         | accordingly from "isis [value]" to "instance [value]".                                                                   |
+---------+--------------------------------------------------------------------------------------------------------------------------+

---

### instance/interface/admin-state.rst

protocols isis instance interface admin-state
---------------------------------------------

**Minimum user role:** operator

Setting an IS-IS interface to disable mode. The IS-IS interface will not send or receive IS-IS packets.

To set the IS-IS interface to disable mode:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Parameter table**

+-------------+------------------------------------------------+--------------+---------+
| Parameter   | Description                                    | Range        | Default |
+=============+================================================+==============+=========+
| admin-state | Administratively set the IS-IS interface state | | enabled    | enabled |
|             |                                                | | disabled   |         |
+-------------+------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-isis-inst-if)# no admin-state disabled

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/adjacency-sid/adjacency-sid.rst

protocols isis instance interface address-family adjacency-sid
--------------------------------------------------------------

**Minimum user role:** operator

When IS-IS forms and adjacency over a given link, it is advertised by the exteded reachability TLV. 
Segment-routing adjacency-sid allocate a specific SID , e.g label, to forward incoming matching mpls traffic over the specific adjacency. I.e to forward traffic over a specific egress interface to a known next-hop
A configured adjacency-sid will be persistent , and will hold the SID value for as long as it is configured, including system reboot. The persistent adjacency-sid is advertised with P-flag set (RFC8667)
To configure a persistent adjacency-sid:

**Command syntax: adjacency-sid [SID type] [sid-index/sid-label]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- Configured SID value (i.e expected label value) must be within the configured SRLB range
- Configured SID value (i.e expected label value) must be unique in the ISIS interface (due to combination of type & value)
- Configured SID value (i.e expected label value) must be unique between all ISIS interfaces and address-families
- Support up to two configured adjacency-sids per interface.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+----------------------------+---------+
| Parameter           | Description                                                                      | Range                      | Default |
+=====================+==================================================================================+============================+=========+
| SID type            | Sid type absolute or index                                                       | | index                    | \-      |
|                     |                                                                                  | | label                    |         |
+---------------------+----------------------------------------------------------------------------------+----------------------------+---------+
| sid-index/sid-label | sid-index: Assigns the prefix-SID label according to the index of the            | | sid-index: 0-31999       | \-      |
|                     | Segment-Routing Global Block used by IS-IS. The value must be within the SRGB    | | sid-label: 256-1040383   |         |
|                     | range.                                                                           |                            |         |
|                     | sid-label: Assigns the prefix-SID label as an absolute value. The value must be  |                            |         |
|                     | within the SRGB range.                                                           |                            |         |
+---------------------+----------------------------------------------------------------------------------+----------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-1
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# adjacency-sid index 10
    dnRouter(cfg-if-afi-adj-sid)#

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-1
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# adjacency-sid absolute 8001
    dnRouter(cfg-if-afi-adj-sid)#


**Removing Configuration**

To remove configured adjacency-sid:
::

    dnRouter(cfg-inst-if-afi)# no adjacency-sid absolute 8001

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/adjacency-sid/protection-eligible.rst

protocols isis instance interface address-family adjacency-sid protection-eligible
----------------------------------------------------------------------------------

**Minimum user role:** operator

* For adjacency-sid configured without protection-eligible (default behavior), SID is always advertised with B flag unset, regardless of protection status in ISIS. Such adjacency-sid will not be protected and will not hold alternate path.
* For adjacency-sid configured with protected flag, sid is always advertised with B flag set. Regardless of protection status in ISIS (i.e if LFA/TI-LFA is enabled - same behavior in Cisco).

To set the adjacency-sid as protection-eligible:

**Command syntax: protection-eligible**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family adjacency-sid

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-1
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# adjacency-sid index 10
    dnRouter(cfg-if-afi-adj-sid)# protection-eligible


**Removing Configuration**

To return to default behavior:
::

    dnRouter(cfg-if-afi-adj-sid)# no protection-eligible

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/afi.rst

protocols isis instance interface address-family
------------------------------------------------

**Minimum user role:** operator

This command enables the interface for the specified IS-IS address-family topology. Address-family cannot be configured if the equivalent topology isn't enabled in the IS-IS instance.
To enable an address-family on the IS-IS interface and enter address-family configuration:


**Command syntax: address-family [address-family-type]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Note**
- When only IPv4-unicast is enabled for all IS-IS enabled interfaces, IS-IS works as a single topology.
- There is no default address-family. You must configure at least one address-family to enable IS-IS for the interface.
- For the ipv6-unicast address family, IS-IS metric-style must be 'wide'.


**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------------+---------+
| Parameter           | Description                                                                      | Range              | Default |
+=====================+==================================================================================+====================+=========+
| address-family-type | The address family to be supported by the IS-IS interface. You must configure at | | ipv4-unicast     | \-      |
|                     | least one address-family to enable IS-IS on the interface.                       | | ipv6-unicast     |         |
|                     |                                                                                  | | ipv4-multicast   |         |
+---------------------+----------------------------------------------------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)#

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-multicast
    dnRouter(cfg-inst-if-afi)#

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)#


**Removing Configuration**

To remove all address-family configuration:
::

    dnRouter(cfg-isis-inst-if)# no address-family

To remove a specific address-family configuration:
::

    dnRouter(cfg-isis-inst-if)# no address-family ipv4-unicast
    dnRouter(cfg-isis-inst-if)# no address-family ipv6-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/conditional-adv-level-1.rst

protocols isis instance interface address-family conditional-adv level level-1 policy
-------------------------------------------------------------------------------------

**Minimum user role:** operator

Condition IP reachability advetisement (TLV 135/235/236/237) of interface prefix using a route policy. 
All related reachability infromation such as Segment-Routing SIDs will also be effected. 
Conditional route Adrvertismeant is used to alter ISIS advertisements based on network status, by identifying specific network scenarios using a routing policy, ISIS should stop advertising given prefixes.
This feature is useful for network edge scenarios like ASBR, Upon failure of uplink interface that is used as exist point to another AS, ISIS will stop advertising the lo0 that is used as the next hop. Commonly used when ASBRs advertise the anycast sid as the BGP next-hop.

**Command syntax: conditional-adv level level-1 policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level take presedence

- Metric manipulation by conditional-adv will override interface metric setting, except when max-metric is being set. - i.e when max-metric is required to be advertised to interface , in case prefix is allowed to be advertised, max-matric will be provided

- For non loopback interface, ISIS neighbor info are uneffected (TLV 22/23/222/223)

**Parameter table**

+-------------+--------------------+------------------+---------+
| Parameter   | Description        | Range            | Default |
+=============+====================+==================+=========+
| policy-name | Impose for level-1 | | string         | \-      |
|             |                    | | length 1-255   |         |
+-------------+--------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv level level-1 policy MY_POLICY
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv level level-1 policy MY_POLICY


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-afi)# no conditional-adv level level-1 policy MY_POLICY

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/conditional-adv-level-2.rst

protocols isis instance interface address-family conditional-adv level level-2 policy
-------------------------------------------------------------------------------------

**Minimum user role:** operator

Condition IP reachability advetisement (TLV 135/235/236/237) of interface prefix using a route policy. 
All related reachability infromation such as Segment-Routing SIDs will also be effected. 
Conditional route Adrvertismeant is used to alter ISIS advertisements based on network status, by identifying specific network scenarios using a routing policy, ISIS should stop advertising given prefixes.
This feature is useful for network edge scenarios like ASBR, Upon failure of uplink interface that is used as exist point to another AS, ISIS will stop advertising the lo0 that is used as the next hop. Commonly used when ASBRs advertise the anycast sid as the BGP next-hop.

**Command syntax: conditional-adv level level-2 policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level take presedence

- Metric manipulation by conditional-adv will override interface metric setting, except when max-metric is being set. - i.e when max-metric is required to be advertised to interface , in case prefix is allowed to be advertised, max-matric will be provided

- For non loopback interface, ISIS neighbor info are uneffected (TLV 22/23/222/223)

**Parameter table**

+-------------+--------------------+------------------+---------+
| Parameter   | Description        | Range            | Default |
+=============+====================+==================+=========+
| policy-name | Impose for level-2 | | string         | \-      |
|             |                    | | length 1-255   |         |
+-------------+--------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv level level-2 policy MY_POLICY
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv level level-2 policy MY_POLICY


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-afi)# no conditional-adv level level-2 policy MY_POLICY

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/conditional-adv.rst

protocols isis instance interface address-family conditional-adv policy
-----------------------------------------------------------------------

**Minimum user role:** operator

Condition IP reachability advetisement (TLV 135/235/236/237) of interface prefix using a route policy. 
All related reachability infromation such as Segment-Routing SIDs will also be effected. 
Conditional route Adrvertismeant is used to alter ISIS advertisements based on network status, by identifying specific network scenarios using a routing policy, ISIS should stop advertising given prefixes.
This feature is useful for network edge scenarios like ASBR, Upon failure of uplink interface that is used as exist point to another AS, ISIS will stop advertising the lo0 that is used as the next hop. Commonly used when ASBRs advertise the anycast sid as the BGP next-hop.

**Command syntax: conditional-adv policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level take presedence

- Metric manipulation by conditional-adv will override interface metric setting, except when max-metric is being set. - i.e when max-metric is required to be advertised to interface , in case prefix is allowed to be advertised, max-matric will be provided

- For non loopback interface, ISIS neighbor info are uneffected (TLV 22/23/222/223)

**Parameter table**

+-------------+----------------------+------------------+---------+
| Parameter   | Description          | Range            | Default |
+=============+======================+==================+=========+
| policy-name | Impose for level-1-2 | | string         | \-      |
|             |                      | | length 1-255   |         |
+-------------+----------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv policy MY_POLICY
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv policy MY_POLICY


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-afi)# no conditional-adv policy MY_POLICY

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/frr.rst

protocols isis instance interface address-family fast-reroute backup-candidate
------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all IS-IS enabled interfaces are valid candidates for IS-IS LFA. The command allows you to include or exclude an interface from being used as a candidate for repair path calculation. When set to be included, the interface will be used for loop-free alternate calculations (when isis fast-reroute is globally enabled. See "isis instance address-family fast-reroute"). If the interface is set to be excluded, it will not be used for repair paths:


**Command syntax: fast-reroute backup-candidate [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The configuration is only valid for the following interface types:
.. - ge{/10/25/40/100}-X/Y/Z,
.. - geX-<f>/<n>/<p>.<sub-interface id>
.. - bundle-<bundle-id>,
.. - bundle-<bundle-id.sub-bundle-id>
- for other interfaces type require commit validation and that cli will not support such command for these interfaces
- The default behavior is per 'isis instance address-family fast-reroute backup-candidate' configuration
- Inheritance logic:
.. - Interface per level config - inherit the interface level-1-2 config (i.e when level isn't specified)
.. - Interface level-1-2 config - inherits the global fast-reroute backup-candidate (which always exists, can be default)
.. - 'backup-candidate' applies per IS-IS interface address-family topology. For example, when operating in a single topology, if you disable the backup-candidate on an ipv4-unicast interface, the LFA to the interface's neighbor will not be valid for both IPv4 & IPv6 prefixes.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | \-      |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate disabled

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate level level-2 enabled


**Removing Configuration**

To revert to the default admin-state and to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate

To revert only to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2 enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/interface/afi/frr1.rst

protocols isis instance interface address-family fast-reroute backup-candidate level level-1
--------------------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all IS-IS enabled interfaces are valid candidates for IS-IS LFA. The command allows you to include or exclude an interface from being used as a candidate for repair path calculation. When set to be included, the interface will be used for loop-free alternate calculations (when isis fast-reroute is globally enabled. See "isis instance address-family fast-reroute"). If the interface is set to be excluded, it will not be used for repair paths:


**Command syntax: fast-reroute backup-candidate level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The configuration is only valid for the following interface types:
.. - ge{/10/25/40/100}-X/Y/Z,
.. - geX-<f>/<n>/<p>.<sub-interface id>
.. - bundle-<bundle-id>,
.. - bundle-<bundle-id.sub-bundle-id>
- for other interfaces type require commit validation and that cli will not support such command for these interfaces
- The default behavior is per 'isis instance address-family fast-reroute backup-candidate' configuration
- Inheritance logic:
.. - Interface per level config - inherit the interface level-1-2 config (i.e when level isn't specified)
.. - Interface level-1-2 config - inherits the global fast-reroute backup-candidate (which always exists, can be default)
.. - 'backup-candidate' applies per IS-IS interface address-family topology. For example, when operating in a single topology, if you disable the backup-candidate on an ipv4-unicast interface, the LFA to the interface's neighbor will not be valid for both IPv4 & IPv6 prefixes.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | \-      |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate disabled

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate level level-2 enabled


**Removing Configuration**

To revert to the default admin-state and to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate

To revert only to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2 enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/interface/afi/frr2.rst

protocols isis instance interface address-family fast-reroute backup-candidate level level-2
--------------------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all IS-IS enabled interfaces are valid candidates for IS-IS LFA. The command allows you to include or exclude an interface from being used as a candidate for repair path calculation. When set to be included, the interface will be used for loop-free alternate calculations (when isis fast-reroute is globally enabled. See "isis instance address-family fast-reroute"). If the interface is set to be excluded, it will not be used for repair paths:


**Command syntax: fast-reroute backup-candidate level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The configuration is only valid for the following interface types:
.. - ge{/10/25/40/100}-X/Y/Z,
.. - geX-<f>/<n>/<p>.<sub-interface id>
.. - bundle-<bundle-id>,
.. - bundle-<bundle-id.sub-bundle-id>
- for other interfaces type require commit validation and that cli will not support such command for these interfaces
- The default behavior is per 'isis instance address-family fast-reroute backup-candidate' configuration
- Inheritance logic:
.. - Interface per level config - inherit the interface level-1-2 config (i.e when level isn't specified)
.. - Interface level-1-2 config - inherits the global fast-reroute backup-candidate (which always exists, can be default)
.. - 'backup-candidate' applies per IS-IS interface address-family topology. For example, when operating in a single topology, if you disable the backup-candidate on an ipv4-unicast interface, the LFA to the interface's neighbor will not be valid for both IPv4 & IPv6 prefixes.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | \-      |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate disabled

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate level level-2 enabled


**Removing Configuration**

To revert to the default admin-state and to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate

To revert only to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2 enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/interface/afi/ldp-sync.rst

protocols isis instance interface address-family ldp-sync
---------------------------------------------------------

**Minimum user role:** operator

The IS-IS-LDP synchronization allows IS-IS to advertise a link where LDP is not fully functional (for example, session not established). The link is then deemed as less preferred.

**Command syntax: ldp-sync [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- This command is valid only for ipv4-unicast address-family.
- This command is not applicable to loopback interfaces.
- Synchronization with LDP is not done by default.

**Parameter table**

+-------------+---------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                               | Range        | Default  |
+=============+===========================================================================+==============+==========+
| admin-state | The administrative state for enabling/disabling IS-IS-LDP synchronization | | enabled    | disabled |
|             |                                                                           | | disabled   |          |
+-------------+---------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# ldp-sync enabled

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# ldp-sync enabled


**Removing Configuration**

To revert ldp-sync to the default admin-state:
::

    dnRouter(cfg-inst-if-afi)# no ldp-sync

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+
| 13.2    | Command updated    |
+---------+--------------------+

---

### instance/interface/afi/metric-level-1.rst

protocols isis instance interface address-family metric level level-1
---------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination. You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric level level-1 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+------------------------------------------------+
| Parameter | Description                                                                      | Range      | Default                                        |
+===========+==================================================================================+============+================================================+
| metric    | The metric that will be set for the link. The range is dependent on the          | 1-16777215 | per global address-family metric configuration |
|           | metric-style configured.                                                         |            |                                                |
|           | The IS-IS TE-metric is the same as the IGP level-2 metric by default.            |            |                                                |
|           | A metric value of 16777215 will cause the interface to not be routable except    |            |                                                |
|           | for interface local address.                                                     |            |                                                |
|           | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       |            |                                                |
|           | metric is set for both level-1 and level-2.                                      |            |                                                |
+-----------+----------------------------------------------------------------------------------+------------+------------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-fa-afi)# no metric 60

To revert to the default metric (when metric per level is not set):
::

    dnRouter(cfg-inst-if-afi)# no metric
    dnRouter(cfg-inst-if-afi)# no metric 15

To revert from max-metric to the last configured metric:
::

    dnRouter(cfg-inst-if-afi)# no metric level-1 max-metric

To revert to the default metric for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no metric level-2

**Command History**

+---------+--------------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                             |
+=========+==========================================================================================================================+
| 6.0     | Command introduced                                                                                                       |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 9.0     | Removed level-1 and level-1-2 routing, removed support of narrow and transition metric styles, changed range and         |
|         | defaults metric value                                                                                                    |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 11.4    | Added support for GRE-tunnels                                                                                            |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 14.0    | Added support for level-1-2                                                                                              |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 15.0    | Updated command syntax                                                                                                   |
+---------+--------------------------------------------------------------------------------------------------------------------------+

---

### instance/interface/afi/metric-level-2.rst

protocols isis instance interface address-family metric level level-2
---------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination. You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric level level-2 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+------------------------------------------------+
| Parameter | Description                                                                      | Range      | Default                                        |
+===========+==================================================================================+============+================================================+
| metric    | The metric that will be set for the link. The range is dependent on the          | 1-16777215 | per global address-family metric configuration |
|           | metric-style configured.                                                         |            |                                                |
|           | The IS-IS TE-metric is the same as the IGP level-2 metric by default.            |            |                                                |
|           | A metric value of 16777215 will cause the interface to not be routable except    |            |                                                |
|           | for interface local address.                                                     |            |                                                |
|           | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       |            |                                                |
|           | metric is set for both level-1 and level-2.                                      |            |                                                |
+-----------+----------------------------------------------------------------------------------+------------+------------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-fa-afi)# no metric 60

To revert to the default metric (when metric per level is not set):
::

    dnRouter(cfg-inst-if-afi)# no metric
    dnRouter(cfg-inst-if-afi)# no metric 15

To revert from max-metric to the last configured metric:
::

    dnRouter(cfg-inst-if-afi)# no metric level-1 max-metric

To revert to the default metric for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no metric level-2

**Command History**

+---------+--------------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                             |
+=========+==========================================================================================================================+
| 6.0     | Command introduced                                                                                                       |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 9.0     | Removed level-1 and level-1-2 routing, removed support of narrow and transition metric styles, changed range and         |
|         | defaults metric value                                                                                                    |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 11.4    | Added support for GRE-tunnels                                                                                            |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 14.0    | Added support for level-1-2                                                                                              |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 15.0    | Updated command syntax                                                                                                   |
+---------+--------------------------------------------------------------------------------------------------------------------------+

---

### instance/interface/afi/metric-max-metric-level-1.rst

protocols isis instance interface address-family metric level level-1 max-metric
--------------------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination.
You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric level level-1 max-metric**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert the metric to the configured metric value:
::

    dnRouter(cfg-inst-if-afi)# no metric max-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/metric-max-metric-level-2.rst

protocols isis instance interface address-family metric level level-2 max-metric
--------------------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination.
You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric level level-2 max-metric**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert the metric to the configured metric value:
::

    dnRouter(cfg-inst-if-afi)# no metric max-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/metric-max-metric.rst

protocols isis instance interface address-family metric max-metric
------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm.
The path's cost is the sum of all metric values for each outgoing interface to the destination.
You can set different metrics for each routing level.
When IS-IS operates in a multi-topology mode, you can set a different metric value for each address-family.
A GRE tunnel interface with a metric value of 16777215 can be set so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric max-metric**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert the metric to the configured metric value:
::

    dnRouter(cfg-inst-if-afi)# no metric max-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/metric.rst

protocols isis instance interface address-family metric
-------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination. You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+------------------------------------------------+
| Parameter | Description                                                                      | Range      | Default                                        |
+===========+==================================================================================+============+================================================+
| metric    | The metric that will be set for the link. The range is dependent on the          | 1-16777215 | per global address-family metric configuration |
|           | metric-style configured.                                                         |            |                                                |
|           | The IS-IS TE-metric is the same as the IGP level-2 metric by default.            |            |                                                |
|           | A metric value of 16777215 will cause the interface to not be routable except    |            |                                                |
|           | for interface local address.                                                     |            |                                                |
|           | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       |            |                                                |
|           | metric is set for both level-1 and level-2.                                      |            |                                                |
+-----------+----------------------------------------------------------------------------------+------------+------------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-fa-afi)# no metric 60

To revert to the default metric (when metric per level is not set):
::

    dnRouter(cfg-inst-if-afi)# no metric
    dnRouter(cfg-inst-if-afi)# no metric 15

To revert from max-metric to the last configured metric:
::

    dnRouter(cfg-inst-if-afi)# no metric level-1 max-metric

To revert to the default metric for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no metric level-2

**Command History**

+---------+--------------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                             |
+=========+==========================================================================================================================+
| 6.0     | Command introduced                                                                                                       |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 9.0     | Removed level-1 and level-1-2 routing, removed support of narrow and transition metric styles, changed range and         |
|         | defaults metric value                                                                                                    |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 11.4    | Added support for GRE-tunnels                                                                                            |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 14.0    | Added support for level-1-2                                                                                              |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 15.0    | Updated command syntax                                                                                                   |
+---------+--------------------------------------------------------------------------------------------------------------------------+

---

### instance/interface/afi/srv6/locator-name/adjacency-sid/adjacency-sid.rst

protocols isis instance interface address-family srv6 locator-name adjacency-sid
--------------------------------------------------------------------------------

**Minimum user role:** operator

When IS-IS forms and adjacency over a given link, it is advertised by the exteded reachability TLV. 
The SID is an IPv6 address, composed by the locator prefix (block and node) and the function value.
The static-function range is between the dynamic-function-range max value and 0xFFF0
To configure a persistent adjacency-sid:

**Command syntax: adjacency-sid [adjacency-sid]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family srv6 locator-name

**Note**
- Configured a SRv6 locator
- Configured SID value must be in the locator's static-function-range
- Support up to two configured adjacency-sids per interface.

**Parameter table**

+---------------+------------------------------+----------------+---------+
| Parameter     | Description                  | Range          | Default |
+===============+==============================+================+=========+
| adjacency-sid | adjacency-sid function value | 0x0001..0xFFF0 | \-      |
+---------------+------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-1
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# srv6
    dnRouter(cfg-if-afi-srv6)# locator-name LOCATOR_1
    dnRouter(cfg-afi-srv6-loc)# adjacency-sid 0xFE00
    dnRouter(cfg-srv6-loc-adj-sid)#


**Removing Configuration**

To remove configured adjacency-sid:
::

    dnRouter(cfg-if-afi-srv6)# no adjacency-sid 0xFE00

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.3    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/srv6/locator-name/adjacency-sid/protection-eligible.rst

protocols isis instance interface address-family srv6 locator-name adjacency-sid protection-eligible
----------------------------------------------------------------------------------------------------

**Minimum user role:** operator

* For adjacency-sid configured without protection-eligible (default behavior), SID is always advertised with B flag unset, regardless of protection status in ISIS. Such adjacency-sid will not be protected and will not have an alternate path.
* For adjacency-sid configured with protection-eligible flag, sid is always advertised with B flag set. Regardless of protection status in ISIS (i.e if LFA/TI-LFA is enabled).

To set the adjacency-sid as protection-eligible:

**Command syntax: protection-eligible**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family srv6 locator-name adjacency-sid

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-1
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# srv6
    dnRouter(cfg-if-afi-srv6)# locator-name LOCATOR_1
    dnRouter(cfg-afi-srv6-loc)# adjacency-sid 0xFE00
    dnRouter(cfg-srv6-loc-adj-sid)# protection-eligible


**Removing Configuration**

To return to default behavior:
::

    dnRouter(cfg-srv6-loc-adj-sid)# no protection-eligible

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.3    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/srv6/locator-name/locator-name.rst

protocols isis instance interface address-family srv6 locator-name
------------------------------------------------------------------

**Minimum user role:** operator

Configure adjacency-SIDs assosiated with a specific SRv6 locator


**Command syntax: locator-name [locator-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family srv6

**Parameter table**

+--------------+----------------+------------------+---------+
| Parameter    | Description    | Range            | Default |
+==============+================+==================+=========+
| locator-name | Choose locator | | string         | \-      |
|              |                | | length 1-255   |         |
+--------------+----------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-1
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# srv6
    dnRouter(cfg-if-afi-srv6)# locator-name LOCATOR_1
    dnRouter(cfg-afi-srv6-loc)#


**Removing Configuration**

To remove a specific or all configured locators:
::

    dnRouter(cfg-if-afi-srv6)# no locator-name LOCATOR_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.3    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/srv6/srv6.rst

protocols isis instance interface address-family srv6
-----------------------------------------------------

**Minimum user role:** operator

SRv6 related configuration

**Command syntax: srv6**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-1
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# srv6
    dnRouter(cfg-if-afi-srv6)#


**Removing Configuration**

To remove SRv6 configuration:
::

    dnRouter(cfg-inst-if-afi)# no srv6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.3    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/tag_1.rst

protocols isis instance interface address-family tag level level-1
------------------------------------------------------------------

**Minimum user role:** operator

By default, no tag is set on any interface that is associated with the IS-IS instance. Use this command to associate a tag with the interface.
The tag will be attached to any prefix set on the interface for the given address-family (ipv4-unicast/ipv6-unicast), and is advertised by IS-IS.
Once tagged, the tag may subsequently match a defined policy and it may be sent in an appropriate sub-TLV (135 for IPv4 ST, 235 for IPv4 MT, 236 for IPv6 ST and 237 for IPv6 MT) when the prefix is advertised via the IS-IS protocol.

Although advertised to the rest of the world via IS-IS, the defined tag will not appear in the RIB of the local router.
The local router sees this route as a directly connected route; it does not see IS-IS as the source of this route.
Therefore, the defined tag is used only by IS-IS. This tag will not be redistributed into other protocols.

To configure the IS-IS tag per interface and address-family:

**Command syntax: tag level level-1 [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The tag value is signaled in the LSP as a sub-TLV of the prefix TLV.
- The tag for an IPv6 prefix can differ from the tag of an IPv4 prefix, even when working in a single-topology.
- By default the tag applies to both Levels unless the Level is explicitly indicated.
- IS-IS local interface prefix has priority over redistributed connected of the same prefix therefore the tag behavior will be in accordance with local IS-IS interface settings.

**Parameter table**

+-----------+-----------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                           | Range        | Default |
+===========+=======================================================================+==============+=========+
| tag       | Set the tag value to be attached to prefixes and advertised by IS-IS. | 1-4294967295 | \-      |
+-----------+-----------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag 200

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2 dnRouter
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag 20


**Removing Configuration**

To remove the tag:
::

    dnRouter(cfg-inst-if-afi)# no tag level-1
    dnRouter(cfg-inst-if-afi)# no tag level-2
    dnRouter(cfg-inst-if-afi)# no tag level-2 20
    dnRouter(cfg-inst-if-afi)# no tag

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/tag_2.rst

protocols isis instance interface address-family tag level level-2
------------------------------------------------------------------

**Minimum user role:** operator

By default, no tag is set on any interface that is associated with the IS-IS instance. Use this command to associate a tag with the interface.
The tag will be attached to any prefix set on the interface for the given address-family (ipv4-unicast/ipv6-unicast), and is advertised by IS-IS.
Once tagged, the tag may subsequently match a defined policy and it may be sent in an appropriate sub-TLV (135 for IPv4 ST, 235 for IPv4 MT, 236 for IPv6 ST and 237 for IPv6 MT) when the prefix is advertised via the IS-IS protocol.

Although advertised to the rest of the world via IS-IS, the defined tag will not appear in the RIB of the local router.
The local router sees this route as a directly connected route; it does not see IS-IS as the source of this route.
Therefore, the defined tag is used only by IS-IS. This tag will not be redistributed into other protocols.

To configure the IS-IS tag per interface and address-family:

**Command syntax: tag level level-2 [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The tag value is signaled in the LSP as a sub-TLV of the prefix TLV.
- The tag for an IPv6 prefix can differ from the tag of an IPv4 prefix, even when working in a single-topology.
- By default the tag applies to both Levels unless the Level is explicitly indicated.
- IS-IS local interface prefix has priority over redistributed connected of the same prefix therefore the tag behavior will be in accordance with local IS-IS interface settings.

**Parameter table**

+-----------+-----------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                           | Range        | Default |
+===========+=======================================================================+==============+=========+
| tag       | Set the tag value to be attached to prefixes and advertised by IS-IS. | 1-4294967295 | \-      |
+-----------+-----------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag 200

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2 dnRouter
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag 20


**Removing Configuration**

To remove the tag:
::

    dnRouter(cfg-inst-if-afi)# no tag level-1
    dnRouter(cfg-inst-if-afi)# no tag level-2
    dnRouter(cfg-inst-if-afi)# no tag level-2 20
    dnRouter(cfg-inst-if-afi)# no tag

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/tag.rst

protocols isis instance interface address-family tag
----------------------------------------------------

**Minimum user role:** operator

By default, no tag is set on any interface that is associated with the IS-IS instance. Use this command to associate a tag with the interface.
The tag will be attached to any prefix set on the interface for the given address-family (ipv4-unicast/ipv6-unicast), and is advertised by IS-IS.
Once tagged, the tag may subsequently match a defined policy and it may be sent in an appropriate sub-TLV (135 for IPv4 ST, 235 for IPv4 MT, 236 for IPv6 ST and 237 for IPv6 MT) when the prefix is advertised via the IS-IS protocol.

Although advertised to the rest of the world via IS-IS, the defined tag will not appear in the RIB of the local router.
The local router sees this route as a directly connected route; it does not see IS-IS as the source of this route.
Therefore, the defined tag is used only by IS-IS. This tag will not be redistributed into other protocols.

To configure the IS-IS tag per interface and address-family:

**Command syntax: tag [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The tag value is signaled in the LSP as a sub-TLV of the prefix TLV.
- The tag for an IPv6 prefix can differ from the tag of an IPv4 prefix, even when working in a single-topology.
- By default the tag applies to both Levels unless the Level is explicitly indicated.
- IS-IS local interface prefix has priority over redistributed connected of the same prefix therefore the tag behavior will be in accordance with local IS-IS interface settings.

**Parameter table**

+-----------+-----------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                           | Range        | Default |
+===========+=======================================================================+==============+=========+
| tag       | Set the tag value to be attached to prefixes and advertised by IS-IS. | 1-4294967295 | \-      |
+-----------+-----------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag 200

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2 dnRouter
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag 20


**Removing Configuration**

To remove the tag:
::

    dnRouter(cfg-inst-if-afi)# no tag level-1
    dnRouter(cfg-inst-if-afi)# no tag level-2
    dnRouter(cfg-inst-if-afi)# no tag level-2 20
    dnRouter(cfg-inst-if-afi)# no tag

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/weight_level-1.rst

protocols isis instance interface address-family weight level level-1
---------------------------------------------------------------------

**Minimum user role:** operator

Set the interface weight to be used for the weighted ecmp forwarding.
For weight = if-bw, the interface weight is the ratio of the interface bandwidth to 1G.
To configure the weight for the interface address-family:

**Command syntax: weight level level-1 [weight]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS weight is per the interface bandwidth.

**Parameter table**

+-----------+-------------------+-----------------------+---------+
| Parameter | Description       | Range                 | Default |
+===========+===================+=======================+=========+
| weight    | ISIS type level-1 | 1..4294967295 | if-bw | \-      |
+-----------+-------------------+-----------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# weight level level-1 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# weight level level-1 15
    dnRouter(cfg-inst-if-afi)# weight level level-1 if-bw


**Removing Configuration**

To revert to the default weight for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no weight level-1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/weight_level-2.rst

protocols isis instance interface address-family weight level level-2
---------------------------------------------------------------------

**Minimum user role:** operator

Set the interface weight to be used for the weighted ecmp forwarding.
For weight = if-bw, the interface weight is the ratio of the interface bandwidth to 1G.
To configure the weight for the interface address-family:

**Command syntax: weight level level-2 [weight]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS weight is per the interface bandwidth.

**Parameter table**

+-----------+-------------------+-----------------------+---------+
| Parameter | Description       | Range                 | Default |
+===========+===================+=======================+=========+
| weight    | ISIS type level-2 | 1..4294967295 | if-bw | \-      |
+-----------+-------------------+-----------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# weight level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# weight level level-2 15
    dnRouter(cfg-inst-if-afi)# weight level level-2 if-bw


**Removing Configuration**

To revert to the default weight for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no weight level-2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/interface/afi/weight.rst

protocols isis instance interface address-family weight
-------------------------------------------------------

**Minimum user role:** operator

Set the interface weight to be used for the weighted ecmp forwarding.
For weight = if-bw, the interface weight is the ratio of the interface bandwidth to 1G.
To configure the weight for the interface address-family:

**Command syntax: weight [weight]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS weight is per the interface bandwidth.

**Parameter table**

+-----------+-------------+-----------------------+---------+
| Parameter | Description | Range                 | Default |
+===========+=============+=======================+=========+
| weight    | weight      | 1..4294967295 | if-bw | if-bw   |
+-----------+-------------+-----------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# weight 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# weight if-bw

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# weight level level-1 15
    dnRouter(cfg-inst-if-afi)# weight level level-2 if-bw

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# weight level level-1 15
    dnRouter(cfg-inst-if-afi)# weight 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-fa-afi)# no weight 60

To revert to the default weight (when weight per level is not set):
::

    dnRouter(cfg-inst-if-afi)# no weight
    dnRouter(cfg-inst-if-afi)# no weight 15

To revert to the default weight for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no weight level-2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/interface/authentication_keychain.rst

protocols isis instance interface authentication keychain
---------------------------------------------------------

**Minimum user role:** operator

To enable hello messages authentication for the interface:


**Command syntax: authentication keychain [keychain-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Note**
- Interface authentication is not applicable to loopback interfaces.


**Parameter table**

+---------------+-----------------------------------------------------------------------+------------------+---------+
| Parameter     | Description                                                           | Range            | Default |
+===============+=======================================================================+==================+=========+
| keychain-name | Reference to a keychain that should be used for hello authentication. | | string         | \-      |
|               |                                                                       | | length 1-255   |         |
+---------------+-----------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# authentication keychain ISIS-keys


**Removing Configuration**

To remove the configuration:
::

    dnRouter(cfg-isis-inst-if)# no authentication

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 6.0     | Command introduced          |
+---------+-----------------------------+
| 25.2    | Added support for keychains |
+---------+-----------------------------+

---

### instance/interface/authentication.rst

protocols isis instance interface authentication password
---------------------------------------------------------

**Minimum user role:** operator

To enable hello messages authentication for the interface:

**Command syntax: authentication [type] password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Note**
- When typing a clear password, the password **won't** be displayed in the CLI terminal
- A clear password length cannot exceed 254 charachters
- Interface authentication is not applicable to loopback interfaces
..- The password is saved encrypted and always displayed as a secret

**Parameter table**

+--------------+----------------------------------------------------------------------------------+-----------------------------------------------+---------+
| Parameter    | Description                                                                      | Range                                         | Default |
+==============+==================================================================================+===============================================+=========+
| type         | The type of authentication used.                                                 | | md5                                         | \-      |
|              |                                                                                  | | clear-text                                  |         |
|              |                                                                                  | | keychain                                    |         |
+--------------+----------------------------------------------------------------------------------+-----------------------------------------------+---------+
| enc-password | The encrypted password. If you do not set an encrypted password, you will be     | A clear password cannot exceed 254 characters | \-      |
|              | prompted to enter a clear password and verify it.                                |                                               |         |
|              | When typing a clear password, the password will   not be displayed in the CLI    |                                               |         |
|              | terminal. The password format must match the encrypted format as displayed in    |                                               |         |
|              | "show config".                                                                   |                                               |         |
+--------------+----------------------------------------------------------------------------------+-----------------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# authentication md5 password
    Enter password
    Enter password for verifications

    dnRouter(cfg-isis-inst-if)# authentication md5 password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==


**Removing Configuration**

To remove the configuration:
::

    dnRouter(cfg-isis-inst-if)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### instance/interface/bfd/address-family.rst

protocols isis instance interface bfd address-family
----------------------------------------------------

**Minimum user role:** operator

By default, a BFD session is established to the interface IP address in the neighbor hello packets, for both IPv4 and IPv6 sessions. When a specific address-family is configured, a BFD session will be establish for that address-family only. BFD protection is per address family, i.e a BFD session down event will update connectivity for the relevant address family topology only.

To configure BFD protection a specific address family:

**Command syntax: address-family [address-family]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface bfd

**Parameter table**

+----------------+----------------------------------------------------------------------------------+---------------+-----------+
| Parameter      | Description                                                                      | Range         | Default   |
+================+==================================================================================+===============+===========+
| address-family | The address-family for which to set BFD protection.                              | | ipv4        | ipv4-ipv6 |
|                | A BFD session will be established for this address family only and a BFD session | | ipv6        |           |
|                | down event will update connectivity for the relevant address family topology     | | ipv4-ipv6   |           |
|                | only.                                                                            |               |           |
+----------------+----------------------------------------------------------------------------------+---------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# isis-level level-1-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# bfd
    dnRouter(cfg-inst-if-bfd)# address-family ipv4


**Removing Configuration**

To revert all BFD configuration to their default values:
::

    dnRouter(cfg-inst-if-bfd)# no address-family

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/bfd/admin-state.rst

protocols isis instance interface bfd admin-state
-------------------------------------------------

**Minimum user role:** operator

To enable/disable a BFD session for IS-IS on the interface:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface bfd

**Note**
- If multiple BFD clients are registered to the same BFD session, a single BFD session is established with the strictest session parameters between all clients.

**Parameter table**

+-------------+----------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                          | Range        | Default  |
+=============+======================================================================+==============+==========+
| admin-state | The administrative state of the BFD feature on  the IS-IS interface. | | enabled    | disabled |
|             |                                                                      | | disabled   |          |
+-------------+----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# isis-level level-1-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# bfd
    dnRouter(cfg-inst-if-bfd)# admin-state enabled


**Removing Configuration**

To disable BFD on the interface:
::

    dnRouter(cfg-inst-if-bfd)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/bfd/bfd.rst

protocols isis instance interface bfd
-------------------------------------

**Minimum user role:** operator

BFD single hop session is used to protected IS-IS link reachability. The BFD session is establish when an IS-IS adjacency is formed. The interface IP address serves as the BFD source address and the IS-IS neighbor address for the given interface serves as the BFD destination address.

To configure BFD protection for IS-IS (BFD must be configured on this interface):


**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Note**

- When the BFD session goes down, IS-IS is notified for the neighbor adjacency state changes to take effect.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# isis-level level-1-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# bfd
    dnRouter(cfg-inst-if-bfd)#


**Removing Configuration**

To revert all BFD configuration to their default values:
::

    dnRouter(cfg-isis-inst-if)# no bfd

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 9.0     | Command removed      |
+---------+----------------------+
| 12.0    | Command reintroduced |
+---------+----------------------+

---

### instance/interface/bfd/min-rx.rst

protocols isis instance interface bfd min-rx
--------------------------------------------

**Minimum user role:** operator

The desired minimum receive interval is the time-frame in which a BFD packet is expected to arrive. If a BFD packet is not received within the configured interval, the BFD session will go down.
The min-rx together with the multiplier, defines the detection time.
The Local Detection timeout = negotiated Rx interval * remote_multiplier (the multiplier value received on the BFD packet).
The Remote Detection timeout = negotiated Tx interval * local_multiplier (the multiplier value configured locally for the session).
Set the desired minimum receive interval for the BFD session:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface bfd

**Note**

- Due to hardware limitation, maximum supported transmit rate is 1700 msec, and negotiated transmit interval higher than 1700 msec will result in actual transmit rate of 1700 msec.

**Parameter table**

+-----------+---------------------------------------------------------------------+--------+---------+
| Parameter | Description                                                         | Range  | Default |
+===========+=====================================================================+========+=========+
| min-rx    | The interval (in msec) in which a BFD packet is expected to arrive. | 5-1700 | 300     |
+-----------+---------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# isis-level level-1-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# bfd
    dnRouter(cfg-inst-if-bfd)# min-rx 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-bfd)# no min-rx

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 12.0    | Command introduced                |
+---------+-----------------------------------+
| 15.1    | Added support for 5 msec interval |
+---------+-----------------------------------+

---

### instance/interface/bfd/min-tx.rst

protocols isis instance interface bfd min-tx
--------------------------------------------

**Minimum user role:** operator

The minimum transmission interval is the time between consecutive transmissions of BFD packets. To configure the transmission rate of BFD packets:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface bfd

**Note**

- Due to hardware limitation, maximum supported transmit rate is 1700msec, and negotiated transmit interval higher than 1700 msec will result in actual transmit rate of 1700 msec.

**Parameter table**

+-----------+--------------------------------------------------------------+--------+---------+
| Parameter | Description                                                  | Range  | Default |
+===========+==============================================================+========+=========+
| min-tx    | The interval (in msec) between transmissions of BFD packets. | 5-1700 | 300     |
+-----------+--------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# isis-level level-1-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# bfd
    dnRouter(cfg-inst-if-bfd)# min-tx 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-bfd)# no min-tx

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 12.0    | Command introduced               |
+---------+----------------------------------+
| 15.1    | Added support for 5msec interval |
+---------+----------------------------------+

---

### instance/interface/bfd/multiplier.rst

protocols isis instance interface bfd multiplier
------------------------------------------------

**Minimum user role:** operator

The multiplier defines the number of min-rx intervals in which a BFD packet is not received before the BFD session goes down.

To configure a local BFD multiplier:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface bfd

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| multiplier | The number of min-rx intervals in which no BFD packet is received as expected    | 2-16  | 3       |
|            | (or the number of missing BFD packets) before the BFD session goes down.         |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# isis-level level-1-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# bfd
    dnRouter(cfg-inst-if-bfd)# multiplier 5

For example, if min-rx is configured to 100 msec and the multiplier is 5, this means that if BFD packets stop arriving, after 500 msec the session goes down.


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-bfd)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/bfd/rsvp-dependency.rst

protocols isis instance interface bfd rsvp-dependency
-----------------------------------------------------

**Minimum user role:** operator

Configure BFD IPv4 for IS-IS to trigger RSVP -TE FRR events. When set, a failure on an IPv4 SH-BFD session protecting IS-IS adjacency will also trigger local an FRR reaction in FIB & RSVP.

**Command syntax: rsvp-dependency [rsvp-dependency]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface bfd

**Parameter table**

+-----------------+----------------------------------------------------+--------------+----------+
| Parameter       | Description                                        | Range        | Default  |
+=================+====================================================+==============+==========+
| rsvp-dependency | The administrative state of the BFD IPv4 for IS-IS | | enabled    | disabled |
|                 |                                                    | | disabled   |          |
+-----------------+----------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# bfd
    dnRouter(cfg-inst-if-bfd)# rsvp-dependency enabled


**Removing Configuration**

To revert all BFD configuration to their default values
::

    dnRouter(cfg-inst-if-bfd)# no rsvp-dependency

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.2    | Command introduced |
+---------+--------------------+

---

### instance/interface/delay-normalization/delay-normalization.rst

protocols isis instance interface delay-normalization
-----------------------------------------------------

**Minimum user role:** operator

Performance monitoring (PM) measures various link characteristics like packet loss, delay and jitter. Such characteristics can be used by IS-IS as a metric for flexible algorithm computation. Low latency routing using dynamic delay measurement is one of the primary use cases for flexible algorithm technology.
Delay is measured in microseconds. If delay values are taken as measured and used as link metrics during the IS-IS topology computation, some valid ECMP paths might be unused because of the negligible difference in the link delay.
The Delay Normalization feature computes a normalized delay value and uses the normalized value instead. This value is advertised and used as a metric during the flexible algorithm computation.
The normalization is performed when the delay is received from the delay measurement component. When the next value is received, it is normalized and compared to the previous saved normalized value. If the values are different, then the LSP generation is triggered.

The following formula is used to calculate the normalized value:


- Dm  measured delay
- Int  configured normalized interval
- Off  configured normalized offset (must be less than the normalized interval Int)
- Dn  normalized delay
- a = Dm / Int (rounded down)
- b = a * Int + Off


If the measured delay (Dm) is less than or equal to b, then the normalized delay (Dn) is equal to b. Otherwise, Dn is b + Int.
To configure IS-IS interface delay normalization and enter the delay normalization configuration mode:

**Command syntax: delay-normalization**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# delay-normalization
    dnRouter(cfg-inst-if-normalization)#


**Removing Configuration**

To revert all delay normalization configuration to its default values:
::

    dnRouter(cfg-isis-inst-if)# no delay-normalization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/delay-normalization/interval.rst

protocols isis instance interface delay-normalization interval
--------------------------------------------------------------

**Minimum user role:** operator

To configure the IS-IS delay normalization interval on the interface:

**Command syntax: interval [delay-normalization-interval]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface delay-normalization

**Parameter table**

+------------------------------+----------------------------------------------------------------+--------------+---------+
| Parameter                    | Description                                                    | Range        | Default |
+==============================+================================================================+==============+=========+
| delay-normalization-interval | The value of the delay normalization interval in microseconds. | 1-4294967295 | \-      |
+------------------------------+----------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# delay-normalization
    dnRouter(cfg-inst-if-normalization)# interval 5


**Removing Configuration**

To remove the delay normalization interval configuration:
::

    dnRouter(cfg-inst-if-normalization)# no interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/delay-normalization/offset.rst

protocols isis instance interface delay-normalization offset
------------------------------------------------------------

**Minimum user role:** operator

To configure the IS-IS delay normalization offset on the interface:

**Command syntax: offset [delay-normalization-offset]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface delay-normalization

**Parameter table**

+----------------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter                  | Description                                                                      | Range        | Default |
+============================+==================================================================================+==============+=========+
| delay-normalization-offset | The value of the delay normalization offset in microseconds. This value must be  | 0-4294967294 | 0       |
|                            | smaller than the value of normalized interval.                                   |              |         |
+----------------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# delay-normalization
    dnRouter(cfg-inst-if-normalization)# offset 3


**Removing Configuration**

To revert the delay normalization offset configuration to its default value:
::

    dnRouter(cfg-inst-if-normalization)# no offset

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/hello-padding.rst

protocols isis instance interface hello-padding
-----------------------------------------------

**Minimum user role:** operator

By default, hello PDUs are padded to the lsp-MTU size of the interface. This is in order to ensure there is no MTU mismatch before the adjacency is established, avoiding the risk of LSP packet loss due to exceeded packet size.

To enable/disable padding:

**Command syntax: hello-padding [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Parameter table**

+-------------+---------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                         | Range        | Default |
+=============+=====================================================================+==============+=========+
| admin-state | The administrative state of the padding option of IS-IS hello PDUs. | | enabled    | enabled |
|             |                                                                     | | disabled   |         |
+-------------+---------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# hello-padding enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-isis-inst-if)# no hello-padding

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 9.0     | Command removed      |
+---------+----------------------+
| 10.0    | Command reintroduced |
+---------+----------------------+

---

### instance/interface/interface.rst

protocols isis instance interface
---------------------------------

**Minimum user role:** operator

To enable IS-IS on an interface and enter interface configuration mode:


**Command syntax: interface [interface-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- Loopback interfaces can be set on multiple IS-IS instances. All other interface types cannot be enabled on more than one IS-IS instance. Loopback interfaces are passive by default.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+----------------------------------------+---------+
| Parameter      | Description                                                                      | Range                                  | Default |
+================+==================================================================================+========================================+=========+
| interface-name | The name of the interface on which IS-IS is enabled. An interface can only be    | | configured interface name.           | \-      |
|                | configured to a single IS-IS instance.                                           | | lo<0-65535>                          |         |
|                |                                                                                  | | irb<0-65535>                         |         |
|                |                                                                                  | | ge{/10/25/40/100}-X/Y/Z              |         |
|                |                                                                                  | | geX-<f>/<n>/<p>.<sub-interface id>   |         |
|                |                                                                                  | | bundle-<bundle-id>                   |         |
|                |                                                                                  | | bundle-<bundle-id.sub-bundle-id>     |         |
|                |                                                                                  | | gre-tunnel-<id>                      |         |
+----------------+----------------------------------------------------------------------------------+----------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface ge100-1/2/1
    dnRouter(cfg-isis-inst-if)#

    dnRouter(cfg-protocols-isis-inst)# interface bundle-2.1012
    dnRouter(cfg-isis-inst-if)#

    dnRouter(cfg-protocols-isis-inst)# interface gre-tunnel-0
    dnRouter(cfg-isis-inst-if)#


**Removing Configuration**

To disable the IS-IS process on an interface:
::

    dnRouter(cfg-protocols-isis-inst)# no interface ge100-1/2/1

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 6.0     | Command introduced            |
+---------+-------------------------------+
| 11.4    | Added support for GRE-tunnels |
+---------+-------------------------------+

---

### instance/interface/level.rst

protocols isis instance interface level
---------------------------------------

**Minimum user role:** operator

ISs that are configured as Level-1-2 may have multiple interfaces for various routing levels. For example, focusing on Area 1 in the following diagram, R3, which is a Level-1-2 IS, has 4 interfaces: 2 interfaces towards R1 and R2 for routing within Area 1 (indicated by the blue lines), 1 interface facing R5 in Area 2 for routing between Area 1 and Area 2, and a fourth interface facing R4, another Level-1-2 IS within Area 1. The R3-R4 link must allow both level-1 routing to enable traffic within Area 1 (as indicated by the blue dashed arrow) and also level-2 routing to enable traffic between the areas (as indicated by the orange dashed arrow). In this case, you would configure the R1- and R2-facing interfaces to circuit-type level-1 in order to form only level-1 adjacencies. Similarly, the R5-facing interface would be configured to form only level-2 adjacencies, while the R4-facing interface would be configured to form level-1-2 adjacencies to enable both routing levels.

A level-1 adjacency can only be formed when both routers are working in level-1 and both share the same Area-ID and prefix portion of the router IS-IS ISO-network.

To configure an interface to support a specific adjacency level:

**Command syntax: level [level]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Note**

- You cannot set a level for loopback interfaces. For loopback interfaces, the interface level is always according to the IS-IS level within the same IS-IS instance.

**Parameter table**

+-----------+--------------------------------------------------------------+---------------+-----------+
| Parameter | Description                                                  | Range         | Default   |
+===========+==============================================================+===============+===========+
| level     | Sets the interface to support the specified adjacency level. | | level-1     | level-1-2 |
|           |                                                              | | level-2     |           |
|           |                                                              | | level-1-2   |           |
+-----------+--------------------------------------------------------------+---------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# level level-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# level level-2

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# level level-1-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# level level-2
    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# level level-1


**Removing Configuration**

To revert to the default interface level:
::

    dnRouter(cfg-isis-inst-if)# no level

**Command History**

+---------+------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                               |
+=========+============================================================================================================+
| 6.0     | Command introduced                                                                                         |
+---------+------------------------------------------------------------------------------------------------------------+
| 9.0     | Removed level-1 and level-1-2 routing, changed   the argument in the syntax from "circuit-type" to "level" |
+---------+------------------------------------------------------------------------------------------------------------+
| 14.0    | Added support for level-1-2 (default changed to level-1-2)                                                 |
+---------+------------------------------------------------------------------------------------------------------------+

---

### instance/interface/mesh-group.rst

protocols isis instance interface mesh-group
--------------------------------------------

**Minimum user role:** operator

This command allows you to set the mesh-group behavior on an interface.
When set to *blocked*, all LSPs including flooded and self-originated will not be sent over the interface.
When set to *mesh-id*, an LSP received on an interface that matches the same mesh-id within the IS-IS instance will not be flooded over this interface.
To configure the mesh-group behavior for the interface:

**Command syntax: mesh-group [mesh-id]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Parameter table**

+-----------+---------------------------------------+----------------------+---------+
| Parameter | Description                           | Range                | Default |
+===========+=======================================+======================+=========+
| mesh-id   | The mesh-id within the IS-IS instance | 0-4294967295/blocked | \-      |
+-----------+---------------------------------------+----------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# mesh-group blocked

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-1
    dnRouter(cfg-isis-inst-if)# mesh-group 5


**Removing Configuration**

To remove the mesh-group setting:
::

    dnRouter(cfg-isis-inst-if)# no mesh-group

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/network-type.rst

protocols isis instance interface network-type
----------------------------------------------

**Minimum user role:** operator

You can configure the IS-IS interface to behave like a point-to-point connection. Configuring a point-to-point adjacency over a broadcast media can improve convergence times because it prevents the system from electing a designated router, prevents flooding from database synchronization, and simplifies SPF computations. This setting affects only IS-IS protocol procedures on the specific interface.

To configure the network-type for the interface:

**Command syntax: network-type [network-type]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Parameter table**

+--------------+---------------------------------------------+----------------+----------------+
| Parameter    | Description                                 | Range          | Default        |
+==============+=============================================+================+================+
| network-type | Sets the adjacency type on the interface.   | point-to-point | point-to-point |
|              | Existing adjacencies will be reset.         |                |                |
+--------------+---------------------------------------------+----------------+----------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# network-type point-to-point


**Removing Configuration**

To revert to the default network type:
::

    dnRouter(cfg-isis-inst-if)# no network-type

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 6.0     | Command introduced                |
+---------+-----------------------------------+
| 9.0     | Removed "broadcast" network-type. |
+---------+-----------------------------------+

---

### instance/interface/passive.rst

protocols isis instance interface passive
-----------------------------------------

**Minimum user role:** operator

Setting an interface to passive mode, instructs IS-IS to only advertise its IP address in the link-state PDUs without running the IS-IS protocol. The interface will not send or receive IS-IS packets.

To set the interface to passive mode:

**Command syntax: passive [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Note**

- Loopback interfaces configured with IS-IS are automatically passive by default and cannot be set to active.

- Passive interfaces receive a metric value of 0 by default.

**Parameter table**

+-------------+-----------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                           | Range        | Default  |
+=============+=======================================================================+==============+==========+
| admin-state | The administrative state of the passive mode for the IS-IS interface. | | enabled    | disabled |
|             |                                                                       | | disabled   |          |
+-------------+-----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# passive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-isis-inst-if)# no passive

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 9.0     | Command removed      |
+---------+----------------------+
| 10.0    | Command reintroduced |
+---------+----------------------+

---

### instance/interface/timers/dead-interval.rst

protocols isis instance interface timers dead-interval
------------------------------------------------------

**Minimum user role:** operator

Routing devices send hello packets at a fixed interval on all interfaces to establish and maintain neighbor relationships. This interval is advertised in the dead interval field in the hello packet.

To modify the amount of time during which hello messages are missing before the neighbor can declare the adjacency as "down":


**Command syntax: dead-interval [dead-interval]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface timers

**Note**

- Reconfiguring dead-interval will reset the hello interval timer and immiditaly cause a hello message to be sent.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter     | Description                                                                      | Range   | Default |
+===============+==================================================================================+=========+=========+
| dead-interval | The dead-interval (in seconds) that will be advertised to neighbors. If a        | 1-65535 | 30      |
|               | neighbor will not receive a hello message within this interval, it will declare  |         |         |
|               | the adjacency as down.                                                           |         |         |
|               | You must select a value that is at least 3 times the value of the hello-interval |         |         |
|               | timer.                                                                           |         |         |
+---------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# timers
    dnRouter(cfg-inst-if-timers)# dead-interval 15


**Removing Configuration**

To revert to the default interval:
::

    dnRouter(cfg-inst-if-timers)# no dead-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### instance/interface/timers/hello-interval.rst

protocols isis instance interface timers hello-interval
-------------------------------------------------------

**Minimum user role:** operator

Routing devices send hello packets at a fixed interval on all interfaces to establish and maintain neighbor relationships. This interval is advertised in the hello interval field in the hello packet.

To modify the frequency with which the routing device sends hello packets out of an interface:


**Command syntax: hello-interval [hello-interval]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface timers

**Note**

- Reconfiguring hello-interval will reset the interval timer and immiditaly cause a hello message to be sent.

**Parameter table**

+----------------+------------------------------------------------------------+---------+---------+
| Parameter      | Description                                                | Range   | Default |
+================+============================================================+=========+=========+
| hello-interval | The time (in seconds) between hello messages for a domain. | 1-65535 | 10      |
+----------------+------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# timers
    dnRouter(cfg-inst-if-timers)# hello-interval 5


**Removing Configuration**

To revert to the default interval:
::

    dnRouter(cfg-inst-if-timers)# no hello-interval

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 6.0     | Command introduced   |
+---------+----------------------+
| 9.0     | Command removed      |
+---------+----------------------+
| 10.0    | Command reintroduced |
+---------+----------------------+

---

### instance/interface/timers/timers.rst

protocols isis instance interface timers
----------------------------------------

**Minimum user role:** operator

To configure IS-IS interface timers and enter timers configuration mode:


**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# timers
    dnRouter(cfg-inst-if-timers)#


**Removing Configuration**

To revert all timers to their default value:
::

    dnRouter(cfg-isis-inst-if)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/advertise-passive-only.rst

protocols isis instance address-family ipv4-multicast advertise passive-only
----------------------------------------------------------------------------

**Minimum user role:** operator

The advertise passive-only command enables to administratively set IS-IS to advertise routes only from passive interfaces.


**Command syntax: advertise passive-only [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Parameter table**

+-------------+-------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                   | Range        | Default  |
+=============+===============================================================================+==============+==========+
| admin-state | Administrative setting IS-IS to advertise routes only from passive interfaces | | enabled    | disabled |
|             |                                                                               | | disabled   |          |
+-------------+-------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# advertise passive-only enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no advertise passive-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/fast-reroute_backup-candidate.rst

protocols isis instance address-family ipv4-multicast fast-reroute backup-candidate
-----------------------------------------------------------------------------------

**Minimum user role:** operator

This commands supports including or excluding all IS-IS instance interfaces for being a candidate for repair path calculations.
When excluded, the interface will not be used for repair paths.
The interface will be used for loop-free alternate calculations when IS-IS fast-reroute is globally enabled.


**Command syntax: fast-reroute backup-candidate [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Parameter table**

+-------------+---------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                     | Range        | Default |
+=============+=================================================================================+==============+=========+
| admin-state | Enable interface for being candidate for repair path calculation for L2 routing | | enabled    | enabled |
|             |                                                                                 | | disabled   |         |
+-------------+---------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute backup-candidate enabled


**Removing Configuration**

To revert fast-reroute backup-candidate settings to their default value:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute backup-candidate

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/fast-reroute_level-1-2.rst

protocols isis instance address-family ipv4-multicast fast-reroute
------------------------------------------------------------------

**Minimum user role:** operator

Defines the administrative state of fast-reroute per IS-IS instance ipv4-multicast topology.
If enabled, all interfaces currently configured as fast-reroute backup-candidates will be eligible for LFA calculation.
This means that for each interface through which IS-IS prefixes are learned as best, the backup path will be calculated accordingly.
Once enabled, fast-reroute state is set for both level-1 and level-2 (depending on the IS-IS level).
Fast reroute alternate paths for the prefix of level-1/level-2 are only available through level-1/level-2 nodes respectively.


**Command syntax: fast-reroute [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- Fast-reroute level-1-2 settings are the default settings for fast-reroute level-1 and fast-reroute level-2

**Parameter table**

+-------------+----------------------------------------+--------------+----------+
| Parameter   | Description                            | Range        | Default  |
+=============+========================================+==============+==========+
| admin-state | Enable ISIS LFA (fast-reroute) setting | | enabled    | disabled |
|             |                                        | | disabled   |          |
+-------------+----------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled


**Removing Configuration**

To revert fast-reroute state to default value:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/fast-reroute_level-1.rst

protocols isis instance address-family ipv4-multicast fast-reroute level level-1
--------------------------------------------------------------------------------

**Minimum user role:** operator

This command defines the administrative state of fast-reroute per IS-IS instance ipv4-multicast topology.
If enabled, all interfaces currently configured as fast-reroute backup-candidate will be eligible for LFA calculation.
This means that for each interface through which IS-IS prefixes are learned as best, the backup path will be calculated accordingly.
Once enabled, fast-reroute state is set for level-1.
Fast reroute alternate paths for the prefix of level-1 is only available through level-1.


**Command syntax: fast-reroute level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- Fast-reroute level-1-2 settings will be default settings for fast-reroute level-1 and fast-reroute level-2

**Parameter table**

+-------------+----------------------------------------+--------------+---------+
| Parameter   | Description                            | Range        | Default |
+=============+========================================+==============+=========+
| admin-state | Enable ISIS LFA (fast-reroute) setting | | enabled    | \-      |
|             |                                        | | disabled   |         |
+-------------+----------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute level level-1 enabled


**Removing Configuration**

To revert fast-reroute level-1 state to default value:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute level level-1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/fast-reroute_level-2.rst

protocols isis instance address-family ipv4-multicast fast-reroute level level-2
--------------------------------------------------------------------------------

**Minimum user role:** operator

This command defines the administrative state of fast-reroute per IS-IS instance ipv4-multicast topology.
If enabled, all interfaces currently configured as fast-reroute backup-candidate will be eligible for LFA calculation.
This means that for each interface through which IS-IS prefixes are learned as best, the backup path will be calculated accordingly.
Once enabled, fast-reroute state is set for level-2.
Fast reroute alternate paths for prefix of level-2 is only available through level-1.


**Command syntax: fast-reroute level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- Fast-reroute level-1-2 settings will be default settings for fast-reroute level-1 and fast-reroute level-2

**Parameter table**

+-------------+----------------------------------------+--------------+---------+
| Parameter   | Description                            | Range        | Default |
+=============+========================================+==============+=========+
| admin-state | Enable ISIS LFA (fast-reroute) setting | | enabled    | \-      |
|             |                                        | | disabled   |         |
+-------------+----------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute level level-2 enabled


**Removing Configuration**

To revert fast-reroute level-2 state to default value:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute level level-2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/ipv4-multicast.rst

protocols isis instance address-family ipv4-multicast
-----------------------------------------------------

**Minimum user role:** operator

Enter the isis address-family ipv4 multicast configuration level:

**Command syntax: address-family ipv4-multicast**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- The configuration within this address-family only takes effect once the topology is enabled.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)#


**Removing Configuration**

To revert all ipv4 multicast configuration to default:
::

    dnRouter(cfg-protocols-isis-inst)# no address-family ipv4-multicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/maximum-paths.rst

protocols isis instance address-family ipv4-multicast maximum-paths
-------------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to install multiple paths with equal cost in the routing table:

**Command syntax: maximum-paths [maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Parameter table**

+---------------+--------------------+-------+---------+
| Parameter     | Description        | Range | Default |
+===============+====================+=======+=========+
| maximum-paths | ISIS multiple path | 1-64  | 8       |
+---------------+--------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# maximum-paths 24


**Removing Configuration**

To revert maximum-paths settings to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no maximum-paths

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/metric-level-1.rst

protocols isis instance address-family ipv4-multicast metric level level-1
--------------------------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive level-1 interface default metric value:

**Command syntax: metric level level-1 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | \-      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# metric level level-1 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric level level-1 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/metric-level-2.rst

protocols isis instance address-family ipv4-multicast metric level level-2
--------------------------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive level-2 interface default metric value:

**Command syntax: metric level level-2 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family, takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | \-      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# metric level level-2 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric level level-2 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/metric.rst

protocols isis instance address-family ipv4-multicast metric
------------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive interface default metric value:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family, takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | 10      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/prefix-priority.rst

protocols isis instance address-family ipv4-multicast prefix-priority tag
-------------------------------------------------------------------------

**Minimum user role:** operator

Assign a tag value to the prefix-priority, to ensure that prefixes with this tag are handled with the given priority

**Command syntax: prefix-priority [prefix-priority] tag [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Parameter table**

+-----------------+--------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                    | Range        | Default |
+=================+================================================================================+==============+=========+
| prefix-priority | The priority - low, mediumm or high                                            | | low        | \-      |
|                 |                                                                                | | medium     |         |
|                 |                                                                                | | high       |         |
+-----------------+--------------------------------------------------------------------------------+--------------+---------+
| tag             | Tag value, that if associated with a prefix will be given the defined priority | 1-4294967295 | \-      |
+-----------------+--------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#


**Removing Configuration**

To remove tag:
::

    dnRouter(cfg-inst-protocols-static)# no prefix-priority high

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/propagate_level1-to-level2.rst

protocols isis instance address-family ipv4-multicast propagate level1-to-level2 policy
---------------------------------------------------------------------------------------

**Minimum user role:** operator

Propagate isis routes between levels.
Propagate level-1 into level-2 - By default all routes from level-1 will be propagated to level-2.
The command is used to filter propagation.


**Command syntax: propagate level1-to-level2 policy [policy]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- Only "policy match ip prefix" can be used in the propagation attachement points. Other match / set statements will be ignored.

**Parameter table**

+-----------+----------------------------------------------------+------------------+---------+
| Parameter | Description                                        | Range            | Default |
+===========+====================================================+==================+=========+
| policy    | Used to filter propagation from Level 1 to Level 2 | | string         | \-      |
|           |                                                    | | length 1-255   |         |
+-----------+----------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# propagate level1-to-level2 policy L1_TO_L2_FILTER


**Removing Configuration**

To revert to default behavior, where all routes are propagated from level-1 to level-2:
::

    dnRouter(cfg-isis-inst-afi)# no propagate level1-to-level2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/propagate_level2-to-level1.rst

protocols isis instance address-family ipv4-multicast propagate level2-to-level1 policy
---------------------------------------------------------------------------------------

**Minimum user role:** operator

Propagate isis routes between levels.
Propagate level-2 into level-1 - By default no route is propagated from level-2 into level-1.
Use policy to control which routes will be propagated


**Command syntax: propagate level2-to-level1 policy [policy]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- Only "policy match ip prefix" can be used in the propagation attechement points. Other match / set statements will be ignored

**Parameter table**

+-----------+--------------------------------------+------------------+---------+
| Parameter | Description                          | Range            | Default |
+===========+======================================+==================+=========+
| policy    | Policy to filter allow leaked routes | | string         | \-      |
|           |                                      | | length 1-255   |         |
+-----------+--------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# propagate level2-to-level1 policy L2_TO_L1_FILTER


**Removing Configuration**

To stop level-2 to level-1 propagation:
::

    dnRouter(cfg-isis-inst-afi)# no propagate level2-to-level1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/redistribute_connected.rst

protocols isis instance address-family ipv4-multicast redistribute connected
----------------------------------------------------------------------------

**Minimum user role:** operator

Sets the redistribute connected routes into IS-IS:
metric - used to set routes metric. By default routes are redistributed with metric value 0.
policy - used to filter and modify redistributed routes. The user can match the route by "match ip prefix" and set whether to allow or deny routes redistribution. For allowed routes, the user can set isis-metric per specific prefixes
level - define into which isis level redistribute routes. When setting level-1-2 redistribute into both level-1 and level-2. By default, redistribute to both levels.


**Command syntax: redistribute connected** metric [metric] policy [policy] level [level]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- By default, no redistribution is performed.

- Metric-type: - internal - set IS-IS internal metric type. - external - set IS-IS external metric type.

**Parameter table**

+-----------+------------------------------------+------------------+-----------+
| Parameter | Description                        | Range            | Default   |
+===========+====================================+==================+===========+
| metric    | update route metric                | 0-16777215       | \-        |
+-----------+------------------------------------+------------------+-----------+
| policy    | redistribute by policy rules       | | string         | \-        |
|           |                                    | | length 1-255   |           |
+-----------+------------------------------------+------------------+-----------+
| level     | Levels to redistribute routes into | | level-1        | level-1-2 |
|           |                                    | | level-2        |           |
|           |                                    | | level-1-2      |           |
+-----------+------------------------------------+------------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute connected
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 100
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL
    dnRouter(cfg-isis-inst-afi)# redistribute connected level-2
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL level-1


**Removing Configuration**

To remove connected routes redistribution policy:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected policy

To revert connected routes redistribution metric change:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected metric

To revert connected routes redistribution for default level:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected level

To stop connected routes redistribution:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/timers/throttle_spf.rst

protocols isis instance address-family ipv4-multicast timers throttle spf
-------------------------------------------------------------------------

**Minimum user role:** operator

IS-IS throttling of shortest path first (SPF) calculations for a given IS-IS address-family topology
delay - time to wait between getting a spf trigger event (for example receiving LSP packet) until running spf calculation
min-holdtime - minimum interval for two consecutive spf runs
max-holdtime - maximum time between consecutive spf runs
throttle algorithm - exponentially increase min-holdtime between spf calculations as long as receiving spf trigger events. if for 2 x max-holdtime duration no spf trigger event happened return min-holdtime to its initial configured value.
Configuration apply for all isis levels


**Command syntax: throttle spf {delay [delay], min-holdtime [min-holdtime], max-holdtime [max-holdtime]}**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast timers

**Note**
- Configuration is per IS-IS address-family topology, When working with Single topology SPF of ipv6-unicast address-family isn't running.
- at least one optional parameter must be configured
- must delay <= min-holdtime <= max-holdtime
- must min-holdtime <= max-holdtime


**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                      | Range    | Default |
+==============+==================================================================================+==========+=========+
| delay        | The minimum amount of time (in msec) from first change received (e.g. receiving  | 0-600000 | 0       |
|              | an LSP packet) till SPF calculation. The value must be  max-holdtime and       |          |         |
|              | min-holdtime.                                                                    |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| min-holdtime | The minimum interval (in msec) between consecutive SPF calculations. The value   | 0-600000 | 5       |
|              | Must be  max-holdtime.                                                          |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| max-holdtime | The maximum interval (in msec) between consecutive SPF calculations. The value   | 0-600000 | 5000    |
|              | must be  delay and min-holdtime.                                                |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# timers
    dnRouter(cfg-inst-afi-timers)# throttle spf delay 10 min-holdtime 15 max-holdtime 6000
    dnRouter(cfg-inst-afi-timers)# throttle spf max-holdtime 6600 delay 12
    dnRouter(cfg-inst-afi-timers)# throttle spf min-holdtime 20


**Removing Configuration**

To revert delay to default value:
::

    dnRouter(cfg-isis-inst-afi)# no throttle spf delay

To revert min-holdtime to deafult value:
::

    dnRouter(cfg-isis-inst-afi)# no throttle spf min-holdtime

To revert max-holdtime to deafult value:
::

    dnRouter(cfg-isis-inst-afi)# no throttle spf max-holdtime

To revert all parameters to deafult value:
::

    dnRouter(cfg-isis-inst-afi)# no throttle spf max-holdtime

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/timers/timers.rst

protocols isis instance address-family ipv4-multicast timers
------------------------------------------------------------

**Minimum user role:** operator

Enters address-family timers configuration level.

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# timers
    dnRouter(cfg-inst-afi-timers)#


**Removing Configuration**

To revert all timers configuration to default value:
::

    dnRouter(cfg-isis-inst-afi)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-multicast/topology.rst

protocols isis instance address-family ipv4-multicast topology
--------------------------------------------------------------

**Minimum user role:** operator

Set if IS-IS will work with Multi-Topology and support a dedicated IPv4-Multicast topology MT ID #3.



**Command syntax: topology [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-multicast

**Note**

- reconfiguring topology admin-state will trigger LSP geneartion and new IS-IS IIH message with update topology information

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | Set if ISIS will work with Multi-Topology and support a dedicated IPv4-Multicast | | enabled    | enabled |
|             | topology MT ID #3                                                                | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# topology enabled


**Removing Configuration**

To revert topology settings to default value:
::

    dnRouter(cfg-isis-inst-afi)# no topology

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/advertise-passive-only.rst

protocols isis instance address-family ipv4-unicast advertise passive-only
--------------------------------------------------------------------------

**Minimum user role:** operator

The advertise passive-only command enables to administratively set IS-IS to advertise routes only from passive interfaces.


**Command syntax: advertise passive-only [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Parameter table**

+-------------+-------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                   | Range        | Default  |
+=============+===============================================================================+==============+==========+
| admin-state | Administrative setting IS-IS to advertise routes only from passive interfaces | | enabled    | disabled |
|             |                                                                               | | disabled   |          |
+-------------+-------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# advertise passive-only enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no advertise passive-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/aggregate-route.rst

protocols isis instance address-family ipv4-unicast aggregate-route
-------------------------------------------------------------------

**Minimum user role:** operator

Summarization reduces the number of routing updates that are flooded across areas. Though IS-IS supports summarization, being a link-state routing protocol, the link-state database must be identical on all routers within the area, and so summarization within an area is not possible. 
Therefore, you configure the summarization on the L1/L2 device that does the redistribution. The summarizing node will create an aggregate route with a next-hop null 0 (discard) in the IS-IS routing table and advertise it when a more specific route exists in the matching IS-IS level.

summary-only - When set, advertise only the summary route and not the contributing individual routes.
adv-unreachable - When set, once a contributing route becomes unreachable, IS-IS advertise this exact prefix with very high metric for the duration of 'prefix-unreachable adv-lifetime' configured time , signaling to remote nodes that prefix is unreachabile to avoid forwarding traffic towards that prefix base on received summary route. 

To configure route summarization in the L1/L2 device:

**Command syntax: aggregate-route [ip-prefix]** level [level] summary-only adv-unreachable

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+---------------+-----------+
| Parameter       | Description                                                                      | Range         | Default   |
+=================+==================================================================================+===============+===========+
| ip-prefix       | The summary route that will be advertised when a more specific route exists in   | A.B.C.D/x     | \-        |
|                 | the matching IS-IS level. The route must match the address-family.               |               |           |
+-----------------+----------------------------------------------------------------------------------+---------------+-----------+
| level           | Specify the required level for which to inject the summary prefix. Default       | | level-1     | level-1-2 |
|                 | behavior is to add to both levels                                                | | level-2     |           |
|                 |                                                                                  | | level-1-2   |           |
+-----------------+----------------------------------------------------------------------------------+---------------+-----------+
| summary-only    | Advertise only the summary route and not the contributing individual routes.     | Boolean       | False     |
+-----------------+----------------------------------------------------------------------------------+---------------+-----------+
| adv-unreachable | Advertise unreachable routes                                                     | Boolean       | False     |
+-----------------+----------------------------------------------------------------------------------+---------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# aggregate-route 3.3.0.0/16
    dnRouter(cfg-isis-inst-afi)# aggregate-route 4.4.0.0/16 level level-1
    dnRouter(cfg-isis-inst-afi)# aggregate-route 5.5.0.0/16 level level-2 summary-only
    dnRouter(cfg-isis-inst-afi)# aggregate-route 6.6.0.0/16 level level-1-2
    dnRouter(cfg-isis-inst-afi)# aggregate-route 5.6.0.0/16 summary-only adv-unreachable
    dnRouter(cfg-isis-inst-afi)# aggregate-route 5.7.0.0/16 adv-unreachable


**Removing Configuration**

To remove all summary-prefix entries:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route

To remove a specific summary-prefix entry:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route 3.3.0.0/16

To revert to the default level:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route 4.4.0.0/16 level level-2

To revert to the default level and remove the summary-only setting:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route 5.5.0.0/16 level level-2 summary-only

To revert usage of adv-unreachable functionality:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route 5.5.0.0/16 adv-unreachable

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 14.0    | Command introduced          |
+---------+-----------------------------+
| 19.3    | Add adv-unreachable support |
+---------+-----------------------------+

---

### instance/ipv4-unicast/default-originate.rst

protocols isis instance address-family ipv4-unicast default-originate
---------------------------------------------------------------------

**Minimum user role:** operator

By default, the default route is distributed only if it is in the RIB and it was not installed from the same IS-IS instance.

To set the IS to distribute a default route to an IS-IS routing domain: 

The default-originate policy command has preference over the always and metric settings, according to the following:

+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| always           | metric           | policy                    | Comment                                                                                                             |
+==================+==================+===========================+=====================================================================================================================+
|                  |                  |                           |                                                                                                                     |
| not set          | not set          | not set                   | default route will not be originated unless it exists in the RIB. Route metric per known metric in RIB              |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| not set          | set              | not set                   | default route will not be originated unless it exists in the RIB with metric value according to user config         |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| set              | not set          | not set                   | default route will be originated with metric 0 value                                                                |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| set              | set              | not set                   | default route will be originated with configured metric                                                             |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| not set / set    | not set / set    | set and return "deny"     | default route will not originate                                                                                    |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| not set          | not set / set    | set and return "allow"    | default route will be originated if route exists in rib no metric modification                                      |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| set              | not set / set    | set and return "allow"    | default route will be originated with metric   modified according to policy                                         |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+

**Command syntax: default-originate** always metric [metric-value] policy [policy-name]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- This option is disabled by default. When enabled, the default behavior is to distribute the default route only if the RIB has the default route and it was not installed from the same IS-IS instance.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter    | Description                                                                      | Range            | Default |
+==============+==================================================================================+==================+=========+
| always       | When specified, the default route is always advertised, even when a default      | boolean          | \-      |
|              | route (0.0.0.0/0) is not present in the routing table.                           |                  |         |
+--------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-value | Specifies the cost for reaching the rest of the world through this default       | 1-16777215       | \-      |
|              | route.                                                                           |                  |         |
+--------------+----------------------------------------------------------------------------------+------------------+---------+
| policy-name  | The name of the route-map used.                                                  | | string         | \-      |
|              | Optionally injects the default route conditionally, depending on the matching    | | length 1-255   |         |
|              | conditions in the policy. Possible policy actions are "match rib-has-route" and  |                  |         |
|              | "set isis-metric".                                                               |                  |         |
+--------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate

    dnRouter(cfg-isis-inst-afi)# default-originate always
    dnRouter(cfg-isis-inst-afi)# default-originate always metric 100

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_2
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate metric 100

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate always metric 100

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate policy DEFAULT_ORIGINATE

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate always metric 100  policy DEFAULT_ORIGINATE


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-isis-inst-afi)# no default-originate

To disable the always behavior (so that the default route is not advertised unless the route is in the RIB):
::

    dnRouter(cfg-isis-inst-afi)# no default-originate always

To revert the default metric value:
::

    dnRouter(cfg-isis-inst-afi)# no default-originate always metric

To disable the default policy value:
::

    dnRouter(cfg-isis-inst-afi)# no default-originate policy

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 6.0     | Command introduced            |
+---------+-------------------------------+
| 9.0     | Command not supported         |
+---------+-------------------------------+
| 10.0    | Command reintroduced          |
+---------+-------------------------------+
| 13.0    | Added support for policy-name |
+---------+-------------------------------+

---

### instance/ipv4-unicast/fast-reroute-backup-candidate.rst

protocols isis instance address-family ipv4-unicast fast-reroute backup-candidate
---------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all IS-IS enabled interfaces are valid candidates for IS-IS LFA. The command allows you to include or exclude an interface from being used as a candidate for repair path calculation. When set to be included, the interface will be used for loop-free alternate calculations (when isis fast-reroute is globally enabled. See "isis instance address-family fast-reroute"). If the interface is set to be excluded, it will not be used for repair paths:


**Command syntax: fast-reroute backup-candidate [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- The configuration is only valid for the following interface types:
.. - ge{/10/25/40/100}-X/Y/Z,
.. - geX-<f>/<n>/<p>.<sub-interface id>
.. - bundle-<bundle-id>,
.. - bundle-<bundle-id.sub-bundle-id>
- for other interfaces type require commit validation and that cli will not support such command for these interfaces
- The default behavior is per 'isis instance address-family fast-reroute backup-candidate' configuration
- Inheritance logic:
.. - Interface per level config - inherit the interface level-1-2 config (i.e when level isn't specified)
.. - Interface level-1-2 config - inherits the global fast-reroute backup-candidate (which always exists, can be default)
.. - 'backup-candidate' applies per IS-IS interface address-family topology. For example, when operating in a single topology, if you disable the backup-candidate on an ipv4-unicast interface, the LFA to the interface's neighbor will not be valid for both IPv4 & IPv6 prefixes.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | enabled |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate disabled

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate level level-2 enabled


**Removing Configuration**

To revert to the default admin-state and to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate

To revert only to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2 enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/ipv4-unicast/fast-reroute-level-1.rst

protocols isis instance address-family ipv4-unicast fast-reroute level level-1
------------------------------------------------------------------------------

**Minimum user role:** operator

The command is responsible for inserting a backup route per IS-IS prefix in the RIB and FIB. Therefore, if a primary path fails, the pre-installed backup path will be used to forward traffic. The backup path will be used as follows (by priority):

#.	Default node protection is preferred over link protection, thus skipping a potential damaged node and forwarding the traffic to the next-hop rather than skipping a potential damaged link.

#.	The path with the lowest metric.

#.	The path with the lowest hop count.

To define the administrative state of fast reroute per IS-IS instance:


**Command syntax: fast-reroute level level-1 [admin-state]** remote-lfa

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- Inheritance logic:
.. - If level not specified, configure for level-1-2 and apply as default behavior for any specific level
.. - If level specified, apply configuration for that level only


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | \-      |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+
| remote-lfa  | When specified, support remote lfa protection using LDP lsp.                     | boolean      | \-      |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute level level-1 enabled

    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled remote-lfa


**Removing Configuration**

To revert to the default admin-state and level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute

To revert to the default fast-reroute admin-state for a specific level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute level level-1

To revert to usage of remote lfa:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute remote-lfa

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+
| 17.1    | Add remote LFA option       |
+---------+-----------------------------+

---

### instance/ipv4-unicast/fast-reroute-level-2.rst

protocols isis instance address-family ipv4-unicast fast-reroute level level-2
------------------------------------------------------------------------------

**Minimum user role:** operator

The command is responsible for inserting a backup route per IS-IS prefix in the RIB and FIB. Therefore, if a primary path fails, the pre-installed backup path will be used to forward traffic. The backup path will be used as follows (by priority):

#.	Default node protection is preferred over link protection, thus skipping a potential damaged node and forwarding the traffic to the next-hop rather than skipping a potential damaged link.

#.	The path with the lowest metric.

#.	The path with the lowest hop count.

To define the administrative state of fast reroute per IS-IS instance:


**Command syntax: fast-reroute level level-2 [admin-state]** remote-lfa

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- Inheritance logic:
.. - If level not specified, configure for level-1-2 and apply as default behavior for any specific level
.. - If level specified, apply configuration for that level only


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | \-      |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+
| remote-lfa  | When specified, support remote lfa protection using LDP lsp.                     | boolean      | \-      |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute level level-1 enabled

    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled remote-lfa


**Removing Configuration**

To revert to the default admin-state and level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute

To revert to the default fast-reroute admin-state for a specific level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute level level-1

To revert to usage of remote lfa:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute remote-lfa

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+
| 17.1    | Add remote LFA option       |
+---------+-----------------------------+

---

### instance/ipv4-unicast/fast-reroute.rst

protocols isis instance address-family ipv4-unicast fast-reroute
----------------------------------------------------------------

**Minimum user role:** operator

The command is responsible for inserting a backup route per IS-IS prefix in the RIB and FIB. Therefore, if a primary path fails, the pre-installed backup path will be used to forward traffic. The backup path will be used as follows (by priority):

#.	Default node protection is preferred over link protection, thus skipping a potential damaged node and forwarding the traffic to the next-hop rather than skipping a potential damaged link.

#.	The path with the lowest metric.

#.	The path with the lowest hop count.

To define the administrative state of fast reroute per IS-IS instance:


**Command syntax: fast-reroute [admin-state]** remote-lfa

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- Inheritance logic:
.. - If level not specified, configure for level-1-2 and apply as default behavior for any specific level
.. - If level specified, apply configuration for that level only


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | disabled |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+
| remote-lfa  | When specified, support remote lfa protection using LDP lsp.                     | boolean      | \-       |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute level level-1 enabled

    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled remote-lfa


**Removing Configuration**

To revert to the default admin-state and level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute

To revert to the default fast-reroute admin-state for a specific level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute level level-1

To revert to usage of remote lfa:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute remote-lfa

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+
| 17.1    | Add remote LFA option       |
+---------+-----------------------------+

---

### instance/ipv4-unicast/ipv4-unicast.rst

protocols isis instance address-family ipv4-unicast
---------------------------------------------------

**Minimum user role:** operator

The enter the isis address-family ipv4 unicast configuration:

**Command syntax: address-family ipv4-unicast**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- The configuration within this address-family only takes effect once the topology is enabled.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)#


**Removing Configuration**

To revert all ipv4 unicast configuration to default:
::

    dnRouter(cfg-protocols-isis-inst)# no address-family ipv4-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/load-balancing.rst

protocols isis instance address-family ipv4-unicast load-balancing
------------------------------------------------------------------

**Minimum user role:** operator

Enabled weighted ECMP in ISIS.
Each of the ECMP paths in the ISIS route solution will have weight matching the egress interface weight.
Traffic will be load balanced between the different paths per the path weight ratio.

**Command syntax: load-balancing [LB-Type]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- The configuration is per IS-IS topology. The chosen load-balancing methond in ipv4-unicast will also apply for ipv6 routes if working as a single-topology.

**Parameter table**

+-----------+------------------------------------------+-----------------+---------+
| Parameter | Description                              | Range           | Default |
+===========+==========================================+=================+=========+
| LB-Type   | ISIS multiple path load balancing method | | ecmp          | ecmp    |
|           |                                          | | weight-ecmp   |         |
+-----------+------------------------------------------+-----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# load-balancing weight-ecmp
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# load-balancing ecmp


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no load-balancing

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/maximum-paths.rst

protocols isis instance address-family ipv4-unicast maximum-paths
-----------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to install multiple paths with equal cost in the routing table:

**Command syntax: maximum-paths [maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- The configuration is per address-family and applies regardless of the IS-IS topology enabled.

**Parameter table**

+---------------+-------------------------------------------------------+-------+---------+
| Parameter     | Description                                           | Range | Default |
+===============+=======================================================+=======+=========+
| maximum-paths | The number of routes to install in the routing table. | 1-64  | 8       |
+---------------+-------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# maximum-paths 12
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# maximum-paths 24


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no maximum-paths

**Command History**

+---------+------------------------------------------------------------------------+
| Release | Modification                                                           |
+=========+========================================================================+
| 6.0     | Command introduced                                                     |
+---------+------------------------------------------------------------------------+
| 9.0     | Command removed                                                        |
+---------+------------------------------------------------------------------------+
| 10.0    | Command reintroduced under address-family hierarchy (with new default) |
+---------+------------------------------------------------------------------------+
| 15.0    | Updated parameter range from 32 to 64                                  |
+---------+------------------------------------------------------------------------+

---

### instance/ipv4-unicast/metric-level-1.rst

protocols isis instance address-family ipv4-unicast metric level level-1
------------------------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive level 1 interface default metric value:

**Command syntax: metric level level-1 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family, takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | \-      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# metric level level-1 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric level level-1 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/metric-level-2.rst

protocols isis instance address-family ipv4-unicast metric level level-2
------------------------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive level 2 interface default metric value:

**Command syntax: metric level level-2 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family, takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | \-      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# metric level level-2 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric level level-2 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/metric.rst

protocols isis instance address-family ipv4-unicast metric
----------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive interface default metric value:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family, takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | 10      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/microloop-avoidance/admin-state.rst

protocols isis instance address-family ipv4-unicast microloop-avoidance admin-state
-----------------------------------------------------------------------------------

**Minimum user role:** operator

To enable microloop avoidance:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast microloop-avoidance

**Note**
- Microloop avoidance works per address-family and not per topology.
- In the event of single-topology, microloop-avoidance is required to be enabled for ipv6-unicast address-family to provide avoidance for ipv6 prefixes.

**Parameter table**

+-------------+----------------------------+--------------+----------+
| Parameter   | Description                | Range        | Default  |
+=============+============================+==============+==========+
| admin-state | Enable microloop avoidance | | enabled    | disabled |
|             |                            | | disabled   |          |
+-------------+----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# admin-state enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# admin-state enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-inst-afi-uloop)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/microloop-avoidance/fib-delay.rst

protocols isis instance address-family ipv4-unicast microloop-avoidance fib-delay
---------------------------------------------------------------------------------

**Minimum user role:** operator

To set the required delay (in milliseconds) between the SR-TE micoloop-avoidance path installation and the post-convergance IS-IS unicast path installation:

**Command syntax: fib-delay [fib-delay]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast microloop-avoidance

**Note**

- Microloop avoidance fib-delay parameter is per IS-IS topology.

- In the event of single-topology, fib-delay of ipv4-unicast address-family will define the expected delay for ipv6 prefixes as well.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| fib-delay | Delay time until installing post convergance IS-IS paths. Within this time       | 1000-60000 | 5000    |
|           | microloop paths will be used                                                     |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# fib-delay 10000
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# fib-delay 10000


**Removing Configuration**

To revert fib-delay to the default value:
::

    dnRouter(cfg-inst-afi-uloop)# no fib-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/microloop-avoidance/maximum-labels.rst

protocols isis instance address-family ipv4-unicast microloop-avoidance maximum-labels
--------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the SR-TE microloop-avoidance constructed label stack. 
If the calculated path exceed the allowed maximum, than a microloop-avoidance path will not be provided by ISIS.
To set the maximum-labels:

**Command syntax: maximum-labels [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast microloop-avoidance

**Note**

- Microloop avoidance maximum-labels parameter is per IS-IS topology.

- In the event of single-topology, maximum-labels of ipv4-unicast address-family will define the maximum label stack of the microloop path for ipv6 prefixes as well.

**Parameter table**

+----------------+-----------------------------------------------------------+-------+---------+
| Parameter      | Description                                               | Range | Default |
+================+===========================================================+=======+=========+
| maximum-labels | Maximum allowed labels to be added for the microloop path | 1-3   | 3       |
+----------------+-----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# maximum-labels 1
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# maximum-labels 1


**Removing Configuration**

To revert maximum-labels to the default value:
::

    dnRouter(cfg-inst-afi-uloop)# no maximum-labels

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/microloop-avoidance/microloop-avoidance.rst

protocols isis instance address-family ipv4-unicast microloop-avoidance
-----------------------------------------------------------------------

**Minimum user role:** operator

Microloops are brief packet loops that occur in the network following a topology change (link down, link up, or metric change events). 
Microloops are caused by the non-simultaneous convergence of different nodes in the network. 
If nodes converge and send traffic to a neighbor node that has not converged yet, traffic may be looped between these two nodes, resulting in packet loss, jitter, and out-of-order packets.

The Segment Routing Microloop Avoidance feature detects if microloops are possible following a topology change. 
If a node computes that a microloop could occur on the new topology, the node creates a loop-free SR-TE path to the destination using a list of segments. 
After the FIB update delay timer expires, the SR-TE path is replaced with regular forwarding paths. 

To configure microloop-avoidance, enter microloop-avoidance configuration mode:

**Command syntax: microloop-avoidance**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- For microloop-avoidance to work, segment-routing must be supported for the given address-family.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)#
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)#


**Removing Configuration**

To revert all microloop-avoidance configuration to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no microloop-avoidance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/microloop-avoidance/mode.rst

protocols isis instance address-family ipv4-unicast microloop-avoidance mode
----------------------------------------------------------------------------

**Minimum user role:** operator

Defines the work mode for microloop-avoidance.

- sr-te: Microloop avoidance provides for different cases of network changes, both local and remote. The protecting path is based on sr-te LSP
- hold-lfa: Applies microloop-avoidance for cases of ISIS interface failure by utilizing the existing LFA path as the protection path

**Command syntax: mode [mode]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast microloop-avoidance

**Note**

- hold-lfa will only provide protection for prefixes that have an LFA path. Regardless of the LFA type (local, rLFA, ti-lfa)

- in either mode, the post convergence path will be installed after a fib-delay

**Parameter table**

+-----------+----------------------------------------------------+--------------+---------+
| Parameter | Description                                        | Range        | Default |
+===========+====================================================+==============+=========+
| mode      | Define the work more for microloop avoidance logic | | sr-te      | sr-te   |
|           |                                                    | | hold-lfa   |         |
+-----------+----------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# mode hold-lfa


**Removing Configuration**

To revert mode to default:
::

    dnRouter(cfg-inst-afi-uloop)# no mode

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/prefix-priority.rst

protocols isis instance address-family ipv4-unicast prefix-priority tag
-----------------------------------------------------------------------

**Minimum user role:** operator

Assign a tag value to the prefix-priority, to ensure that prefixes with this tag are handled with the given priority

**Command syntax: prefix-priority [prefix-priority] tag [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Parameter table**

+-----------------+--------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                    | Range        | Default |
+=================+================================================================================+==============+=========+
| prefix-priority | The priority - low, mediumm or high                                            | | low        | \-      |
|                 |                                                                                | | medium     |         |
|                 |                                                                                | | high       |         |
+-----------------+--------------------------------------------------------------------------------+--------------+---------+
| tag             | Tag value, that if associated with a prefix will be given the defined priority | 1-4294967295 | \-      |
+-----------------+--------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#


**Removing Configuration**

To remove tag:
::

    dnRouter(cfg-inst-protocols-static)# no prefix-priority high

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/prefix-unreachable/adv-lifetime.rst

protocols isis instance address-family ipv4-unicast prefix-unreachable adv-lifetime
-----------------------------------------------------------------------------------

**Minimum user role:** operator

Lifetime of the prefix-unreachable advertisements:

**Command syntax: adv-lifetime [adv-lifetime]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast prefix-unreachable

**Parameter table**

+--------------+----------------------------------------------------+----------+---------+
| Parameter    | Description                                        | Range    | Default |
+==============+====================================================+==========+=========+
| adv-lifetime | Lifetime of the prefix-unreachable advertisements. | 30-65535 | 180     |
+--------------+----------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-unreachable
    dnRouter(cfg-inst-afi-upa)# adv-lifetime 100


**Removing Configuration**

To restore adv-lifetime to default value:
::

    dnRouter(cfg-inst-afi-upa)# no adv-lifetime

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/prefix-unreachable/prefix-unreachable.rst

protocols isis instance address-family ipv4-unicast prefix-unreachable
----------------------------------------------------------------------

**Minimum user role:** operator

To enter prefix-unreachable configuration level:

**Command syntax: prefix-unreachable**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-unreachable
    dnRouter(cfg-inst-afi-upa)#


**Removing Configuration**

To restore all prefix-unreachable configurations to default value:
::

    dnRouter(cfg-isis-inst-afi)# no prefix-unreachable

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/prefix-unreachable/rx-process.rst

protocols isis instance address-family ipv4-unicast prefix-unreachable rx-process
---------------------------------------------------------------------------------

**Minimum user role:** operator

Enable reception of unreachable prefix announcement (UPA) in order to create and install an unreachable route entry to RIB
If received UPA is found as best route for RIB installation (by regular metric and level consideration) an unreachable route will be added to RIB. 
BGP next-hops (or SRv6 SIDs) matching resolution over an unreachable route will result as invalid next-hop/SID reachablity, triggering PIC edge (in case alternate path exist)
The goal of UPA is to exclude specific prefixes from being reachable when prefix summarization happened across the network. That is useful for triggering fast-convergence mechanisms outside of the IGPs level

To enable rx-process of received unreachable prefixes:

**Command syntax: rx-process [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast prefix-unreachable

**Note**
- When disabled, a received high metric unreachable prefix (metric > 0xFE000000) is omitted from SPF calculations and not included in ISIS route installations

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enable reception of unreachable prefix announcement (UPA) in order to create and | | enabled    | disabled |
|             | install an unreachable route entry to RIB                                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-unreachable
    dnRouter(cfg-inst-afi-upa)# rx-process enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-unreachable
    dnRouter(cfg-inst-afi-upa)# rx-process enabled


**Removing Configuration**

To revert the rx-process to the default value:
::

    dnRouter(cfg-inst-afi-upa)# no rx-process

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/propagate-level1-to-level2.rst

protocols isis instance address-family ipv4-unicast propagate level1-to-level2 policy
-------------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all level-1 routes propagate into level-2. Use this command to filter the routes that propagate from level-1 to level-2, or to enable route leaking from level-2 to level-1. To do both, explicitly set the command twice, once for each direction. Note that using a policy is mandatory with this command; the policy limits the number of route that are propagated or leaked.

To propagate routes between levels:

**Command syntax: propagate level1-to-level2 policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- "Only the following commands can be used in the propagation attachment points; other match/set statements will be ignored:"
.. - "policy match ip prefix"
.. - "policy match tag"
.. - "policy set tag"
- Routes can propagate from level-1 to level-2 and from level-2 to level-1 at the same time. They cannnot propagate between same levels.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                                      | Range            | Default |
+=============+==================================================================================+==================+=========+
| policy-name | Enter an existing policy that lists the routes that will be propagated or        | | string         | \-      |
|             | leaked. Only "policy match ip prefix" can be used in the propagation attachment  | | length 1-255   |         |
|             | points. Other match / set statements will be ignored.                            |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute static
    dnRouter(cfg-isis-inst-afi)# propagate level1-to-level2 policy L1_TO_L2_FILTER


**Removing Configuration**

To stop level-1 into level-2 propagation filtering:
::

    dnRouter(cfg-isis-inst-afi)# no propagate level1-to-level2

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 14.0    | Command introduced     |
+---------+------------------------+
| 15.0    | Updated command syntax |
+---------+------------------------+

---

### instance/ipv4-unicast/propagate-level2-to-level1.rst

protocols isis instance address-family ipv4-unicast propagate level2-to-level1 policy
-------------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all level-1 routes propagate into level-2. Use this command to filter the routes that propagate from level-1 to level-2, or to enable route leaking from level-2 to level-1. To do both, explicitly set the command twice, once for each direction. Note that using a policy is mandatory with this command; the policy limits the number of route that are propagated or leaked.

To propagate routes between levels:

**Command syntax: propagate level2-to-level1 policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- "Only the following commands can be used in the propagation attachment points; other match/set statements will be ignored:"
.. - "policy match ip prefix"
.. - "policy match tag"
.. - "policy set tag"
- Routes can propagate from level-1 to level-2 and from level-2 to level-1 at the same time. They cannnot propagate between same levels.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                                      | Range            | Default |
+=============+==================================================================================+==================+=========+
| policy-name | Enter an existing policy that lists the routes that will be propagated or        | | string         | \-      |
|             | leaked. Only "policy match ip prefix" can be used in the propagation attachment  | | length 1-255   |         |
|             | points. Other match / set statements will be ignored.                            |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute static
    dnRouter(cfg-isis-inst-afi)# propagate level2-to-level1 policy LEAK_FILTER


**Removing Configuration**

To stop level-2 into level-1 propagation filtering:
::

    dnRouter(cfg-isis-inst-afi)# no propagate level2-to-level1

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 14.0    | Command introduced     |
+---------+------------------------+
| 15.0    | Updated command syntax |
+---------+------------------------+

---

### instance/ipv4-unicast/redistribute_connected.rst

protocols isis instance address-family ipv4-unicast redistribute connected
--------------------------------------------------------------------------

**Minimum user role:** operator

Sets the redistribute connected routes into IS-IS:
metric - used to set routes metric. By default routes are redistributed with metric value 0.
policy - used to filter and modify redistributed routes. The user can match the route by "match ip prefix" and set whether to allow or deny routes redistribution. For allowed routes, the user can set isis-metric per specific prefixes
level - define into which isis level redistribute routes. When setting level-1-2 redistribute into both level-1 and level-2. By default, redistribute to both levels.


**Command syntax: redistribute connected** metric [metric] policy [policy] level [level]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- By default, no redistribution is performed.

- Metric-type: - internal - set IS-IS internal metric type. - external - set IS-IS external metric type.

**Parameter table**

+-----------+------------------------------------+------------------+-----------+
| Parameter | Description                        | Range            | Default   |
+===========+====================================+==================+===========+
| metric    | update route metric                | 0-16777215       | \-        |
+-----------+------------------------------------+------------------+-----------+
| policy    | redistribute by policy rules       | | string         | \-        |
|           |                                    | | length 1-255   |           |
+-----------+------------------------------------+------------------+-----------+
| level     | Levels to redistribute routes into | | level-1        | level-1-2 |
|           |                                    | | level-2        |           |
|           |                                    | | level-1-2      |           |
+-----------+------------------------------------+------------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute connected
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 100
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL
    dnRouter(cfg-isis-inst-afi)# redistribute connected level-2
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL level-1


**Removing Configuration**

To remove connected routes redistribution policy:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected policy

To revert connected routes redistribution metric change:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected metric

To revert connected routes redistribution for default level:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected level

To stop connected routes redistribution:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/redistribute_static.rst

protocols isis instance address-family ipv4-unicast redistribute static
-----------------------------------------------------------------------

**Minimum user role:** operator

Devices are allowed to redistribute static routes or routes to connected interfaces into IS-IS.

To redistribute routes learned by other means into IS-IS:

**Command syntax: redistribute static** metric [metric-value] policy [policy-name] level [level]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- This option is disabled by default.
-  Redistribution can be done from multiple protocols
-  Metric-type:
.. -  Internal - set IS-IS internal metric type
.. -  External - set IS-IS external metric type

**Parameter table**

+--------------+----------------------------------------------------------------------------------+------------------+-----------+
| Parameter    | Description                                                                      | Range            | Default   |
+==============+==================================================================================+==================+===========+
| metric-value | Used to set the allowed routes' metric. By default, routes are redistributed     | 0-16777215       | \-        |
|              | with metric 0.                                                                   |                  |           |
+--------------+----------------------------------------------------------------------------------+------------------+-----------+
| policy-name  | The name of the route-map used. Used to filter and modify redistributed routes.  | | string         | \-        |
|              | ou can set whether to allow or deny the redistribution of the routes that match  | | length 1-255   |           |
|              | the specified policy.                                                            |                  |           |
+--------------+----------------------------------------------------------------------------------+------------------+-----------+
| level        | Specify into which IS-IS level to redistribute routes. When setting level-1-2    | | level-1        | level-1-2 |
|              | routes will be redistributed into both level-1 and level-2.                      | | level-2        |           |
|              |                                                                                  | | level-1-2      |           |
+--------------+----------------------------------------------------------------------------------+------------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute connected
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 100
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL
    dnRouter(cfg-isis-inst-afi)# redistribute connected level-2
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL level-1


**Removing Configuration**

To stop redistribution of all protocols:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute

To stop redistribution of a specific protocol:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute static

To remove metric modification or policy filtering, or revert to the default level:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute static metric policy

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 6.0     | Command introduced          |
+---------+-----------------------------+
| 9.0     | Command not supported       |
+---------+-----------------------------+
| 10.0    | Command reintroduced        |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+

---

### instance/ipv4-unicast/segment-routing/admin-state.rst

protocols isis instance address-family ipv4-unicast segment-routing admin-state
-------------------------------------------------------------------------------

**Minimum user role:** operator

This command enables/disables segment-routing in IS-IS for source routing using MPLS SID. When enabled, segment-routing information is exchanged with all IS-IS neighbors. 

To enable/disable segment-routing:


**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast segment-routing

**Note**

- Segment-routing can be enabled for a single IS-IS instance only.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state of segment routing. When   enabled, segment-routing     | | enabled    | disabled |
|             | information is exchanged with all IS-IS neighbors.                               | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# admin-state enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-inst-afi-sr)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/segment-routing/mapping-server/level1-to-level2.rst

protocols isis instance address-family ipv4-unicast segment-routing mapping-server propagate level1-to-level2 policy
--------------------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

You can control the propagation of binding SIDs between IS-IS levels. Propagation can be done even if the router is not enabled as a mapping client.

Only "policy match ipv4 prefix" can be used in the propagation attachment points. Other match / set statements will be ignored. Match is achieved when a binding-SID prefix is matches an allow rule in the attached prefix-list. When the binding-SID has a range, the match in the propagation policy is on the first prefix in the range. I.e., a binding-SID 9.9.9.1/32 with range 10 will be matched with ipv4-prefix 9.9.9.1/32 matching-len 32, but not with 9.9.9.4/32 matching-len 32.

To control propagation of binding-SIDs between IS-IS levels:

**Command syntax: propagate level1-to-level2 policy [policy-name]** s-flag-ignore

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast segment-routing mapping-server

**Note**

- Propagation can be done from level-1 to level-2 and from level-2 to level-1 at the same time, each using a separate policy.

- Reconfiguring the policy in any propagation direction will maintain existing s-flag-ignore settings.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter     | Description                                                                      | Range            | Default |
+===============+==================================================================================+==================+=========+
| policy-name   | The new preference value to be advertised                                        | | string         | \-      |
|               | A value of 0 indicates that advertisements from this node must not be used. The  | | length 1-255   |         |
|               | preference TLV will not be advertised.                                           |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+
| s-flag-ignore | Allows the propagation even when the s-flag is not set on the binding-SID TLV.   | \-               | \-      |
|               | By default, when s-flag is not set, no propagation will be done for binding-SIDs |                  |         |
|               | in any direction. The s-flag configuration is per direction.                     |                  |         |
|               | Reconfiguring the policy in a given propagate direction will maintain the        |                  |         |
|               | existing s-flag-ignore settings.                                                 |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# propagate level1-to-level2 policy My_Pol_1_2 s-flag-ignore
    dnRouter(cfg-afi-sr-mapping)# propagate level2-to-level1 policy My_Pol_2_1


**Removing Configuration**

To remove the s-flag-ignore configuration:
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level1-to-level2 policy My_Pol_1_2 s-flag-ignore

To stop level-1 into level-2 propagation and remove the s-flag-ignore configuration:
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level1-to-level2 policy My_Pol_1_2

To revert to the default behavior where all binding-SID with s-flag configured will be propagated from level-2 to level-1, (i.e., also remove s-flag-ignore configuration):
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level2-to-level1 policy My_Pol_2_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/segment-routing/mapping-server/level2-to-level1.rst

protocols isis instance address-family ipv4-unicast segment-routing mapping-server propagate level2-to-level1 policy
--------------------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

You can control the propagation of binding SIDs between IS-IS levels. Propagation can be done even if the router is not enabled as a mapping client.

Only "policy match ipv4 prefix" can be used in the propagation attachment points. Other match / set statements will be ignored. Match is achieved when a binding-SID prefix is matches an allow rule in the attached prefix-list. When the binding-SID has a range, the match in the propagation policy is on the first prefix in the range. I.e., a binding-SID 9.9.9.1/32 with range 10 will be matched with ipv4-prefix 9.9.9.1/32 matching-len 32, but not with 9.9.9.4/32 matching-len 32.

To control propagation of binding-SIDs between IS-IS levels:

**Command syntax: propagate level2-to-level1 policy [policy-name]** s-flag-ignore

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast segment-routing mapping-server

**Note**

- Propagation can be done from level-1 to level-2 and from level-2 to level-1 at the same time, each using a separate policy.

- Reconfiguring the policy in any propagation direction will maintain existing s-flag-ignore settings.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter     | Description                                                                      | Range            | Default |
+===============+==================================================================================+==================+=========+
| policy-name   | The new preference value to be advertised                                        | | string         | \-      |
|               | A value of 0 indicates that advertisements from this node must not be used. The  | | length 1-255   |         |
|               | preference TLV will not be advertised.                                           |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+
| s-flag-ignore | Allows the propagation even when the s-flag is not set on the binding-SID TLV.   | \-               | \-      |
|               | By default, when s-flag is not set, no propagation will be done for binding-SIDs |                  |         |
|               | in any direction. The s-flag configuration is per direction.                     |                  |         |
|               | Reconfiguring the policy in a given propagate direction will maintain the        |                  |         |
|               | existing s-flag-ignore settings.                                                 |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# propagate level1-to-level2 policy My_Pol_1_2 s-flag-ignore
    dnRouter(cfg-afi-sr-mapping)# propagate level2-to-level1 policy My_Pol_2_1


**Removing Configuration**

To remove the s-flag-ignore configuration:
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level1-to-level2 policy My_Pol_1_2 s-flag-ignore

To stop level-1 into level-2 propagation and remove the s-flag-ignore configuration:
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level1-to-level2 policy My_Pol_1_2

To revert to the default behavior where all binding-SID with s-flag configured will be propagated from level-2 to level-1, (i.e., also remove s-flag-ignore configuration):
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level2-to-level1 policy My_Pol_2_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/segment-routing/mapping-server/mapping-server.rst

protocols isis instance address-family ipv4-unicast segment-routing mapping-server
----------------------------------------------------------------------------------

**Minimum user role:** operator

A mapping-server with advertise enabled will advertise the binding SIDs defined in "segment-routing mpls mapping-server prefix-sid-map". A mapping-server with receive enabled is a mapping-client and will accept binding SIDs as if there were prefix-SID advertised from network nodes. See "isis instance address-family segment-routing mapping-server prefix-sid-map advertise" and "isis instance address-family segment-routing mapping-server prefix-sid-map receive".

To configure the segment routing mapping server:

**Command syntax: mapping-server**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast segment-routing

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)#


**Removing Configuration**

To revert all mapping-server configuration to their default values:
::

    dnRouter(cfg-inst-afi-sr)# no mapping-server

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/segment-routing/mapping-server/preference.rst

protocols isis instance address-family ipv4-unicast segment-routing mapping-server preference
---------------------------------------------------------------------------------------------

**Minimum user role:** operator

You can change the preference value of the mapping server - the higher the value the more preferred the server.

To configure the preference value for the mapping server:

**Command syntax: preference [preference]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast segment-routing mapping-server

**Note**

- Segment-routing can be enabled for a single IS-IS instance only.

**Parameter table**

+------------+----------------------------------------------------------------------------------+----------------+---------+
| Parameter  | Description                                                                      | Range          | Default |
+============+==================================================================================+================+=========+
| preference | The new preference value to be advertised                                        | 0-255/disabled | 128     |
|            | A value of 0 indicates that advertisements from this node must not be used. The  |                |         |
|            | preference TLV will not be advertised.                                           |                |         |
+------------+----------------------------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# preference 200

    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# preference disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-afi-sr-mapping)# no preference

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/segment-routing/mapping-server/prefix-sid-map-advertise.rst

protocols isis instance address-family ipv4-unicast segment-routing mapping-server prefix-sid-map advertise
-----------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

This command enables the node as a mapping server. The router will advertise binding SIDs according to the configured mapping (see "segment-routing mpls mapping-server prefix-sid-map" on page 2208).

To enable/disable the node as a mapping server:

**Command syntax: prefix-sid-map advertise [admin-state]** level [level]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast segment-routing mapping-server

**Note**

- When mapping server is enabled, the router will always use the local mapping, even if the mapping client functionality is disabled.

- Mapping server messages are not propagated between levels.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+---------------+-----------+
| Parameter   | Description                                                                      | Range         | Default   |
+=============+==================================================================================+===============+===========+
| admin-state | The administrative state of the mapping-server. When enabled, the router will    | | enabled     | disabled  |
|             | act as a segment-routing mapping server and will always use the local mapping,   | | disabled    |           |
|             | even if the mapping client functionality is disabled.                            |               |           |
+-------------+----------------------------------------------------------------------------------+---------------+-----------+
| level       | Defines for which IS-IS level the prefix-SID mapping will be advertised.         | | level-1     | level-1-2 |
|             |                                                                                  | | level-2     |           |
|             |                                                                                  | | level-1-2   |           |
+-------------+----------------------------------------------------------------------------------+---------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# prefix-sid-map advertise enabled

    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# prefix-sid-map advertise enabled level level-1


**Removing Configuration**

To revert to the default value level advertisement:
::

    dnRouter(cfg-inst-afi-sr)# no prefix-sid-map advertise enabled level

To revert to the default advertise admin-state and level values:
::

    dnRouter(cfg-inst-afi-sr)# no prefix-sid-map advertise

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/segment-routing/mapping-server/prefix-sid-map-receive.rst

protocols isis instance address-family ipv4-unicast segment-routing mapping-server prefix-sid-map receive
---------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

This command enables the node as a mapping client. A mapping client can server multiple mapping servers.

To enable/disable the node as a mapping client:

**Command syntax: prefix-sid-map receive [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast segment-routing mapping-server

**Note**

- When mapping server is enabled, the router will always use the local mapping, even if the mapping client functionality is disabled.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state of the mapping-client. When enabled, the router will    | | enabled    | enabled |
|             | act as a segment-routing mapping client.                                         | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# prefix-sid-map receive enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-afi-sr)# no prefix-sid-map receive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/segment-routing/segment-routing.rst

protocols isis instance address-family ipv4-unicast segment-routing
-------------------------------------------------------------------

**Minimum user role:** operator

To enter the isis segment-routing configuration level:


**Command syntax: segment-routing**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)#


**Removing Configuration**

To revert all segment-routing configurations to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no segment-routing

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/admin-state_level-1-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute admin-state
-------------------------------------------------------------------------------

**Minimum user role:** operator

To enable ti-lfa fast-reroute:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- ti-fast-reroute cannot be enabled if isis fast-reroute is enabled for the same address-family and level.

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+-------------+-----------------------------+--------------+----------+
| Parameter   | Description                 | Range        | Default  |
+=============+=============================+==============+==========+
| admin-state | configuration for level-1-2 | | enabled    | disabled |
|             |                             | | disabled   |          |
+-------------+-----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state enabled


**Removing Configuration**

To revert the admin-state to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/admin-state_level-1.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute admin-state level level-1
---------------------------------------------------------------------------------------------

**Minimum user role:** operator

To enable the ti-lfa fast-reroute:

**Command syntax: admin-state level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- ti-fast-reroute cannot be enabled if isis fast-reroute is enabled for the same address-family and level.

**Parameter table**

+-------------+---------------------------+--------------+---------+
| Parameter   | Description               | Range        | Default |
+=============+===========================+==============+=========+
| admin-state | configuration for level-1 | | enabled    | \-      |
|             |                           | | disabled   |         |
+-------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state level level-1 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state level level-1 enabled


**Removing Configuration**

To revert the admin-state to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no admin-state level level-1 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/admin-state_level-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute admin-state level level-2
---------------------------------------------------------------------------------------------

**Minimum user role:** operator

To enable ti-lfa fast-reroute:

**Command syntax: admin-state level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- ti-fast-reroute cannot be enabled if isis fast-reroute is enabled for the same address-family and level.

**Parameter table**

+-------------+---------------------------+--------------+---------+
| Parameter   | Description               | Range        | Default |
+=============+===========================+==============+=========+
| admin-state | configuration for level-2 | | enabled    | \-      |
|             |                           | | disabled   |         |
+-------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state level level-2 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state level level-2 enabled


**Removing Configuration**

To revert the admin-state to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no admin-state level level-2 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/fallback-lfa_level-1-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute fallback-lfa
--------------------------------------------------------------------------------

**Minimum user role:** operator

There may be cases where the ti-fast-reroute path can't be found. For example, not all routers in an IS-IS instance are SR speakers.
To enable fallback on regular igp lfa if no ti-fast-reroute path was found:

**Command syntax: fallback-lfa [fallback-lfa]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+--------------+-----------------------------+--------------+----------+
| Parameter    | Description                 | Range        | Default  |
+==============+=============================+==============+==========+
| fallback-lfa | configuration for level-1-2 | | enabled    | disabled |
|              |                             | | disabled   |          |
+--------------+-----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa enabled


**Removing Configuration**

To revert the fallback-lfa to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no fallback-lfa

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/fallback-lfa_level-1.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute fallback-lfa level level-1
----------------------------------------------------------------------------------------------

**Minimum user role:** operator

There may be cases where the ti-fast-reroute path can't be found. For example, not all routers in an IS-IS instance are SR speakers.
To enable fallback on regular igp lfa if no ti-fast-reroute path was found:

**Command syntax: fallback-lfa level level-1 [fallback-lfa]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+--------------+---------------------------+--------------+---------+
| Parameter    | Description               | Range        | Default |
+==============+===========================+==============+=========+
| fallback-lfa | configuration for level-1 | | enabled    | \-      |
|              |                           | | disabled   |         |
+--------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa level level-1 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa level level-1 enabled


**Removing Configuration**

To revert the fallback-lfa level-1 to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no fallback-lfa level level-1 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/fallback-lfa_level-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute fallback-lfa level level-2
----------------------------------------------------------------------------------------------

**Minimum user role:** operator

There may be cases where the ti-fast-reroute path can't be found. For example, not all routers in an IS-IS instance are SR speakers.
To enable fallback on regular igp lfa if no ti-fast-reroute path was found:

**Command syntax: fallback-lfa level level-2 [fallback-lfa]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+--------------+---------------------------+--------------+---------+
| Parameter    | Description               | Range        | Default |
+==============+===========================+==============+=========+
| fallback-lfa | configuration for level-2 | | enabled    | \-      |
|              |                           | | disabled   |         |
+--------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa level level-2 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa level level-2 enabled


**Removing Configuration**

To revert the fallback-lfa level-2 to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no fallback-lfa level level-2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/maximum-labels_level-1-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute maximum-labels
----------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the TI-LFA constructed label stack. 
If the calculated path exceeds the allowed maximum then an LFA path will not be provided by IS-IS and no alternate path will be installed.  
To set the maximum-labels:

**Command syntax: maximum-labels [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- If the level is not specified, it will be set for all isis supported levels.

- Level-1-2 settings will be the default of per-level behavior.

**Parameter table**

+----------------+-----------------------------+-------+---------+
| Parameter      | Description                 | Range | Default |
+================+=============================+=======+=========+
| maximum-labels | configuration for level-1-2 | 1-5   | 3       |
+----------------+-----------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels 2
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels 4


**Removing Configuration**

To revert the maximum-labels to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no maximum-labels

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/maximum-labels_level-1.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute maximum-labels level level-1
------------------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the TI-LFA constructed label stack. 
If the calculated path exceeds the allowed maximum, then an LFA path will not be provided by IS-IS and no alternate path will be installed.  
To set the maximum-labels:

**Command syntax: maximum-labels level level-1 [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Parameter table**

+----------------+---------------------------+-------+---------+
| Parameter      | Description               | Range | Default |
+================+===========================+=======+=========+
| maximum-labels | configuration for level-1 | 1-5   | \-      |
+----------------+---------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels level level-1 2
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels level level-1 4


**Removing Configuration**

To revert the maximum-labels to default:
::

    dnRouter(cfg-inst-afi-ti-frr)# no maximum-labels level level-1 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/maximum-labels_level-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute maximum-labels level level-2
------------------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the TI-LFA constructed label stack. 
If the calculated path exceeds the allowed maximum then an LFA path will not be provided by IS-IS and no alternate path will be installed.
To set the maximum-labels:

**Command syntax: maximum-labels level level-2 [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Parameter table**

+----------------+---------------------------+-------+---------+
| Parameter      | Description               | Range | Default |
+================+===========================+=======+=========+
| maximum-labels | configuration for level-2 | 1-5   | \-      |
+----------------+---------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels level level-2 2
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels level level-2 4


**Removing Configuration**

To revert the maximum-labels to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no maximum-labels level level-2 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/protection-mode_level-1-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute protection-mode
-----------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the required ti-fast-reroute protection for a given ISIS afi and level.
Configuring Shared Risk Link Group (SRLG) protection in TI-LFA Fast-reroute for segment routing allows for a fast reroute backup path that shares no common SRLG with the protected (primary) path.
Links with the same SRLG configuration typically share a common fiber, meaning they may fail if the fiber breaks. TI-LFA SRLG-disjoint protection attempts to find a backup path that excludes the SRLG of the protected path All links of the protected path that share any SRLG with the candidate backup paths are excluded.
For link protection, only the link protection LFA will be calculated. If none are found, no LFA will be provided.
For node protection, first find the node protecting the LFA paths. If none are found, a link protection LFA path will be calculated.

SRLG-disjoint - once set, the fast-reroute LFA path will be an SRLG disjoint with a primary path egress interface SRLG value.

To set the ti-fast-reroute protection:

**Command syntax: protection-mode [protection-mode]** srlg-disjoint

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- Node protection calculation has a higher calculation complexity, and may risk that ISIS will find an LFA path in the required time.

- If the level is not specified, set for all ISIS supported levels.

- Level-1-2 settings are the default of per-level behavior.

**Parameter table**

+-----------------+-------------------------------------------+----------+---------+
| Parameter       | Description                               | Range    | Default |
+=================+===========================================+==========+=========+
| protection-mode | configuration for level-1-2               | | link   | link    |
|                 |                                           | | node   |         |
+-----------------+-------------------------------------------+----------+---------+
| srlg-disjoint   | srlg-disjoint configuration for level-1-2 | \-       | \-      |
+-----------------+-------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode node
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode link
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode node srlg-disjoint


**Removing Configuration**

To revert the protection-mode to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode

To revert the srlg-disjoint constraint:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode node srlg-disjoint

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/protection-mode_level-1.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute protection-mode level level-1
-------------------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the required ti-fast-reroute protection for a given ISIS afi and level.
Configuring Shared Risk Link Group (SRLG) protection in TI-LFA Fast-reroute for segment routing allows for a fast reroute backup path that shares no common SRLG with the protected (primary) path.
Links with the same SRLG configuration typically share a common fiber, meaning they may fail if the fiber breaks. TI-LFA SRLG-disjoint protection attempts to find a backup path that excludes the SRLG of the protected path All links of the protected path that share any SRLG with the candidate backup paths are excluded.
For link protection, only the link protection LFA will be calculated. If none are found, no LFA will be provided.
For node protection, first find the node protecting the LFA paths. If none are found, a link protection LFA path will be calculated.

SRLG-disjoint - once set, the fast-reroute LFA path will be a SRLG disjoint with a primary path egress interface SRLG value.

To set the ti-fast-reroute protection:

**Command syntax: protection-mode level level-1 [protection-mode]** srlg-disjoint

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- Node protection calculation has a higher calculation complexity, and may risk that ISIS will find an LFA path in the required time.

**Parameter table**

+-----------------+-----------------------------------------+----------+---------+
| Parameter       | Description                             | Range    | Default |
+=================+=========================================+==========+=========+
| protection-mode | configuration for level-1               | | link   | \-      |
|                 |                                         | | node   |         |
+-----------------+-----------------------------------------+----------+---------+
| srlg-disjoint   | srlg-disjoint configuration for level-1 | \-       | \-      |
+-----------------+-----------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-1 node
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-1 link
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-1 node srlg-disjoint


**Removing Configuration**

To revert the protection-mode to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode level level-1 

To revert the srlg-disjoint constraint:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode level level-1 node srlg-disjoint

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/protection-mode_level-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute protection-mode level level-2
-------------------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the required ti-fast-reroute protection for a given ISIS afi and level.
Configuring Shared Risk Link Group (SRLG) protection in TI-LFA Fast-reroute for segment routing allows for a fast reroute backup path that shares no common SRLG with the protected (primary) path.
Links with the same SRLG configuration typically share a common fiber, meaning they may fail if the fiber breaks. TI-LFA SRLG-disjoint protection attempts to find a backup path that excludes the SRLG of the protected path All links of the protected path that share any SRLG with the candidate backup paths are excluded.
For link protection, only the link protection LFA will be calculated. If none are found, no LFA will be provided.
For node protection, first find the node protecting the LFA paths. If none are found, a link protection LFA path will be calculated.

SRLG-disjoint - once set, the fast-reroute LFA path will be an SRLG disjoint with a primary path egress interface SRLG value.

To set the ti-fast-reroute protection:

**Command syntax: protection-mode level level-2 [protection-mode]** srlg-disjoint

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- Node protection calculation has a higher calculation complexity, and may risk that ISIS will find an LFA path in the required time.

**Parameter table**

+-----------------+-------------------------------------------+----------+---------+
| Parameter       | Description                               | Range    | Default |
+=================+===========================================+==========+=========+
| protection-mode | configuration for level-2                 | | link   | \-      |
|                 |                                           | | node   |         |
+-----------------+-------------------------------------------+----------+---------+
| srlg-disjoint   | srlg-disjoint configuration for level-1-2 | \-       | \-      |
+-----------------+-------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-2 node
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-2 link
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-2 node srlg-disjoint


**Removing Configuration**

To revert the protection-mode to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode level level-2 

To revert the srlg-disjoint constraint:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode level level-2 node srlg-disjoint

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/srlg-asla.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute srlg-asla
-----------------------------------------------------------------------------

**Minimum user role:** operator

When enabled, DNOS advertises the SRLG information under an application specific SRLG TLV (type 238) for the application type LFA (SABM with F bit).
When enabled, DNOS honors the received application specific SRLG TLVs.
When recevied with the application type LFA (SABM with F bit) any ti-fast-reroute calculation that is require to consider SRLG, utilizes the application specific TLV information regarding the SRLG link values.

To enable the LFA SRLG aplication specific Link Attribute:

**Command syntax: srlg-asla [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**
- The local SRLG is configured under 'protocols mpls traffic-engineering interface <if-name> srlg-group', and is applied for any SRLG advertisement type, i.e legacy and ASLA.
- Once enabled, the ASLA LFA SRLG will be advertised, regardless if the ASLA SR SRLG (S bit) or ASLA Flex-Algo SRLG (X bit) are advertised.
- The SRLG-ASLA configuration is per address-family (i.e topology). Enabling it in a given address-family results in:
-- Advertising the ASLA SRLG TLV 238 which may serve both address families in remote routers.
-- Locally, only the enabled address-family honores received the ASLA SRLG TLV 238 for this address-family (i.e topology) TI-LFA calculations.
- For a given address-family SRLG-ASLA, once enabled, if the ASLA SRLG TLV is not recevied, or received with an L-FLAG, or the F-bit is not set, DNOS leverages the legacy SRLG TLVs in the ti-lfa calculation.
- ASLA LFA SRLG is advertised without an L flag by default and include the configured SRLG values. In case the use-legacy-te is enabled, it sets the L-FLAG in SRLG TLV 238.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enable advertisement and reception of srlg information under Application         | | enabled    | disabled |
|             | Specific SRLG TLV (type 238) for application type LFA (SABM with F bit)          | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-asla enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-asla enabled


**Removing Configuration**

To revert the srlg-asla to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no srlg-asla

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/srlg-mode.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute srlg-mode
-----------------------------------------------------------------------------

**Minimum user role:** operator

Define the SRLG disjointment constraint.
loose (default) - Require srlg disjoint between protected egress interface and protecting path local egress interface , if disjoint alternate path not found, DNOS will provide an LFA path (assuming such exists) without ANY SRLG consideration.
loose-full-path - Require srlg disjoint between protected egress interface and all links of protecting path. if disjoint alternate path not found, DNOS will provide an LFA path (assuming such exists) without ANY SRLG consideration.
strict - Require srlg disjoint between protected egress interface and protecting path local egress interface , if disjoint alternate path not found, no alternate path will be provided.
strict-full-path - Require srlg disjoint between protected egress interface and all links of protecting path. if disjoint alternate path not found, no alternate path will be provided.

To set SRLG-mode:

**Command syntax: srlg-mode [srlg-mode]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- loose-full-path/strict-full-path mode has compute resource penelty and it will take longer to find ti-fast-reroute alternate paths

- The configuration has no effect if the protection mode is not SRLG disjoint.

**Parameter table**

+-----------+-----------------------------------------+----------------------+---------+
| Parameter | Description                             | Range                | Default |
+===========+=========================================+======================+=========+
| srlg-mode | Define the srlg disjointment constraint | | loose              | loose   |
|           |                                         | | loose-full-path    |         |
|           |                                         | | strict             |         |
|           |                                         | | strict-full-path   |         |
+-----------+-----------------------------------------+----------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-mode strict
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-mode loose-full-path


**Removing Configuration**

To revert the srlg-mode to the default behavior:
::

    dnRouter(cfg-inst-afi-ti-frr)# no srlg-mode

**Command History**

+---------+--------------------------------------------------------------------+
| Release | Modification                                                       |
+=========+====================================================================+
| 18.1    | Command introduced                                                 |
+---------+--------------------------------------------------------------------+
| 18.3    | Diffrentiate between loose and strict and add full-path constraint |
+---------+--------------------------------------------------------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/srlg-over-node.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute srlg-over-node
----------------------------------------------------------------------------------

**Minimum user role:** operator

When protection mode is node-protection" and a slrg-disjoint is required, the system by default will try and find lfa path by the following phases:
1. Find a protection path that provides both srlg-disjoint and node protection.
2. If none are found, find a protection path that provides node protection (assuming srlg-mode is not strict).
3. If none are found, find a protection path that provides both srlg-disjoint and link protection.
4. If none are found, find a protection path that provides link protection (assuming srlg-mode is not strict).

If srlg disjointment is preferred over providing node protection, the user must enable srlg-over-node. This will result in the system trying to find an lfa path by the following phases:
1. Find a protection path that provides both srlg-disjoint and node protection.
2. If none are found, find a protection path that provides both srlg-disjoint and link protection.
3. If none are found, find a protection path that provides node protection (assuming srlg-mode is not strict).
4. If none are found, find a protection path that provides link protection (assuming srlg-mode is not strict).

To enable srlg-over-node:

**Command syntax: srlg-over-node [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- The configuration has no effect if protection mode is not "node-protection", or if the srlg-mode is strict.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | In case node protection with srlg-disjoint is required, define that              | | enabled    | disabled |
|             | srlg-disjointment is more important to be provided than node protection          | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-over-node enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-over-node enabled


**Removing Configuration**

To revert the srlg-over-node to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no srlg-over-node

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/strict-spf-protection_level-1-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute strict-spf-protection
-----------------------------------------------------------------------------------------

**Minimum user role:** operator

To set if segment-routing can utilize the TI-LFA path for the protection of strict-spf prefix-sids:

**Command syntax: strict-spf-protection [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+-------------+-----------------------------+--------------+----------+
| Parameter   | Description                 | Range        | Default  |
+=============+=============================+==============+==========+
| admin-state | configuration for level-1-2 | | enabled    | disabled |
|             |                             | | disabled   |          |
+-------------+-----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection enabled


**Removing Configuration**

To revert the strict-spf-protection to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no strict-spf-protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/strict-spf-protection_level-1.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute strict-spf-protection level level-1
-------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

To set if segment-routing can utilize the TI-LFA path for the protection of strict-spf prefix-sids:

**Command syntax: strict-spf-protection level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+-------------+---------------------------+--------------+---------+
| Parameter   | Description               | Range        | Default |
+=============+===========================+==============+=========+
| admin-state | configuration for level-1 | | enabled    | \-      |
|             |                           | | disabled   |         |
+-------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection level level-1 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection level level-1 enabled


**Removing Configuration**

To revert the strict-spf-protection to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no level level-1 strict-spf-protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/strict-spf-protection_level-2.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute strict-spf-protection level level-2
-------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

To set if segment-routing can utilize the TI-LFA path for the protection of strict-spf prefix-sids:

**Command syntax: strict-spf-protection level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast ti-fast-reroute

**Note**

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+-------------+---------------------------+--------------+---------+
| Parameter   | Description               | Range        | Default |
+=============+===========================+==============+=========+
| admin-state | configuration for level-2 | | enabled    | \-      |
|             |                           | | disabled   |         |
+-------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection level level-2 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection level level-2 enabled


**Removing Configuration**

To revert the strict-spf-protection to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no level level-2 strict-spf-protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/ti-fast-reroute/ti-fast-reroute.rst

protocols isis instance address-family ipv4-unicast ti-fast-reroute
-------------------------------------------------------------------

**Minimum user role:** operator

Topology-Independent Loop-Free-Alternate can be used to construct alternate paths using Segment-Routing lsps to provide sub 50msec fast reroute recovery. 
With TI-LFA it will create a per-prefix alternate path. 
The alternate path may utilize usage of SR labels to construct a specific SR LSP to forward the packet to the desired merge-point with the goal of using the post-convergence path. 
By doing so, an alternate path can be provided for any required topology. 

To configure ti-lfa, enter the ti-lfa configuration mode:

**Command syntax: ti-fast-reroute**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- ti-fast-reroute cannot be enabled if isis fast-reroute is enabled for the same address-family and level.

- For ti-fast-reroute to work, segment-routing must be supported for the given address-family.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)#
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)#


**Removing Configuration**

To revert all ti-fast-reroute configuration to default:
::

    dnRouter(cfg-isis-inst-afi)# no ti-fast-reroute

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/timers/throttle_spf.rst

protocols isis instance address-family ipv4-unicast timers throttle spf
-----------------------------------------------------------------------

**Minimum user role:** operator

When an IS-IS router receives an updated LSP, it doesnt immediately run SPF but schedules it, in case there is a change in the topology. Because several routers may be affected by the change, it is likely that multiple updated LSPs are received. The router waits for a short while so that it only has to run SPF once for all updated LSPs.

To prevent the router from repeatedly running SPF if the topology change results from a flapping link, the delay in running SPF will keep increasing as long as updated LSPs keep arriving and up to the maximum holdtime interval.

The configuration applies to a specific IS-IS address-family topology and to all IS-IS levels.

To set the SPF timers:


**Command syntax: throttle spf {delay [delay], min-holdtime [min-holdtime], max-holdtime [max-holdtime]}**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast timers

**Note**
- At least one optional parameter must be configured.
- When working with a single topology, SPF for IPv6-unicast address-family won't run.


**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                      | Range    | Default |
+==============+==================================================================================+==========+=========+
| delay        | The minimum amount of time (in msec) from first change received (e.g. receiving  | 0-600000 | 0       |
|              | an LSP packet) till SPF calculation. The value must be  max-holdtime and       |          |         |
|              | min-holdtime.                                                                    |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| min-holdtime | The minimum interval (in msec) between consecutive SPF calculations. The value   | 0-600000 | 5       |
|              | Must be  max-holdtime.                                                          |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| max-holdtime | The maximum interval (in msec) between consecutive SPF calculations. The value   | 0-600000 | 5000    |
|              | must be  delay and min-holdtime.                                                |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# timers
    dnRouter(cfg-inst-afi-timers)# throttle spf max-holdtime 6600 delay 12
    dnRouter(cfg-inst-afi-timers)# throttle spf min-holdtime 20
    dnRouter(cfg-inst-afi-timers)# throttle spf delay 12 min-holdtime 5 max-holdtime 6600

In the last example, the delay is set to 12 sec, the min-holdtime is set to the default 5 sec and the max-holdtime to 6600 sec. Hence, when an LSP first arrives, the router delays the SPF calculation according to the delay timer (12 sec). 12 seconds after receiving the LSP it will perform the SPF calculation. When a subsequent LSP arrives, it will delay the calculation by min-hold time (5 sec). For every subsequent LSP, the calculation delay will be double the previous delay, until the max-holdtime (6600 sec) is reached.


**Removing Configuration**

To revert all timers to their default value:
::

    dnRouter(cfg-isis-inst-timers)# no throttle spf

To revert a timer to its default value:
::

    dnRouter(cfg-isis-inst-timers)# no throttle spf max-holdtime
    dnRouter(cfg-isis-inst-timers)# no throttle spf delay min-holdtime

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 6.0     | Command introduced                                           |
+---------+--------------------------------------------------------------+
| 9.0     | Applied new hierarchy, removed level-1 and level-1-2 routing |
+---------+--------------------------------------------------------------+

---

### instance/ipv4-unicast/timers/timers.rst

protocols isis instance address-family ipv4-unicast timers
----------------------------------------------------------

**Minimum user role:** operator

Enters address-family timers configuration level.

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# timers
    dnRouter(cfg-inst-afi-timers)#


**Removing Configuration**

To revert all timers configuration to default value:
::

    dnRouter(cfg-isis-inst-afi)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/traffic-engineering_level_level-1.rst

protocols isis instance address-family ipv4-unicast traffic-engineering level level-1
-------------------------------------------------------------------------------------

**Minimum user role:** operator

To enable traffic-engineering support in IS-IS level-1:

  


**Command syntax: traffic-engineering level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**

- TE support is for either level 1 or level 2, even when the IS-IS router supports level-1-2. It cannot be enabled together with traffic-engineering support for level-2.

**Parameter table**

+-------------+------------------------------------+--------------+---------+
| Parameter   | Description                        | Range        | Default |
+=============+====================================+==============+=========+
| admin-state | set TE support for Level-1 routing | | enabled    | \-      |
|             |                                    | | disabled   |         |
+-------------+------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# traffic-engineering level level-1 enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no traffic-engineering level level-1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/traffic-engineering_level_level-2.rst

protocols isis instance address-family ipv4-unicast traffic-engineering level level-2
-------------------------------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to send an MPLS traffic engineering link information (e.g. available bandwidth):


**Command syntax: traffic-engineering level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- This command applies to IS-IS level-2 only.
- IS-IS TE is automatically assigned according to router-id. The router-id is identical for all IS-IS instances.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state of the traffic engineering feature for the IS-IS Level  | | enabled    | \-      |
|             | 2 per address-family.                                                            | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# traffic-engineering level level-2 enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no traffic-engineering level level-2  enabled

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv4-unicast/traffic-engineering.rst

protocols isis instance address-family ipv4-unicast traffic-engineering
-----------------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to send MPLS traffic engineering link information (e.g. available bandwidth):


**Command syntax: traffic-engineering [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv4-unicast

**Note**
- This command applies to IS-IS level-1 and level-2
- In case an explicit level in configured, the explicit configuration is imposed
- IS-IS TE is automatically assigned according to router-id. The router-id is identical for all IS-IS instances.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state of the traffic engineering feature for the IS-IS Level  | | enabled    | disabled |
|             | 2 per address-family.                                                            | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# traffic-engineering enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no traffic-engineering enabled

**Command History**

+---------+-----------------------------------------------+
| Release | Modification                                  |
+=========+===============================================+
| 9.0     | Command introduced                            |
+---------+-----------------------------------------------+
| 19.1    | Command updated to effect level-1 and level-2 |
+---------+-----------------------------------------------+

---

### instance/ipv6-unicast/advertise-passive-only.rst

protocols isis instance address-family ipv6-unicast advertise passive-only
--------------------------------------------------------------------------

**Minimum user role:** operator

The advertise passive-only command enables to administratively set IS-IS to advertise routes only from passive interfaces.


**Command syntax: advertise passive-only [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Parameter table**

+-------------+-------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                   | Range        | Default  |
+=============+===============================================================================+==============+==========+
| admin-state | Administrative setting IS-IS to advertise routes only from passive interfaces | | enabled    | disabled |
|             |                                                                               | | disabled   |          |
+-------------+-------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# advertise passive-only enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no advertise passive-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/aggregate-route.rst

protocols isis instance address-family ipv6-unicast aggregate-route
-------------------------------------------------------------------

**Minimum user role:** operator

Summarization reduces the number of routing updates that are flooded across areas. Though IS-IS supports summarization, being a link-state routing protocol, the link-state database must be identical on all routers within the area, and so summarization within an area is not possible. 
Therefore, you configure the summarization on the L1/L2 device that does the redistribution. The summarizing node will create an aggregate route with a next-hop null 0 (discard) in the IS-IS routing table and advertise it when a more specific route exists in the matching IS-IS level.

summary-only - When set, advertise only the summary route and not the contributing individual routes.
adv-unreachable - When set, once a contributing route becomes unreachable, IS-IS advertise this exact prefix with very high metric for the duration of 'prefix-unreachable adv-lifetime' configured time , signaling to remote nodes that prefix is unreachabile to avoid forwarding traffic towards that prefix base on received summary route. 

To configure route summarization in the L1/L2 device:

**Command syntax: aggregate-route [ip-prefix]** level [level] summary-only adv-unreachable

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+---------------+-----------+
| Parameter       | Description                                                                      | Range         | Default   |
+=================+==================================================================================+===============+===========+
| ip-prefix       | The summary route that will be advertised when a more specific route exists in   | X:X::X:X/x    | \-        |
|                 | the matching IS-IS level. The route must match the address-family.               |               |           |
+-----------------+----------------------------------------------------------------------------------+---------------+-----------+
| level           | Specify the required level for which to inject the summary prefix. Default       | | level-1     | level-1-2 |
|                 | behavior is to add to both levels                                                | | level-2     |           |
|                 |                                                                                  | | level-1-2   |           |
+-----------------+----------------------------------------------------------------------------------+---------------+-----------+
| summary-only    | Advertise only the summary route and not the contributing individual routes.     | Boolean       | False     |
+-----------------+----------------------------------------------------------------------------------+---------------+-----------+
| adv-unreachable | Advertise unreachable routes                                                     | Boolean       | False     |
+-----------------+----------------------------------------------------------------------------------+---------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# aggregate-route 3.3.0.0/16
    dnRouter(cfg-isis-inst-afi)# aggregate-route 4.4.0.0/16 level level-1
    dnRouter(cfg-isis-inst-afi)# aggregate-route 5.5.0.0/16 level level-2 summary-only
    dnRouter(cfg-isis-inst-afi)# aggregate-route 6.6.0.0/16 level level-1-2
    dnRouter(cfg-isis-inst-afi)# aggregate-route 5.6.0.0/16 summary-only adv-unreachable
    dnRouter(cfg-isis-inst-afi)# aggregate-route 5.7.0.0/16 adv-unreachable


**Removing Configuration**

To remove all summary-prefix entries:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route

To remove a specific summary-prefix entry:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route 3.3.0.0/16

To revert to the default level:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route 4.4.0.0/16 level level-2

To revert to the default level and remove the summary-only setting:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route 5.5.0.0/16 level level-2 summary-only

To revert usage of adv-unreachable functionality:
::

    dnRouter(cfg-isis-inst-afi)# no aggregate-route 5.5.0.0/16 adv-unreachable

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 14.0    | Command introduced          |
+---------+-----------------------------+
| 19.3    | Add adv-unreachable support |
+---------+-----------------------------+

---

### instance/ipv6-unicast/default-originate.rst

protocols isis instance address-family ipv6-unicast default-originate
---------------------------------------------------------------------

**Minimum user role:** operator

By default, the default route is distributed only if it is in the RIB and it was not installed from the same IS-IS instance.

To set the IS to distribute a default route to an IS-IS routing domain: 

The default-originate policy command has preference over the always and metric settings, according to the following:

+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| always           | metric           | policy                    | Comment                                                                                                             |
+==================+==================+===========================+=====================================================================================================================+
|                  |                  |                           |                                                                                                                     |
| not set          | not set          | not set                   | default route will not be originated unless it exists in the RIB. Route metric per known metric in RIB              |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| not set          | set              | not set                   | default route will not be originated unless it exists in the RIB with metric value according to user config         |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| set              | not set          | not set                   | default route will be originated with metric 0 value                                                                |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| set              | set              | not set                   | default route will be originated with configured metric                                                             |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| not set / set    | not set / set    | set and return "deny"     | default route will not originate                                                                                    |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| not set          | not set / set    | set and return "allow"    | default route will be originated if route exists in rib no metric modification                                      |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+
|                  |                  |                           |                                                                                                                     |
| set              | not set / set    | set and return "allow"    | default route will be originated with metric   modified according to policy                                         |
+------------------+------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------+

**Command syntax: default-originate** always metric [metric-value] policy [policy-name]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- This option is disabled by default. When enabled, the default behavior is to distribute the default route only if the RIB has the default route and it was not installed from the same IS-IS instance.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter    | Description                                                                      | Range            | Default |
+==============+==================================================================================+==================+=========+
| always       | When specified, the default route is always advertised, even when a default      | boolean          | \-      |
|              | route (0.0.0.0/0) is not present in the routing table.                           |                  |         |
+--------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-value | Specifies the cost for reaching the rest of the world through this default       | 1-16777215       | \-      |
|              | route.                                                                           |                  |         |
+--------------+----------------------------------------------------------------------------------+------------------+---------+
| policy-name  | The name of the route-map used.                                                  | | string         | \-      |
|              | Optionally injects the default route conditionally, depending on the matching    | | length 1-255   |         |
|              | conditions in the policy. Possible policy actions are "match rib-has-route" and  |                  |         |
|              | "set isis-metric".                                                               |                  |         |
+--------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate

    dnRouter(cfg-isis-inst-afi)# default-originate always
    dnRouter(cfg-isis-inst-afi)# default-originate always metric 100

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_2
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate metric 100

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate always metric 100

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate policy DEFAULT_ORIGINATE

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# default-originate always metric 100  policy DEFAULT_ORIGINATE


**Removing Configuration**

To disable this option:
::

    dnRouter(cfg-isis-inst-afi)# no default-originate

To disable the always behavior (so that the default route is not advertised unless the route is in the RIB):
::

    dnRouter(cfg-isis-inst-afi)# no default-originate always

To revert the default metric value:
::

    dnRouter(cfg-isis-inst-afi)# no default-originate always metric

To disable the default policy value:
::

    dnRouter(cfg-isis-inst-afi)# no default-originate policy

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 6.0     | Command introduced            |
+---------+-------------------------------+
| 9.0     | Command not supported         |
+---------+-------------------------------+
| 10.0    | Command reintroduced          |
+---------+-------------------------------+
| 13.0    | Added support for policy-name |
+---------+-------------------------------+

---

### instance/ipv6-unicast/fast-reroute-backup-candidate.rst

protocols isis instance address-family ipv6-unicast fast-reroute backup-candidate
---------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all IS-IS enabled interfaces are valid candidates for IS-IS LFA. The command allows you to include or exclude an interface from being used as a candidate for repair path calculation. When set to be included, the interface will be used for loop-free alternate calculations (when isis fast-reroute is globally enabled. See "isis instance address-family fast-reroute"). If the interface is set to be excluded, it will not be used for repair paths:


**Command syntax: fast-reroute backup-candidate [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- The configuration is only valid for the following interface types:
.. - ge{/10/25/40/100}-X/Y/Z,
.. - geX-<f>/<n>/<p>.<sub-interface id>
.. - bundle-<bundle-id>,
.. - bundle-<bundle-id.sub-bundle-id>
- for other interfaces type require commit validation and that cli will not support such command for these interfaces
- The default behavior is per 'isis instance address-family fast-reroute backup-candidate' configuration
- Inheritance logic:
.. - Interface per level config - inherit the interface level-1-2 config (i.e when level isn't specified)
.. - Interface level-1-2 config - inherits the global fast-reroute backup-candidate (which always exists, can be default)
.. - 'backup-candidate' applies per IS-IS interface address-family topology. For example, when operating in a single topology, if you disable the backup-candidate on an ipv4-unicast interface, the LFA to the interface's neighbor will not be valid for both IPv4 & IPv6 prefixes.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | enabled |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate disabled

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# fast-reroute backup-candidate level level-2 enabled


**Removing Configuration**

To revert to the default admin-state and to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate

To revert only to the default level:
::

    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2 enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate enabled
    dnRouter(cfg-inst-if-afi)# no fast-reroute backup-candidate level level-2

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/ipv6-unicast/fast-reroute-level-1.rst

protocols isis instance address-family ipv6-unicast fast-reroute level level-1
------------------------------------------------------------------------------

**Minimum user role:** operator

The command is responsible for inserting a backup route per IS-IS prefix in the RIB and FIB. Therefore, if a primary path fails, the pre-installed backup path will be used to forward traffic. The backup path will be used as follows (by priority):

#.	Default node protection is preferred over link protection, thus skipping a potential damaged node and forwarding the traffic to the next-hop rather than skipping a potential damaged link.

#.	The path with the lowest metric.

#.	The path with the lowest hop count.

To define the administrative state of fast reroute per IS-IS instance:


**Command syntax: fast-reroute level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- Inheritance logic:
.. - If level not specified, configure for level-1-2 and apply as default behavior for any specific level
.. - If level specified, apply configuration for that level only


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | \-      |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute level level-1 enabled


**Removing Configuration**

To revert to the default admin-state and level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute

To revert to the default fast-reroute admin-state for a specific level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute level level-1

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/ipv6-unicast/fast-reroute-level-2.rst

protocols isis instance address-family ipv6-unicast fast-reroute level level-2
------------------------------------------------------------------------------

**Minimum user role:** operator

The command is responsible for inserting a backup route per IS-IS prefix in the RIB and FIB. Therefore, if a primary path fails, the pre-installed backup path will be used to forward traffic. The backup path will be used as follows (by priority):

#.	Default node protection is preferred over link protection, thus skipping a potential damaged node and forwarding the traffic to the next-hop rather than skipping a potential damaged link.

#.	The path with the lowest metric.

#.	The path with the lowest hop count.

To define the administrative state of fast reroute per IS-IS instance:


**Command syntax: fast-reroute level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- Inheritance logic:
.. - If level not specified, configure for level-1-2 and apply as default behavior for any specific level
.. - If level specified, apply configuration for that level only


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | \-      |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute level level-1 enabled


**Removing Configuration**

To revert to the default admin-state and level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute

To revert to the default fast-reroute admin-state for a specific level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute level level-1

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/ipv6-unicast/fast-reroute.rst

protocols isis instance address-family ipv6-unicast fast-reroute
----------------------------------------------------------------

**Minimum user role:** operator

The command is responsible for inserting a backup route per IS-IS prefix in the RIB and FIB. Therefore, if a primary path fails, the pre-installed backup path will be used to forward traffic. The backup path will be used as follows (by priority):

#.	Default node protection is preferred over link protection, thus skipping a potential damaged node and forwarding the traffic to the next-hop rather than skipping a potential damaged link.

#.	The path with the lowest metric.

#.	The path with the lowest hop count.

To define the administrative state of fast reroute per IS-IS instance:


**Command syntax: fast-reroute [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- Inheritance logic:
.. - If level not specified, configure for level-1-2 and apply as default behavior for any specific level
.. - If level specified, apply configuration for that level only


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state for including or excluding the interface from being     | | enabled    | disabled |
|             | used for repair paths see "Inheritance logic" under notes                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute enabled
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# fast-reroute level level-1 enabled


**Removing Configuration**

To revert to the default admin-state and level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute

To revert to the default fast-reroute admin-state for a specific level:
::

    dnRouter(cfg-isis-inst-afi)# no fast-reroute level level-1

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 13.0    | Command introduced          |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+
| 15.0    | Updated command syntax      |
+---------+-----------------------------+

---

### instance/ipv6-unicast/ipv6-unicast.rst

protocols isis instance address-family ipv6-unicast
---------------------------------------------------

**Minimum user role:** operator

To enter the ISIS address-family ipv6 unicast configuration:

**Command syntax: address-family ipv6-unicast**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- The configuration within this address-family only takes effect once the topology is enabled.

- Traffic Engineering extensions are now supported on ISIS IPv6-Unicast topology.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)#


**Removing Configuration**

To revert all ipv6 unicast configuration to default:
::

    dnRouter(cfg-protocols-isis-inst)# no address-family ipv6-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/load-balancing.rst

protocols isis instance address-family ipv6-unicast load-balancing
------------------------------------------------------------------

**Minimum user role:** operator

Enabled weighted ECMP in ISIS.
Each of the ECMP paths in the ISIS route solution will have weight matching the egress interface weight.
Traffic will be load balanced between the different paths per the path weight ratio.

**Command syntax: load-balancing [LB-Type]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- The configuration is per IS-IS topology. The chosen load-balancing methond in ipv4-unicast will also apply for ipv6 routes if working as a single-topology.

**Parameter table**

+-----------+------------------------------------------+-----------------+---------+
| Parameter | Description                              | Range           | Default |
+===========+==========================================+=================+=========+
| LB-Type   | ISIS multiple path load balancing method | | ecmp          | ecmp    |
|           |                                          | | weight-ecmp   |         |
+-----------+------------------------------------------+-----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# load-balancing weight-ecmp
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# load-balancing ecmp


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no load-balancing

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/maximum-paths.rst

protocols isis instance address-family ipv6-unicast maximum-paths
-----------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to install multiple paths with equal cost in the routing table:

**Command syntax: maximum-paths [maximum-paths]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- The configuration is per address-family and applies regardless of the IS-IS topology enabled.

**Parameter table**

+---------------+-------------------------------------------------------+-------+---------+
| Parameter     | Description                                           | Range | Default |
+===============+=======================================================+=======+=========+
| maximum-paths | The number of routes to install in the routing table. | 1-64  | 8       |
+---------------+-------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# maximum-paths 12
    dnRouter(cfg-isis-inst-afi)# exit
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# maximum-paths 24


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no maximum-paths

**Command History**

+---------+------------------------------------------------------------------------+
| Release | Modification                                                           |
+=========+========================================================================+
| 6.0     | Command introduced                                                     |
+---------+------------------------------------------------------------------------+
| 9.0     | Command removed                                                        |
+---------+------------------------------------------------------------------------+
| 10.0    | Command reintroduced under address-family hierarchy (with new default) |
+---------+------------------------------------------------------------------------+
| 15.0    | Updated parameter range from 32 to 64                                  |
+---------+------------------------------------------------------------------------+

---

### instance/ipv6-unicast/metric-level-1.rst

protocols isis instance address-family ipv6-unicast metric level level-1
------------------------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive level-1 interface default metric value:

**Command syntax: metric level level-1 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family, takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | \-      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# metric level level-1 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric level level-1 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/metric-level-2.rst

protocols isis instance address-family ipv6-unicast metric level level-2
------------------------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive level-2 interface default metric value:

**Command syntax: metric level level-2 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family, takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | \-      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# metric level level-2 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric level level-2 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/metric.rst

protocols isis instance address-family ipv6-unicast metric
----------------------------------------------------------

**Minimum user role:** operator

To configure a non-passive interface default metric value:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level takes presedence.

- The default metric applies for non-passive interfaces only.

- Any interface level metric configuration in the relevant address-family, takes presedence over global address-family metric settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       | 1-16777215 | 10      |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no metric 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/microloop-avoidance/admin-state.rst

protocols isis instance address-family ipv6-unicast microloop-avoidance admin-state
-----------------------------------------------------------------------------------

**Minimum user role:** operator

To enable microloop avoidance:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast microloop-avoidance

**Note**
- Microloop avoidance works per address-family and not per topology.
- In the event of a single-topology, the microloop-avoidance is required to be enabled for the ipv6-unicast address-family to provide avoidance for the ipv6 prefixes.

**Parameter table**

+-------------+----------------------------+--------------+----------+
| Parameter   | Description                | Range        | Default  |
+=============+============================+==============+==========+
| admin-state | Enable microloop avoidance | | enabled    | disabled |
|             |                            | | disabled   |          |
+-------------+----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# admin-state enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# admin-state enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-inst-afi-uloop)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/microloop-avoidance/fib-delay.rst

protocols isis instance address-family ipv6-unicast microloop-avoidance fib-delay
---------------------------------------------------------------------------------

**Minimum user role:** operator

To set the required delay (in milliseconds) between the SR-TE micoloop-avoidance path installation and the post-convergance ISIS unicast path installation:

**Command syntax: fib-delay [fib-delay]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast microloop-avoidance

**Note**

- The microloop avoidance fib-delay parameter is per ISIS topology.

- In the event of a single-topology, the fib-delay of ipv4-unicast address-family will define the expected delay for the ipv6 prefixes as well.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| fib-delay | Delay time until installing post convergance IS-IS paths. Within this time       | 1000-60000 | 5000    |
|           | microloop paths will be used                                                     |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# fib-delay 10000
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# fib-delay 10000


**Removing Configuration**

To revert fib-delay to the default value:
::

    dnRouter(cfg-inst-afi-uloop)# no fib-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/microloop-avoidance/maximum-labels.rst

protocols isis instance address-family ipv6-unicast microloop-avoidance maximum-labels
--------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the SR-TE microloop-avoidance constructed label stack.
If the calculated path exceed the allowed maximum, than a microloop-avoidance path will not be provided by ISIS.
To set the maximum-labels:

**Command syntax: maximum-labels [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast microloop-avoidance

**Note**

- The microloop avoidance maximum-labels parameter is per an IS-IS topology.

- In the event of a single-topology, the maximum-labels of ipv4-unicast address-family will define the maximum label stack of the microloop path for the ipv6 prefixes as well.

**Parameter table**

+----------------+-----------------------------------------------------------+-------+---------+
| Parameter      | Description                                               | Range | Default |
+================+===========================================================+=======+=========+
| maximum-labels | Maximum allowed labels to be added for the microloop path | 1-3   | 3       |
+----------------+-----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# maximum-labels 1
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)# maximum-labels 1


**Removing Configuration**

To revert maximum-labels to the default value:
::

    dnRouter(cfg-inst-afi-uloop)# no maximum-labels

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/microloop-avoidance/microloop-avoidance.rst

protocols isis instance address-family ipv6-unicast microloop-avoidance
-----------------------------------------------------------------------

**Minimum user role:** operator

Microloops are brief packet loops that occur in the network following a topology change (link down, link up, or metric change events). 
Microloops are caused by the non-simultaneous convergence of different nodes in the network. 
If nodes converge and send traffic to a neighbor node that has not converged yet, traffic may be looped between these two nodes, resulting in packet loss, jitter, and out-of-order packets.

The Segment Routing Microloop Avoidance feature detects if microloops are possible following a topology change. 
If a node computes that a microloop could occur on the new topology, the node creates a loop-free SR-TE path to the destination using a list of segments. 
After the FIB update delay timer expires, the SR-TE path is replaced with regular forwarding paths. 

To configure microloop-avoidance, enter microloop-avoidance configuration mode:

**Command syntax: microloop-avoidance**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- For microloop-avoidance to work, segment-routing must be supported for the given address-family.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)#
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# microloop-avoidance
    dnRouter(cfg-inst-afi-uloop)#


**Removing Configuration**

To revert all microloop-avoidance configuration to the default value:
::

    dnRouter(cfg-isis-inst-afi)# no microloop-avoidance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/prefix-priority.rst

protocols isis instance address-family ipv6-unicast prefix-priority tag
-----------------------------------------------------------------------

**Minimum user role:** operator

Assign a tag value to the prefix-priority, to ensure that prefixes with this tag are handled with the given priority

**Command syntax: prefix-priority [prefix-priority] tag [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Parameter table**

+-----------------+--------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                    | Range        | Default |
+=================+================================================================================+==============+=========+
| prefix-priority | The priority - low, mediumm or high                                            | | low        | \-      |
|                 |                                                                                | | medium     |         |
|                 |                                                                                | | high       |         |
+-----------------+--------------------------------------------------------------------------------+--------------+---------+
| tag             | Tag value, that if associated with a prefix will be given the defined priority | 1-4294967295 | \-      |
+-----------------+--------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance ISIS_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-multicast
    dnRouter(cfg-isis-inst-afi)# prefix-priority high tag 100
    dnRouter(cfg-isis-inst-afi)#


**Removing Configuration**

To remove tag:
::

    dnRouter(cfg-inst-protocols-static)# no prefix-priority high

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/prefix-unreachable/adv-lifetime.rst

protocols isis instance address-family ipv6-unicast prefix-unreachable adv-lifetime
-----------------------------------------------------------------------------------

**Minimum user role:** operator

Lifetime of the prefix-unreachable advertisements:

**Command syntax: adv-lifetime [adv-lifetime]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast prefix-unreachable

**Parameter table**

+--------------+----------------------------------------------------+----------+---------+
| Parameter    | Description                                        | Range    | Default |
+==============+====================================================+==========+=========+
| adv-lifetime | Lifetime of the prefix-unreachable advertisements. | 30-65535 | 180     |
+--------------+----------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-unreachable
    dnRouter(cfg-inst-afi-upa)# adv-lifetime 100


**Removing Configuration**

To restoreadv-lifetime to default value:
::

    dnRouter(cfg-inst-afi-upa)# no adv-lifetime

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/prefix-unreachable/prefix-unreachable.rst

protocols isis instance address-family ipv6-unicast prefix-unreachable
----------------------------------------------------------------------

**Minimum user role:** operator

To enter prefix-unreachable configuration level:

**Command syntax: prefix-unreachable**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-unreachable
    dnRouter(cfg-inst-afi-upa)#


**Removing Configuration**

To restore all prefix-unreachable configurations to default value:
::

    dnRouter(cfg-isis-inst-afi)# no prefix-unreachable

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/prefix-unreachable/rx-process.rst

protocols isis instance address-family ipv6-unicast prefix-unreachable rx-process
---------------------------------------------------------------------------------

**Minimum user role:** operator

Enable reception of unreachable prefix announcement (UPA) in order to create and install an unreachable route entry to RIB
If received UPA is found as best route for RIB installation (by regular metric and level consideration) an unreachable route will be added to RIB. 
BGP next-hops (or SRv6 SIDs) matching resolution over an unreachable route will result as invalid next-hop/SID reachablity, triggering PIC edge (in case alternate path exist)
The goal of UPA is to exclude specific prefixes from being reachable when prefix summarization happened across the network. That is useful for triggering fast-convergence mechanisms outside of the IGPs level

To enable rx-process of received unreachable prefixes:

**Command syntax: rx-process [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast prefix-unreachable

**Note**
- When disabled, a received high metric unreachable prefix (metric > 0xFE000000) is omitted from SPF calculations and not included in ISIS route installations

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enable reception of unreachable prefix announcement (UPA) in order to create and | | enabled    | disabled |
|             | install an unreachable route entry to RIB                                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-unreachable
    dnRouter(cfg-inst-afi-upa)# rx-process enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# prefix-unreachable
    dnRouter(cfg-inst-afi-upa)# rx-process enabled


**Removing Configuration**

To revert the rx-process to the default value:
::

    dnRouter(cfg-inst-afi-upa)# no rx-process

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/propagate-level1-to-level2.rst

protocols isis instance address-family ipv6-unicast propagate level1-to-level2 policy
-------------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all level-1 routes propagate into level-2. Use this command to filter the routes that propagate from level-1 to level-2, or to enable route leaking from level-2 to level-1. To do both, explicitly set the command twice, once for each direction. Note that using a policy is mandatory with this command; the policy limits the number of route that are propagated or leaked.

To propagate routes between levels:

**Command syntax: propagate level1-to-level2 policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- "Only the following commands can be used in the propagation attachment points; other match/set statements will be ignored:"
.. - "policy match ip prefix"
.. - "policy match tag"
.. - "policy set tag"
- Routes can propagate from level-1 to level-2 and from level-2 to level-1 at the same time. They cannnot propagate between same levels.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                                      | Range            | Default |
+=============+==================================================================================+==================+=========+
| policy-name | Enter an existing policy that lists the routes that will be propagated or        | | string         | \-      |
|             | leaked. Only "policy match ip prefix" can be used in the propagation attachment  | | length 1-255   |         |
|             | points. Other match / set statements will be ignored.                            |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute static
    dnRouter(cfg-isis-inst-afi)# propagate level1-to-level2 policy L1_TO_L2_FILTER


**Removing Configuration**

To stop level-1 into level-2 propagation filtering:
::

    dnRouter(cfg-isis-inst-afi)# no propagate level1-to-level2

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 14.0    | Command introduced     |
+---------+------------------------+
| 15.0    | Updated command syntax |
+---------+------------------------+

---

### instance/ipv6-unicast/propagate-level2-to-level1.rst

protocols isis instance address-family ipv6-unicast propagate level2-to-level1 policy
-------------------------------------------------------------------------------------

**Minimum user role:** operator

By default, all level-1 routes propagate into level-2. Use this command to filter the routes that propagate from level-1 to level-2, or to enable route leaking from level-2 to level-1. To do both, explicitly set the command twice, once for each direction. Note that using a policy is mandatory with this command; the policy limits the number of route that are propagated or leaked.

To propagate routes between levels:

**Command syntax: propagate level2-to-level1 policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- "Only the following commands can be used in the propagation attachment points; other match/set statements will be ignored:"
.. - "policy match ip prefix"
.. - "policy match tag"
.. - "policy set tag"
- Routes can propagate from level-1 to level-2 and from level-2 to level-1 at the same time. They cannnot propagate between same levels.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                                      | Range            | Default |
+=============+==================================================================================+==================+=========+
| policy-name | Enter an existing policy that lists the routes that will be propagated or        | | string         | \-      |
|             | leaked. Only "policy match ip prefix" can be used in the propagation attachment  | | length 1-255   |         |
|             | points. Other match / set statements will be ignored.                            |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute static
    dnRouter(cfg-isis-inst-afi)# propagate level2-to-level1 policy LEAK_FILTER


**Removing Configuration**

To stop level-2 into level-1 propagation filtering:
::

    dnRouter(cfg-isis-inst-afi)# no propagate level2-to-level1

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 14.0    | Command introduced     |
+---------+------------------------+
| 15.0    | Updated command syntax |
+---------+------------------------+

---

### instance/ipv6-unicast/redistribute_connected.rst

protocols isis instance address-family ipv6-unicast redistribute connected
--------------------------------------------------------------------------

**Minimum user role:** operator

Sets the redistribute connected routes into IS-IS:
metric - used to set routes metric. By default routes are redistributed with metric value 0.
policy - used to filter and modify redistributed routes. The user can match the route by "match ip prefix" and set whether to allow or deny routes redistribution. For allowed routes, the user can set isis-metric per specific prefixes
level - define into which isis level redistribute routes. When setting level-1-2 redistribute into both level-1 and level-2. By default, redistribute to both levels.


**Command syntax: redistribute connected** metric [metric] policy [policy] level [level]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- By default, no redistribution is performed.

- Metric-type: - internal - set IS-IS internal metric type. - external - set IS-IS external metric type.

**Parameter table**

+-----------+------------------------------------+------------------+-----------+
| Parameter | Description                        | Range            | Default   |
+===========+====================================+==================+===========+
| metric    | update route metric                | 0-16777215       | \-        |
+-----------+------------------------------------+------------------+-----------+
| policy    | redistribute by policy rules       | | string         | \-        |
|           |                                    | | length 1-255   |           |
+-----------+------------------------------------+------------------+-----------+
| level     | Levels to redistribute routes into | | level-1        | level-1-2 |
|           |                                    | | level-2        |           |
|           |                                    | | level-1-2      |           |
+-----------+------------------------------------+------------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute connected
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 100
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL
    dnRouter(cfg-isis-inst-afi)# redistribute connected level-2
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL level-1


**Removing Configuration**

To remove connected routes redistribution policy:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected policy

To revert connected routes redistribution metric change:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected metric

To revert connected routes redistribution for default level:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected level

To stop connected routes redistribution:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute connected

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/redistribute_static.rst

protocols isis instance address-family ipv6-unicast redistribute static
-----------------------------------------------------------------------

**Minimum user role:** operator

Devices are allowed to redistribute static routes or routes to connected interfaces into IS-IS.

To redistribute routes learned by other means into IS-IS:

**Command syntax: redistribute static** metric [metric-value] policy [policy-name] level [level]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- This option is disabled by default.
-  Redistribution can be done from multiple protocols
-  Metric-type:
.. -  Internal - set IS-IS internal metric type
.. -  External - set IS-IS external metric type

**Parameter table**

+--------------+----------------------------------------------------------------------------------+------------------+-----------+
| Parameter    | Description                                                                      | Range            | Default   |
+==============+==================================================================================+==================+===========+
| metric-value | Used to set the allowed routes' metric. By default, routes are redistributed     | 0-16777215       | \-        |
|              | with metric 0.                                                                   |                  |           |
+--------------+----------------------------------------------------------------------------------+------------------+-----------+
| policy-name  | The name of the route-map used. Used to filter and modify redistributed routes.  | | string         | \-        |
|              | ou can set whether to allow or deny the redistribution of the routes that match  | | length 1-255   |           |
|              | the specified policy.                                                            |                  |           |
+--------------+----------------------------------------------------------------------------------+------------------+-----------+
| level        | Specify into which IS-IS level to redistribute routes. When setting level-1-2    | | level-1        | level-1-2 |
|              | routes will be redistributed into both level-1 and level-2.                      | | level-2        |           |
|              |                                                                                  | | level-1-2      |           |
+--------------+----------------------------------------------------------------------------------+------------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# redistribute connected
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 100
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL
    dnRouter(cfg-isis-inst-afi)# redistribute connected level-2
    dnRouter(cfg-isis-inst-afi)# redistribute connected metric 110 policy MY_POL level-1


**Removing Configuration**

To stop redistribution of all protocols:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute

To stop redistribution of a specific protocol:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute static

To remove metric modification or policy filtering, or revert to the default level:
::

    dnRouter(cfg-isis-inst-afi)# no redistribute static metric policy

**Command History**

+---------+-----------------------------+
| Release | Modification                |
+=========+=============================+
| 6.0     | Command introduced          |
+---------+-----------------------------+
| 9.0     | Command not supported       |
+---------+-----------------------------+
| 10.0    | Command reintroduced        |
+---------+-----------------------------+
| 14.0    | Added support for level-1-2 |
+---------+-----------------------------+

---

### instance/ipv6-unicast/segment-routing-srv6/admin-state.rst

protocols isis instance address-family ipv6-unicast segment-routing-srv6 admin-state
------------------------------------------------------------------------------------

**Minimum user role:** operator

Enable srv6 in IS-IS, for source routing using SRv6 SID.
Once enabled, segment-routing-srv6 information will be exchanged will all isis neighbors.


**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing-srv6

**Note**

- The isis segment-routing (mpls) and isis segment-routing-srv6 are mutually exclusive. Segment-routing (mpls) must be disabled for segment-routing-srv6 to be enabled.

**Parameter table**

+-------------+---------------------------------------------+--------------+----------+
| Parameter   | Description                                 | Range        | Default  |
+=============+=============================================+==============+==========+
| admin-state | Enable IGP segment routing for ipv6-unicast | | enabled    | disabled |
|             |                                             | | disabled   |          |
+-------------+---------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing-srv6
    dnRouter(cfg-inst-afi-srv6)# admin-state enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-inst-afi-srv6)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing-srv6/locator-name/locator-name.rst

protocols isis instance address-family ipv6-unicast segment-routing-srv6 locator-name
-------------------------------------------------------------------------------------

**Minimum user role:** operator

When a locator is associated with the isis instance an END.X behavior will be dynamically allocated for that locator for each interface that is associated 
with the isis instance and is configured with an ipv6-unicast address family. The locator-prefix+END.x will be installed into the RIB and FIB. Four entries 
will be installed:
1. locator-prefix+END.x/64
2. locator-prefix+END.x/80
3. locator-base+END.x/48
4. locator-base+END.x/64


**Command syntax: locator-name [srv6-igp-locator]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing-srv6

**Parameter table**

+------------------+--------------------------+------------------+---------+
| Parameter        | Description              | Range            | Default |
+==================+==========================+==================+=========+
| srv6-igp-locator | The defined locator name | | string         | \-      |
|                  |                          | | length 1-255   |         |
+------------------+--------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# segment-routing-srv6
    dnRouter(cfg-isis-inst-srv6)# locator-name LOCATOR_1
    dnRouter(cfg-inst-srv6-locator)#


**Removing Configuration**

To remove a specific or all configured locators:
::

    dnRouter(cfg-isis-inst-srv6)# no locator-name LOCATOR_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing-srv6/locator-name/metric.rst

protocols isis instance address-family ipv6-unicast segment-routing-srv6 locator-name metric
--------------------------------------------------------------------------------------------

**Minimum user role:** operator

To configure a metric value for the locator. The metric value will be advertised by IS-IS.

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing-srv6 locator-name

**Parameter table**

+-----------+------------------------------+------------+---------+
| Parameter | Description                  | Range      | Default |
+===========+==============================+============+=========+
| metric    | The metric value for the sid | 1-16777214 | 1       |
+-----------+------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing-srv6
    dnRouter(cfg-inst-afi-srv6)# locator-name LOCATOR_1
    dnRouter(cfg-afi-srv6-locator)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-afi-srv6-locator)# no metric 20

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing-srv6/segment-routing-srv6.rst

protocols isis instance address-family ipv6-unicast segment-routing-srv6
------------------------------------------------------------------------

**Minimum user role:** operator

A router in a Segment Routing network can select any path to forward traffic, whether explicit or Interior Gateway Protocol (IGP) shortest path. Each segment in the path to a network destination has an identifier (a segment ID - SID) that is distributed throughout the network via IGP extensions.

To use segment routing with IS-IS leveraging SRv6 for SID encoding, you need to configure these commands:
#.      Enable segment routing for the ipv6-unicast afi of an IS-IS instance.

#.      Select the locator-name that was globally defined.

#.      Optional. Set the metric for the IS-IS segment-routing srv6 locator. If you do not explicitly configure the metric, the default value will be used.

To enter IS-IS segment-routing-srv6 configuration level:

**Command syntax: segment-routing-srv6**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- Segment-routing-srv6 is only available for ipv6-unicast address family.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing-srv6
    dnRouter(cfg-inst-afi-srv6)#


**Removing Configuration**

To revert all IS-IS segment-routing-srv6 configuration to their default values:
::

    dnRouter(cfg-isis-inst-afi)# no segment-routing-srv6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing/admin-state.rst

protocols isis instance address-family ipv6-unicast segment-routing admin-state
-------------------------------------------------------------------------------

**Minimum user role:** operator

Enable segment-routing in IS-IS, for source routing using MPLS SID.
Once enabled, segment-routing information will be exchanged will all isis neighbors.


**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing

**Parameter table**

+-------------+---------------------------------------------+--------------+----------+
| Parameter   | Description                                 | Range        | Default  |
+=============+=============================================+==============+==========+
| admin-state | Enable IGP segment routing for ipv6-unicast | | enabled    | disabled |
|             |                                             | | disabled   |          |
+-------------+---------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# admin-state enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-inst-afi-sr)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing/mapping-server/level1-to-level2.rst

protocols isis instance address-family ipv6-unicast segment-routing mapping-server propagate level1-to-level2 policy
--------------------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

You can control the propagation of binding SIDs between ISIS levels. Propagation can be done even if the router is not enabled as a mapping client.

Only "policy match ipv6 prefix" can be used in the propagation attachment points. Other match / set statements will be ignored.
Match is achieved when a binding-SID prefix is matches an allow rule in the attached prefix-list. When the binding-SID has a range, the match in the propagation policy is on the first prefix in the range. I.e., a binding-SID 9:9::9:1/128 with range 10 will be matched with ipv6-prefix 9:9::9:1/128 matching-len 128, but not with 9:9::9:4/128 matching-len 128.

To control the propagation of binding-SIDs between ISIS levels:

**Command syntax: propagate level1-to-level2 policy [policy-name]** s-flag-ignore

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing mapping-server

**Note**

- Propagation can be done from level-1 to level-2 and from level-2 to level-1 at the same time, each using a separate policy.

- Reconfiguring the policy in any propagation direction maintains the existing s-flag-ignore settings.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter     | Description                                                                      | Range            | Default |
+===============+==================================================================================+==================+=========+
| policy-name   | The new preference value to be advertised                                        | | string         | \-      |
|               | A value of 0 indicates that advertisements from this node must not be used. The  | | length 1-255   |         |
|               | preference TLV will not be advertised.                                           |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+
| s-flag-ignore | Allows the propagation even when the s-flag is not set on the binding-SID TLV.   | \-               | \-      |
|               | By default, when s-flag is not set, no propagation will be done for binding-SIDs |                  |         |
|               | in any direction. The s-flag configuration is per direction.                     |                  |         |
|               | Reconfiguring the policy in a given propagate direction will maintain the        |                  |         |
|               | existing s-flag-ignore settings.                                                 |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# propagate level1-to-level2 policy My_Pol_1_2 s-flag-ignore
    dnRouter(cfg-afi-sr-mapping)# propagate level2-to-level1 policy My_Pol_2_1


**Removing Configuration**

To remove the s-flag-ignore configuration:
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level1-to-level2 policy My_Pol_1_2 s-flag-ignore

To stop level-1 into level-2 propagation and remove the s-flag-ignore configuration:
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level1-to-level2 policy My_Pol_1_2

To revert to the default behavior where all binding-SID with s-flag configured will be propagated from level-2 to level-1, (i.e., also remove s-flag-ignore configuration):
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level2-to-level1 policy My_Pol_2_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing/mapping-server/level2-to-level1.rst

protocols isis instance address-family ipv6-unicast segment-routing mapping-server propagate level2-to-level1 policy
--------------------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

You can control the propagation of binding SIDs between ISIS levels. Propagation can be done even if the router is not enabled as a mapping client.

Only "policy match ipv6 prefix" can be used in the propagation attachment points. Other match / set statements will be ignored.
Match is achieved when a binding-SID prefix is matches an allow rule in the attached prefix-list. When the binding-SID has a range, the match in the propagation policy is on the first prefix in the range. I.e., a binding-SID 9:9::9:1/128 with range 10 will be matched with ipv6-prefix 9:9::9:1/128 matching-len 128, but not with 9:9::9:4/128 matching-len 128.

To control the propagation of binding-SIDs between ISIS levels:

**Command syntax: propagate level2-to-level1 policy [policy-name]** s-flag-ignore

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing mapping-server

**Note**

- Propagation can be done from level-1 to level-2 and from level-2 to level-1 at the same time, each using a separate policy.

- Reconfiguring the policy in any propagation direction maintains the existing s-flag-ignore settings.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter     | Description                                                                      | Range            | Default |
+===============+==================================================================================+==================+=========+
| policy-name   | The new preference value to be advertised                                        | | string         | \-      |
|               | A value of 0 indicates that advertisements from this node must not be used. The  | | length 1-255   |         |
|               | preference TLV will not be advertised.                                           |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+
| s-flag-ignore | Allows the propagation even when the s-flag is not set on the binding-SID TLV.   | \-               | \-      |
|               | By default, when s-flag is not set, no propagation will be done for binding-SIDs |                  |         |
|               | in any direction. The s-flag configuration is per direction.                     |                  |         |
|               | Reconfiguring the policy in a given propagate direction will maintain the        |                  |         |
|               | existing s-flag-ignore settings.                                                 |                  |         |
+---------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# propagate level1-to-level2 policy My_Pol_1_2 s-flag-ignore
    dnRouter(cfg-afi-sr-mapping)# propagate level2-to-level1 policy My_Pol_2_1


**Removing Configuration**

To remove the s-flag-ignore configuration:
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level1-to-level2 policy My_Pol_1_2 s-flag-ignore

To stop level-1 into level-2 propagation and remove the s-flag-ignore configuration:
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level1-to-level2 policy My_Pol_1_2

To revert to the default behavior where all binding-SID with s-flag configured will be propagated from level-2 to level-1, (i.e., also remove s-flag-ignore configuration):
::

    dnRouter(cfg-afi-sr-mapping)# no propagate level2-to-level1 policy My_Pol_2_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing/mapping-server/mapping-server.rst

protocols isis instance address-family ipv6-unicast segment-routing mapping-server
----------------------------------------------------------------------------------

**Minimum user role:** operator

A mapping-server with advertise enabled advertises the binding SIDs defined in "segment-routing mpls mapping-server prefix-sid-map". A mapping-server with receive enabled is a mapping-client and accepts binding SIDs as if there were prefix-SID advertised from network nodes. See "isis instance address-family segment-routing mapping-server prefix-sid-map advertise" and "isis instance address-family segment-routing mapping-server prefix-sid-map receive".

To configure the segment routing mapping server:

**Command syntax: mapping-server**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing

**Note**

- Configuration of an IPv6-unicast mapping-server applies for IPv6 binding-sid handling regardless of topology.

- -In case of a single topology, the IPv6 binding-SIDs are advertised and honored under TLV 149.

- -In case of a multi topology, the IPv6 binding-SIDs are advertised and honored under TLV 150.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)#


**Removing Configuration**

To revert all mapping-server configuration to their default values:
::

    dnRouter(cfg-inst-afi-sr)# no mapping-server

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing/mapping-server/prefix-sid-map-advertise.rst

protocols isis instance address-family ipv6-unicast segment-routing mapping-server prefix-sid-map advertise
-----------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

This command enables the node as a mapping server. The router advertises binding SIDs according to the configured mapping (see "segment-routing mpls mapping-server prefix-sid-map" on page 2208).

To enable/disable the node as a mapping server:

**Command syntax: prefix-sid-map advertise [admin-state]** level [level]

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing mapping-server

**Note**

- When the mapping server is enabled, the router always uses the local mapping, even if the mapping client functionality is disabled.

- The mapping server messages are not propagated between levels.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+---------------+-----------+
| Parameter   | Description                                                                      | Range         | Default   |
+=============+==================================================================================+===============+===========+
| admin-state | The administrative state of the mapping-server. When enabled, the router will    | | enabled     | disabled  |
|             | act as a segment-routing mapping server and will always use the local mapping,   | | disabled    |           |
|             | even if the mapping client functionality is disabled.                            |               |           |
+-------------+----------------------------------------------------------------------------------+---------------+-----------+
| level       | Defines for which IS-IS level the prefix-SID mapping will be advertised.         | | level-1     | level-1-2 |
|             |                                                                                  | | level-2     |           |
|             |                                                                                  | | level-1-2   |           |
+-------------+----------------------------------------------------------------------------------+---------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# prefix-sid-map advertise enabled

    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# prefix-sid-map advertise enabled level level-1


**Removing Configuration**

To revert to the default value level advertisement:
::

    dnRouter(cfg-inst-afi-sr)# no prefix-sid-map advertise enabled level

To revert to the default advertise admin-state and level values:
::

    dnRouter(cfg-inst-afi-sr)# no prefix-sid-map advertise

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing/mapping-server/prefix-sid-map-receive.rst

protocols isis instance address-family ipv6-unicast segment-routing mapping-server prefix-sid-map receive
---------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

This command enables the node as a mapping client. A mapping client can server multiple mapping servers.

To enable/disable the node as a mapping client:

**Command syntax: prefix-sid-map receive [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast segment-routing mapping-server

**Note**

- When the mapping server is enabled, the router always uses the local mapping, even if the mapping client functionality is disabled.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state of the mapping-client. When enabled, the router will    | | enabled    | enabled |
|             | act as a segment-routing mapping client.                                         | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)# mapping-server
    dnRouter(cfg-afi-sr-mapping)# prefix-sid-map receive enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-afi-sr)# no prefix-sid-map receive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/segment-routing/segment-routing.rst

protocols isis instance address-family ipv6-unicast segment-routing
-------------------------------------------------------------------

**Minimum user role:** operator

Enter isis segment-routing configuration level


**Command syntax: segment-routing**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# segment-routing
    dnRouter(cfg-inst-afi-sr)#


**Removing Configuration**

To revert all segment-routing configuration to default:
::

    dnRouter(cfg-isis-inst-afi)# no segment-routing

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/admin-state_level-1-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute admin-state
-------------------------------------------------------------------------------

**Minimum user role:** operator

To enable ti-lfa fast-reroute:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- ti-fast-reroute cannot be enabled if isis fast-reroute is enabled for the same address-family and level.

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+-------------+-----------------------------+--------------+----------+
| Parameter   | Description                 | Range        | Default  |
+=============+=============================+==============+==========+
| admin-state | configuration for level-1-2 | | enabled    | disabled |
|             |                             | | disabled   |          |
+-------------+-----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state enabled


**Removing Configuration**

To revert the admin-state to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/admin-state_level-1.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute admin-state level level-1
---------------------------------------------------------------------------------------------

**Minimum user role:** operator

To enable the ti-lfa fast-reroute:

**Command syntax: admin-state level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- ti-fast-reroute cannot be enabled if isis fast-reroute is enabled for the same address-family and level.

**Parameter table**

+-------------+---------------------------+--------------+---------+
| Parameter   | Description               | Range        | Default |
+=============+===========================+==============+=========+
| admin-state | configuration for level-1 | | enabled    | \-      |
|             |                           | | disabled   |         |
+-------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state level level-1 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state level level-1 enabled


**Removing Configuration**

To revert the admin-state to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no admin-state level level-1 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/admin-state_level-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute admin-state level level-2
---------------------------------------------------------------------------------------------

**Minimum user role:** operator

To enable ti-lfa fast-reroute:

**Command syntax: admin-state level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- ti-fast-reroute cannot be enabled if isis fast-reroute is enabled for the same address-family and level.

**Parameter table**

+-------------+---------------------------+--------------+---------+
| Parameter   | Description               | Range        | Default |
+=============+===========================+==============+=========+
| admin-state | configuration for level-2 | | enabled    | \-      |
|             |                           | | disabled   |         |
+-------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state level level-2 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# admin-state level level-2 enabled


**Removing Configuration**

To revert the admin-state to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no admin-state level level-2 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/fallback-lfa_level-1-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute fallback-lfa
--------------------------------------------------------------------------------

**Minimum user role:** operator

There may be cases where the ti-fast-reroute path can't be found. For example, not all routers in an IS-IS instance are SR speakers.
To enable fallback on regular igp lfa if no ti-fast-reroute path was found:

**Command syntax: fallback-lfa [fallback-lfa]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+--------------+-----------------------------+--------------+----------+
| Parameter    | Description                 | Range        | Default  |
+==============+=============================+==============+==========+
| fallback-lfa | configuration for level-1-2 | | enabled    | disabled |
|              |                             | | disabled   |          |
+--------------+-----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa enabled


**Removing Configuration**

To revert the fallback-lfa to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no fallback-lfa

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/fallback-lfa_level-1.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute fallback-lfa level level-1
----------------------------------------------------------------------------------------------

**Minimum user role:** operator

There may be cases where the ti-fast-reroute path can't be found. For example, not all routers in an IS-IS instance are SR speakers.
To enable fallback on regular igp lfa if no ti-fast-reroute path was found:

**Command syntax: fallback-lfa level level-1 [fallback-lfa]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+--------------+---------------------------+--------------+---------+
| Parameter    | Description               | Range        | Default |
+==============+===========================+==============+=========+
| fallback-lfa | configuration for level-1 | | enabled    | \-      |
|              |                           | | disabled   |         |
+--------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa level level-1 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa level level-1 enabled


**Removing Configuration**

To revert the fallback-lfa level-1 to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no fallback-lfa level level-1 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/fallback-lfa_level-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute fallback-lfa level level-2
----------------------------------------------------------------------------------------------

**Minimum user role:** operator

There may be cases where the ti-fast-reroute path can't be found. For example, not all routers in an IS-IS instance are SR speakers.
To enable fallback on regular igp lfa if no ti-fast-reroute path was found:

**Command syntax: fallback-lfa level level-2 [fallback-lfa]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+--------------+---------------------------+--------------+---------+
| Parameter    | Description               | Range        | Default |
+==============+===========================+==============+=========+
| fallback-lfa | configuration for level-2 | | enabled    | \-      |
|              |                           | | disabled   |         |
+--------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa level level-2 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# fallback-lfa level level-2 enabled


**Removing Configuration**

To revert the fallback-lfa level-2 to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no fallback-lfa level level-2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/maximum-labels_level-1-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute maximum-labels
----------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the TI-LFA constructed label stack. 
If the calculated path exceeds the allowed maximum then an LFA path will not be provided by IS-IS and no alternate path will be installed.  
To set the maximum-labels:

**Command syntax: maximum-labels [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- If the level is not specified, it will be set for all isis supported levels.

- Level-1-2 settings will be the default of per-level behavior.

**Parameter table**

+----------------+-----------------------------+-------+---------+
| Parameter      | Description                 | Range | Default |
+================+=============================+=======+=========+
| maximum-labels | configuration for level-1-2 | 1-5   | 3       |
+----------------+-----------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels 2
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels 4


**Removing Configuration**

To revert the maximum-labels to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no maximum-labels

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/maximum-labels_level-1.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute maximum-labels level level-1
------------------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the TI-LFA constructed label stack. 
If the calculated path exceeds the allowed maximum, then an LFA path will not be provided by IS-IS and no alternate path will be installed.  
To set the maximum-labels:

**Command syntax: maximum-labels level level-1 [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Parameter table**

+----------------+---------------------------+-------+---------+
| Parameter      | Description               | Range | Default |
+================+===========================+=======+=========+
| maximum-labels | configuration for level-1 | 1-5   | \-      |
+----------------+---------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels level level-1 2
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels level level-1 4


**Removing Configuration**

To revert the maximum-labels to default:
::

    dnRouter(cfg-inst-afi-ti-frr)# no maximum-labels level level-1 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/maximum-labels_level-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute maximum-labels level level-2
------------------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the TI-LFA constructed label stack. 
If the calculated path exceeds the allowed maximum then an LFA path will not be provided by IS-IS and no alternate path will be installed.
To set the maximum-labels:

**Command syntax: maximum-labels level level-2 [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Parameter table**

+----------------+---------------------------+-------+---------+
| Parameter      | Description               | Range | Default |
+================+===========================+=======+=========+
| maximum-labels | configuration for level-2 | 1-5   | \-      |
+----------------+---------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels level level-2 2
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# maximum-labels level level-2 4


**Removing Configuration**

To revert the maximum-labels to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no maximum-labels level level-2 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/protection-mode_level-1-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute protection-mode
-----------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the required ti-fast-reroute protection for a given ISIS afi and level.
Configuring Shared Risk Link Group (SRLG) protection in TI-LFA Fast-reroute for segment routing allows for a fast reroute backup path that shares no common SRLG with the protected (primary) path.
Links with the same SRLG configuration typically share a common fiber, meaning they may fail if the fiber breaks. TI-LFA SRLG-disjoint protection attempts to find a backup path that excludes the SRLG of the protected path All links of the protected path that share any SRLG with the candidate backup paths are excluded.
For link protection, only the link protection LFA will be calculated. If none are found, no LFA will be provided.
For node protection, first find the node protecting the LFA paths. If none are found, a link protection LFA path will be calculated.

SRLG-disjoint - once set, the fast-reroute LFA path will be an SRLG disjoint with a primary path egress interface SRLG value.

To set the ti-fast-reroute protection:

**Command syntax: protection-mode [protection-mode]** srlg-disjoint

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- Node protection calculation has a higher calculation complexity, and may risk that ISIS will find an LFA path in the required time.

- If the level is not specified, set for all ISIS supported levels.

- Level-1-2 settings are the default of per-level behavior.

**Parameter table**

+-----------------+-------------------------------------------+----------+---------+
| Parameter       | Description                               | Range    | Default |
+=================+===========================================+==========+=========+
| protection-mode | configuration for level-1-2               | | link   | link    |
|                 |                                           | | node   |         |
+-----------------+-------------------------------------------+----------+---------+
| srlg-disjoint   | srlg-disjoint configuration for level-1-2 | \-       | \-      |
+-----------------+-------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode node
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode link
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode node srlg-disjoint


**Removing Configuration**

To revert the protection-mode to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode

To revert the srlg-disjoint constraint:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode node srlg-disjoint

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/protection-mode_level-1.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute protection-mode level level-1
-------------------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the required ti-fast-reroute protection for a given ISIS afi and level.
Configuring Shared Risk Link Group (SRLG) protection in TI-LFA Fast-reroute for segment routing allows for a fast reroute backup path that shares no common SRLG with the protected (primary) path.
Links with the same SRLG configuration typically share a common fiber, meaning they may fail if the fiber breaks. TI-LFA SRLG-disjoint protection attempts to find a backup path that excludes the SRLG of the protected path All links of the protected path that share any SRLG with the candidate backup paths are excluded.
For link protection, only the link protection LFA will be calculated. If none are found, no LFA will be provided.
For node protection, first find the node protecting the LFA paths. If none are found, a link protection LFA path will be calculated.

SRLG-disjoint - once set, the fast-reroute LFA path will be a SRLG disjoint with a primary path egress interface SRLG value.

To set the ti-fast-reroute protection:

**Command syntax: protection-mode level level-1 [protection-mode]** srlg-disjoint

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- Node protection calculation has a higher calculation complexity, and may risk that ISIS will find an LFA path in the required time.

**Parameter table**

+-----------------+-----------------------------------------+----------+---------+
| Parameter       | Description                             | Range    | Default |
+=================+=========================================+==========+=========+
| protection-mode | configuration for level-1               | | link   | \-      |
|                 |                                         | | node   |         |
+-----------------+-----------------------------------------+----------+---------+
| srlg-disjoint   | srlg-disjoint configuration for level-1 | \-       | \-      |
+-----------------+-----------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-1 node
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-1 link
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-1 node srlg-disjoint


**Removing Configuration**

To revert the protection-mode to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode level level-1 

To revert the srlg-disjoint constraint:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode level level-1 node srlg-disjoint

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/protection-mode_level-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute protection-mode level level-2
-------------------------------------------------------------------------------------------------

**Minimum user role:** operator

Sets the required ti-fast-reroute protection for a given ISIS afi and level.
Configuring Shared Risk Link Group (SRLG) protection in TI-LFA Fast-reroute for segment routing allows for a fast reroute backup path that shares no common SRLG with the protected (primary) path.
Links with the same SRLG configuration typically share a common fiber, meaning they may fail if the fiber breaks. TI-LFA SRLG-disjoint protection attempts to find a backup path that excludes the SRLG of the protected path All links of the protected path that share any SRLG with the candidate backup paths are excluded.
For link protection, only the link protection LFA will be calculated. If none are found, no LFA will be provided.
For node protection, first find the node protecting the LFA paths. If none are found, a link protection LFA path will be calculated.

SRLG-disjoint - once set, the fast-reroute LFA path will be an SRLG disjoint with a primary path egress interface SRLG value.

To set the ti-fast-reroute protection:

**Command syntax: protection-mode level level-2 [protection-mode]** srlg-disjoint

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- Node protection calculation has a higher calculation complexity, and may risk that ISIS will find an LFA path in the required time.

**Parameter table**

+-----------------+-------------------------------------------+----------+---------+
| Parameter       | Description                               | Range    | Default |
+=================+===========================================+==========+=========+
| protection-mode | configuration for level-2                 | | link   | \-      |
|                 |                                           | | node   |         |
+-----------------+-------------------------------------------+----------+---------+
| srlg-disjoint   | srlg-disjoint configuration for level-1-2 | \-       | \-      |
+-----------------+-------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-2 node
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-2 link
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# protection-mode level level-2 node srlg-disjoint


**Removing Configuration**

To revert the protection-mode to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode level level-2 

To revert the srlg-disjoint constraint:
::

    dnRouter(cfg-inst-afi-ti-frr)# no protection-mode level level-2 node srlg-disjoint

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/srlg-asla.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute srlg-asla
-----------------------------------------------------------------------------

**Minimum user role:** operator

When enabled, DNOS advertises the SRLG information under an application specific SRLG TLV (type 238) for the application type LFA (SABM with F bit).
When enabled, DNOS honors the received application specific SRLG TLVs.
When recevied with the application type LFA (SABM with F bit) any ti-fast-reroute calculation that is require to consider SRLG, utilizes the application specific TLV information regarding the SRLG link values.

To enable the LFA SRLG aplication specific Link Attribute:

**Command syntax: srlg-asla [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**
- The local SRLG is configured under 'protocols mpls traffic-engineering interface <if-name> srlg-group', and is applied for any SRLG advertisement type, i.e legacy and ASLA.
- Once enabled, the ASLA LFA SRLG will be advertised, regardless if the ASLA SR SRLG (S bit) or ASLA Flex-Algo SRLG (X bit) are advertised.
- The SRLG-ASLA configuration is per address-family (i.e topology). Enabling it in a given address-family results in:
-- Advertising the ASLA SRLG TLV 238 which may serve both address families in remote routers.
-- Locally, only the enabled address-family honores received the ASLA SRLG TLV 238 for this address-family (i.e topology) TI-LFA calculations.
- For a given address-family SRLG-ASLA, once enabled, if the ASLA SRLG TLV is not recevied, or received with an L-FLAG, or the F-bit is not set, DNOS leverages the legacy SRLG TLVs in the ti-lfa calculation.
- ASLA LFA SRLG is advertised without an L flag by default and include the configured SRLG values. In case the use-legacy-te is enabled, it sets the L-FLAG in SRLG TLV 238.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Enable advertisement and reception of srlg information under Application         | | enabled    | disabled |
|             | Specific SRLG TLV (type 238) for application type LFA (SABM with F bit)          | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-asla enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-asla enabled


**Removing Configuration**

To revert the srlg-asla to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no srlg-asla

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/srlg-mode.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute srlg-mode
-----------------------------------------------------------------------------

**Minimum user role:** operator

Define the SRLG disjointment constraint.
loose (default) - Require srlg disjoint between protected egress interface and protecting path local egress interface , if disjoint alternate path not found, DNOS will provide an LFA path (assuming such exists) without ANY SRLG consideration.
loose-full-path - Require srlg disjoint between protected egress interface and all links of protecting path. if disjoint alternate path not found, DNOS will provide an LFA path (assuming such exists) without ANY SRLG consideration.
strict - Require srlg disjoint between protected egress interface and protecting path local egress interface , if disjoint alternate path not found, no alternate path will be provided.
strict-full-path - Require srlg disjoint between protected egress interface and all links of protecting path. if disjoint alternate path not found, no alternate path will be provided.

To set SRLG-mode:

**Command syntax: srlg-mode [srlg-mode]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- loose-full-path/strict-full-path mode has compute resource penelty and it will take longer to find ti-fast-reroute alternate paths

- The configuration has no effect if the protection mode is not SRLG disjoint.

**Parameter table**

+-----------+-----------------------------------------+----------------------+---------+
| Parameter | Description                             | Range                | Default |
+===========+=========================================+======================+=========+
| srlg-mode | Define the srlg disjointment constraint | | loose              | loose   |
|           |                                         | | loose-full-path    |         |
|           |                                         | | strict             |         |
|           |                                         | | strict-full-path   |         |
+-----------+-----------------------------------------+----------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-mode strict
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-mode loose-full-path


**Removing Configuration**

To revert the srlg-mode to the default behavior:
::

    dnRouter(cfg-inst-afi-ti-frr)# no srlg-mode

**Command History**

+---------+--------------------------------------------------------------------+
| Release | Modification                                                       |
+=========+====================================================================+
| 18.1    | Command introduced                                                 |
+---------+--------------------------------------------------------------------+
| 18.3    | Diffrentiate between loose and strict and add full-path constraint |
+---------+--------------------------------------------------------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/srlg-over-node.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute srlg-over-node
----------------------------------------------------------------------------------

**Minimum user role:** operator

When protection mode is node-protection" and a slrg-disjoint is required, the system by default will try and find lfa path by the following phases:
1. Find a protection path that provides both srlg-disjoint and node protection.
2. If none are found, find a protection path that provides node protection (assuming srlg-mode is not strict).
3. If none are found, find a protection path that provides both srlg-disjoint and link protection.
4. If none are found, find a protection path that provides link protection (assuming srlg-mode is not strict).

If srlg disjointment is preferred over providing node protection, the user must enable srlg-over-node. This will result in the system trying to find an lfa path by the following phases:
1. Find a protection path that provides both srlg-disjoint and node protection.
2. If none are found, find a protection path that provides both srlg-disjoint and link protection.
3. If none are found, find a protection path that provides node protection (assuming srlg-mode is not strict).
4. If none are found, find a protection path that provides link protection (assuming srlg-mode is not strict).

To enable srlg-over-node:

**Command syntax: srlg-over-node [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- The configuration has no effect if protection mode is not "node-protection", or if the srlg-mode is strict.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | In case node protection with srlg-disjoint is required, define that              | | enabled    | disabled |
|             | srlg-disjointment is more important to be provided than node protection          | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-over-node enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# srlg-over-node enabled


**Removing Configuration**

To revert the srlg-over-node to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no srlg-over-node

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/strict-spf-protection_level-1-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute strict-spf-protection
-----------------------------------------------------------------------------------------

**Minimum user role:** operator

To set if segment-routing can utilize the TI-LFA path for the protection of strict-spf prefix-sids:

**Command syntax: strict-spf-protection [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+-------------+-----------------------------+--------------+----------+
| Parameter   | Description                 | Range        | Default  |
+=============+=============================+==============+==========+
| admin-state | configuration for level-1-2 | | enabled    | disabled |
|             |                             | | disabled   |          |
+-------------+-----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection enabled


**Removing Configuration**

To revert the strict-spf-protection to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no strict-spf-protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/strict-spf-protection_level-1.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute strict-spf-protection level level-1
-------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

To set if segment-routing can utilize the TI-LFA path for the protection of strict-spf prefix-sids:

**Command syntax: strict-spf-protection level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+-------------+---------------------------+--------------+---------+
| Parameter   | Description               | Range        | Default |
+=============+===========================+==============+=========+
| admin-state | configuration for level-1 | | enabled    | \-      |
|             |                           | | disabled   |         |
+-------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection level level-1 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection level level-1 enabled


**Removing Configuration**

To revert the strict-spf-protection to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no level level-1 strict-spf-protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/strict-spf-protection_level-2.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute strict-spf-protection level level-2
-------------------------------------------------------------------------------------------------------

**Minimum user role:** operator

To set if segment-routing can utilize the TI-LFA path for the protection of strict-spf prefix-sids:

**Command syntax: strict-spf-protection level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast ti-fast-reroute

**Note**

- If the level is not specified, set for all isis supported levels.

- Level-1-2 settings are the default of per level behavior.

**Parameter table**

+-------------+---------------------------+--------------+---------+
| Parameter   | Description               | Range        | Default |
+=============+===========================+==============+=========+
| admin-state | configuration for level-2 | | enabled    | \-      |
|             |                           | | disabled   |         |
+-------------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection level level-2 enabled
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)# strict-spf-protection level level-2 enabled


**Removing Configuration**

To revert the strict-spf-protection to the default value:
::

    dnRouter(cfg-inst-afi-ti-frr)# no level level-2 strict-spf-protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/ti-fast-reroute/ti-fast-reroute.rst

protocols isis instance address-family ipv6-unicast ti-fast-reroute
-------------------------------------------------------------------

**Minimum user role:** operator

Topology-Independent Loop-Free-Alternate can be used to construct alternate paths using Segment-Routing lsps to provide sub 50msec fast reroute recovery. 
With TI-LFA it will create a per-prefix alternate path. 
The alternate path may utilize usage of SR labels to construct a specific SR LSP to forward the packet to the desired merge-point with the goal of using the post-convergence path. 
By doing so, an alternate path can be provided for any required topology. 

To configure ti-lfa, enter the ti-lfa configuration mode:

**Command syntax: ti-fast-reroute**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- ti-fast-reroute cannot be enabled if isis fast-reroute is enabled for the same address-family and level.

- For ti-fast-reroute to work, segment-routing must be supported for the given address-family.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)#
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# ti-fast-reroute
    dnRouter(cfg-inst-afi-ti-frr)#


**Removing Configuration**

To revert all ti-fast-reroute configuration to default:
::

    dnRouter(cfg-isis-inst-afi)# no ti-fast-reroute

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/timers/throttle_spf.rst

protocols isis instance address-family ipv6-unicast timers throttle spf
-----------------------------------------------------------------------

**Minimum user role:** operator

When an IS-IS router receives an updated LSP, it doesnt immediately run SPF but schedules it, in case there is a change in the topology. Because several routers may be affected by the change, it is likely that multiple updated LSPs are received. The router waits for a short while so that it only has to run SPF once for all updated LSPs.

To prevent the router from repeatedly running SPF if the topology change results from a flapping link, the delay in running SPF will keep increasing as long as updated LSPs keep arriving and up to the maximum holdtime interval.

The configuration applies to a specific IS-IS address-family topology and to all IS-IS levels.

To set the SPF timers:


**Command syntax: throttle spf {delay [delay], min-holdtime [min-holdtime], max-holdtime [max-holdtime]}**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast timers

**Note**
- At least one optional parameter must be configured.
- When working with a single topology, SPF for IPv6-unicast address-family won't run.


**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                      | Range    | Default |
+==============+==================================================================================+==========+=========+
| delay        | The minimum amount of time (in msec) from first change received (e.g. receiving  | 0-600000 | 0       |
|              | an LSP packet) till SPF calculation. The value must be  max-holdtime and       |          |         |
|              | min-holdtime.                                                                    |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| min-holdtime | The minimum interval (in msec) between consecutive SPF calculations. The value   | 0-600000 | 5       |
|              | Must be  max-holdtime.                                                          |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| max-holdtime | The maximum interval (in msec) between consecutive SPF calculations. The value   | 0-600000 | 5000    |
|              | must be  delay and min-holdtime.                                                |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# timers
    dnRouter(cfg-inst-afi-timers)# throttle spf max-holdtime 6600 delay 12
    dnRouter(cfg-inst-afi-timers)# throttle spf min-holdtime 20
    dnRouter(cfg-inst-afi-timers)# throttle spf delay 12 min-holdtime 5 max-holdtime 6600

In the last example, the delay is set to 12 sec, the min-holdtime is set to the default 5 sec and the max-holdtime to 6600 sec. Hence, when an LSP first arrives, the router delays the SPF calculation according to the delay timer (12 sec). 12 seconds after receiving the LSP it will perform the SPF calculation. When a subsequent LSP arrives, it will delay the calculation by min-hold time (5 sec). For every subsequent LSP, the calculation delay will be double the previous delay, until the max-holdtime (6600 sec) is reached.


**Removing Configuration**

To revert all timers to their default value:
::

    dnRouter(cfg-isis-inst-timers)# no throttle spf

To revert a timer to its default value:
::

    dnRouter(cfg-isis-inst-timers)# no throttle spf max-holdtime
    dnRouter(cfg-isis-inst-timers)# no throttle spf delay min-holdtime

**Command History**

+---------+--------------------------------------------------------------+
| Release | Modification                                                 |
+=========+==============================================================+
| 6.0     | Command introduced                                           |
+---------+--------------------------------------------------------------+
| 9.0     | Applied new hierarchy, removed level-1 and level-1-2 routing |
+---------+--------------------------------------------------------------+

---

### instance/ipv6-unicast/timers/timers.rst

protocols isis instance address-family ipv6-unicast timers
----------------------------------------------------------

**Minimum user role:** operator

Enters address-family timers configuration level.

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv4-unicast
    dnRouter(cfg-isis-inst-afi)# timers
    dnRouter(cfg-inst-afi-timers)#


**Removing Configuration**

To revert all timers configuration to default value:
::

    dnRouter(cfg-isis-inst-afi)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/topology.rst

protocols isis instance address-family ipv6-unicast topology
------------------------------------------------------------

**Minimum user role:** operator

Traditionally, when running IPv4 and IPv6 simultaneously, IS-IS can operate in single-topology or multi-topology mode. In single topology, a single topology is generated for both IPv4 and IPv6 and SPF calculations are done on both address-families simulatenously. In multi-topology, IPv4 and IPv6 prefixes are separated on different topologies and the SPF calculations are therefore also done separately.

To configure whether IS-IS will work with multi-topology and support a dedicated IPv6-Unicast topology (MT ID #2 - RFC5120):

**Command syntax: topology [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- Reconfiguring the topology admin-state will trigger LSP generation and a new IS-IS IIH message will be created with the updated topology information.

- Disabling ipv6-unicast topology does not automatically switch to single topology as other topologies (e.g. multicast) may be enabled.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | Set if ISIS will work with Multi-Topology and support a dedicated IPv6-Unicast   | | enabled    | enabled |
|             | topology MT ID #2                                                                | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# topology disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-isis-inst-afi)# no topology

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/traffic-engineering_level_level-1.rst

protocols isis instance address-family ipv6-unicast traffic-engineering level level-1
-------------------------------------------------------------------------------------

**Minimum user role:** operator

To enable traffic-engineering support in IS-IS level-1:


**Command syntax: traffic-engineering level level-1 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**

- TE support is for either level 1 or level 2, even when the IS-IS router supports level-1-2. It cannot be enabled together with traffic-engineering support for level-2.

**Parameter table**

+-------------+------------------------------------+--------------+---------+
| Parameter   | Description                        | Range        | Default |
+=============+====================================+==============+=========+
| admin-state | set TE support for Level-1 routing | | enabled    | \-      |
|             |                                    | | disabled   |         |
+-------------+------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# traffic-engineering level level-1 enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no traffic-engineering level level-1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/traffic-engineering_level_level-2.rst

protocols isis instance address-family ipv6-unicast traffic-engineering level level-2
-------------------------------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to send MPLS traffic engineering link information (e.g. available bandwidth):


**Command syntax: traffic-engineering level level-2 [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- This command applies to IS-IS level-2 only.
- IS-IS TE is automatically assigned according to the router-id. The router-id is identical for all IS-IS instances.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state of the traffic engineering feature for the IS-IS Level  | | enabled    | \-      |
|             | 2 per address-family.                                                            | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# traffic-engineering level level-2 enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no traffic-engineering level level-2  enabled

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/ipv6-unicast/traffic-engineering.rst

protocols isis instance address-family ipv6-unicast traffic-engineering
-----------------------------------------------------------------------

**Minimum user role:** operator

To configure IS-IS to send MPLS traffic engineering link information (e.g. available bandwidth):


**Command syntax: traffic-engineering [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance address-family ipv6-unicast

**Note**
- This command applies to IS-IS level-1 and level-2
- In case an explicit level in configured, the explicit configuration is imposed
- IS-IS TE is automatically assigned according to router-id. The router-id is identical for all IS-IS instances.


**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state of the traffic engineering feature for the IS-IS Level  | | enabled    | disabled |
|             | 2 per address-family.                                                            | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# address-family ipv6-unicast
    dnRouter(cfg-isis-inst-afi)# traffic-engineering enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-afi)# no traffic-engineering enabled

**Command History**

+---------+-----------------------------------------------+
| Release | Modification                                  |
+=========+===============================================+
| 9.0     | Command introduced                            |
+---------+-----------------------------------------------+
| 19.1    | Command updated to effect level-1 and level-2 |
+---------+-----------------------------------------------+

---

### instance/iso-network.rst

protocols isis instance iso-network
-----------------------------------

**Minimum user role:** operator

In an IS-IS network topology, the routing domain may be divided into multiple subdomains referred to as areas. Each area is assigned an area address. The network entity title (NET) serves as the area address and must be configured in order for IS-IS to work. The ISO-network address is composed of three primary parts:
  - **Area**: the area ID field of variable length from minimum 1 byte to maximum 13 bytes. It may comprise the following sub-parts:
  - Authority and Format Identifier (AFI): identifies the authority which dictates the format of the address.
  - Initial Domain Identifier (IDI): identifies the organization belonging to the AFI.
  - High Order Domain-Specific Part (HODSP): the IS-IS area number within the AS.
  - **System ID**: 6 bytes identifying the node (i.e. router) on the network. Must be identical for all IS-IS instances.
  - **Network Selector** (NSEL): a 1 byte field identifying the network layer service to which a packet should be sent. This field must always be set to 00, indicating that no transport information is carried.

To configure the NET address for an IS-IS instance:


**Command syntax: iso-network [network]** [, network, network]

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- An IS-IS instance may be assigned up to 3 NET addresses. This is useful when merging or splitting areas in the domain. Once the merge or split is complete, there is no need for multiple NET addresses.

- Network must be configured for IS-IS.

- You can configure up to 3 different networks under a single IS-IS instance.

- System-id must be identical for all networks in the same IS-IS instance and for all IS-IS instances.

- The network entity title used for the IS-IS   instance in hexadecimal, as described above. When configuring multiple NETs,   the system ID must be identical in all**Parameter table**

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| network   | The network entity title used for the IS-IS instance in hexadecimal, as          | \-    | \-      |
|           | described above. When configuring multiple NETs, the system ID must be identical |       |         |
|           | in all NETs.                                                                     |       |         |
|           | You must configure a network for IS-IS.                                          |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# iso-network 50.0001.0100.0070.1A45.00

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# iso-network 50.0001.F100.0070.1A45.00, 50.0002.F100.0070.1A45.00


**Removing Configuration**

To remove all NET values:
::

    dnRouter(cfg-protocols-isis-inst)# no iso-network

To remove a specific NET value:
::

    dnRouter(cfg-protocols-isis-inst)# no iso-network 50.0001.F100.0070.1A45.00

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 9.0     | Changed "net" argument to "iso-network" in syntax   |
+---------+-----------------------------------------------------+
| 10.0    | System ID must be identical for all IS-IS instances |
+---------+-----------------------------------------------------+

---

### instance/level.rst

protocols isis instance level
-----------------------------

**Minimum user role:** operator

IS-IS routers (i.e. Intermediate Systems (IS)), are designated as Level-1 (area routers), Level-2 (domain routers) or Level 1-2 (both area and domain routers). ISs that operate at Level 1 exchange routing information with other Level-1 ISs in the same area. ISs that operate at Level 2 exchange routing information with other Level-2 devices only. The set of Level-2 devices and the links that interconnect them form the Level-2 subdomain, which must not be partitioned in order for routing to work properly.

To configure the router's behavior:


**Command syntax: level [level]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- RSVP-TE and BGP-LS are supported on Level-2 only.

**Parameter table**

+-----------+----------------------------------------+---------------+-----------+
| Parameter | Description                            | Range         | Default   |
+===========+========================================+===============+===========+
| level     | The level at which the router operates | | level-1     | level-1-2 |
|           |                                        | | level-2     |           |
|           |                                        | | level-1-2   |           |
+-----------+----------------------------------------+---------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# level level-2


**Removing Configuration**

To revert to the default router level:
::

    dnRouter(cfg-protocols-isis-inst)# no level

**Command History**

+---------+------------------------------------------------------------+
| Release | Modification                                               |
+=========+============================================================+
| 6.0     | Command introduced                                         |
+---------+------------------------------------------------------------+
| 9.0     | Removed level-1 and level-1-2 routing                      |
+---------+------------------------------------------------------------+
| 14.0    | Added support for level-1-2 (changed default to level-1-2) |
+---------+------------------------------------------------------------+
| 17.0    | Added support for level-1                                  |
+---------+------------------------------------------------------------+

---

### instance/loopback_interface/admin-state.rst

protocols isis instance interface admin-state
---------------------------------------------

**Minimum user role:** operator

Setting an IS-IS interface to disable mode. The IS-IS interface will not send or receive IS-IS packets.

To set the IS-IS interface to disable mode:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Parameter table**

+-------------+------------------------------------------------+--------------+---------+
| Parameter   | Description                                    | Range        | Default |
+=============+================================================+==============+=========+
| admin-state | Administratively set the IS-IS interface state | | enabled    | enabled |
|             |                                                | | disabled   |         |
+-------------+------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-isis-inst-if)# no admin-state disabled

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/afi.rst

protocols isis instance interface address-family
------------------------------------------------

**Minimum user role:** operator

This command enables the interface for the specified IS-IS address-family topology. Address-family cannot be configured if the equivalent topology isn't enabled in the IS-IS instance.
To enable an address-family on the IS-IS interface and enter address-family configuration:


**Command syntax: address-family [address-family-type]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface

**Note**
- When only IPv4-unicast is enabled for all IS-IS enabled interfaces, IS-IS works as a single topology.
- There is no default address-family. You must configure at least one address-family to enable IS-IS for the interface.
- For the ipv6-unicast address family, IS-IS metric-style must be 'wide'.


**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------------+---------+
| Parameter           | Description                                                                      | Range              | Default |
+=====================+==================================================================================+====================+=========+
| address-family-type | The address family to be supported by the IS-IS interface. You must configure at | | ipv4-unicast     | \-      |
|                     | least one address-family to enable IS-IS on the interface.                       | | ipv6-unicast     |         |
|                     |                                                                                  | | ipv4-multicast   |         |
+---------------------+----------------------------------------------------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)#

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-multicast
    dnRouter(cfg-inst-if-afi)#

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)#


**Removing Configuration**

To remove all address-family configuration:
::

    dnRouter(cfg-isis-inst-if)# no address-family

To remove a specific address-family configuration:
::

    dnRouter(cfg-isis-inst-if)# no address-family ipv4-unicast
    dnRouter(cfg-isis-inst-if)# no address-family ipv6-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/conditional-adv-level-1.rst

protocols isis instance interface address-family conditional-adv level level-1 policy
-------------------------------------------------------------------------------------

**Minimum user role:** operator

Condition IP reachability advetisement (TLV 135/235/236/237) of interface prefix using a route policy. 
All related reachability infromation such as Segment-Routing SIDs will also be effected. 
Conditional route Adrvertismeant is used to alter ISIS advertisements based on network status, by identifying specific network scenarios using a routing policy, ISIS should stop advertising given prefixes.
This feature is useful for network edge scenarios like ASBR, Upon failure of uplink interface that is used as exist point to another AS, ISIS will stop advertising the lo0 that is used as the next hop. Commonly used when ASBRs advertise the anycast sid as the BGP next-hop.

**Command syntax: conditional-adv level level-1 policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level take presedence

- Metric manipulation by conditional-adv will override interface metric setting, except when max-metric is being set. - i.e when max-metric is required to be advertised to interface , in case prefix is allowed to be advertised, max-matric will be provided

- For non loopback interface, ISIS neighbor info are uneffected (TLV 22/23/222/223)

**Parameter table**

+-------------+--------------------+------------------+---------+
| Parameter   | Description        | Range            | Default |
+=============+====================+==================+=========+
| policy-name | Impose for level-1 | | string         | \-      |
|             |                    | | length 1-255   |         |
+-------------+--------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv level level-1 policy MY_POLICY
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv level level-1 policy MY_POLICY


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-afi)# no conditional-adv level level-1 policy MY_POLICY

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/conditional-adv-level-2.rst

protocols isis instance interface address-family conditional-adv level level-2 policy
-------------------------------------------------------------------------------------

**Minimum user role:** operator

Condition IP reachability advetisement (TLV 135/235/236/237) of interface prefix using a route policy. 
All related reachability infromation such as Segment-Routing SIDs will also be effected. 
Conditional route Adrvertismeant is used to alter ISIS advertisements based on network status, by identifying specific network scenarios using a routing policy, ISIS should stop advertising given prefixes.
This feature is useful for network edge scenarios like ASBR, Upon failure of uplink interface that is used as exist point to another AS, ISIS will stop advertising the lo0 that is used as the next hop. Commonly used when ASBRs advertise the anycast sid as the BGP next-hop.

**Command syntax: conditional-adv level level-2 policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level take presedence

- Metric manipulation by conditional-adv will override interface metric setting, except when max-metric is being set. - i.e when max-metric is required to be advertised to interface , in case prefix is allowed to be advertised, max-matric will be provided

- For non loopback interface, ISIS neighbor info are uneffected (TLV 22/23/222/223)

**Parameter table**

+-------------+--------------------+------------------+---------+
| Parameter   | Description        | Range            | Default |
+=============+====================+==================+=========+
| policy-name | Impose for level-2 | | string         | \-      |
|             |                    | | length 1-255   |         |
+-------------+--------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv level level-2 policy MY_POLICY
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv level level-2 policy MY_POLICY


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-afi)# no conditional-adv level level-2 policy MY_POLICY

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/conditional-adv.rst

protocols isis instance interface address-family conditional-adv policy
-----------------------------------------------------------------------

**Minimum user role:** operator

Condition IP reachability advetisement (TLV 135/235/236/237) of interface prefix using a route policy. 
All related reachability infromation such as Segment-Routing SIDs will also be effected. 
Conditional route Adrvertismeant is used to alter ISIS advertisements based on network status, by identifying specific network scenarios using a routing policy, ISIS should stop advertising given prefixes.
This feature is useful for network edge scenarios like ASBR, Upon failure of uplink interface that is used as exist point to another AS, ISIS will stop advertising the lo0 that is used as the next hop. Commonly used when ASBRs advertise the anycast sid as the BGP next-hop.

**Command syntax: conditional-adv policy [policy-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- Level configuration is optional, if no level is set, impose for level-1-2. Any configuration for more specific level take presedence

- Metric manipulation by conditional-adv will override interface metric setting, except when max-metric is being set. - i.e when max-metric is required to be advertised to interface , in case prefix is allowed to be advertised, max-matric will be provided

- For non loopback interface, ISIS neighbor info are uneffected (TLV 22/23/222/223)

**Parameter table**

+-------------+----------------------+------------------+---------+
| Parameter   | Description          | Range            | Default |
+=============+======================+==================+=========+
| policy-name | Impose for level-1-2 | | string         | \-      |
|             |                      | | length 1-255   |         |
+-------------+----------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv policy MY_POLICY
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# conditional-adv policy MY_POLICY


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-if-afi)# no conditional-adv policy MY_POLICY

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/metric-level-1.rst

protocols isis instance interface address-family metric level level-1
---------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination. You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric level level-1 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | The metric that will be set for the link. The range is dependent on the          | 0-16777215 | \-      |
|           | metric-style configured.                                                         |            |         |
|           | The IS-IS TE-metric is the same as the IGP level-2 metric by default.            |            |         |
|           | A metric value of 16777215 will cause the interface to not be routable except    |            |         |
|           | for interface local address.                                                     |            |         |
|           | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       |            |         |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-fa-afi)# no metric 60

To revert to the default metric (when metric per level is not set):
::

    dnRouter(cfg-inst-if-afi)# no metric
    dnRouter(cfg-inst-if-afi)# no metric 15

To revert from max-metric to the last configured metric:
::

    dnRouter(cfg-inst-if-afi)# no metric level-1 max-metric

To revert to the default metric for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no metric level-2

**Command History**

+---------+--------------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                             |
+=========+==========================================================================================================================+
| 6.0     | Command introduced                                                                                                       |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 9.0     | Removed level-1 and level-1-2 routing, removed support of narrow and transition metric styles, changed range and         |
|         | defaults metric value                                                                                                    |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 11.4    | Added support for GRE-tunnels                                                                                            |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 14.0    | Added support for level-1-2                                                                                              |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 15.0    | Updated command syntax                                                                                                   |
+---------+--------------------------------------------------------------------------------------------------------------------------+

---

### instance/loopback_interface/afi/metric-level-2.rst

protocols isis instance interface address-family metric level level-2
---------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination. You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric level level-2 [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | The metric that will be set for the link. The range is dependent on the          | 0-16777215 | \-      |
|           | metric-style configured.                                                         |            |         |
|           | The IS-IS TE-metric is the same as the IGP level-2 metric by default.            |            |         |
|           | A metric value of 16777215 will cause the interface to not be routable except    |            |         |
|           | for interface local address.                                                     |            |         |
|           | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       |            |         |
|           | metric is set for both level-1 and level-2.                                      |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-fa-afi)# no metric 60

To revert to the default metric (when metric per level is not set):
::

    dnRouter(cfg-inst-if-afi)# no metric
    dnRouter(cfg-inst-if-afi)# no metric 15

To revert from max-metric to the last configured metric:
::

    dnRouter(cfg-inst-if-afi)# no metric level-1 max-metric

To revert to the default metric for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no metric level-2

**Command History**

+---------+--------------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                             |
+=========+==========================================================================================================================+
| 6.0     | Command introduced                                                                                                       |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 9.0     | Removed level-1 and level-1-2 routing, removed support of narrow and transition metric styles, changed range and         |
|         | defaults metric value                                                                                                    |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 11.4    | Added support for GRE-tunnels                                                                                            |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 14.0    | Added support for level-1-2                                                                                              |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 15.0    | Updated command syntax                                                                                                   |
+---------+--------------------------------------------------------------------------------------------------------------------------+

---

### instance/loopback_interface/afi/metric-max-metric-level-1.rst

protocols isis instance interface address-family metric level level-1 max-metric
--------------------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination.
You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric level level-1 max-metric**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert the metric to the configured metric value:
::

    dnRouter(cfg-inst-if-afi)# no metric max-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/metric-max-metric-level-2.rst

protocols isis instance interface address-family metric level level-2 max-metric
--------------------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination.
You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric level level-2 max-metric**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert the metric to the configured metric value:
::

    dnRouter(cfg-inst-if-afi)# no metric max-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/metric-max-metric.rst

protocols isis instance interface address-family metric max-metric
------------------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm.
The path's cost is the sum of all metric values for each outgoing interface to the destination.
You can set different metrics for each routing level.
When IS-IS operates in a multi-topology mode, you can set a different metric value for each address-family.
A GRE tunnel interface with a metric value of 16777215 can be set so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric max-metric**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert the metric to the configured metric value:
::

    dnRouter(cfg-inst-if-afi)# no metric max-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/metric.rst

protocols isis instance interface address-family metric
-------------------------------------------------------

**Minimum user role:** operator

IS-IS uses metrics to calculate the path's cost as part of the SPF algorithm. The path's cost is the sum of all metric values for each outgoing interface to the destination. You can set different metrics for each routing level.
When IS-IS operates in multi-topology mode, you can set a different metric value for each address-family.
Set a GRE tunnel interface with a metric value of 16777215 so that no IS-IS routes will be routable through the GRE interface.
To configure the metric for the interface address-family:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**

- By default, the IS-IS te-metric is the same as the igp level-2 metric.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+------------------------------------------------+
| Parameter | Description                                                                      | Range      | Default                                        |
+===========+==================================================================================+============+================================================+
| metric    | The metric that will be set for the link. The range is dependent on the          | 0-16777215 | per global address-family metric configuration |
|           | metric-style configured.                                                         |            |                                                |
|           | The IS-IS TE-metric is the same as the IGP level-2 metric by default.            |            |                                                |
|           | A metric value of 16777215 will cause the interface to not be routable except    |            |                                                |
|           | for interface local address.                                                     |            |                                                |
|           | If you do not specify level-1 and level-2 for level-1-2 ISs, then the same       |            |                                                |
|           | metric is set for both level-1 and level-2.                                      |            |                                                |
+-----------+----------------------------------------------------------------------------------+------------+------------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-3
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric max-metric

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# metric level level-1 15
    dnRouter(cfg-inst-if-afi)# metric 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-fa-afi)# no metric 60

To revert to the default metric (when metric per level is not set):
::

    dnRouter(cfg-inst-if-afi)# no metric
    dnRouter(cfg-inst-if-afi)# no metric 15

To revert from max-metric to the last configured metric:
::

    dnRouter(cfg-inst-if-afi)# no metric level-1 max-metric

To revert to the default metric for a specific routing level:
::

    dnRouter(cfg-inst-if-afi)# no metric level-2

**Command History**

+---------+--------------------------------------------------------------------------------------------------------------------------+
| Release | Modification                                                                                                             |
+=========+==========================================================================================================================+
| 6.0     | Command introduced                                                                                                       |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 9.0     | Removed level-1 and level-1-2 routing, removed support of narrow and transition metric styles, changed range and         |
|         | defaults metric value                                                                                                    |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 11.4    | Added support for GRE-tunnels                                                                                            |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 14.0    | Added support for level-1-2                                                                                              |
+---------+--------------------------------------------------------------------------------------------------------------------------+
| 15.0    | Updated command syntax                                                                                                   |
+---------+--------------------------------------------------------------------------------------------------------------------------+

---

### instance/loopback_interface/afi/prefix-sid-flex-algo.rst

protocols isis instance interface address-family prefix-sid flex-algo
---------------------------------------------------------------------

**Minimum user role:** operator

A prefix-SID is a type of a SID that is attached to an IP prefix.
There are two types of Prefix-SID: A Node-SID, which must be globally unique, and an Anycast-SID, which can be duplicated and can allow a type of very coarse traffic engineering.
The node SID uses the node's loopback address as the prefix.
Assigning a prefix-sid Flex-Algo, will allow prefix-sid reachability only in the assigned Flex-Algo id domain. It is recommended to set the node-SID on the same loopback interface used for "routing-options router-id".

To allocate a prefix SID Flex-Algo to a loopback interface address:

**Command syntax: prefix-sid flex-algo [flex-algo id] [sid-type] [sid-index/sid-label]** prefix-type [prefix-type] explicit-null

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The command is applicable only to loopback interfaces.
- By default, the prefix-sid is assigned a Node-Sid.
- Can set multiple prefix-sids of different Flex-Algo identifiers for the same loopback interface. All sids must have different local labels.
- It is recommended that you set the Node-SID on the same loopback interface used for "routing-options router-id".
.. - The configured Prefix-SID will be compared with the configured SRGB value, if found out of block range (by either index or label), the commit will fail.
.. - The configured Prefix-SID will be compared with the currently in used SRGB value, if found out of block range (by either index or label), the SID will not be used and the PREFIX_SID_OUT_OF_RANGE syslog will be sent after the commit is applied.
.. -  Cannot configure (commit validation) the same sid-index or label for different prefix-sids. i.e for different algorithm prefix-sid or among different loopback interfaces.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| Parameter           | Description                                                                      | Range                    | Default |
+=====================+==================================================================================+==========================+=========+
| flex-algo id        | flex algorithm identifier                                                        | 128-255                  | \-      |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| sid-type            | Sid type absolute or index                                                       | | index                  | \-      |
|                     |                                                                                  | | label                  |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| sid-index/sid-label | sid-index: Assigns the prefix-SID label according to the index of the            | | sid-index: 0-255999    | \-      |
|                     | Segment-Routing Global Block used by IS-IS. The value must be within the SRGB    | | sid-label: 16-955999   |         |
|                     | range.                                                                           |                          |         |
|                     | sid-label: Assigns the prefix-SID label as an absolute value. The value must be  |                          |         |
|                     | within the SRGB range.                                                           |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| prefix-type         | The type of SID for the router:                                                  | | node                   | node    |
|                     | node - The SID is used to identify the node in the network. The "node" type can  | | anycast                |         |
|                     | only be used for interfaces with an address of /32 (ipv4) or /128 (ipv6).        |                          |         |
|                     | anycast - This SID type may be identical on several routers, helping in creating |                          |         |
|                     | ECMP aware SFP paths                                                             |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| explicit-null       | When set, a penultimate hop neighbor of the Prefix-SID originator will replace   | Boolean                  | False   |
|                     | the Prefix-SID with a Prefix-SID that has an Explicit NULL value.                |                          |         |
|                     | When not used, the default behavior is implicit-null.                            |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid flex-algo 128 index 1

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv6-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid flex-algo 128 index 100

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid flex-algo 128 label 16001 explicit-null

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo1
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid flex-algo 128 index 3000 prefix-type anycast


**Removing Configuration**

To revert prefix-sid optional to its default value:
::

    dnRouter(cfg-inst-if-afi)# no prefix-sid flex-algo 128 index 1 explicit-null

To remove a prefix-sid of a specific flex-algo
::

    dnRouter(cfg-inst-if-afi)# no prefix-sid flex-algo 128

To remove all flex-algo prefix-sids
::

    dnRouter(cfg-inst-if-afi)# no prefix-sid flex-algo

**Command History**

+---------+------------------------------------------------------+
| Release | Modification                                         |
+=========+======================================================+
| 18.0    | Command introduced                                   |
+---------+------------------------------------------------------+
| 18.1    | Add support for flex-algo prefix-sid in ipv6-unicast |
+---------+------------------------------------------------------+

---

### instance/loopback_interface/afi/prefix-sid-strict-spf.rst

protocols isis instance interface address-family prefix-sid strict-spf
----------------------------------------------------------------------

**Minimum user role:** operator

A prefix-SID is a type of a SID that is attached to an IP prefix. There are two types of Prefix-SID: Node-SID, which must be globally unique, and anycast-SID, which can be duplicated and can allow a type of very coarse traffic engineering. The node SID uses the node's loopback address as the prefix.

It is recommended to set the node-SID on the same loopback interface used for "routing-options router-id".

To allocate a prefix SID to a loopback interface address:

**Command syntax: prefix-sid strict-spf [sid-type] [sid-index/sid-label]** prefix-type [prefix-type] explicit-null

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The command is applicable only to loopback interfaces.
- By default, the prefix-sid is assigned a node-sid.
- It is recommended that you set the Node-SID on the same loopback interface used for "routing-options router-id"
.. - Configured Prefix-SID will be compared with the configured SRGB value, if found out of block range (by either index or label), fail commit
.. - Configured Prefix-SID will be compared with the currently in used SRGB value, if found out of block range (by either index or label), SID will not be used and PREFIX_SID_OUT_OF_RANGE syslog will be sent after commit is applied
.. -  Cannot configure (commit validation) same sid-index or label for different prefix-sid. i.e for different algorithm prefix-sid or among different loopback interfaces

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| Parameter           | Description                                                                      | Range                    | Default |
+=====================+==================================================================================+==========================+=========+
| sid-type            | Sid type absolute or index                                                       | | index                  | \-      |
|                     |                                                                                  | | label                  |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| sid-index/sid-label | sid-index: Assigns the prefix-SID label according to the index of the            | | sid-index: 0-255999    | \-      |
|                     | Segment-Routing Global Block used by IS-IS. The value must be within the SRGB    | | sid-label: 16-955999   |         |
|                     | range.                                                                           |                          |         |
|                     | sid-label: Assigns the prefix-SID label as an absolute value. The value must be  |                          |         |
|                     | within the SRGB range.                                                           |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| prefix-type         | The type of SID for the router:                                                  | | node                   | node    |
|                     | node - The SID is used to identify the node in the network. The "node" type can  | | anycast                |         |
|                     | only be used for interfaces with an address of /32 (ipv4) or /128 (ipv6).        |                          |         |
|                     | anycast - This SID type may be identical on several routers, helping in creating |                          |         |
|                     | ECMP aware SFP paths                                                             |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| explicit-null       | When set, a penultimate hop neighbor of the Prefix-SID originator will replace   | Boolean                  | False   |
|                     | the Prefix-SID with a Prefix-SID that has an Explicit NULL value.                |                          |         |
|                     | When not used, the default behavior is implicit-null.                            |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid index 1

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid label 16001 explicit-null

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo1
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid index 3000 prefix-type anycast

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid index 22 algorithm spf
    dnRouter(cfg-inst-if-afi)# prefix-sid strict-spf index 23


**Removing Configuration**

dnRouter(cfg-inst-if-afi)# no prefix-sid strict-spf
::

    dnRouter(cfg-inst-if-afi)# no prefix-sid strict-spf index 22

**Command History**

+---------+------------------------------------------------+
| Release | Modification                                   |
+=========+================================================+
| 14.0    | Command introduced                             |
+---------+------------------------------------------------+
| 15.0    | Added support for spf and strict-spf algorithm |
+---------+------------------------------------------------+

---

### instance/loopback_interface/afi/prefix-sid.rst

protocols isis instance interface address-family prefix-sid
-----------------------------------------------------------

**Minimum user role:** operator

A prefix-SID is a type of a SID that is attached to an IP prefix. There are two types of Prefix-SID: Node-SID, which must be globally unique, and anycast-SID, which can be duplicated and can allow a type of very coarse traffic engineering. The node SID uses the node's loopback address as the prefix.

It is recommended to set the node-SID on the same loopback interface used for "routing-options router-id".

To allocate a prefix SID to a loopback interface address:

**Command syntax: prefix-sid [sid-type] [sid-index/sid-label]** prefix-type [prefix-type] explicit-null

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The command is applicable only to loopback interfaces.
- By default, the prefix-sid is assigned a node-sid.
- It is recommended that you set the Node-SID on the same loopback interface used for "routing-options router-id".
.. - Configured Prefix-SID will be compared with the configured SRGB value, if found out of block range (by either index or label), fail commit
.. - Configured Prefix-SID will be compared with the currently in used SRGB value, if found out of block range (by either index or label), SID will not be used and PREFIX_SID_OUT_OF_RANGE syslog will be sent after commit is applied
.. -  Cannot configure (commit validation) same sid-index or label for different prefix-sid. i.e for different algorithm prefix-sid or among different loopback interfaces

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| Parameter           | Description                                                                      | Range                    | Default |
+=====================+==================================================================================+==========================+=========+
| sid-type            | Sid type absolute or index                                                       | | index                  | \-      |
|                     |                                                                                  | | label                  |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| sid-index/sid-label | sid-index: Assigns the prefix-SID label according to the index of the            | | sid-index: 0-255999    | \-      |
|                     | Segment-Routing Global Block used by IS-IS. The value must be within the SRGB    | | sid-label: 16-955999   |         |
|                     | range.                                                                           |                          |         |
|                     | sid-label: Assigns the prefix-SID label as an absolute value. The value must be  |                          |         |
|                     | within the SRGB range.                                                           |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| prefix-type         | The type of SID for the router:                                                  | | node                   | node    |
|                     | node - The SID is used to identify the node in the network. The "node" type can  | | anycast                |         |
|                     | only be used for interfaces with an address of /32 (ipv4) or /128 (ipv6).        |                          |         |
|                     | anycast - This SID type may be identical on several routers, helping in creating |                          |         |
|                     | ECMP aware SFP paths                                                             |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| explicit-null       | When set, a penultimate hop neighbor of the Prefix-SID originator will replace   | Boolean                  | False   |
|                     | the Prefix-SID with a Prefix-SID that has an Explicit NULL value.                |                          |         |
|                     | When not used, the default behavior is implicit-null.                            |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid index 1

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid label 16001 explicit-null

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo1
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid index 3000 prefix-type anycast

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface lo0
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# prefix-sid index 22 algorithm spf
    dnRouter(cfg-inst-if-afi)# prefix-sid strict-spf index 23


**Removing Configuration**

dnRouter(cfg-inst-if-afi)# no prefix-sid
::

    dnRouter(cfg-inst-if-afi)# no prefix-sid index 22

**Command History**

+---------+------------------------------------------------+
| Release | Modification                                   |
+=========+================================================+
| 14.0    | Command introduced                             |
+---------+------------------------------------------------+
| 15.0    | Added support for spf and strict-spf algorithm |
+---------+------------------------------------------------+

---

### instance/loopback_interface/afi/tag_1.rst

protocols isis instance interface address-family tag level level-1
------------------------------------------------------------------

**Minimum user role:** operator

By default, no tag is set on any interface that is associated with the IS-IS instance. Use this command to associate a tag with the interface.
The tag will be attached to any prefix set on the interface for the given address-family (ipv4-unicast/ipv6-unicast), and is advertised by IS-IS.
Once tagged, the tag may subsequently match a defined policy and it may be sent in an appropriate sub-TLV (135 for IPv4 ST, 235 for IPv4 MT, 236 for IPv6 ST and 237 for IPv6 MT) when the prefix is advertised via the IS-IS protocol.

Although advertised to the rest of the world via IS-IS, the defined tag will not appear in the RIB of the local router.
The local router sees this route as a directly connected route; it does not see IS-IS as the source of this route.
Therefore, the defined tag is used only by IS-IS. This tag will not be redistributed into other protocols.

To configure the IS-IS tag per interface and address-family:

**Command syntax: tag level level-1 [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The tag value is signaled in the LSP as a sub-TLV of the prefix TLV.
- The tag for an IPv6 prefix can differ from the tag of an IPv4 prefix, even when working in a single-topology.
- By default the tag applies to both Levels unless the Level is explicitly indicated.
- IS-IS local interface prefix has priority over redistributed connected of the same prefix therefore the tag behavior will be in accordance with local IS-IS interface settings.

**Parameter table**

+-----------+-----------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                           | Range        | Default |
+===========+=======================================================================+==============+=========+
| tag       | Set the tag value to be attached to prefixes and advertised by IS-IS. | 1-4294967295 | \-      |
+-----------+-----------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag 200

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2 dnRouter
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag 20


**Removing Configuration**

To remove the tag:
::

    dnRouter(cfg-inst-if-afi)# no tag level-1
    dnRouter(cfg-inst-if-afi)# no tag level-2
    dnRouter(cfg-inst-if-afi)# no tag level-2 20
    dnRouter(cfg-inst-if-afi)# no tag

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/tag_2.rst

protocols isis instance interface address-family tag level level-2
------------------------------------------------------------------

**Minimum user role:** operator

By default, no tag is set on any interface that is associated with the IS-IS instance. Use this command to associate a tag with the interface.
The tag will be attached to any prefix set on the interface for the given address-family (ipv4-unicast/ipv6-unicast), and is advertised by IS-IS.
Once tagged, the tag may subsequently match a defined policy and it may be sent in an appropriate sub-TLV (135 for IPv4 ST, 235 for IPv4 MT, 236 for IPv6 ST and 237 for IPv6 MT) when the prefix is advertised via the IS-IS protocol.

Although advertised to the rest of the world via IS-IS, the defined tag will not appear in the RIB of the local router.
The local router sees this route as a directly connected route; it does not see IS-IS as the source of this route.
Therefore, the defined tag is used only by IS-IS. This tag will not be redistributed into other protocols.

To configure the IS-IS tag per interface and address-family:

**Command syntax: tag level level-2 [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The tag value is signaled in the LSP as a sub-TLV of the prefix TLV.
- The tag for an IPv6 prefix can differ from the tag of an IPv4 prefix, even when working in a single-topology.
- By default the tag applies to both Levels unless the Level is explicitly indicated.
- IS-IS local interface prefix has priority over redistributed connected of the same prefix therefore the tag behavior will be in accordance with local IS-IS interface settings.

**Parameter table**

+-----------+-----------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                           | Range        | Default |
+===========+=======================================================================+==============+=========+
| tag       | Set the tag value to be attached to prefixes and advertised by IS-IS. | 1-4294967295 | \-      |
+-----------+-----------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag 200

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2 dnRouter
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag 20


**Removing Configuration**

To remove the tag:
::

    dnRouter(cfg-inst-if-afi)# no tag level-1
    dnRouter(cfg-inst-if-afi)# no tag level-2
    dnRouter(cfg-inst-if-afi)# no tag level-2 20
    dnRouter(cfg-inst-if-afi)# no tag

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/afi/tag.rst

protocols isis instance interface address-family tag
----------------------------------------------------

**Minimum user role:** operator

By default, no tag is set on any interface that is associated with the IS-IS instance. Use this command to associate a tag with the interface.
The tag will be attached to any prefix set on the interface for the given address-family (ipv4-unicast/ipv6-unicast), and is advertised by IS-IS.
Once tagged, the tag may subsequently match a defined policy and it may be sent in an appropriate sub-TLV (135 for IPv4 ST, 235 for IPv4 MT, 236 for IPv6 ST and 237 for IPv6 MT) when the prefix is advertised via the IS-IS protocol.

Although advertised to the rest of the world via IS-IS, the defined tag will not appear in the RIB of the local router.
The local router sees this route as a directly connected route; it does not see IS-IS as the source of this route.
Therefore, the defined tag is used only by IS-IS. This tag will not be redistributed into other protocols.

To configure the IS-IS tag per interface and address-family:

**Command syntax: tag [tag]**

**Command mode:** config

**Hierarchies**

- protocols isis instance interface address-family

**Note**
- The tag value is signaled in the LSP as a sub-TLV of the prefix TLV.
- The tag for an IPv6 prefix can differ from the tag of an IPv4 prefix, even when working in a single-topology.
- By default the tag applies to both Levels unless the Level is explicitly indicated.
- IS-IS local interface prefix has priority over redistributed connected of the same prefix therefore the tag behavior will be in accordance with local IS-IS interface settings.

**Parameter table**

+-----------+-----------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                           | Range        | Default |
+===========+=======================================================================+==============+=========+
| tag       | Set the tag value to be attached to prefixes and advertised by IS-IS. | 1-4294967295 | \-      |
+-----------+-----------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface bundle-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag 200

    dnRouter(cfg-protocols-isis-inst)# interface bundle-4
    dnRouter(cfg-isis-inst-if)# level level-1-2 dnRouter
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag level level-2 20

    dnRouter(cfg-protocols-isis-inst)# interface bundle-5
    dnRouter(cfg-isis-inst-if)# level level-1-2
    dnRouter(cfg-isis-inst-if)# address-family ipv4-unicast
    dnRouter(cfg-inst-if-afi)# tag level level-1 15
    dnRouter(cfg-inst-if-afi)# tag 20


**Removing Configuration**

To remove the tag:
::

    dnRouter(cfg-inst-if-afi)# no tag level-1
    dnRouter(cfg-inst-if-afi)# no tag level-2
    dnRouter(cfg-inst-if-afi)# no tag level-2 20
    dnRouter(cfg-inst-if-afi)# no tag

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### instance/loopback_interface/loopback_interface.rst

protocols isis instance interface
---------------------------------

**Minimum user role:** operator

To enable IS-IS on an interface and enter interface configuration mode:


**Command syntax: interface [interface-name]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- Loopback interfaces can be set on multiple IS-IS instances. All other interface types cannot be enabled on more than one IS-IS instance. Loopback interfaces are passive by default.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+----------------------------------------+---------+
| Parameter      | Description                                                                      | Range                                  | Default |
+================+==================================================================================+========================================+=========+
| interface-name | The name of the interface on which IS-IS is enabled. An interface can only be    | | configured interface name.           | \-      |
|                | configured to a single IS-IS instance.                                           | | lo<0-65535>                          |         |
|                |                                                                                  | | irb<0-65535>                         |         |
|                |                                                                                  | | ge{/10/25/40/100}-X/Y/Z              |         |
|                |                                                                                  | | geX-<f>/<n>/<p>.<sub-interface id>   |         |
|                |                                                                                  | | bundle-<bundle-id>                   |         |
|                |                                                                                  | | bundle-<bundle-id.sub-bundle-id>     |         |
|                |                                                                                  | | gre-tunnel-<id>                      |         |
+----------------+----------------------------------------------------------------------------------+----------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# interface ge100-1/2/1
    dnRouter(cfg-isis-inst-if)#

    dnRouter(cfg-protocols-isis-inst)# interface bundle-2.1012
    dnRouter(cfg-isis-inst-if)#

    dnRouter(cfg-protocols-isis-inst)# interface gre-tunnel-0
    dnRouter(cfg-isis-inst-if)#


**Removing Configuration**

To disable the IS-IS process on an interface:
::

    dnRouter(cfg-protocols-isis-inst)# no interface ge100-1/2/1

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 6.0     | Command introduced            |
+---------+-------------------------------+
| 11.4    | Added support for GRE-tunnels |
+---------+-------------------------------+

---

### instance/lsp-flood-reduction/admin-state.rst

protocols isis instance lsp-flood-reduction admin-state
-------------------------------------------------------

**Minimum user role:** operator

To enable/disable lsp-flood-reduction:


**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance lsp-flood-reduction

**Parameter table**

+-------------+-------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                       | Range        | Default |
+=============+===================================================================+==============+=========+
| admin-state | The administrative state of the lsp-flood-reduction functionality | | enabled    | enabled |
|             |                                                                   | | disabled   |         |
+-------------+-------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# lsp-flood-reduction
    dnRouter(cfg-isis-inst-lspfr)# admin-state disabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-lspfr)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### instance/lsp-flood-reduction/lsp-flood-reduction.rst

protocols isis instance lsp-flood-reduction
-------------------------------------------

**Minimum user role:** operator

When utilizing high scale IS-IS deployment with a multitude of redundant links, reducing the amount of IS-IS flooding is sometimes required (in highly meshed environments).

When entering lsp-flood-reduction configuration level with lsp flood reduction enabled, the lsp flooding will be minimized when there are parallel interfaces to the same adjacent neighbor. LSP will be sent only over a subset of these interfaces.

To enter lsp-flood-reduction level:


**Command syntax: lsp-flood-reduction**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis)# lsp-flood-reduction
    dnRouter(cfg-isis-inst-lspfr)#


**Removing Configuration**

To remove all lsp-flood-reduction configuration:
::

    dnRouter(cfg-protocols-isis)# no lsp-flood-reduction

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### instance/lsp-flood-reduction/max-lsp-replicas.rst

protocols isis instance lsp-flood-reduction max-lsp-replicas
------------------------------------------------------------

**Minimum user role:** operator

To configure the maximum number of lsp replicas to be sent over parallel interfaces when lsp-flood-reduction is in use:


**Command syntax: max-lsp-replicas [replicas]**

**Command mode:** config

**Hierarchies**

- protocols isis instance lsp-flood-reduction

**Parameter table**

+-----------+------------------------------------+-------+---------+
| Parameter | Description                        | Range | Default |
+===========+====================================+=======+=========+
| replicas  | The maximum number of lsp replicas | 2-64  | 2       |
+-----------+------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# lsp-flood-reduction
    dnRouter(cfg-isis-inst-lspfr)# max-lsp-replicas 3


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-lspfr)# no max-lsp-replicas

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### instance/lsp-mtu.rst

protocols isis instance lsp-mtu
-------------------------------

**Minimum user role:** operator

To configure the maximum size of generated LSPs:


**Command syntax: lsp-mtu [mtu]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- For isis to work properly in isis domain, lsp-mtu must be lower than any L2 MTU of any IS-IS enabled interface in that domain.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+----------+---------+
| Parameter | Description                                                                      | Range    | Default |
+===========+==================================================================================+==========+=========+
| mtu       | Sets the maximum size (in bytes) of LSPs. The value must be lower than the L3    | 512-9205 | 1497    |
|           | MTU-3 of any IS-IS enabled interface (3 bytes due to the LLC header).            |          |         |
+-----------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# lsp-mtu 600


**Removing Configuration**

To revert to the default MTU:
::

    dnRouter(cfg-protocols-isis-inst)# no lsp-mtu

**Command History**

+---------+-----------------------+
| Release | Modification          |
+=========+=======================+
| 6.0     | Command introduced    |
+---------+-----------------------+
| 9.0     | Command not supported |
+---------+-----------------------+

---

### instance/max-metric-type.rst

protocols isis instance max-metric-type
---------------------------------------

**Minimum user role:** operator

By default, only an IGP metric is modified to the configured max-metric once the max-metric is desired (administrative, on start-up, administrative per interface).
The operator can select if the max-metric value is imposed for the IGP metric, te-metric or link delay.
To set a new max-metric value:


**Command syntax: max-metric-type {igp [igp-admin-state], te [te-admin-state], delay [delay-admin-state]}**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- At least one metric type must be configured.

- It's require that at least one of the 3 metric types must be enabled (can be due to default enabled).

- The value of 16777215 for a given link result is that this link cannot be used in a topology that has the link metric as the metric type for which max-metric was used.

**Parameter table**

+-------------------+---------------------------------------------------------------------------+--------------+----------+
| Parameter         | Description                                                               | Range        | Default  |
+===================+===========================================================================+==============+==========+
| igp-admin-state   | Set IGP metric with max-metric value when such is desired                 | | enabled    | enabled  |
|                   |                                                                           | | disabled   |          |
+-------------------+---------------------------------------------------------------------------+--------------+----------+
| te-admin-state    | Set Traffic Engineering metric with max-metric value when such is desired | | enabled    | disabled |
|                   |                                                                           | | disabled   |          |
+-------------------+---------------------------------------------------------------------------+--------------+----------+
| delay-admin-state | Set Link Delay with max-metric value when such is desired                 | | enabled    | disabled |
|                   |                                                                           | | disabled   |          |
+-------------------+---------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# max-metric-type delay enabled

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# max-metric-type igp disabled te enabled


**Removing Configuration**

To revert all types to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no max-metric-type

To revert specific metric type to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no max-metric-type te

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/max-metric.rst

protocols isis instance max-metric
----------------------------------

**Minimum user role:** operator

The max-metric command enables to set a maximum value for the IS-IS metric. This is the max-metric that will be used for the "isis instance interface address-family metric" or when "isis instance advertise max-metric" is used. By setting a maximum metric value to an interface, you are maximally reducing the chances of selecting that interface for best path calculation.

To set a new max-metric value:


**Command syntax: max-metric [max-metric]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+------------+------------------------------------+------------+----------+
| Parameter  | Description                        | Range      | Default  |
+============+====================================+============+==========+
| max-metric | Sets the value for maximum metric. | 1-16777215 | 16777214 |
+------------+------------------------------------+------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# max-metric 16777214


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-isis-inst)# no max-metric

**Command History**

+---------+-------------------------------------+
| Release | Modification                        |
+=========+=====================================+
| 10.0    | Command introduced                  |
+---------+-------------------------------------+
| 13.0    | Modified max-metric parameter range |
+---------+-------------------------------------+

---

### instance/overload-on-startup/admin-state.rst

protocols isis instance overload on-startup admin-state
-------------------------------------------------------

**Minimum user role:** operator

Use the command to enable or disable the IS-IS overload behavior upon system start. Once set, the default behavior for the system is to advertise the overload-bit for the configured interval period. The overload-bit signals other routers not to use it as an intermediate hop in their SPF calculations.

To set the IS-IS overload behavior on startup:


**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance overload on-startup

**Parameter table**

+-------------+--------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                  | Range        | Default  |
+=============+==============================================================+==============+==========+
| admin-state | Administratively sets the IS-IS overload behavior on startup | | enabled    | disabled |
|             |                                                              | | disabled   |          |
+-------------+--------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# overload on-startup
    dnRouter(cfg-isis-inst-overload)# admin-state enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-isis-inst-overload)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### instance/overload-on-startup/advertisement-type.rst

protocols isis instance overload on-startup advertisement-type
--------------------------------------------------------------

**Minimum user role:** operator

Configure what IS-IS will advertise in the event the system is overloaded upon process start. IS-IS will either advertise overload-bit, max-metric or both. Overload-bit enables IS-IS LSP to signal other routers not to use it as an intermediate hop in their SPF calculations.

Max-metric enables IS-IS to advertise the max-metric value configured for all instance links. When the value is set to 16777214, the router will be considered to be the least preferable in path calculations (but may still be chosen). When the value is set to 16777215, the router will be excluded in path calculations.

To set the IS-IS advertisement-type:


**Command syntax: advertisement-type [advertisement-type]**

**Command mode:** config

**Hierarchies**

- protocols isis instance overload on-startup

**Parameter table**

+--------------------+---------------------------------------------------+---------------------------------+--------------+
| Parameter          | Description                                       | Range                           | Default      |
+====================+===================================================+=================================+==============+
| advertisement-type | Sets what IS-IS will advertise upon process start | | overload-bit                  | overload-bit |
|                    |                                                   | | max-metric                    |              |
|                    |                                                   | | overload-bit-and-max-metric   |              |
+--------------------+---------------------------------------------------+---------------------------------+--------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# overload on-startup
    dnRouter(cfg-isis-inst-overload)# advertisement-type max-metric


**Removing Configuration**

To revert advertisement-type to default:
::

    dnRouter(cfg-isis-inst-overload)# no advertisement-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### instance/overload-on-startup/interval.rst

protocols isis instance overload on-startup interval
----------------------------------------------------

**Minimum user role:** operator

Configure the maximum interval that IS-IS will advertise the overload-bit or max-metric upon process start.

To set the maximum interval:


**Command syntax: interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols isis instance overload on-startup

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| interval  | The interval time (in seconds) after system start for which IS-IS will advertise | 5-86400 | 600     |
|           | the overload-bit or max-metric                                                   |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# overload on-startup
    dnRouter(cfg-isis-inst-overload)# interval 300


**Removing Configuration**

To revert interval to default:
::

    dnRouter(cfg-isis-inst-overload)# no interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### instance/overload-on-startup/overload-on-startup.rst

protocols isis instance overload on-startup
-------------------------------------------

**Minimum user role:** operator

When a router starts, it takes time until the routing tables are converged to align with network forwarding. In cases where BGP unicast routes are forwarded over IS-IS reachability, there is a need to wait for BGP convergence before advertising itself as a valid transit router. You can define the amount of time IS-IS is considered to be overloaded after BGP convergence has completed, by setting the wait-for-bgp timer and / or an interval period (there is an additional *bgp-delay* timer after BGP has converged).

To enter overload on-startup configuration level:


**Command syntax: overload on-startup**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- The *interval* timer will always take precedence even if wait-for-bgp is set. When the interval expires, the system will no longer be considered in overload.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# overload on-startup
    dnRouter(cfg-isis-inst-overload)#


**Removing Configuration**

::

    dnRouter(cfg-protocols-isis)# no overload on-startup

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### instance/overload-on-startup/wait-for-bgp.rst

protocols isis instance overload on-startup wait-for-bgp
--------------------------------------------------------

**Minimum user role:** operator

Configure the maximum interval that IS-IS will advertise the overload-bit or max-metric, upon process start, until BGP convergence is completed.

To set the bgp delay time:


**Command syntax: wait-for-bgp** bgp-delay [bgp-delay]

**Command mode:** config

**Hierarchies**

- protocols isis instance overload on-startup

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| bgp-delay | The time (in seconds) where IS-IS is considered to be overloaded after bgp       | 0-86400 | 0       |
|           | convergence has completed                                                        |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# overload on-startup
    dnRouter(cfg-isis-inst-overload)# wait-for-bgp

    dnRouter(cfg-isis-inst-overload)# wait-for-bgp bgp-delay 120


**Removing Configuration**

To revert *bgp-delay* to the default value:
::

    dnRouter(cfg-isis-inst-overload)# no wait-for-bgp bgp-delay

To disable the *wait-for-bgp* constraint and revert *bgp-delay* to the default value:
::

    dnRouter(cfg-isis-inst-overload)# no wait-for-bgp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### instance/seamless-bfd/reflector/advertise.rst

protocols isis instance seamless-bfd reflector advertise
--------------------------------------------------------

**Minimum user role:** operator

To enable or disable advertising the Seamless BFD Reflector Discriminator

**Command syntax: advertise [advertise]**

**Command mode:** config

**Hierarchies**

- protocols isis instance seamless-bfd reflector

**Parameter table**

+-----------+-------------------------------------------+--------------+----------+
| Parameter | Description                               | Range        | Default  |
+===========+===========================================+==============+==========+
| advertise | Set to enable to advertise this reflector | | enabled    | disabled |
|           |                                           | | disabled   |          |
+-----------+-------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# seamless-bfd
    dnRouter(cfg-isis-inst-s_bfd)# reflector reflector1
    dnRouter(cfg-inst-s_bfd-reflector)# advertise enabled
    dnRouter(cfg-inst-s_bfd-reflector)#


**Removing Configuration**

To stop advertising the reflector discriminator.
::

    dnRouter(ccfg-inst-s_bfd-reflector)# no advertise

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/seamless-bfd/reflector/reflector.rst

protocols isis instance seamless-bfd reflector
----------------------------------------------

**Minimum user role:** operator

Provide the seamless BFD Reflector that should be advertised by ISIS

**Command syntax: reflector [reflector-list-to-advertise]**

**Command mode:** config

**Hierarchies**

- protocols isis instance seamless-bfd

**Parameter table**

+-----------------------------+-----------------------+-------+---------+
| Parameter                   | Description           | Range | Default |
+=============================+=======================+=======+=========+
| reflector-list-to-advertise | Name of the reflector | \-    | \-      |
+-----------------------------+-----------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# seamless-bfd
    dnRouter(cfg-isis-inst-s_bfd)# reflector reflector1
    dnRouter(cfg-inst-s_bfd-reflector)#


**Removing Configuration**

To remove this reflector from being advertised.
::

    dnRouter(cfg-isis-inst-s_bfd)# no reflector

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/seamless-bfd/seamless-bfd.rst

protocols isis instance seamless-bfd
------------------------------------

**Minimum user role:** operator

To configure IS-IS to advertise seamless-bfd reflector discriminators:

**Command syntax: seamless-bfd**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# seamless-bfd
    dnRouter(cfg-isis-inst-s_bfd)#


**Removing Configuration**

To stop the isis process from advertising seamless-bfd relector discriminators
::

    dnRouter(cfg-protocols-isis-inst)# no seamless-bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/segment-routing/administrative-distance.rst

protocols isis instance segment-routing administrative-distance
---------------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance. This setting affects which protocol is preferred in mpls-nexthop table in the RIB.

To configure the administrative distance for IS-IS segment routing:

**Command syntax: administrative-distance [admin-distance]**

**Command mode:** config

**Hierarchies**

- protocols isis instance segment-routing

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                                      | Range | Default |
+================+==================================================================================+=======+=========+
| admin-distance | Sets the administrative distance for IS-IS segment-routing. A value of 255 will  | 1-255 | 107     |
|                | cause the router to remove the route from the routing table.                     |       |         |
+----------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# segment-routing
    dnRouter(cfg-isis-inst-sr)# administrative-distance 103


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-isis-inst-sr)# no administrative-distance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### instance/segment-routing/segment-routing.rst

protocols isis instance segment-routing
---------------------------------------

**Minimum user role:** operator

A router in a Segment Routing network can select any path to forward traffic, whether explicit or Interior Gateway Protocol (IGP) shortest path. Each segment in the path to a network destination has an identifier (a segment ID - SID) that is distributed throughout the network via IGP extensions.

To use segment routing with IS-IS, you need to configure these commands:

#.      Optional. Set the segment routing global block (SRGB) and segment routing local block (SRLB) label ranges that will be used by each segment routing-enabled router in the network. You can do this globally for all IGPs (see "routing-options segment-routing mpls global-block" and "routing-options segment-routing mpls local-block") or within the IGP (see "isis instance segment-routing global-block" and "isis instance segment-routing local-block"). If you do not explicitly configure label block ranges, default ranges will be used.

#.      Enable segment routing for an IS-IS instance.

#.      Set the router's node-SID.

#.      Optional. Set the administrative-distance for IS-IS segment-routing. If you do not explicitly configure the administrative-distance, the default value will be used.

To enter IS-IS segment-routing configuration level:

**Command syntax: segment-routing**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Note**

- Segment-routing is only available for ipv4-unicast address family.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# segment-routing
    dnRouter(cfg-isis-inst-sr)#


**Removing Configuration**

To revert all IS-IS segment-routing configuration to their default values:
::

    dnRouter(cfg-protocols-isis-inst)# no segment-routing

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### instance/shortcut-usage.rst

protocols isis instance shortcut-usage
--------------------------------------

**Minimum user role:** operator

Set if IS-IS will run shortcut calculation to find shortcut paths using lsp nexthop and install them in mpls-nh table. If enabled, no forwarding-adjacency link can be configured for the IS-IS instance.
Behavior applies for all IS-IS levels.

**Command syntax: shortcut-usage [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | Set if ISIS will run shortcut calculation to find shortcut paths using lsp       | | enabled    | enabled |
|             | nexthop and install them in mpls-nh table.                                       | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# shortcut-usage enabled

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# shortcut-usage disabled


**Removing Configuration**

To revert the shortcut-usage to its default value:
::

    dnRouter(cfg-protocols-bgp-neighbor)# no shortcut-usage

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### instance/timers/lsp-interval.rst

protocols isis instance timers lsp-interval
-------------------------------------------

**Minimum user role:** operator

You can set the minimum amount of time (in seconds) between consecutive lsp packets that are transmitted on a given interface.

To configure the interval:

**Command syntax: lsp-interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols isis instance timers

**Note**

- The first packet to be sent on an interface will be transmitted immediately.

- If lsp-interval has been reconfigured, it will only take effect after the next packet is transmitted.

**Parameter table**

+-----------+-------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                       | Range   | Default |
+===========+===================================================================+=========+=========+
| interval  | The minimum interval (in seconds) between consecutive LSP packets | 0-10000 | 0       |
+-----------+-------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# timers
    dnRouter(cfg-isis-inst-timers)# lsp-interval 33


**Removing Configuration**

To revert to the default interval:
::

    dnRouter(cfg-isis-inst-timers)# no lsp-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### instance/timers/lsp-lifetime.rst

protocols isis instance timers lsp-lifetime
-------------------------------------------

**Minimum user role:** operator

The LSP lifetime interval determines the maximum amount of time that LSPs can remain in the router's database without being refreshed. You may need to adjust the maximum LSP lifetime if you change the LSP refresh interval.

To configure the lifetime interval:

**Command syntax: lsp-lifetime [interval]**

**Command mode:** config

**Hierarchies**

- protocols isis instance timers

**Note**

- The configuration applies to all IS-IS levels

- lsp-lifetime interval must >= 300 + lsp-refresh.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-----------+---------+
| Parameter | Description                                                                      | Range     | Default |
+===========+==================================================================================+===========+=========+
| interval  | The maximum time (in seconds) that an LSP can remain in the router's database    | 360-65535 | 1200    |
|           | without being refreshed.                                                         |           |         |
|           | The set interval must be higher than the set lsp-refresh timer.                  |           |         |
+-----------+----------------------------------------------------------------------------------+-----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# timers
    dnRouter(cfg-isis-inst-timers)# lsp-lifetime 1000


**Removing Configuration**

To revert to the default interval:
::

    dnRouter(cfg-isis-inst-timers)# no lsp-lifetime

**Command History**

+---------+---------------------------------------------------------------------+
| Release | Modification                                                        |
+=========+=====================================================================+
| 6.0     | Command introduced                                                  |
+---------+---------------------------------------------------------------------+
| 9.0     | Moved to IS-IS global timers, removed level-1 and level-1-2 routing |
+---------+---------------------------------------------------------------------+

---

### instance/timers/lsp-refresh.rst

protocols isis instance timers lsp-refresh
------------------------------------------

**Minimum user role:** operator

The refresh interval determines the rate at which LSPs containing different sequence numbers are regenerated. This is done to keep the database information fresh.

To configure the refresh rate:

**Command syntax: lsp-refresh [interval]**

**Command mode:** config

**Hierarchies**

- protocols isis instance timers

**Note**

- The configuration applies to all isis levels

- lsp-lifetime interval must >= 300 + lsp-refresh.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| interval  | The minimum interval (in seconds) between regeneration of LSPs containing        | 1-65235 | 900     |
|           | different sequence numbers.                                                      |         |         |
|           | The set interval must be lower than the lsp-lifetime timer.                      |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# timers
    dnRouter(cfg-isis-inst-timers)# lsp-refresh 100


**Removing Configuration**

To revert to the default interval:
::

    dnRouter(cfg-isis-inst-timers)# no lsp-refresh

**Command History**

+---------+---------------------------------------------------------------------+
| Release | Modification                                                        |
+=========+=====================================================================+
| 6.0     | Command introduced                                                  |
+---------+---------------------------------------------------------------------+
| 9.0     | Moved to IS-IS global timers, removed level-1 and level-1-2 routing |
+---------+---------------------------------------------------------------------+

---

### instance/timers/throttle-lsp.rst

protocols isis instance timers throttle lsp
-------------------------------------------

**Minimum user role:** operator

In the NCR, local LSPs are generated as a result of interface status change, e.g interface going up/down, or change in neighbor adjacency. Repeated recalculations of LSPs can cause increased CPU load on the local router. Also, the flooding of these recalculated LSPs to other IS-IS routers in the network causes increased traffic and prolonged route calculations. A solution is to delay the LSP updates to reduce the number of recalculations. However, such delays impact convergence time.

This command gives you control over LSP generation timers to decide on the optimal trade-off between convergence time and LSP flooding.

This command sets the minimum intervals at which LSPs are sent on an IS-IS interface to control the flooding pace to neighboring routing devices and prevent overloading them.

The throttle algorithm exponentially increases the holdtime between LSP generations as long as LSP generation triggering events keep coming. If for two max-holdtime durations no LSP generation triggering event is received, the min-holdtime reverts to its original value.

To set throttle LSP timers:

**Command syntax: throttle lsp {delay [delay], max-holdtime [max-holdtime], min-holdtime [min-holdtime]}**

**Command mode:** config

**Hierarchies**

- protocols isis instance timers

**Note**
- The configuration applies to all IS-IS levels
- You can set each parameter individually in any order
- The parameters' values must be: delay <= min-holdtime <= max-holdtime.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                      | Range    | Default |
+==============+==================================================================================+==========+=========+
| delay        | The minimum amount of time (in msec) from first change received till SPF         | 0-600000 | 50      |
|              | calculation.                                                                     |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| max-holdtime | The minimum hold time (in msec) between consecutive SPF calculations.            | 0-600000 | 5000    |
|              | Must be lower than max-holdtime.                                                 |          |         |
|              | The min-holdtime is doubled after every LSP calculation, until max-holdtime is   |          |         |
|              | reached. If after 2 max-holdtime durations no LSP generation triggering event    |          |         |
|              | occurs, the min-holdtime reverts to its original configured value.               |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| min-holdtime | The maximum holdtime (in msec) between consecutive LSP calculations.             | 0-600000 | 200     |
|              | Must be higher than min-holdtime.                                                |          |         |
|              | 2 x max-holdtime must be lower than the set lsp-refresh. See "isis instance      |          |         |
|              | timers lsp-refresh".                                                             |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# timers
    dnRouter(cfg-isis-inst-timers)# throttle lsp max-holdtime 5000 delay 5
    dnRouter(cfg-isis-inst-timers)# throttle lsp min-holdtime 20
    dnRouter(cfg-isis-inst-timers)# throttle lsp delay 200 min-holdtime 400 max-holdtime 10000

In the last example, the delay is set to 200ms, the min-holdtime is set to 400 ms and the max-holdtime to 10s. Hence, when an LSA first arrives, the router delays the SPF calculation according to the delay timer (200 msec). 200 msec after receiving the LSA it will perform the SPF calculation. When a subsequent LSA arrives, it will delay the calculation by min-hold time (400 msec). For every subsequent LSA, the calculation delay will be double the previous delay, until the max-holdtime (10s) is reached.


**Removing Configuration**

To revert a timer to its default value:
::

    dnRouter(cfg-isis-inst-timers)# no throttle lsp max-holdtime
    dnRouter(cfg-isis-inst-timers)# no throttle lsp delay min-holdtime

To revert all timers to their default value:
::

    dnRouter(cfg-isis-inst-timers)# no throttle lsp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### instance/timers/timers.rst

protocols isis instance timers
------------------------------

**Minimum user role:** operator

To configure global IS-IS timers, enter the timers configuration level:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols isis instance

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# instance area_1
    dnRouter(cfg-protocols-isis-inst)# timers
    dnRouter(cfg-isis-inst-timers)#


**Removing Configuration**

To revert all timers to their default value:
::

    dnRouter(cfg-protocols-isis-inst)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### isis overview.rst

Intermediate System to Intermediate System (IS-IS) Overview
-----------------------------------------------------------
The IS-IS routing protocol is a link-state Interior Gateway Protocol (IGP) providing fast convergence, better stability, and more efficient use of bandwidth, memory, and CPU resources. Like other link-state protocols, IS-IS propagates the information required to build a complete network connectivity map on each participating device. This map is then used to calculate the shortest path to destinations.

In large ISIS domains, scaling the number of nodes and links can become a limiting factor due to the LSP database's increased size. Splitting the ISIS domain into levels is an efficient scaling method. Level 1/2 functionality supports route leaking and propagation between the different levels and summarization on level boundaries. DNOS supports pure L2 and L1/L2 border nodes.

**Note**

- RSVP-TE and BGP-LS are supported on L2 only.

---

### isis.rst

protocols isis
--------------

**Minimum user role:** operator

The IS-IS routing protocol is a link-state Interior Gateway Protocol (IGP) providing fast convergence, better stability, and more efficient use of bandwidth, memory, and CPU resources. Like other link-state protocols, IS-IS propagates the information required to build a complete network connectivity map on each participating device. This map is then used to calculate the shortest path to destinations.

In large IS-IS domains, scaling the number of nodes and links can become a limiting factor due to the LSP database's increased size. Splitting the IS-IS domain into levels is an efficient scaling method. Level 1/2 functionality supports route leaking and propagation between the different levels and summarization on level boundaries. DNOS supports pure L2 and L1/L2 border nodes.

To enter the IS-IS global configuration level:

**Command syntax: isis**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- RSVP-TE and BGP-LS are supported on L2 only.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)#


**Removing Configuration**

To remove all IS-IS instances and return all global IS-IS configuration to the default values:
::

    dnRouter(cfg-protocols)# no isis

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### lsp-fingerprint.rst

protocols isis lsp-fingerprint
------------------------------

**Minimum user role:** operator

Enable advertisement of fingerprint TLV (Type 15) according to rfc8196.
Fingerprint TLV will hold unique system identifiers.
Fingerprint TLV is used to detect duplicating nodes in the network. The detection will result only in a system event, no other corrective action is automatically taken.
To enable LSP fingerprint TLV generation:

**Command syntax: lsp-fingerprint [lsp-fingerprint]**

**Command mode:** config

**Hierarchies**

- protocols isis

**Note**

- Configuration applies for all ISIS instances and for all levels ISIS is enabled on for a given instance.

- Fingerprint TLV is advertised under the LSP first fragment.

- Fingerprint TLV is advertised with S, A flags unset. Support of fingerprint TLV does not reflect system support for autoconfiguration.

- The system event will comply with DNOS syslog suppression, such as a single syslog notification that is sent every 30sec as long as duplication is recognized by repeatedly getting the conflicting LSP.

- The fingerprint will not be signaled in any other type of packet, but LSP.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter       | Description                                                                      | Range        | Default  |
+=================+==================================================================================+==============+==========+
| lsp-fingerprint | Enable advertisement of fingerprint tlv (Type 15) according to rfc8196.          | | enabled    | disabled |
|                 | Fingerprint tlv will hold system unique identifier. Fingerprint tlv is used to   | | disabled   |          |
|                 | detect duplicating nodes in the network                                          |              |          |
+-----------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# lsp-fingerprint enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-isis)# no lsp-fingerprint

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2.1  | Command introduced |
+---------+--------------------+

---

### maximum-adjacencies.rst

protocols isis maximum-adjacencies
----------------------------------

**Minimum user role:** operator

You can control the number of IS-IS adjacencies allowed. When a threshold is crossed, a system-event notification is generated allowing you to take action, if necessary. The thresholds are for generating system-events only. There is no strict limit on the number of IS-IS adjacencies that can be formed.

To limit the number of IS-IS adjacencies:

**Command syntax: maximum-adjacencies [max-adjacencies]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols isis

**Note**

- There is no strict limitation on the number of IS-IS adjacencies that can be formed.

- When a threshold is crossed (max-adjacencies or threshold), a single system-event notification is generated.

- When a threshold is cleared (max-adjacencies or threshold), a single system-event notification is generated.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter       | Description                                                                      | Range   | Default |
+=================+==================================================================================+=========+=========+
| max-adjacencies | The maximum number of IS-IS adjacencies allowed. When this threshold is crossed, | 1-65535 | 50      |
|                 | a system-event notification is generated every 30 seconds until the number of    |         |         |
|                 | adjacencies drops below the maximum.                                             |         |         |
+-----------------+----------------------------------------------------------------------------------+---------+---------+
| threshold       | A percentage (%) of max-adjacencies to give you advance notice that the number   | 1-100   | 75      |
|                 | of adjacencies is reaching the maximum level. When this threshold is crossed, a  |         |         |
|                 | single system-event notification is generated.                                   |         |         |
+-----------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# maximum-adjacencies 50 threshold 80

In the above example, the maximum number of IS-IS adjacencies is set to 50 and the threshold is set to 80%. This means that when the number of adjacencies reaches 40, a system-event notification will be generated that the 80% threshold has been crossed. If you do nothing, you will not receive another notification until the number of adjacencies reaches 50.


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-protocols-isis)# no maximum-adjacencies

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### maximum-routes.rst

protocols isis maximum-routes
-----------------------------

**Minimum user role:** operator

You can control the size of the RIB by setting thresholds to generate system event notifications. When a threshold is crossed, a system-event notification is generated allowing you to take action, if necessary. The scale is aggregated across all isis instances and address-families.

To set thresholds on IS-IS routes:

**Command syntax: maximum-routes [max-routes]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols isis

**Note**

- There is no strict limitation on the number of IS-IS adjacencies that can be formed.

- When a threshold is crossed (max-routes or threshold), a single system-event notification is generated.

- When a threshold is cleared (max-routes or threshold), a single system-event notification is generated.

**Parameter table**

+------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter  | Description                                                                      | Range        | Default |
+============+==================================================================================+==============+=========+
| max-routes | The maximum number of IS-IS routes you want in the RIB. When this threshold is   | 1-4294967295 | 32000   |
|            | crossed, a single system-event notification is generated. You will not be        |              |         |
|            | notified again.                                                                  |              |         |
|            | 0 means no limit; a system-event will not be generated.                          |              |         |
+------------+----------------------------------------------------------------------------------+--------------+---------+
| threshold  | A percentage (%) of max-routes to give you advance notice that the number of     | 1-100        | 75      |
|            | IS-IS routes in the RIB is reaching the maximum level. When this threshold is    |              |         |
|            | crossed, a system-event notification is generated. You will not be notified      |              |         |
|            | again.                                                                           |              |         |
+------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# isis
    dnRouter(cfg-protocols-isis)# maximum-routes 15000 threshold 80

In the above example, the maximum number of IS-IS routes in the RIB is set to 15,000 and the threshold is set to 80%. This means that when the number of IS-IS routes in the RIB reaches 12,000, a system-event notification will be generated that the 80% threshold has been crossed. If you do nothing, you will not receive another notification until the number of routes reaches 15,000.


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-protocols-isis)# no maximum-routes

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### nsr.rst

protocols isis nsr
------------------

**Minimum user role:** operator

IS-IS nonstop routing (NSR) enables an IS-IS speaker to maintain IS-IS adjacencies, state and database, while undergoing a switchover at the CPU level (e.g. NCC switchover).
Unlike IS-IS graceful-restart (GR), which requires support from an IS-IS neighbor as GR helper, NSR recovery is transparent to the network and connected neighbors.

IS-IS NSR is supported for cluster (external NCC) and stand-alone setups.

To enable/disable isis NSR:

**Command syntax: nsr [nsr]**

**Command mode:** config

**Hierarchies**

- protocols isis

**Note**

- NSR is mutually exclusive with GR support. IS-IS nsr and IS-IS graceful restart cannot be enabled at the same time.

**Parameter table**

+-----------+----------------------------+--------------+---------+
| Parameter | Description                | Range        | Default |
+===========+============================+==============+=========+
| nsr       | Set IS-IS Non Stop Routing | | enabled    | enabled |
|           |                            | | disabled   |         |
+-----------+----------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols isis
    dnRouter(cfg-protocols-isis)# nsr enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-isis)# no nsr

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---


## SECTION 2.F: LACP

Files in this section: 10

### interface/interface.rst

protocols lacp interface
------------------------

**Minimum user role:** operator

Configure the interface under the LACP protocol.

**Command syntax: interface [interface]**

**Command mode:** config

**Hierarchies**

- protocols lacp

**Parameter table**

+-----------+---------------------------+------------------+---------+
| Parameter | Description               | Range            | Default |
+===========+===========================+==================+=========+
| interface | Reference to the list key | | string         | \-      |
|           |                           | | length 1-255   |         |
+-----------+---------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp
    dnRouter(cfg-protocols-lacp)# interface bundle-2
    dnRouter(cfg-protocols-lacp-if)#


**Removing Configuration**

To remove the interface from the lacp:
::

    dnRouter(cfg-protocols-lacp)# no interface bundle-2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### interface/mode.rst

protocols lacp interface mode
-----------------------------

**Minimum user role:** operator

LACP packets are exchanged between interfaces in the following modes:

	Active: the interface initiates negotiation with another interface by sending LACP packets (LACPDUs).

	Passive: the interface responds to LACP packets it receives but does not initiate LACP negotiation.

**Command syntax: mode [lacp-mode]**

**Command mode:** config

**Hierarchies**

- protocols lacp interface

**Note**
-	For LACP to operate, you must not set the interfaces on both sides of the link to passive mode.

-	At least one side must be active for the LACP negotiations to be initiated.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------------+---------+
| Parameter | Description                                                                      | Range       | Default |
+===========+==================================================================================+=============+=========+
| lacp-mode | ACTIVE is to initiate the transmission of LACP packets. PASSIVE is to wait for   | | active    | active  |
|           | peer to initiate the transmission of LACP packets. ACTIVE mode by default        | | passive   |         |
+-----------+----------------------------------------------------------------------------------+-------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp
    dnRouter(cfg-protocols-lacp)# interface bundle-2
    dnRouter(cfg-protocols-lacp-if)# mode active

    dnRouter(cfg-protocols-lacp)# interface bundle-1
    dnRouter(cfg-protocols-lacp-if)# mode passive


**Removing Configuration**

To revert to the default mode:
::

    dnRouter(cfg-protocols-lacp-if)# no mode

**Command History**

+---------+-----------------------------------------------------+
| Release | Modification                                        |
+=========+=====================================================+
| 6.0     | Command introduced                                  |
+---------+-----------------------------------------------------+
| 10.0    | Static mode not supported, moved to a new hierarchy |
+---------+-----------------------------------------------------+

---

### interface/period.rst

protocols lacp interface period
-------------------------------

**Minimum user role:** operator

To configure the frequency with which PDUs are sent to the partner system:

**Command syntax: period [period]**

**Command mode:** config

**Hierarchies**

- protocols lacp interface

**Parameter table**

+-----------+--------------------------------------------------------------------------------+-----------+---------+
| Parameter | Description                                                                    | Range     | Default |
+===========+================================================================================+===========+=========+
| period    | Set the period between LACP messages -- uses the lacp-period-type enumeration. | | short   | long    |
|           |                                                                                | | long    |         |
+-----------+--------------------------------------------------------------------------------+-----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp

    dnRouter(cfg-protocols-lacp)# interface bundle-2
    dnRouter(cfg-protocols-lacp-if)# period short

    dnRouter(cfg-protocols-lacp)# interface bundle-1
    dnRouter(cfg-protocols-lacp-if)# period long


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-lacp-if)# no period

**Command History**

+---------+-----------------------+
| Release | Modification          |
+=========+=======================+
| 6.0     | Command introduced    |
+---------+-----------------------+
| 10.0    | Applied new hierarchy |
+---------+-----------------------+

---

### interface/port-key.rst

protocols lacp interface port-key
---------------------------------

**Minimum user role:** operator

The Port-key (2 bytes) of this bundle interface.

**Command syntax: port-key [port-key]**

**Command mode:** config

**Hierarchies**

- protocols lacp interface

**Parameter table**

+-----------+--------------------------------------------------+---------+---------+
| Parameter | Description                                      | Range   | Default |
+===========+==================================================+=========+=========+
| port-key  | Port-Key used by the node on this LAG interface. | 0-65535 | \-      |
+-----------+--------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp
    dnRouter(cfg-protocols-lacp)# interface bundle-2
    dnRouter(cfg-protocols-lacp-if)# port-key 10
    dnRouter(cfg-protocols-lacp-if)#


**Removing Configuration**

To revert the port-key to the global value.
::

    dnRouter(cfg-protocols-lacp-if)# no port-key

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### interface/priority.rst

protocols lacp interface priority
---------------------------------

**Minimum user role:** operator

The significant part of the per interface LACP system identifier (2 bytes) priority.
A lower value is a higher priority.

The actor with the higher priority is the master after negotiation with other systems.

**Command syntax: priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols lacp interface

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| priority  | Sytem priority used by the node on this LAG interface. Lower value is higher     | 0-65535 | \-      |
|           | priority for determining which node is the controlling system.                   |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp
    dnRouter(cfg-protocols-lacp)# interface bundle-2
    dnRouter(cfg-protocols-lacp-if)# priority 10
    dnRouter(cfg-protocols-lacp-if)#


**Removing Configuration**

To revert the priority to the global value:
::

    dnRouter(cfg-protocols-lacp-if)# no priority

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### interface/system-id.rst

protocols lacp interface system-id
----------------------------------

**Minimum user role:** operator

The interface's LACP system ID is formed by combining the interface priorityy with the interface system's ID. The system ID is the least significant part of the LACP system unique identifier, in the form of a MAC address. The system MAC address is randomly selected from a pool of addresses, whose first 3 bytes have a fixed value (84:40:76) and last 3 bytes are randomized on first start-up. The ID assignment is performed once after deployment and persists after reset. You can optionally change the system-ID.
To change the LACP system ID:

**Command syntax: system-id [system-id]**

**Command mode:** config

**Hierarchies**

- protocols lacp interface

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| system-id | The MAC address portion of the node's System ID. This is combined with the       | \-    | \-      |
|           | system priority to construct the 8-octet system-id                               |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp
    dnRouter(cfg-protocols-lacp)# interface bundle-2
    dnRouter(cfg-protocols-lacp-if)# system-id 11:22:33:44:55:66
    dnRouter(cfg-protocols-lacp-if)#


**Removing Configuration**

To revert to the global system-id:
::

    dnRouter(cfg-protocols-lacp-if)# no system-id

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### lacp overview.rst

Link Aggregation Control Protocol (LACP) Overview
-------------------------------------------------

The Link Aggregation Control Protocol (LACP) is used for dynamically exchanging information between two bundle partner systems to automatically maintain the links within the bundle. A partner actively sends out a LACP protocol data unit (PDU) to a remote partner containing information about its state, its ports and links, and any information it knows about the remote partner.

A partner can either be an active or passive participant in LACP. An active partner periodically initiates LACPDUs to its remote partner. A passive partner only responds to LACPDUs.

**Note**
-	The ports at both ends must be of the same speed and duplex.

The LACP feature provides a mechanism for automatic link failover within the bundle interface.

**LACP Configuration**

LACP exchanges are made between actors (the transmitting link) and partners (the receiving link). The LACP mode can be either active or passive.

To configure LACP on a predefined bundle interface with associated physical interfaces (ports):

 1. Enter LACP mode. See protocols lacp.

 2. Configure the LACP system identifier. The system identifier is the concatenation of the system priority value and the system ID value.
    a. Configure the system priority. See lacp system-priority.
    b. Configure the system ID. See lacp system-id.
 3. Configure the LACP parameters, using the following general command:

**Example**

::

    dnRouter(cfg-protocols)# lacp interface [interface-name] parameter [parameter-value]


**The parameters are:**

+----------------+----------------------------------------------------------------------------------------------------------+-----------------------+
| Parameter      | Description                                                                                              | Reference             |
+----------------+----------------------------------------------------------------------------------------------------------+-----------------------+
| Interface-name | The name of the interface on which to configure LACP.                                                    | -                     |
+----------------+----------------------------------------------------------------------------------------------------------+-----------------------+
| Mode           | The mode for exchanging LACP packets between interfaces.                                                 | lacp interface mode   |
+----------------+----------------------------------------------------------------------------------------------------------+-----------------------+
| Period         | The frequency of sending LACPDUs.                                                                        | lacp interface period |
+----------------+----------------------------------------------------------------------------------------------------------+-----------------------+
| Min-links      | The minimum number of interface members that must be active for the aggregate interface to be available. | interfaces min-links  |
+----------------+----------------------------------------------------------------------------------------------------------+-----------------------+

 4. Configure the bundle's members' port priority. See interfaces port-priority.

---

### lacp.rst

protocols lacp
--------------

**Minimum user role:** operator

To start the LACP process:

**Command syntax: lacp**

**Command mode:** config

**Hierarchies**

- protocols

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp
    dnRouter(cfg-protocols-lacp)#


**Removing Configuration**

To remove the lacp protocol:
::

    dnRouter(cfg-protocols)# no lacp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### system-id.rst

protocols lacp system-id
------------------------

**Minimum user role:** operator

The LACP system ID is formed by combining the LACP system-priority with the system's ID. The system ID is the least significant part of the LACP system unique identifier, in the form of a MAC address. The system MAC address is randomly selected from a pool of addresses, whose first 3 bytes have a fixed value (84:40:76) and last 3 bytes are randomized on first start-up. The ID assignment is performed once after deployment and persists after reset. You can optionally change the system-id.
To change the LACP system ID:

**Command syntax: system-id [system-id]**

**Command mode:** config

**Hierarchies**

- protocols lacp

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| system-id | The MAC address portion of the node's System ID. This is combined with the       | \-    | \-      |
|           | system priority to construct the 8-octet system-id                               |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp
    dnRouter(cfg-protocols-lacp)# system-id 11:22:33:44:55:66


**Removing Configuration**

To revert to the default system-id:
::

    dnRouter(cfg-protocols-lacp)# no system-id

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### system-priority.rst

protocols lacp system-priority
------------------------------

**Minimum user role:** operator

The significant Part of LACP system identifier (2 bytes), Priority for the system.
A lower value is higher priority.

The actor with the higher priority is the master after negotiation with other systems.

**Command syntax: system-priority [system-priority]**

**Command mode:** config

**Hierarchies**

- protocols lacp

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter       | Description                                                                      | Range   | Default |
+=================+==================================================================================+=========+=========+
| system-priority | Sytem priority used by the node on this LAG interface. Lower value is higher     | 0-65535 | 1       |
|                 | priority for determining which node is the controlling system.                   |         |         |
+-----------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lacp
    dnRouter(cfg-protocols-lacp)# system-priority 10


**Removing Configuration**

To revert the priority to the default value:
::

    dnRouter(cfg-protocols-lacp)# no system-priority

**Command History**

+---------+--------------------------+
| Release | Modification             |
+=========+==========================+
| 6.0     | Command introduced       |
+---------+--------------------------+
| 9.0     | Updated priority default |
+---------+--------------------------+

---


## SECTION 2.G: LDP

Files in this section: 42

### address-family/address-family.rst

protocols ldp address-family
----------------------------

**Minimum user role:** operator

Enter address-family configuration mode:

**Command syntax: address-family [address-family-type]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- Notice the change in the prompt from dnRouter(cfg-protocols-ldp)#  to dnRouter(cfg-protocols-ldp-afi)# . You have entered the address-family configuration mode. You can proceed to configure address-family LDP parameters.

**Parameter table**

+---------------------+---------------------+--------------+---------+
| Parameter           | Description         | Range        | Default |
+=====================+=====================+==============+=========+
| address-family-type | address family type | ipv4-unicast | \-      |
+---------------------+---------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)#


**Removing Configuration**

To remove the address-family configuration hierarchy:
::

    dnRouter(cfg-protocols-ldp)# no address-family ipv4-unicast

**Command History**

+---------+-------------------------------------+
| Release | Modification                        |
+=========+=====================================+
| 6.0     | Command introduced                  |
+---------+-------------------------------------+
| 13.0    | Updated range value to ipv4-unicast |
+---------+-------------------------------------+

---

### address-family/discovery_hello.rst

protocols ldp address-family discovery hello interval holdtime
--------------------------------------------------------------

**Minimum user role:** operator

This command sets how often hello messages are sent and the time (in seconds) in which a session is maintained in the absence of LDP messages from the neighbor (hello adjacency):

**Command syntax: discovery hello interval [hello interval] holdtime [hello holdtime]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family

**Note**

- The holdtime must be at least three times greater than interval, if the interval is 15, the holdtime must be at least 45 or greater.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter      | Description                                                                      | Range   | Default |
+================+==================================================================================+=========+=========+
| hello interval | The interval (in seconds) in which hello packets are sent.                       | 1-21845 | 5       |
+----------------+----------------------------------------------------------------------------------+---------+---------+
| hello holdtime | The period of time (in seconds) in which a session is maintained in the absence  | 3-65535 | 15      |
|                | of LDP messages from the neighbor.                                               |         |         |
+----------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# discovery hello interval 15 holdtime 45


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-ldp-afi)# no discovery hello

**Command History**

+---------+------------------------------------------------------------+
| Release | Modification                                               |
+=========+============================================================+
| 6.0     | Command introduced                                         |
+---------+------------------------------------------------------------+
| 13.0    | Updated range values for hello interval and hello holdtime |
+---------+------------------------------------------------------------+

---

### address-family/discovery_targeted/accept.rst

protocols ldp address-family discovery targeted accept
------------------------------------------------------

**Minimum user role:** operator

This command enables the router to accept targeted hello messages from a remote peer, to open an LDP session. 
In the event of bi-directional LDP tunneling between two LDP peers that send and receive hellos, an LDP session will be formed:

**Command syntax: accept [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family discovery targeted

**Note**

- In case of LDP tunneling headend, LDP speaker will send targeted hello regardless of this configuration. If both sides sends and receive hellos a LDP session will be form, e.g in case of bi-directional LDP tunneling between two LDP peers

- no command returns admin-state to default value

**Parameter table**

+-------------+---------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                               | Range        | Default  |
+=============+===========================================================================+==============+==========+
| admin-state | Defines whether to enable or disable the router to accept targeted hellos | | enabled    | disabled |
|             |                                                                           | | disabled   |          |
+-------------+---------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# discovery targeted
    dnRouter(cfg-ldp-afi-disc-tar)# accept enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-ldp-afi-disc-tar)# no accept

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### address-family/discovery_targeted/discovery_targeted.rst

protocols ldp address-family discovery targeted
-----------------------------------------------

**Minimum user role:** operator

To enter the LDP address-family discovery targeted configuration level:


**Command syntax: discovery targeted**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# discovery targeted
    dnRouter(cfg-ldp-afi-disc-tar)#


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-ldp-afi)# no discovery targeted

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### address-family/discovery_targeted/hello.rst

protocols ldp address-family discovery targeted hello interval holdtime
-----------------------------------------------------------------------

**Minimum user role:** operator

This command allows you to set the frequency that targeted hello messages will be sent and the duration of the hold time for LDP hello adjacency:

**Command syntax: hello interval [hello interval] holdtime [session-holdtime]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family discovery targeted

**Note**

- holdtime must be at least three times greater than interval

- The 'no hello' command returns interval and holdtime to default values

**Parameter table**

+------------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter        | Description                                                                      | Range   | Default |
+==================+==================================================================================+=========+=========+
| hello interval   | The interval (in seconds) that hello messages will be sent.                      | 1-21845 | 10      |
+------------------+----------------------------------------------------------------------------------+---------+---------+
| session-holdtime | The period of time (in seconds) in which a session will go down if no hellos     | 3-65535 | 90      |
|                  | have been received after the timer expires.                                      |         |         |
+------------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# discovery targeted
    dnRouter(cfg-ldp-afi-disc-tar)# hello interval 15 holdtime 45


**Removing Configuration**

To return the interval and holdtime to their default values:
::

    dnRouter(cfg-ldp-afi-disc-tar)# no hello

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### address-family/discovery_transport-address.rst

protocols ldp address-family discovery transport-address
--------------------------------------------------------

**Minimum user role:** operator

Sets the default LDP transport address for the address family.
The LSR advertises the transport address in the transport address TLV of the LDP hello messages:

**Command syntax: discovery transport-address [ipv4-address]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family

**Note**

- The ipv4 address must be configured to use LDP.

**Parameter table**

+--------------+------------------------------------------------------------+---------+---------+
| Parameter    | Description                                                | Range   | Default |
+==============+============================================================+=========+=========+
| ipv4-address | An arbitrary address advertised in LDP discovery messages. | A.B.C.D | \-      |
+--------------+------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# discovery transport-address 2.2.2.2


**Removing Configuration**

To revert to the default configuration (the LDP Router ID):
::

    dnRouter(cfg-protocols-ldp-afi)# no discovery transport-address

**Command History**

+---------+------------------------------+
| Release | Modification                 |
+=========+==============================+
| 6.0     | Command introduced           |
+---------+------------------------------+
| 13.0    | Added Removing Configuration |
+---------+------------------------------+

---

### address-family/interface/admin-state.rst

protocols ldp address-family interface admin-state
--------------------------------------------------

**Minimum user role:** operator

Setting the LDP interface to disable mode. The interface will not send or receive LDP packets.

To set the LDP interface to disable mode:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family interface

**Parameter table**

+-------------+------------------------------------+--------------+---------+
| Parameter   | Description                        | Range        | Default |
+=============+====================================+==============+=========+
| admin-state | Administratively set the LDP state | | enabled    | enabled |
|             |                                    | | disabled   |         |
+-------------+------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# interface ge100-0/0/0
    dnRouter(cfg-ldp-afi-if)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-ldp-afi-if)# no admin-state disabled

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### address-family/interface/discovery_hello.rst

protocols ldp address-family interface discovery hello interval holdtime
------------------------------------------------------------------------

**Minimum user role:** operator

You can set the LDP hello timers per interface.
This command overrides the default hello timers for a specified interface:

**Command syntax: discovery hello interval [interval] holdtime [holdtime]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family interface

**Note**

- The holdtime must be at least three times greater than interval, if the interval is 15, the holdtime must be at least 45 or greater.

- If you do not set discovery parameters, the default values will apply. The default values for this command are the current values of the LDP address-family discovery hello configuration.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| interval  | The period of time (in seconds) between the sending of consecutive Hello         | 1-21845 | \-      |
|           | messages.                                                                        |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+
| holdtime  | The period of time a discovered LDP neighbor is remembered without receipt of an | 3-65535 | \-      |
|           | LDP Hello message from the neighbor.                                             |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# interface bundle-2
    dnRouter(cfg-protocols-ldp-afi-if)# discovery hello interval 20 holdtime 60


**Removing Configuration**

To revert all discovery interval and holdtime values of the interface to their default value:
::

    dnRouter(cfg-protocols-ldp-afi-if)# no discovery hello

**Command History**

+---------+------------------------------------------------------------+
| Release | Modification                                               |
+=========+============================================================+
| 6.0     | Command introduced                                         |
+---------+------------------------------------------------------------+
| 13.0    | Updated range values for hello interval and hello holdtime |
+---------+------------------------------------------------------------+

---

### address-family/interface/interface.rst

protocols ldp address-family interface
--------------------------------------

**Minimum user role:** operator

To enable LDP on an interface for a specified address-family and entering LDP interface configuration mode:


**Command syntax: interface [interface-name]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family

**Note**

- Notice the change in prompt.

- This cannot be set on a Loopback interface.

**Parameter table**

+----------------+----------------------------------------------------------+--------------------------------------------------------+---------+
| Parameter      | Description                                              | Range                                                  | Default |
+================+==========================================================+========================================================+=========+
| interface-name | The name of the interface on which LDP is to be enabled. | | ge{/10/25/40/100}-X/Y/Z                              | \-      |
|                |                                                          | | ge<interface speed>-<A>/<B>/<C>.<sub-interface id>   |         |
|                |                                                          | | bundle-<bundle-id>                                   |         |
|                |                                                          | | bundle-<bundle-id.subinterface>                      |         |
+----------------+----------------------------------------------------------+--------------------------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# interface ge100-1/2/1
    dnRouter(cfg-protocols-ldp-afi-if)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# interface bundle-2
    dnRouter(cfg-protocols-ldp-if)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp)# interface bundle-2.1012
    dnRouter(cfg-protocols-ldp-if)#


**Removing Configuration**

To disable the LDP process for all interfaces:
::

    dnRouter(cfg-protocols-ldp)# no interface

To disable the LDP process for a specific interface:
::

    dnRouter(cfg-protocols-ldp)# no interface ge100-1/2/1

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 6.0     | Command introduced                      |
+---------+-----------------------------------------+
| 13.0    | Updated range values for interface-name |
+---------+-----------------------------------------+

---

### address-family/label_allocation-filter.rst

protocols ldp address-family label allocation-filter
----------------------------------------------------

**Minimum user role:** operator

To configure filtering policies (using an existing IP prefix-list) for selective local label binding:

**Command syntax: label allocation-filter [prefix-list-name]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family

**Parameter table**

+------------------+-------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                             | Range            | Default |
+==================+=========================================================================+==================+=========+
| prefix-list-name | The name of the configured prefix list. See routing-policy prefix-list. | | string         | \-      |
|                  |                                                                         | | length 1-255   |         |
+------------------+-------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# label allocation-filter PL4_LDP_FILTER


**Removing Configuration**

To remove all prefix list policies:
::

    dnRouter(cfg-protocols-ldp-afi)# no label allocation-filter

**Command History**

+---------+----------------------------------------------------------------+
| Release | Modification                                                   |
+=========+================================================================+
| 6.0     | Command introduced                                             |
+---------+----------------------------------------------------------------+
| 13.0    | Command syntax changed from allocated-for to allocation-filter |
+---------+----------------------------------------------------------------+

---

### address-family/label_explicit-null.rst

protocols ldp address-family label explicit-null
------------------------------------------------

**Minimum user role:** operator

Assign explicit-null (label 0) to local bindings. 
Label 0 indicates that the label stack must be 'popped' and the packet is then forwarded based on the IP header, by default it is implicit null (Label 3):

**Command syntax: label explicit-null [admin-state ]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family

**Parameter table**

+--------------+----------------------------------------------+--------------+----------+
| Parameter    | Description                                  | Range        | Default  |
+==============+==============================================+==============+==========+
| admin-state  | Administratively set the label explicit-null | | enabled    | disabled |
|              |                                              | | disabled   |          |
+--------------+----------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# label explicit-null enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# label explicit-null disabled


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-ldp-afi)# no label explicit-null

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 6.0     | Command introduced                           |
+---------+----------------------------------------------+
| 13.0    | Added admin-state setting to command syntax  |
+---------+----------------------------------------------+

---

### address-family/session_holdtime.rst

protocols ldp address-family session holdtime
---------------------------------------------

**Minimum user role:** operator

Set the default LDP TCP session holdtime (in seconds) per address-family:

**Command syntax: session holdtime [session-holdtime]**

**Command mode:** config

**Hierarchies**

- protocols ldp address-family

**Note**

- Default value for neighbor session holdtime is derived from the configured address-family session holdtime.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter        | Description                                                                      | Range    | Default |
+==================+==================================================================================+==========+=========+
| session-holdtime | The period of time (in seconds) in which a discovered LDP neighbor is remembered | 15-65535 | 180     |
|                  | without receiving an LDP Hello message from the neighbor.                        |          |         |
+------------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# address-family ipv4-unicast
    dnRouter(cfg-protocols-ldp-afi)# session holdtime 600


**Removing Configuration**

To revert to the default session holdtime:
::

    dnRouter(cfg-protocols-ldp-afi)# no session holdtime

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### admin-state.rst

protocols ldp admin-state
-------------------------

**Minimum user role:** operator

Setting the LDP protocol to disable mode. LDP will not send or receive LDP packets.

To set the LDP protocol to disable mode:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Parameter table**

+-------------+------------------------------------+--------------+---------+
| Parameter   | Description                        | Range        | Default |
+=============+====================================+==============+=========+
| admin-state | Administratively set the LDP state | | enabled    | enabled |
|             |                                    | | disabled   |         |
+-------------+------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ldp
    dnRouter(cfg-protocols-ldp)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-ldp)# no admin-state disabled

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### administrative-distance.rst

protocols ldp administrative-distance
-------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To configure the administrative-distance for LDP:

**Command syntax: administrative-distance [admin-distance]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- When reconfiguring the administrative-distance, run clear ldp neighbor.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                                      | Range | Default |
+================+==================================================================================+=======+=========+
| admin-distance | Sets the administrative distance for LDP. A value of 255 will cause the router   | 1-255 | 105     |
|                | to remove the route from the forwarding table.                                   |       |         |
+----------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ldp
    dnRouter(cfg-protocols-ldp)# administrative-distance 130


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ldp)# no administrative-distance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### authentication.rst

protocols ldp authentication password
-------------------------------------

**Minimum user role:** operator

To set the MD5 authentication password for all LDP neighbors.
Changing the authentication configuration will cause all LDP sessions to restart unless they have a per-neighbor authentication configuration, which will override this setting.

**Command syntax: authentication [type] password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- If a password is not provided with the command, you will be prompted to enter a clear-text password. The clear-text password is 1-80 charachters long.

- When authentication password is specified authentication is set on TCP sessions by default.

- When typing a clear text password, the password and retyping won't be displayed in the CLI terminal

- Clear text password length is 1-80 charachters

- enc-password must be a valid dnRouter encrypted password

- changing authentication configuration will cause all LDP sessions to restart unless they have an overriding per neighbor configuration for authentication

- password is saved encrypted, and always displayed as secret

- The 'no authentication' command disables authentication as default configuration. This results in restarting LDP neighbor sessions, for which there is no override authentication configuration.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter    | Description                                                                      | Range | Default |
+==============+==================================================================================+=======+=========+
| type         | authentication type                                                              | md5   | \-      |
+--------------+----------------------------------------------------------------------------------+-------+---------+
| enc-password | set a default password for authentication encrypted secret password string for   | \-    | \-      |
|              | the LDP neighbor. if the user enters a clear-text password, the password is then |       |         |
|              | encrypted by the system and saved in secret argument. if user specified 'secret' |       |         |
|              | save string in secret                                                            |       |         |
+--------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# authentication md5 password
    Enter password:
    Enter password for verification:

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# authentication md5 password enc-!344fGVkX1+


**Removing Configuration**

To disable the authentication:
::

    dnRouter(cfg-protocols-ldp)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### class-of-service.rst

protocols ldp class-of-service
------------------------------

**Minimum user role:** operator

To set the DSCP value for outgoing LDP packets:

**Command syntax: class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- IPP is set accordingly, i.e. a DSCP value of 48 is mapped to 6.

**Parameter table**

+------------------+------------------------------------------+-------+---------+
| Parameter        | Description                              | Range | Default |
+==================+==========================================+=======+=========+
| class-of-service | LDP UDP and TCP packets class of service | 0-56  | 48      |
+------------------+------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# class-of-service 50


**Removing Configuration**

To revert the dscp-value to the default value:
::

    dnRouter(cfg-protocols-ldp)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### graceful-restart/admin-state.rst

protocols ldp graceful-restart admin-state
------------------------------------------

**Minimum user role:** operator

To enable/disable LDP graceful restart:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ldp graceful-restart

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Sets the administrative state of the graceful restart feature. When enabled, LDP | | enabled    | disabled |
|             | will continue forwarding traffic for a grace period during a failure, in the     | | disabled   |          |
|             | case that both peers exchange Fault Tolerance TLV in the initialization message, |              |          |
|             | and both peers declare support in graceful restart informing the peer of the     |              |          |
|             | reconnect time they expect him to wait after losing neighborship.                |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# graceful-restart
    dnRouter(cfg-protocols-ldp-gr)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# graceful-restart
    dnRouter(cfg-protocols-ldp-gr)# admin-state disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ldp-gr)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### graceful-restart/graceful-restart.rst

protocols ldp graceful-restart
------------------------------

**Minimum user role:** operator

LDP graceful restart enables a router to continue forwarding traffic while its LDP control plane is restarting.
It also enables a helper router to assist a peer that is attempting to restart LDP.

To enter LDP graceful restart configuration level:

**Command syntax: graceful-restart**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- Notice the change in prompt.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# graceful-restart
    dnRouter(cfg-protocols-ldp-gr)#


**Removing Configuration**

To revert the graceful-restart parameters to their default values:
::

    dnRouter(cfg-protocols-ldp)# no graceful-restart

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 6.0     | Command introduced                           |
+---------+----------------------------------------------+
| 13.0    | Command split into three additional commands |
+---------+----------------------------------------------+

---

### graceful-restart/reconnect-time.rst

protocols ldp graceful-restart reconnect-time
---------------------------------------------

**Minimum user role:** operator

When the router gracefully restarts, its LDP peers wait a specific length of time before attempting to reestablish the LDP session.
The restarting router is expected to resume sending LDP messages within this time frame.
To configure the LDP graceful restart reconnect time:

**Command syntax: reconnect-time [reconnect-time]**

**Command mode:** config

**Hierarchies**

- protocols ldp graceful-restart

**Parameter table**

+----------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter      | Description                                                                      | Range  | Default |
+================+==================================================================================+========+=========+
| reconnect-time | Time (in seconds) the router expects the peer helper router to keep forwarding   | 30-300 | 60      |
|                | and for the connection reestablishment before it declares the neighborship lost. |        |         |
|                | When the LDP session is initialized, the peers exchange Fault Tolerance TLV      |        |         |
|                | where they inform each other of their reconnect time.                            |        |         |
+----------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# graceful-restart
    dnRouter(cfg-protocols-ldp-gr)# reconnect-time 70


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ldp-gr)# no reconnect-time

::

    dnRouter(cfg-protocols-ldp)# no graceful-restart reconnect-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### graceful-restart/recovery-time.rst

protocols ldp graceful-restart recovery-time
--------------------------------------------

**Minimum user role:** operator

When a router restarts, its peer helper will wait for no longer than the "reconnect time" for the connection to reestablish.
Once the connection has reestablished (which must occur before the reconnect-time expires), both peers inform each other of the duration the peer must maintain the LDP bindings in stale state before it is removed from the FIB - this is the Fault Tolerance TLV recovery time where both peers inform each other during the session reinitialization. Both LDP peers wait until the end of the recovery time during which the LDP peers exchange label mappings and restart gracefully before purging the LDP information from both helper and restarting router. During the recovery time, both LDP peers maintain the LDP forwarding information and keep forwarding while exchanging label mappings and clearing the stale marking from refreshed states. Only those LDP entries that remained stale after the recovery time are deleted and cleared from the FIB.
To configure the LDP graceful restart recovery time:

**Command syntax: recovery-time [recovery-time]**

**Command mode:** config

**Hierarchies**

- protocols ldp graceful-restart

**Parameter table**

+---------------+------------------------------------------------------------------+---------+---------+
| Parameter     | Description                                                      | Range   | Default |
+===============+==================================================================+=========+=========+
| recovery-time | Time (in seconds) to wait for recovery after a graceful-restart. | 30-1800 | 120     |
+---------------+------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# graceful-restart
    dnRouter(cfg-protocols-ldp-gr)# recovery-time 140


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ldp-gr)# no recovery-time

::

    dnRouter(cfg-protocols-ldp)# no graceful-restart recovery-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### ldp overview.rst

Label Distribution Protocol (LDP) Overview
------------------------------------------
Label Distribution Protocol (LDP) enables peer label switch routers (LSRs) to exchange label information for supporting hop-by-hop forwarding in a Multi-Protocol Label Switching (MPLS) network.

With IP forwarding, when a packet arrives at a router, the router looks at the destination address in the IP header, performs a route lookup, and forwards the packet to the next hop. With MPLS forwarding, when a packet arrives at a router, the router looks at the incoming label, looks up the label in a table, and forwards the packet to the next hop.

Each router has a unique LSR ID. When you enable LDP, LSRs send out discovery messages ("Hello" messages) to announce their presence in the network. The discovery messages are transmitted periodically as multicast UDP packets to all directly connected routers on the subnet. If a neighbor LSR responds to the message, the two routers can establish an LDP session. Within the "hello" packet, the router advertises its LSR ID and also a transport IP address, which is used to build the TCP connection with the neighbor LSR. The LSRs can then exchange label information.

DNOS supports downstream-unsolicited label distribution method with ordered label control and liberal label retention.

**Downstream-unsolicited** means that as soon as the LSR learns a route, it sends a FEC-to-label binding for that route to all peer LSRs, both upstream and downstream and does not wait for a request from an upstream device.

**Ordered** label control means that an LSR does not advertise a label for a FEC unless it is the egress LSR for the FEC (i.e. when the FEC is its directly attached interface or when MPLS is not configured on the next-hop interface) or until it has received a label for the FEC from its downstream peer. This prevents early data mapping from occurring on the first LSR in the path.

**Liberal** label retention means that any label mapping that may ever be used as a next hop is retained. Should a topology change occur, the labels to use in the new topology are already in place.

The mappings distributed by the LDP protocol are used to build a Label Information Base (LIB) - a data structure representing the mapping of each prefix to a label for each neighboring LDP peer. The LIBs are then used to construct the Label Forwarding Information Base (LFIB), which is the actual table used by the data path to take the forwarding decision.

The MPLS LDP-IGP synchronization feature provides a means to synchronize LDP and IGPs to minimize MPLS packet loss. When an IGP adjacency is established on a link but LDP IGP synchronization is not yet achieved or is lost, the IGP advertises the max-metric on that link. LDP-sync is always enabled in LDP. Also, all OSPF interfaces (except loopbacks) are enabled for LDP sync. See Configuring LDP Sync.
---

### ldp-sync_on-session-delay.rst

protocols ldp ldp-sync on-session-delay
---------------------------------------

**Minimum user role:** operator

The MPLS LDP-IGP synchronization feature provides a means to synchronize LDP and IGPs to minimize MPLS packet loss.
When an IGP adjacency is established on a link but LDP IGP synchronization is not yet achieved or is lost, the IGP advertises the max-metric on that link. 
LDP-sync is always enabled in LDP. Also, all OSPF interfaces (except loopbacks) are enabled for LDP sync.

To configure LDP-IGP synchronization:

**Command syntax: ldp-sync on-session-delay [on-session-delay]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- LDP sync is always enabled in LDP either with no delay or with configured delay.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter        | Description                                                                      | Range | Default |
+==================+==================================================================================+=======+=========+
| on-session-delay | The amount of time to wait (in seconds) before notifying if the LDP interface is | 5-300 | 15      |
|                  | synchronized                                                                     |       |         |
+------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ldp
    dnRouter(cfg-protocols-ldp)# ldp-sync on-session-delay 50


**Removing Configuration**

To revert the delay configuraiton to default:
::

    dnRouter(cfg-protocols-ldp)# no ldp-sync on-session-delay

**Command History**

+---------+---------------------------------------------------+
| Release | Modification                                      |
+=========+===================================================+
| 6.0     | Command introduced                                |
+---------+---------------------------------------------------+
| 13.0    | Command syntax changed from on-proc to on-session |
+---------+---------------------------------------------------+

---

### ldp.rst

protocols ldp
-------------

**Minimum user role:** operator

To start the process, enter LDP configuration hierarchy using the following command:

**Command syntax: ldp**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- You can only configure LDP for the default VRF.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)#


**Removing Configuration**

To remove the LDP protocol configuration:
::

    dnRouter(cfg-protocols)# no protocols ldp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### multipoint/load-split/downstream-rebalancing-timer.rst

protocols ldp multipoint load-split downstream-rebalancing-timer
----------------------------------------------------------------

**Minimum user role:** operator

To configure the mLDP load split downstream rebalancing timer:


**Command syntax: downstream-rebalancing-timer [downstream-rebalancing-timer]**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint load-split

**Parameter table**

+------------------------------+-------------------------------------------------------------------------+--------+---------+
| Parameter                    | Description                                                             | Range  | Default |
+==============================+=========================================================================+========+=========+
| downstream-rebalancing-timer | The timer for global mLDP LSPs rebalancing across downstream interfaces | 1-3600 | 60      |
+------------------------------+-------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# load-split
    dnRouter(cfg-ldp-mldp-ls)# downstream-rebalancing-timer 600


**Removing Configuration**

To revert the mLDP load split downstream rebalancing timer to its default value: 
::

    dnRouter(cfg-ldp-mldp-ls)# no downstream-rebalancing-timer

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/load-split/load-split.rst

protocols ldp multipoint load-split
-----------------------------------

**Minimum user role:** operator

To configure multipoint LDP load split, enter the mLDP load split configuration mode:

**Command syntax: load-split**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# load-split
    dnRouter(cfg-ldp-mldp-ls)#


**Removing Configuration**

To revert all mLDP load split parameters to their default values: 
::

    dnRouter(cfg-protocols-ldp-mldp)# no load-split

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/load-split/upstream-rebalancing-timer.rst

protocols ldp multipoint load-split upstream-rebalancing-timer
--------------------------------------------------------------

**Minimum user role:** operator

To configure the mLDP load split upstream rebalancing timer:


**Command syntax: upstream-rebalancing-timer [upstream-rebalancing-timer]**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint load-split

**Parameter table**

+----------------------------+------------------------------------------------------------------+--------+---------+
| Parameter                  | Description                                                      | Range  | Default |
+============================+==================================================================+========+=========+
| upstream-rebalancing-timer | The timer for global mLDP LSPs rebalancing across upstream nodes | 1-3600 | 60      |
+----------------------------+------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# load-split
    dnRouter(cfg-ldp-mldp-ls)# upstream-rebalancing-timer 600


**Removing Configuration**

To revert the mLDP load split upstream rebalancing timer to its default value: 
::

    dnRouter(cfg-ldp-mldp-ls)# no upstream-rebalancing-timer

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/make-before-break/admin-state.rst

protocols ldp multipoint make-before-break admin-state
------------------------------------------------------

**Minimum user role:** operator

To enable or disable the multipoint LDP make-before-break capability:


**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint make-before-break

**Parameter table**

+-------------+-----------------------------------------------+--------------+----------+
| Parameter   | Description                                   | Range        | Default  |
+=============+===============================================+==============+==========+
| admin-state | Administratively sets the mLDP MBB capability | | enabled    | disabled |
|             |                                               | | disabled   |          |
+-------------+-----------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# mbb
    dnRouter(cfg-ldp-mldp-mbb)# admin-state enabled


**Removing Configuration**

To revert the mLDP MBB administrative state to its default value: 
::

    dnRouter(cfg-ldp-mldp-mbb)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/make-before-break/make-before-break.rst

protocols ldp multipoint make-before-break
------------------------------------------

**Minimum user role:** operator

To configure the multipoint LDP make-before-break capability, enter the mLDP MBB configuration mode:

**Command syntax: make-before-break**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# make-before-break
    dnRouter(cfg-ldp-mldp-mbb)#


**Removing Configuration**

To revert all mLDP MBB parameters to their default values: 
::

    dnRouter(cfg-protocols-ldp-mldp)# no make-before-break

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/make-before-break/switchover-delay.rst

protocols ldp multipoint make-before-break switchover-delay
-----------------------------------------------------------

**Minimum user role:** operator

To configure the switchover delay in seconds for a point-to-multipoint LSP from the old LSR to the new upstream LSR:


**Command syntax: switchover-delay [switchover-delay]**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint make-before-break

**Parameter table**

+------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter        | Description                                                                      | Range | Default |
+==================+==================================================================================+=======+=========+
| switchover-delay | Switchover delay in seconds for a point-to-multipoint LSP from the old LSR to    | 1-600 | 30      |
|                  | the new upstream LSR. If an MBB acknowledgment is received on a point of local   |       |         |
|                  | repair (PLR) router, the PLR waits for the specified seconds to switch its       |       |         |
|                  | upstream LSR from the old LSR to the new LSR.                                    |       |         |
+------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# mbb
    dnRouter(cfg-ldp-mldp-mbb)# switchover-delay 10


**Removing Configuration**

To revert the mLDP MBB switchover delay to its default value: 
::

    dnRouter(cfg-ldp-mldp-mbb)# no switchover-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/make-before-break/timeout.rst

protocols ldp multipoint make-before-break timeout
--------------------------------------------------

**Minimum user role:** operator

To configure the timeout (in seconds) for a downstream node to await acknowledgement of MBB notifications from upstream nodes:


**Command syntax: timeout [mbb-timeout]**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint make-before-break

**Parameter table**

+-------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter   | Description                                                                      | Range | Default |
+=============+==================================================================================+=======+=========+
| mbb-timeout | The timeout (in seconds) for a downstream node to await acknowledgement of MBB   | 1-600 | 30      |
|             | notifications from upstream nodes. Even if an MBB acknowledgment is not received |       |         |
|             | for a point-to-multipoint LSP before the specified timeout period expires, the   |       |         |
|             | label-switching router (LSR) performs an MBB switchover from the old LSR to the  |       |         |
|             | new upstream LSR.                                                                |       |         |
+-------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# mbb
    dnRouter(cfg-ldp-mldp-mbb)# timeout 60


**Removing Configuration**

To revert the mLDP MBB timeout to its default value: 
::

    dnRouter(cfg-ldp-mldp-mbb)# no timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/multipoint.rst

protocols ldp multipoint
------------------------

**Minimum user role:** operator

To configure multipoint LDP, enter the mLDP configuration mode:

**Command syntax: multipoint**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)#


**Removing Configuration**

To revert all mLDP parameters to their default values: 
::

    dnRouter(cfg-protocols-ldp)# no multipoint

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/p2mp/admin-state.rst

protocols ldp multipoint p2mp admin-state
-----------------------------------------

**Minimum user role:** operator

To enable or disable the multipoint LDP point-to-multipoint capability:


**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint p2mp

**Parameter table**

+-------------+------------------------------------------------+--------------+----------+
| Parameter   | Description                                    | Range        | Default  |
+=============+================================================+==============+==========+
| admin-state | Administratively sets the mLDP P2MP capability | | enabled    | disabled |
|             |                                                | | disabled   |          |
+-------------+------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# p2mp
    dnRouter(cfg-ldp-mldp-p2mp)# admin-state enabled


**Removing Configuration**

To revert the mLDP P2MP administrative state to its default value: 
::

    dnRouter(cfg-ldp-mldp-p2mp)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### multipoint/p2mp/p2mp.rst

protocols ldp multipoint p2mp
-----------------------------

**Minimum user role:** operator

To configure the multipoint LDP point-to-multipoint capability, enter the mLDP P2MP configuration mode:

**Command syntax: p2mp**

**Command mode:** config

**Hierarchies**

- protocols ldp multipoint

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# multipoint
    dnRouter(cfg-protocols-ldp-mldp)# p2mp
    dnRouter(cfg-ldp-mldp-p2mp)#


**Removing Configuration**

To revert all mLDP P2MP parameters to their default values: 
::

    dnRouter(cfg-protocols-ldp-mldp)# no p2mp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### neighbor/authentication_none.rst

protocols ldp neighbor authentication none
------------------------------------------

**Minimum user role:** operator

Sets the LDP neighbor authentication mode (None). 
This per-neighbor configuration overrides the global LDP authentication configuration. 
When set to "none", the LDP neighbor will not be authenticated.

**Command syntax: authentication none**

**Command mode:** config

**Hierarchies**

- protocols ldp neighbor

**Note**

- LDP neighbor TCP session is set using the global default LDP authentication configuration. Alternatively the user may override the authentication configuration per neighbor.

- Configuration applies also for targeted LDP session

- Command 'authentication none' disables authentication for the specified LDP neighbor.

- Changing authentication configuration restarts the relevant LDP neighbor TCP session.

- Command 'no authentication' reverts the authentication settings to the global default LDP authentication settings.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# neighbor 21.1.34.1
    dnRouter(cfg-protocols-ldp-neighbor)# authentication none


**Removing Configuration**

To revert the authentication settings to the global default LDP authentication settings:
::

    dnRouter(cfg-protocols-ldp-neighbor)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### neighbor/authentication.rst

protocols ldp neighbor authentication password
----------------------------------------------

**Minimum user role:** operator

Sets the LDP neighbor authentication mode (MD5). 
When MD5 mode is set, the authentication password must be set. 
This per-neighbor configuration overrides the global LDP authentication configuration.

**Command syntax: authentication [type] password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols ldp neighbor

**Note**

- LDP neighbor TCP session is set using the global default LDP authentication configuration. Alternatively the user may override the authentication configuration per neighbor.

- Configuration applies also for targeted LDP session

- Command'authentication md5 password' enables MD5 authentication and sets the password.

- When typing a clear text password, the password and retyping won't be displayed in the CLI terminal

- Clear text password length is 1-80 characters

- Enc-password must be a valid dnRouter encrypted password

- Changing authentication configuration restarts the relevant LDP neighbor TCP session.

- Password is saved encrypted and always displayed as secret

- Command 'no authentication' reverts the authentication settings to the global default LDP authentication settings.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                      | Range    | Default |
+==============+==================================================================================+==========+=========+
| type         | authentication type                                                              | | md5    | \-      |
|              |                                                                                  | | none   |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| enc-password | set the authentication encrypted secret password string for the LDP neighbor. if | \-       | \-      |
|              | the user enters a clear-text password, the password is then encrypted by the     |          |         |
|              | system and saved in secret argument. if user specified 'secret' save string in   |          |         |
|              | secret                                                                           |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# neighbor 21.1.34.1
    dnRouter(cfg-protocols-ldp-neighbor)# authentication md5 password
    Enter password:
    Enter password for verification:

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# neighbor 21.1.34.1
    dnRouter(cfg-protocols-ldp-neighbor)# authentication md5 password enc-!344fGVkX1+


**Removing Configuration**

To revert the authentication settings to the global default LDP authentication settings:
::

    dnRouter(cfg-protocols-ldp-neighbor)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### neighbor/neighbor.rst

protocols ldp neighbor
----------------------

**Minimum user role:** operator

Set an LDP neighbor IP address to enter LDP neighbor configuration hierarchy:

**Command syntax: neighbor [ipv4-address]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Parameter table**

+--------------+----------------------------------+---------+---------+
| Parameter    | Description                      | Range   | Default |
+==============+==================================+=========+=========+
| ipv4-address | The IPv4 address of the neighbor | A.B.C.D | \-      |
+--------------+----------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# neighbor 21.1.34.1
    dnRouter(cfg-protocols-ldp-neighbor)#


**Removing Configuration**

To delete the configuration for the specified neighbor:
::

    dnRouter(cfg-protocols-ldp)# no neighbor 21.1.34.1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### neighbor/session_holdtime.rst

protocols ldp neighbor session holdtime
---------------------------------------

**Minimum user role:** operator

To change the session holdtime for the neighbor:

**Command syntax: session holdtime [session-holdtime]**

**Command mode:** config

**Hierarchies**

- protocols ldp neighbor

**Note**

- Default value for neighbor session holdtime is derived from the configured address-family session holdtime.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter        | Description                                                                      | Range    | Default |
+==================+==================================================================================+==========+=========+
| session-holdtime | The period of time (in seconds) in which a session is maintained in the absence  | 15-65535 | \-      |
|                  | of LDP messages from the neighbor.                                               |          |         |
+------------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# neighbor 21.1.34.1
    dnRouter(cfg-protocols-ldp-neighbor)# session holdtime 1000


**Removing Configuration**

To revert to the default session holdtime:
::

    dnRouter(cfg-protocols-ldp-neighbor)# no session holdtime

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.0    | Command introduced |
+---------+--------------------+

---

### nsr.rst

protocols ldp nsr
-----------------

**Minimum user role:** operator

LDP nonstop routing (NSR) enables an LDP speaker to maintain the LDP session's state while undergoing switchover at the CPU level (e.g. NCC switchover).
Unlike LDP graceful-restart (GR), which requires both LDP ends to support the GR capability and logic, NSR is transparent, and the other end of the LDP session is unaware of the NSR process.

While LDP works with NSR, LDP continue to support as a helper for neighbor GR.

The LDP process (ldpd) running on the active NCC, saves (in the NSR DB) all the information required for recovering from an LDP failure and for providing nonstop routing (including LDP TCP session information and any advertised and received prefix<->label).
The NSR DBs, located on both active and standby NCCs, are regularly synchronized. In the event of a switchover/failover, ldpd starts on the standby NCC and recovers the TCP and LDP session parameters from the NSR-DB in the standby NCC.

To enable/disable the LDP NSR feature:

**Command syntax: nsr [nsr]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- LDP NSR cannot be enabled together with LDP Graceful-Restart.

**Parameter table**

+-----------+-----------------------------------------+--------------+---------+
| Parameter | Description                             | Range        | Default |
+===========+=========================================+==============+=========+
| nsr       | The admin-state of LDP non-stop-routing | | enabled    | enabled |
|           |                                         | | disabled   |         |
+-----------+-----------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# nsr enabled

    dnRouter(cfg-protocols-ldp)# nsr disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ldp)# no nsr

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### rcv-addr-withdraw-delay.rst

protocols ldp rcv-addr-withdraw-delay
-------------------------------------

**Minimum user role:** operator

Use this command to delay the LDP reaction for an address-withdraw message received from a neighbor. 
Multiple address-withdraw messages, that are received during the delay period, will be treated together as soon as the delay timer expires.

**Command syntax: rcv-addr-withdraw-delay [delay]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- A value of 0 means there is no delay and LDP will react immediately to any received address-withdraw.

**Parameter table**

+-----------+-------------------------------+-------+---------+
| Parameter | Description                   | Range | Default |
+===========+===============================+=======+=========+
| delay     | The delay period (in seconds) | 0-120 | 0       |
+-----------+-------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ldp
    dnRouter(cfg-protocols-ldp)# rcv-addr-withdraw-delay 10


**Removing Configuration**

To return the delay timer to the default value:
::

    dnRouter(cfg-protocols-ldp)# no rcv-addr-withdraw-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### router-id.rst

protocols ldp router-id
-----------------------

**Minimum user role:** operator

To configure the LDP router ID:

**Command syntax: router-id [ipv4-address]**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Note**

- To configure LDP a router-id must be configured. If one is not configured, the default router-id is the router-options router-id. If the router-options router-id is not configured, the highest IPv4 address of any loopback interface will be used.

**Parameter table**

+--------------+--------------------------------------------+---------+---------+
| Parameter    | Description                                | Range   | Default |
+==============+============================================+=========+=========+
| ipv4-address | The network ipv4 address of the LDP router | A.B.C.D | \-      |
+--------------+--------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ldp
    dnRouter(cfg-protocols-ldp)# router-id 100.70.1.45


**Removing Configuration**

To remove configuration:
::

    dnRouter(cfg-protocols-ldp)# no router-id

**Command History**

+---------+-------------------------------------------------------+
| Release | Modification                                          |
+=========+=======================================================+
| 6.0     | Command introduced                                    |
+---------+-------------------------------------------------------+
| 13.0    | Command syntax changed from router-id to ipv4-address |
+---------+-------------------------------------------------------+

---

### session_protection/session_protection.rst

protocols ldp session protection
--------------------------------

**Minimum user role:** operator

Enables the LDP session protection, and enters its configuration hierarchy.
Once enabled, LDP will initiate targeted hellos to any discovered neighbor to protect LDP sessions even if a direct link goes down.
By default the feature is disabled.
To enable LDP session protection:

**Command syntax: session protection**

**Command mode:** config

**Hierarchies**

- protocols ldp

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# session protection
    dnRouter(cfg-protocols-ldp-session-prot)#


**Removing Configuration**

To remove session protection:
::

    dnRouter(cfg-protocols-ldp)# no session protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### session_protection/timeout.rst

protocols ldp session protection timeout
----------------------------------------

**Minimum user role:** operator

Defines the amount of time (in seconds) that the session protection Targeted-Hello should be retained once Link-Hello timed out.
To configure session protection timeout:

**Command syntax: timeout [timeout]**

**Command mode:** config

**Hierarchies**

- protocols ldp session protection

**Note**

- Setting the timer value to 0, results in an infinite timeout. T-Hello will remain as long as the LDP TCP session is active.

**Parameter table**

+-----------+---------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                         | Range   | Default |
+===========+=====================================================================+=========+=========+
| timeout   | Time duration to retain targeted-hello after link-hello had stopped | 0-65535 | 0       |
+-----------+---------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ldp
    dnRouter(cfg-protocols-ldp)# session protection
    dnRouter(cfg-protocols-ldp-session-prot)# timeout 360


**Removing Configuration**

To revert to default value:
::

    dnRouter(cfg-protocols-ldp-session-prot)# no timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---


## SECTION 2.H: LLDP

Files in this section: 12

### admin-state.rst

protocols lldp admin-state
--------------------------

**Minimum user role:** operator

To enable LLDP admin-state (LLDP admin-state is disabled by default):

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols lldp

**Parameter table**

+-------------+-----------------------------------------+--------------+---------+
| Parameter   | Description                             | Range        | Default |
+=============+=========================================+==============+=========+
| admin-state | System level state of the LLDP protocol | | enabled    | enabled |
|             |                                         | | disabled   |         |
+-------------+-----------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# admin-state enabled


**Removing Configuration**

To return LLDP admin-state to its default value:
::

    dnRouter(cfg-protocols-lldp)# no admin-state

**Command History**

+---------+------------------------------------------------------------+
| Release | Modification                                               |
+=========+============================================================+
| 7.0     | Command introduced                                         |
+---------+------------------------------------------------------------+
| 9.0     | Not supported in this version                              |
+---------+------------------------------------------------------------+
| 10.0    | Command reintroduced with admin-state "enabled" by default |
+---------+------------------------------------------------------------+
| 16.1    | Updated command with admin-state "disabled" by default     |
+---------+------------------------------------------------------------+

---

### chassis-id-mac-address.rst

protocols lldp chassis-id-mac-address
-------------------------------------

**Minimum user role:** operator

Configure lldp mandatory Chassis ID tlv information. 
When advertising Chassis ID with type mac-address (default system behavior), this configuration defines which system mac address is to be advertised
* system-id - (default behavior) Signal the system-id mac address. A locally randomized mac address from DRIVENETS MAC pool, unique per router deployment
* chassis-mac - Advertise the router platform base mac address as chassis-id. Option is valid for Stand-Alone systems only.

**Command syntax: chassis-id-mac-address [chassis-id-mac-address]**

**Command mode:** config

**Hierarchies**

- protocols lldp

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+-----------------+-----------+
| Parameter              | Description                                                                      | Range           | Default   |
+========================+==================================================================================+=================+===========+
| chassis-id-mac-address | The Chassis ID is a mandatory TLV which identifies the chassis component of the  | | system-id     | system-id |
|                        | endpoint identifier associated with the transmitting LLDP agent.                 | | chassis-mac   |           |
|                        | chassis-id-mac-address defines which system mac is to be advertised when chassis |                 |           |
|                        | id type is mac-address                                                           |                 |           |
+------------------------+----------------------------------------------------------------------------------+-----------------+-----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# chassis-id-mac-address chassis-mac

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# chassis-id-mac-address system-d


**Removing Configuration**

To return chassis-id-mac-address to default value:
::

    dnRouter(cfg-protocols-lldp)# no chassis-id-mac-address

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### interface/interface.rst

protocols lldp interface
------------------------

**Minimum user role:** operator

Use this command to configure LLDP on an interface. To enter LLDP interface configuration mode:

**Command syntax: interface [interface-name]**

**Command mode:** config

**Hierarchies**

- protocols lldp

**Note**

- Notice the change in prompt from dnRouter(cfg-protocols-lldp)# to dnRouter(cfg-protocols-lldp-if)# (LLDP interface configuration mode).

- Once LLDP is enabled on the interface, transmission and reception of LLDP messages are both available. To change this behavior, see "lldp interface receive" and "lldp interface transmit" commands.

**Parameter table**

+----------------+----------------------------------------------------------------+--------------------------+---------+
| Parameter      | Description                                                    | Range                    | Default |
+================+================================================================+==========================+=========+
| interface-name | The physical interface on which to configure the LLDP protocol | Physical interfaces only | \-      |
+----------------+----------------------------------------------------------------+--------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# interface ge100-2/4/1
    dnRouter(cfg-protocols-lldp-if)#


**Removing Configuration**

To remove lldp configuration from the interface:
::

    dnRouter(cfg-protocols-lldp)# no interface ge100-2/4/1

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 7.0     | Command introduced            |
+---------+-------------------------------+
| 9.0     | Not supported in this version |
+---------+-------------------------------+
| 10.0    | Command reintroduced          |
+---------+-------------------------------+

---

### interface/receive.rst

protocols lldp interface receive
--------------------------------

**Minimum user role:** operator

To configure lldp interface receive capability.

By default, reception of LLDP messages is available.

**Command syntax: receive [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols lldp interface

**Parameter table**

+-------------+----------------------------------------------+--------------+---------+
| Parameter   | Description                                  | Range        | Default |
+=============+==============================================+==============+=========+
| admin-state | Configures ability to receive LLDP messages. | | enabled    | enabled |
|             |                                              | | disabled   |         |
+-------------+----------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# interface ge100-2/4/1
    dnRouter(cfg-protocols-lldp-if)# receive enabled

    dnRouter(cfg-protocols-lldp)# interface ge100-4/2/1
    dnRouter(cfg-protocols-lldp-if)# receive disabled


**Removing Configuration**

To revert the receive capability to the default value:
::

    dnRouter(cfg-protocols-lldp-if)# no receive

**Command History**

+---------+------------------------------------------------------------+
| Release | Modification                                               |
+=========+============================================================+
| 7.0     | Command introduced                                         |
+---------+------------------------------------------------------------+
| 9.0     | Not supported in this version                              |
+---------+------------------------------------------------------------+
| 10.0    | Command reintroduced with admin-state "enabled" by default |
+---------+------------------------------------------------------------+

---

### interface/transmit.rst

protocols lldp interface transmit
---------------------------------

**Minimum user role:** operator

To configure lldp interface transmit capability.

By default, transmission of LLDP messages is available.

**Command syntax: transmit [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols lldp interface

**Parameter table**

+-------------+-----------------------------------------------+--------------+---------+
| Parameter   | Description                                   | Range        | Default |
+=============+===============================================+==============+=========+
| admin-state | Configures ability to transmit LLDP messages. | | enabled    | enabled |
|             |                                               | | disabled   |         |
+-------------+-----------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# interface ge100-2/4/1
    dnRouter(cfg-protocols-lldp-if)# transmit enabled

    dnRouter(cfg-protocols-lldp)# interface ge100-4/2/1
    dnRouter(cfg-protocols-lldp-if)# transmit disabled


**Removing Configuration**

To revert the transmit capability to the default value:
::

    dnRouter(cfg-protocols-lldp-if)# no transmit

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 7.0     | Command introduced            |
+---------+-------------------------------+
| 9.0     | Not supported in this version |
+---------+-------------------------------+
| 10.0    | Command reintroduced          |
+---------+-------------------------------+

---

### lldp overview.rst

Link Layer Discovery Protocol (LLDP) Overview
---------------------------------------------

LLDP is a neighbor discovery protocol that is used for network devices to advertise information about themselves to other devices on the network and learn about each other. The information gathered with LLDP is stored in the device and can be queried. The topology of an LLDP-enabled network can be discovered by crawling the hosts and querying this database.

The information that can be retrieved include:

- System name and description
- Port name and description
- IP management address
- System capabilities (switching, routing, etc.)

LLDP information is sent by the devices from each of their interfaces at fixed interval in the form of an Ethernet frame. Each frame contains one LLDP data unit (LLDPDU), which is a sequence of type, length, and value (TLV) attributes carrying configuration information, device capabilities, and device identity.

For transmitted LLDPDU, the interfaces from which LLDP information is collected are:

- Physical interfaces with admin-state "enabled"
- Interfaces with LLDP admin-state "enabled"
- LLDP Tx per interface is "enabled"

For received LLDPDU, the interfaces from which LLDP information is collected are:

- Physical interfaces with admin-state "enabled"
- Interfaces with LLDP admin-state "enabled"
- LLDP Rx per interface is "enabled"

Tx and Rx states per interface are independent. Each interface can send without receiving or receive without sending LLDPDUs.

The Ethernet frame used in LLDP includes:

- The destination MAC address - typically set to a special multicast address that 802.1D -compliant bridges do not forward
- The EtherType field set to 0x88cc
- Mandatory TLV attributes:

   - Chassis ID
   - Port ID
   - Time to Live

- Optional TLV attributes
- End of LLDPDU TLV - with type and length fields set to 0

+-------------------------------------------------+-------------------+-----------+----------------+-------------+------------------+---------------+----------------------+
| Destination MAC                                 | Source MAC        | EtherType | Chassis ID TLV | Port ID TLV | Time to live TLV | Optional TLVs | End of LLDPDU TLV    |
+-------------------------------------------------+-------------------+-----------+----------------+-------------+------------------+---------------+----------------------+
| 01:80:c2:00:00:0e (we send) or (can receive)    | Station's address | 0x88cc    | Type = 1       | Type = 2    | Type = 3         | Zero or more  | Type = 0. Length = 0 |
| 01:80:c2:00:00:03 or 01:80:c2:00:00:00          |                   |           |                |             |                  | complete TLVs |                      |
+-------------------------------------------------+-------------------+-----------+----------------+-------------+------------------+---------------+----------------------+

Each TLV component has the following basic structure:

+--------+--------+--------------+
| Type   | Length | Value        |
+--------+--------+--------------+
| 7 bits | 9 bits | 0-511 octets |
+--------+--------+--------------+

DNOS supports the following TLVs:

+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| TLV Type | TLV Name            | Values and Origin                                                                                   | YANG Path                                                                        |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 1        | Chassis ID          | Chassis ID Subtype: MAC address (val = 4)                                                           | Chassis_id: dn-top:drivenets-top/dn-proto:protocols/                             |
|          |                     | Chassis ID: Station's_MAC_address (MAC Address pattern)                                             | dn-lacp:lacp/dn-lacp:config-items/dn-lacp-private:actual-system-id               |
|          |                     | This value is identical for all interfaces in the cluster and is                                    |                                                                                  |
|          |                     | taken from the system-id defined in LAG control - LACP (in the private yang)                        |                                                                                  |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 2        | Port ID             | Port ID Subtype: Interface name (val = 5)                                                           | Interface_name: dn-if:interfaces/dn-if:interface*/dn-if:oper-items/dn-if:name    |
|          |                     | Port ID: Interface_name (string)                                                                    |                                                                                  |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 3        | Time To Live        | Seconds: hold_time (uint_16)                                                                        | Hold_time: dn-top:drivenets-top/dn-proto:protocols/dn-lldp:lldp/dn-lldp:         |
|          |                     |                                                                                                     | oper-items/dn-lldp:timers/dn-lldp:hold-time                                      |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 4        | Port description    | Port Description: Interface_description (string) If value not configured,                           | Interface_description: dn-top:drivenets-top/dn-if:interfaces/dn-if:              |
|          |                     | this TLV type not sent                                                                              | interface*/dn-if:oper-items/dn-if:description                                    |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 5        | System name         | System Name: System_name (string)                                                                   | System_name: dn-top: drivenets-top/dn-sys:system/dn-sys:oper-items/dn-sys:name   |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 6        | System description  | System Description: DRIVENETS                                                                       | System_description: dn-top:drivenets-top/dn-sys:system/dn-sys:oper-items/dn-sys: |
|          |                     | LTD. System_description, DNOS_version (string) Concatenated string of fixed                         | system-info/dn-sys:description                                                   |
|          |                     | and configurable values                                                                             |                                                                                  |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 7        | System capabilities | Capabilities:                                                                                       | dn-top:drivenets-top/dn-proto:protocols/dn-lldp:lldp/dn-lldp:oper-items/dn-      |
|          |                     |                                                                                                     |                                                                                  |
|          |                     |     - Other: Not capable (0)                                                                        | lldp:capabilities/dn-lldp:capability*                                            |
|          |                     |     - Repeater: Not capable (0)                                                                     |                                                                                  |
|          |                     |     - Bridge: Capable (1)                                                                           |                                                                                  |
|          |                     |     - WLAN access point: Not capable (0)                                                            |                                                                                  |
|          |                     |     - Router: Capable (1)                                                                           |                                                                                  |
|          |                     |     - Telephone: Not capable (0)                                                                    |                                                                                  |
|          |                     |     - DOCSIS cable device: Not capable (0)                                                          |                                                                                  |
|          |                     |     - Station only: Not capable (0)                                                                 |                                                                                  |
|          |                     |                                                                                                     |                                                                                  |
|          |                     |  Enabled Capabilities:                                                                              |                                                                                  |
|          |                     |     - Other: Not capable (0)                                                                        |                                                                                  |
|          |                     |     - Repeater: Not capable (0)                                                                     |                                                                                  |
|          |                     |     - Bridge: Capable (1)                                                                           |                                                                                  |
|          |                     |     - WLAN access point: Not capable (0)                                                            |                                                                                  |
|          |                     |     - Router: Capable (1)                                                                           |                                                                                  |
|          |                     |     - Telephone: Not capable (0)                                                                    |                                                                                  |
|          |                     |     - DOCSIS cable device: Not capable (0)                                                          |                                                                                  |
|          |                     |     - Station only: Not capable (0)                                                                 |                                                                                  |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 8        | Management address  |     - Address String Length: len(Address Subtype) + len(Management Address)                         | Inband-management source-interface: dn-top:drivenets-top/dn-sys:system/dn-sys:   |
|          |                     |     - Address Subtype: IPv4 (1) / IPv6 (2)                                                          | oper-items/dn-sys:inband-management/dn-sys:source-interface                      |
|          |                     |     - Management Address: ipv4_address / ipv6_address                                               |                                                                                  |
|          |                     |     - Interface Subtype: ifIndex (2)                                                                | IPv4 Management Address: dn-top:drivenets-top/dn-if:interfaces/dn-if:            |
|          |                     |     - Interface Number: ifindex                                                                     | interface*/dn-ip:ipv4/dn-ip:addresses/dn-ip:address*/dn-ip:oper-items/dn-ip:ip   |
|          |                     |     - OID String Length: 0                                                                          |                                                                                  |
|          |                     |                                                                                                     |                                                                                  |   
|          |                     |      By default for DP interfaces, the management address will be taken                             | IPv6 Management Address: dn-top:drivenets-top/dn-if:interfaces/dn-if:            |
|          |                     |      from the in-band-management source-interface configuration to be advertised.                   | interface*/dn-ip:ipv6/dn-ip:addresses/dn-ip:address*/dn-ip:oper-items/dn-ip:ip   |
|          |                     |      By default for mgmt interfaces, the management address will be taken from the                  |                                                                                  |
|          |                     |      configured interface address.                                                                  | Interface_ifindex: dn-top:drivenets-top/dn-if:interfaces/dn-if:interface*/dn-    |
|          |                     |      If there is no any address configuration, this TLV type will be sent with                      | if:oper-items/dn-if:if-index                                                     |
|          |                     |      the following values:                                                                          |                                                                                  |
|          |                     |      - Address String Length: len(Address Subtype) + len(Management Address)                        | Station's_MAC_address: dn-top:drivenets-top/dn-if:interfaces/dn-if:interface*/dn-|
|          |                     |      - Address Subtype: 802 (includes all 802 media plus Ethernet "canonical format") (value - 6)   | eth:ethernet/dn-eth:oper-items/dn-eth:mac-address                                |
|          |                     |      - Management Address: Station's_MAC_address (MAC Address pattern)                              |                                                                                  |
|          |                     |      - Interface Subtype: ifIndex (2)                                                               |                                                                                  |
|          |                     |      - Interface Number: ifindex                                                                    |                                                                                  |
|          |                     |      - OID String Length: 0                                                                         |                                                                                  |
|          |                     |                                                                                                     |                                                                                  |   
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+
| 0        | End of LLDPDU       | 0x0000                                                                                              | N/A                                                                              |
+----------+---------------------+-----------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------+




The parsing of the TLV is handled separately for each received LLDP packet.

- TLV types that are not supported, are discarded. They are counted as unrecognized TLVs.
- Supported TLV types that are malformed are discarded. They are counted as discarded TLVs.
- When duplicate TLV types are received in the same packet, the last received TLV overrides any previous TLV.

Each Network Cloud node (NCP, NCF, NCC) includes a container with the node_manager process running the LLDP protocol on that node. This process is responsible for sending and receiving LLDP TLVs per node interface:

**NCP:**

- Data Path interfaces (UNI/NNI) - geX-Y.Z.W
- Management interfaces for OOB - mgmt-ncc/0/0 mgmt-ncp/x/y
- Control interfaces for cluster connectivity- ctrl-ncp/x/y

**NCF:**

- Management interfaces for OOB - mgmt-ncf/x/y
- Control interfaces for cluster connectivity- ctrl-ncf/x/y

**NCC:**

- Management interfaces for OOB - mgmt-ncc/x/y
- Control interfaces for cluster connectivity- ctrl-ncc/x/y

All gathered LLDP information is sent to the NCC (Centralized functionality). All LLDP configuration is maintained in the NCC, which distributes it to all cluster nodes.

To manage the internal cluster link detection before container deployment, the host OS contains an LLDP process (lldpd-os) only for the internal management interfaces:

**NCP:**

- Management interfaces for OOB - mgmt-ncp/x/y
- Control interfaces for cluster connectivity- ctrl-ncp/x/y

**NCF:**

- Management interfaces for OOB - mgmt-ncf/x/y
- Control interfaces for cluster connectivity- ctrl-ncf/x/y

**NCC:**

- Management interfaces for OOB - mgmt-ncc/x/y
- Control interfaces for cluster connectivity- ctrl-ncc/x/y

The lldpd-os process performs "hand-out" to the custom node_manager process when deployed.

The collected LLDP information is stored in the database in case of NCC switchover or reset. Due to performance considerations, up to 10 simultaneous active neighbors are supported per LLDP interface.

**LLDP Configuration**


To configure LLDP follow these general steps:

1. Enter LLDP configuration mode. See protocols lldp.
2. Enable/Disable LLDP globally. See lldp admin-state.
3. Enable/Disable LLDP on an interface. See lldp interface.
4. Configure LLDP timers. See lldp timers.

---

### lldp.rst

protocols lldp
--------------

**Minimum user role:** operator

To enter LLDP configuration mode:"

**Command syntax: lldp**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- The lldp protocol is applicable for default vrf only.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)#


**Removing Configuration**

To remove the LLDP protocol
::

    dnRouter(cfg-protocols)# no lldp

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 7.0     | Command introduced            |
+---------+-------------------------------+
| 9.0     | Not supported in this version |
+---------+-------------------------------+
| 10.0    | Command reintroduced          |
+---------+-------------------------------+

---

### management_source-interface.rst

protocols lldp management source-interface
------------------------------------------

**Minimum user role:** operator


To configure the source interface from which the management address will be taken for lldp management tlv advertisements:

**Command syntax: management source-interface [management source-address]**

**Command mode:** config

**Hierarchies**

- protocols lldp

**Note**

- The source-interface can belong to any vrf in the system

- In case source-interface has no ip address, or in state down, lldp will fallback to advertise mac address of the provided interface.'

**Parameter table**

+---------------------------+--------------------------------------------------------------------------------+------------------+---------+
| Parameter                 | Description                                                                    | Range            | Default |
+===========================+================================================================================+==================+=========+
| management source-address | source interface for management address to be advertised under management tlv. | | string         | \-      |
|                           |                                                                                | | length 1-255   |         |
+---------------------------+--------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# management-source-interface bundle-1.127

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# management-source-interface irb5


**Removing Configuration**

To revert to default management address behavior:
::

    dnRouter(cfg-protocols-lldp-if)# no management-source-interface

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### timers/hold-time.rst

protocols lldp timers hold-time
-------------------------------

**Minimum user role:** operator

To adjust the LLDP hold-time timer:

**Command syntax: hold-time [hold-time]**

**Command mode:** config

**Hierarchies**

- protocols lldp timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+----------+---------+
| Parameter | Description                                                                      | Range    | Default |
+===========+==================================================================================+==========+=========+
| hold-time | Sets the amount of time (in seconds) that LLDP information is held before it is  | 30-65535 | 120     |
|           | discarded.                                                                       |          |         |
+-----------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# timers
    dnRouter(cfg-protocols-lldp-timers)# hold-time 90


**Removing Configuration**

To return the hold-time to its default value:
::

    dnRouter(cfg-protocols-lldp-timers)# no hold-time

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 7.0     | Command introduced            |
+---------+-------------------------------+
| 9.0     | Not supported in this version |
+---------+-------------------------------+
| 10.0    | Command reintroduced          |
+---------+-------------------------------+

---

### timers/keep-alive.rst

protocols lldp timers keep-alive
--------------------------------

**Minimum user role:** operator

To adjust the LLDP keep-alive timer:

**Command syntax: keep-alive [keep-alive]**

**Command mode:** config

**Hierarchies**

- protocols lldp timers

**Parameter table**

+------------+---------------------------------------------------+----------+---------+
| Parameter  | Description                                       | Range    | Default |
+============+===================================================+==========+=========+
| keep-alive | frequency at which LLDP advertisements are sent . | 30-65535 | 30      |
+------------+---------------------------------------------------+----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# timers
    dnRouter(cfg-protocols-lldp-timers)# keep-alive 30


**Removing Configuration**

To return the keep-alive to its default value:
::

    dnRouter(cfg-protocols-lldp-timers)# no keep-alive

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 7.0     | Command introduced            |
+---------+-------------------------------+
| 9.0     | Not supported in this version |
+---------+-------------------------------+
| 10.0    | Command reintroduced          |
+---------+-------------------------------+

---

### timers/timers.rst

protocols lldp timers
---------------------

**Minimum user role:** operator

To adjust the intervals at which LLDP messages are sent:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols lldp

**Example**
::

    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# timers


**Removing Configuration**

To return the timers to their default value:
::

    dnRouter(cfg-protocols-lldp)# no timers

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 7.0     | Command introduced            |
+---------+-------------------------------+
| 9.0     | Not supported in this version |
+---------+-------------------------------+
| 10.0    | Command reintroduced          |
+---------+-------------------------------+

---

### tlv-filter.rst

protocols lldp tlv-filter
-------------------------

**Minimum user role:** operator

This command allows LLDP to disable non-mandatory TLV messages so that sensitive information about a network is not disclosed. To filter optional LLDP TLVs to be sent to peers:

**Command syntax: tlv-filter [optional-TLV-name]** [, optional-TLV-name, optional-TLV-name]

**Command mode:** config

**Hierarchies**

- protocols lldp

**Note**

- Multiple TLVs can be specified at once (separated by commas).

**Parameter table**

+-------------------+------------------------------------------------+-------------------------+---------+
| Parameter         | Description                                    | Range                   | Default |
+===================+================================================+=========================+=========+
| optional-TLV-name | Filter optional LLDP TLVs to be sent to peers. | | management-address    | \-      |
|                   |                                                | | port-description      |         |
|                   |                                                | | system-capabilities   |         |
|                   |                                                | | system-description    |         |
|                   |                                                | | system-name           |         |
+-------------------+------------------------------------------------+-------------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# tlv-filter management-address

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# lldp
    dnRouter(cfg-protocols-lldp)# tlv-filter management-address, system-capabilities


**Removing Configuration**

To remove specific optional TLVs from the LLDP TLV filter:
::

    dnRouter(cfg-protocols-lldp)# no tlv-filter management-address

::

    dnRouter(cfg-protocols-lldp)# no tlv-filter management-address, system-description

To remove the entire LLDP TLV filter:
::

    dnRouter(cfg-protocols-lldp)# no tlv-filter

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---


## SECTION 2.I: MPLS

Files in this section: 83

### mpls overview.rst

Multiprotocol Label Switching (MPLS) Overview
---------------------------------------------
MPLS is a packet-forwarding technology that uses labels in order to make data forwarding decisions. With MPLS, the Layer 3 header analysis is done just once, when the packet enters the MPLS domain. Subsequent packet forwarding is done by inspecting the label, without examining the packet.

These labels describe how to forward an incoming packet on an MPLS-enabled router. MPLS-labeled packets are switched to a destination via a specific path rather than being routed to a destination based on the routing table.

---

### mpls.rst

protocols mpls
--------------

**Minimum user role:** operator

To configure MPLS, enter MPLS configuration mode:

**Command syntax: mpls**

**Command mode:** config

**Hierarchies**

- protocols

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)#


**Removing Configuration**

To remove the MPLS protocol configuration:
::

    dnRouter(cfg-protocols)# no mpls

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### policy/pcep_delegation.rst

protocols segment-routing mpls policy pcep delegation
-----------------------------------------------------

**Minimum user role:** operator

Enable SR-TE delegation to a remote PCE.
For a delegated policy, the local router (acting as PCC) will comply with policy updates provided by the PCE.
A policy path provided by PCE will be considered as the most preferred path

Policy information is passed to PCE even if not delegated to it

**Command syntax: pcep delegation [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+-------------+------------------------------------------------+------------+---------+
| Parameter   | Description                                    | Range      | Default |
+=============+================================================+============+=========+
| admin-state | Enable SR-TE policy delegation to a remote PCE | enabled    | \-      |
|             |                                                | disabled   |         |
+-------------+------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# pcep delegation enabeld


**Removing Configuration**

To revert the pcep delegation to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no pcep delegation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/admin-group-map/admin-group-map.rst

protocols mpls traffic-engineering admin-group-map
--------------------------------------------------

**Minimum user role:** operator

RSVP allows you to configure administrative groups for CSPF path selection. Administrative groups allow you to group links with similar characteristics.
An administrative group is typically:
-	Named with a color (see "mpls traffic-engineering admin-group-map bit-position")
-	Assigned a numeric value (see "mpls traffic-engineering admin-group-map bit-position"). Lower numbers indicate higher priority.
-	Applied to an RSVP interface for the appropriate link (see "mpls traffic-engineering interface admin-group")
Once admin-groups are created, you can use them to include or exclude links in RSVP tunnels. See how in "rsvp tunnel primary admin-group include" and "rsvp tunnel primary admin-group exclude".
To create an admin-group, enter the admin-group-map configuration mode:

**Command syntax: admin-group-map**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# admin-group-map
    dnRouter(cfg-mpls-te-admin-group-map)#


**Removing Configuration**

To remove all admin-group configuration:
::

    dnRouter(cfg-protocols-mpls-te)# no admin-group-map

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### traffic-engineering/admin-group-map/bit-position.rst

protocols mpls traffic-engineering admin-group-map bit-position name
--------------------------------------------------------------------

**Minimum user role:** operator

An admin-group-map is a bit field where each bit represents a specific admin-group (set by bit-position). You can set a traffic-engineering enabled interface with different admin-groups. RSVP uses the admin-group values to decide where tunnels are permitted to flow.
Bits 0-31 used to represent legacy Administrative group mapping per RFC5305 . Bits 32-255 used to represent Extended Administrative group mapping per RFC7308
The bit-position and admin-group name pairing is unique. You cannot set the same admin-group name with a different bit-position and you cannot pair the same bit-position with different admin-group names.
To create an admin-group-map:

**Command syntax: bit-position [bit-position] name [admin-group-name]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering admin-group-map

**Note**

- Changing the admin-group will trigger MPLS TE tunnel calculation (make before brake).

**Parameter table**

+------------------+---------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                               | Range            | Default |
+==================+===========================================================================+==================+=========+
| bit-position     | The position of the bit representing a specific admin-group               | 0-255            | \-      |
+------------------+---------------------------------------------------------------------------+------------------+---------+
| admin-group-name | Provide a name for the admin-group. The name represents the bit-position. | | string         | \-      |
|                  |                                                                           | | length 1-255   |         |
+------------------+---------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# admin-group-map
    dnRouter(cfg-mpls-te-admin-group-map)# bit-position 1 name GOLD
    dnRouter(cfg-mpls-te-admin-group-map)# bit-position 2 name SILVER

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# admin-group-map
    dnRouter(cfg-mpls-te-admin-group-map)# bit-position 140 name PLATINUM


**Removing Configuration**

To remove an existing admin-group:
::

    dnRouter(cfg-mpls-te-admin-group-map)# no bit-position 1

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 9.0     | Command introduced                 |
+---------+------------------------------------+
| 18.0    | Added Extended admin-group support |
+---------+------------------------------------+

---

### traffic-engineering/bandwidth_percent_class-type_0.rst

protocols mpls traffic-engineering bandwidth percent class-type 0
-----------------------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity.
You can change the maximum limit for bandwidth reservation for TE on an interface per type-class.This limit may exceed the physical limit of the interface.
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value.
Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces.
Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces.
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle.
When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth percent [bw-percent] class-type 0**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- For n =< m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.

- Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.

- If class-type is used, the bandwidth value must be set for each class-type.

**Parameter table**

+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+
| Parameter  | Description                                                                      | Range    | Default                                  |
+============+==================================================================================+==========+==========================================+
| bw-percent | The TE available bandwidth on the interface relative to the physical interface   | 0..10000 | As traffic-engineering bandwidth setting |
|            | bandwidth (in %). When used on a bundle interface, if one of the links drops,    |          |                                          |
|            | the TE reserved bandwidth will change accordingly.                               |          |                                          |
+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-mpls-te)# bandwidth percent 95 class-type 0


**Removing Configuration**

To revert bandwidth restrictions to the default values for class type 0:
::

    dnRouter(cfg-mpls-te)# no bandwidth percent 95 class-type 0

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/bandwidth_percent_class-type_1.rst

protocols mpls traffic-engineering bandwidth percent class-type 1
-----------------------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity.
You can change the maximum limit for bandwidth reservation for TE on an interface per type-class.This limit may exceed the physical limit of the interface.
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value.
Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces.
Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces.
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle.
When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth percent [bw-percent] class-type 1**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- For n =< m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.

- Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.

- If class-type is used, the bandwidth value must be set for each class-type.

**Parameter table**

+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+
| Parameter  | Description                                                                      | Range    | Default                                  |
+============+==================================================================================+==========+==========================================+
| bw-percent | The TE available bandwidth on the interface relative to the physical interface   | 0..10000 | As traffic-engineering bandwidth setting |
|            | bandwidth (in %). When used on a bundle interface, if one of the links drops,    |          |                                          |
|            | the TE reserved bandwidth will change accordingly.                               |          |                                          |
+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-mpls-te)# bandwidth percent 90 class-type 1


**Removing Configuration**

To revert bandwidth restrictions to the default values for class type 1:
::

    dnRouter(cfg-mpls-te)# no bandwidth percent 90 class-type 1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/bandwidth_percent.rst

protocols mpls traffic-engineering bandwidth percent
----------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity.
You can change the maximum limit for bandwidth reservation for TE on an interface per type-class.This limit may exceed the physical limit of the interface.
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value.
Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces.
Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces.
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle.
When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth percent [bw-percent]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- For n =< m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.

- Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.

- If class-type is used, the bandwidth value must be set for each class-type.

**Parameter table**

+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+
| Parameter  | Description                                                                      | Range    | Default                                  |
+============+==================================================================================+==========+==========================================+
| bw-percent | The TE available bandwidth on the interface relative to the physical interface   | 0..10000 | As traffic-engineering bandwidth setting |
|            | bandwidth (in %). When used on a bundle interface, if one of the links drops,    |          |                                          |
|            | the TE reserved bandwidth will change accordingly.                               |          |                                          |
+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-mpls-te)# bandwidth percent 95


**Removing Configuration**

To revert bandwidth restrictions to the default values for all classes:
::

    dnRouter(cfg-mpls-te)# no bandwidth percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/bandwidth_units_class-type_0.rst

protocols mpls traffic-engineering bandwidth
--------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity.
You can change the maximum limit for bandwidth reservation for TE on an interface per type-class.This limit may exceed the physical limit of the interface.
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value.
Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces.
Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces.
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle.
When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth [bandwidth-value] [bandwidth-units] class-type 0**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- For n =< m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.

- Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.

- If class-type is used, the bandwidth value must be set for each class-type.

**Parameter table**

+-----------------+--------------------+--------------+---------+
| Parameter       | Description        | Range        | Default |
+=================+====================+==============+=========+
| bandwidth-value | bandwidth in units | 0-4294967295 | 75      |
+-----------------+--------------------+--------------+---------+
| bandwidth-units | bandwidth units    | | kbps       | percent |
|                 |                    | | mbps       |         |
|                 |                    | | gbps       |         |
|                 |                    | | percent    |         |
+-----------------+--------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-mpls-te)# bandwidth 900 mbps class-type 0


**Removing Configuration**

To revert to the default bandwidth value for class-type 0:
::

    dnRouter(cfg-mpls-te)# no bandwidth 900 mbps class-type 0

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/bandwidth_units_class-type_1.rst

protocols mpls traffic-engineering bandwidth
--------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity.
You can change the maximum limit for bandwidth reservation for TE on an interface per type-class.This limit may exceed the physical limit of the interface.
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value.
Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces.
Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces.
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle.
When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth [bandwidth-value] [bandwidth-units] class-type 1**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- For n =< m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.

- Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.

- If class-type is used, the bandwidth value must be set for each class-type.

**Parameter table**

+-----------------+--------------------+--------------+---------+
| Parameter       | Description        | Range        | Default |
+=================+====================+==============+=========+
| bandwidth-value | bandwidth in units | 0-4294967295 | 0       |
+-----------------+--------------------+--------------+---------+
| bandwidth-units | bandwidth units    | | kbps       | percent |
|                 |                    | | mbps       |         |
|                 |                    | | gbps       |         |
|                 |                    | | percent    |         |
+-----------------+--------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-mpls-te)# bandwidth 1000 mbps class-type 1


**Removing Configuration**

To revert to the default bandwidth value for class-type 1:
::

    dnRouter(cfg-mpls-te)# no bandwidth 1000 mbps class-type 1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/bandwidth_units.rst

protocols mpls traffic-engineering bandwidth
--------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity.
You can change the maximum limit for bandwidth reservation for TE on an interface per type-class.This limit may exceed the physical limit of the interface.
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value.
Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces.
Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces.
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle.
When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth [bandwidth] [unit]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- For n =< m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.

- Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.

- If class-type is used, the bandwidth value must be set for each class-type.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+----------------------------+------------------------------------------+
| Parameter | Description                                                                      | Range                      | Default                                  |
+===========+==================================================================================+============================+==========================================+
| bandwidth | The TE available bandwidth on the interface. The allocated bandwidth is not      | | 0..4294967295 for kbps   | As traffic-engineering bandwidth setting |
|           | limited by the physical capacity of the physical interface. You may allocate     | | 0..41943030 for mbps     |                                          |
|           | more bandwidth than the physical interface allows (over-subscription).           | | 0..41960 for gbps        |                                          |
+-----------+----------------------------------------------------------------------------------+----------------------------+------------------------------------------+
| unit      | The unit of measurement for the bandwidth.                                       | | kbps                     | As traffic-engineering bandwidth setting |
|           |                                                                                  | | mbps                     |                                          |
|           |                                                                                  | | gbps                     |                                          |
+-----------+----------------------------------------------------------------------------------+----------------------------+------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-mpls-te)# bandwidth 1000 mbps


**Removing Configuration**

To revert bandwidth restrictions to the default values for all classes:
::

    dnRouter(cfg-mpls-te)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/admin-state.rst

protocols mpls traffic-engineering diffserv-te admin-state
----------------------------------------------------------

**Minimum user role:** operator

You can enable or disable DiffServ-te on the system. When disabled, any DiffServ-te configuration will not apply and no DiffServ-te tunnel (whether head, tail, or transit) will be established. When enabled, you can set different levels of service and bandwidth to different class types. Non DiffServ-te path requests will be regarded as class 0.

To enable/disable diffserve-te:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te

**Note**

- Changing the admin-state will reset all tunnels (head, tail, and transit) in a break before make fashion.

**Parameter table**

+-------------+--------------------------------------------------------+--------------+----------+
| Parameter   | Description                                            | Range        | Default  |
+=============+========================================================+==============+==========+
| admin-state | The administrative state of diffserv-te in the system. | | enabled    | disabled |
|             |                                                        | | disabled   |          |
+-------------+--------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-mpls-te-diffserv)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/bandwidth-model.rst

protocols mpls traffic-engineering diffserv-te bandwidth-model
--------------------------------------------------------------

**Minimum user role:** operator

The bandwidth model determines the values of the available bandwidth advertised by the interior gateway protocols (IGPs).

To configure the bandwidth model:

**Command syntax: bandwidth-model [bandwidth-model]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te

**Note**

- The Russian doll model (RDM) is defined in RFC 4127.

**Parameter table**

+-----------------+-----------------------------------------------------------------+-------+---------+
| Parameter       | Description                                                     | Range | Default |
+=================+=================================================================+=======+=========+
| bandwidth-model | The bandwidth model to be used by DiffServ bandwidth allocation | rdm   | rdm     |
+-----------------+-----------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# bandwidth-model rdm


**Removing Configuration**

To revert to the default model:
::

    dnRouter(cfg-mpls-te-diffserv)# no bandwidth-model

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/admin-state.rst

protocols mpls traffic-engineering diffserv-te cbts admin-state
---------------------------------------------------------------

**Minimum user role:** operator

When enabled with diffserv-te enabled, traffic is forwarded to tunnels according to class of service-to-tunnel mapping. See "mpls traffic-engineering diffserv-te cbts".

To enable CBTS forwarding:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts

**Parameter table**

+-------------+-----------------------------------------------+--------------+----------+
| Parameter   | Description                                   | Range        | Default  |
+=============+===============================================+==============+==========+
| admin-state | The administrative state of the CBTS feature. | | enabled    | disabled |
|             |                                               | | disabled   |          |
+-------------+-----------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-te-diffserv-cbts)# no admin-state 

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cbts.rst

protocols mpls traffic-engineering diffserv-te cbts
---------------------------------------------------

**Minimum user role:** operator

Class-based tunnel selection (CBTS) dynamically routes different class-of-service (CoS) traffic on different TE tunnels. Tunnel selection is based on the packet's CoS: for MPLS packets the EXP value of the topmost label is used; for IP packets the IPP value is used.
When CBTS is enabled, packets will be forwarded to a tunnel only if:
-	The packet destination is resolved by the specific RSVP tunnel (either directly or by an IGP-shortcut)
-	The packet CoS field value matches the tunnel's te-class according to the configured te-class-map te-class (see "mpls traffic-engineering diffserv-te te-class-map te-class" (including fallback selection algorithm).
If multiple tunnels are active for the same te-class selected by CBTS, the traffic is load-balanced across them.
If no active TE tunnel matches the traffic CoS, the traffic will be forwarded according to the following fallback selection algorithm:
#.	Forward traffic over the TE-class X that forwards the lowest CoS value.
#.	If no tunnel is available for TE-class X, use the TE-class of the following CoS value.
#.	If no TE-class matching any of the CoS values is available, don't apply the CBTS constraint and forward the traffic over all available tunnels (ECMP).

To enter the CBTS configuration hierarchy:

**Command syntax: cbts**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)#


**Removing Configuration**

To revert all CBTS configuration to default values:
::

    dnRouter(cfg-mpls-te-diffserv)# no cbts

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos_0_te-class.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map cos 0 te-class
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can configure the CoS to TE tunnel mapping. If there is no active TE tunnel matching the traffic CoS, traffic will be forwarded as follows:
-	Over the TE-class that forwards the lowest CoS value
-	If there is no available tunnels for this TE class, the TE-class with the next higher CoS value will be used
-	If there is no available TE-class that matches any of the CoS values, the CBTS constraint will not be applied and the traffic will be forwarded over all available tunnels equally (ECMP).

The default mapping:

+-----+----------+
| CoS | TE-class |
+=====+==========+
| 0   | 0        |
+-----+----------+
| 1   | 0        |
+-----+----------+
| 2   | 0        |
+-----+----------+
| 3   | 0        |
+-----+----------+
| 4   | 0        |
+-----+----------+
| 5   | 0        |
+-----+----------+
| 6   | 0        |
+-----+----------+
| 7   | 0        |
+-----+----------+

You can map multiple CoS values can to the same te-class, but different te-classes may not carry the same CoS value.

Fallback example:
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1

  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1**

  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2**

  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 0 priority 3**

  dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4

  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5**

  dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6

  dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 5

  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 3

  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 3

  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 3

  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 3

  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 3

  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 3

  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 2

tunnels of te-class 1, 2, 3, 5 exist at first

if there are no available tunnel of TE-class 3, forward cos 1-6 to te-class 5

if also there are no available tunnel of TE-class 5, forward cos 0 & 1-6 to te-class 2

if also there are no available tunnel of TE-class 2, forward cos 0 & 1-6 & 7 to te-class 1


To configure the CoS to TE tunnel mapping:

**Command syntax: cos 0 te-class [cos-0]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts cos-te-map

**Parameter table**

+-----------+-----------------------------+-------+---------+
| Parameter | Description                 | Range | Default |
+===========+=============================+=======+=========+
| cos-0     | te-class that carries CoS 0 | 0-7   | 0       |
+-----------+-----------------------------+-------+---------+

**Example**

In this example, if there is no available TE-class 3 tunnel, CoS 1-6 traffic will be directed to TE-class 5.
If there is no available TE-class 5 tunnel, CoS 0 and CoS 1-6 traffic will be directed to TE-class 2.
If TE-class 2 tunnels are also unavailable, all CoS traffic (0, 1-6, and 7) will be directed to TE-class 1.
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 0
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 6
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 7


**Removing Configuration**

To revert to the default mapping for a specific CoS ID:
::

    dnRouter(cfg-diffserv-cbts-cos-te-map)# no cos 0

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos_1_te-class.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map cos 1 te-class
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can configure the CoS to TE tunnel mapping. If there is no active TE tunnel matching the traffic CoS, traffic will be forwarded as follows:
-	Over the TE-class that forwards the lowest CoS value
-	If there is no available tunnels for this TE class, the TE-class with the next higher CoS value will be used
-	If there is no available TE-class that matches any of the CoS values, the CBTS constraint will not be applied and the traffic will be forwarded over all available tunnels equally (ECMP).

The default mapping:

+-----+----------+
| CoS | TE-class |
+=====+==========+
| 0   | 0        |
+-----+----------+
| 1   | 0        |
+-----+----------+
| 2   | 0        |
+-----+----------+
| 3   | 0        |
+-----+----------+
| 4   | 0        |
+-----+----------+
| 5   | 0        |
+-----+----------+
| 6   | 0        |
+-----+----------+
| 7   | 0        |
+-----+----------+

You can map multiple CoS values can to the same te-class, but different te-classes may not carry the same CoS value.

Fallback example:
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 0 priority 3**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 5
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 2

tunnels of te-class 1, 2, 3, 5 exist at first
if there are no available tunnel of TE-class 3, forward cos 1-6 to te-class 5
if also there are no available tunnel of TE-class 5, forward cos 0 & 1-6 to te-class 2
if also there are no available tunnel of TE-class 2, forward cos 0 & 1-6 & 7 to te-class 1

To configure the CoS to TE tunnel mapping:

**Command syntax: cos 1 te-class [cos-1]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts cos-te-map

**Parameter table**

+-----------+-----------------------------+-------+---------+
| Parameter | Description                 | Range | Default |
+===========+=============================+=======+=========+
| cos-1     | te-class that carries CoS 1 | 0-7   | 0       |
+-----------+-----------------------------+-------+---------+

**Example**

In this example, if there is no available TE-class 3 tunnel, CoS 1-6 traffic will be directed to TE-class 5.
If there is no available TE-class 5 tunnel, CoS 0 and CoS 1-6 traffic will be directed to TE-class 2.
If TE-class 2 tunnels are also unavailable, all CoS traffic (0, 1-6, and 7) will be directed to TE-class 1.
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 0
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 6
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 7


**Removing Configuration**

To revert to the default mapping for a specific CoS ID:
::

    dnRouter(cfg-diffserv-cbts-cos-te-map)# no cos 1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos_2_te-class.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map cos 2 te-class
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can configure the CoS to TE tunnel mapping. If there is no active TE tunnel matching the traffic CoS, traffic will be forwarded as follows:
-	Over the TE-class that forwards the lowest CoS value
-	If there is no available tunnels for this TE class, the TE-class with the next higher CoS value will be used
-	If there is no available TE-class that matches any of the CoS values, the CBTS constraint will not be applied and the traffic will be forwarded over all available tunnels equally (ECMP).

The default mapping:

+-----+----------+
| CoS | TE-class |
+=====+==========+
| 0   | 0        |
+-----+----------+
| 1   | 0        |
+-----+----------+
| 2   | 0        |
+-----+----------+
| 3   | 0        |
+-----+----------+
| 4   | 0        |
+-----+----------+
| 5   | 0        |
+-----+----------+
| 6   | 0        |
+-----+----------+
| 7   | 0        |
+-----+----------+

You can map multiple CoS values can to the same te-class, but different te-classes may not carry the same CoS value.

Fallback example:
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 0 priority 3**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 5
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 2

tunnels of te-class 1, 2, 3, 5 exist at first
if there are no available tunnel of TE-class 3, forward cos 1-6 to te-class 5
if also there are no available tunnel of TE-class 5, forward cos 0 & 1-6 to te-class 2
if also there are no available tunnel of TE-class 2, forward cos 0 & 1-6 & 7 to te-class 1

To configure the CoS to TE tunnel mapping:

**Command syntax: cos 2 te-class [cos-2]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts cos-te-map

**Parameter table**

+-----------+-----------------------------+-------+---------+
| Parameter | Description                 | Range | Default |
+===========+=============================+=======+=========+
| cos-2     | te-class that carries CoS 2 | 0-7   | 0       |
+-----------+-----------------------------+-------+---------+

**Example**

In this example, if there is no available TE-class 3 tunnel, CoS 1-6 traffic will be directed to TE-class 5.
If there is no available TE-class 5 tunnel, CoS 0 and CoS 1-6 traffic will be directed to TE-class 2.
If TE-class 2 tunnels are also unavailable, all CoS traffic (0, 1-6, and 7) will be directed to TE-class 1.
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 0
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 6
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 7


**Removing Configuration**

To revert to the default mapping for a specific CoS ID:
::

    dnRouter(cfg-diffserv-cbts-cos-te-map)# no cos 2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos_3_te-class.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map cos 3 te-class
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can configure the CoS to TE tunnel mapping. If there is no active TE tunnel matching the traffic CoS, traffic will be forwarded as follows:
-	Over the TE-class that forwards the lowest CoS value
-	If there is no available tunnels for this TE class, the TE-class with the next higher CoS value will be used
-	If there is no available TE-class that matches any of the CoS values, the CBTS constraint will not be applied and the traffic will be forwarded over all available tunnels equally (ECMP).

The default mapping:

+-----+----------+
| CoS | TE-class |
+=====+==========+
| 0   | 0        |
+-----+----------+
| 1   | 0        |
+-----+----------+
| 2   | 0        |
+-----+----------+
| 3   | 0        |
+-----+----------+
| 4   | 0        |
+-----+----------+
| 5   | 0        |
+-----+----------+
| 6   | 0        |
+-----+----------+
| 7   | 0        |
+-----+----------+

You can map multiple CoS values can to the same te-class, but different te-classes may not carry the same CoS value.

Fallback example:
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 0 priority 3**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 5
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 2

tunnels of te-class 1, 2, 3, 5 exist at first
if there are no available tunnel of TE-class 3, forward cos 1-6 to te-class 5
if also there are no available tunnel of TE-class 5, forward cos 0 & 1-6 to te-class 2
if also there are no available tunnel of TE-class 2, forward cos 0 & 1-6 & 7 to te-class 1

To configure the CoS to TE tunnel mapping:

**Command syntax: cos 3 te-class [cos-3]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts cos-te-map

**Parameter table**

+-----------+-----------------------------+-------+---------+
| Parameter | Description                 | Range | Default |
+===========+=============================+=======+=========+
| cos-3     | te-class that carries CoS 3 | 0-7   | 0       |
+-----------+-----------------------------+-------+---------+

**Example**

In this example, if there is no available TE-class 3 tunnel, CoS 1-6 traffic will be directed to TE-class 5.
If there is no available TE-class 5 tunnel, CoS 0 and CoS 1-6 traffic will be directed to TE-class 2.
If TE-class 2 tunnels are also unavailable, all CoS traffic (0, 1-6, and 7) will be directed to TE-class 1.
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 0
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 6
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 7


**Removing Configuration**

To revert to the default mapping for a specific CoS ID:
::

    dnRouter(cfg-diffserv-cbts-cos-te-map)# no cos 3

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos_4_te-class.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map cos 4 te-class
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can configure the CoS to TE tunnel mapping. If there is no active TE tunnel matching the traffic CoS, traffic will be forwarded as follows:
-	Over the TE-class that forwards the lowest CoS value
-	If there is no available tunnels for this TE class, the TE-class with the next higher CoS value will be used
-	If there is no available TE-class that matches any of the CoS values, the CBTS constraint will not be applied and the traffic will be forwarded over all available tunnels equally (ECMP).

The default mapping:

+-----+----------+
| CoS | TE-class |
+=====+==========+
| 0   | 0        |
+-----+----------+
| 1   | 0        |
+-----+----------+
| 2   | 0        |
+-----+----------+
| 3   | 0        |
+-----+----------+
| 4   | 0        |
+-----+----------+
| 5   | 0        |
+-----+----------+
| 6   | 0        |
+-----+----------+
| 7   | 0        |
+-----+----------+

You can map multiple CoS values can to the same te-class, but different te-classes may not carry the same CoS value.

Fallback example:
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 0 priority 3**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 5
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 2

tunnels of te-class 1, 2, 3, 5 exist at first
if there are no available tunnel of TE-class 3, forward cos 1-6 to te-class 5
if also there are no available tunnel of TE-class 5, forward cos 0 & 1-6 to te-class 2
if also there are no available tunnel of TE-class 2, forward cos 0 & 1-6 & 7 to te-class 1

To configure the CoS to TE tunnel mapping:

**Command syntax: cos 4 te-class [cos-4]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts cos-te-map

**Parameter table**

+-----------+-----------------------------+-------+---------+
| Parameter | Description                 | Range | Default |
+===========+=============================+=======+=========+
| cos-4     | te-class that carries CoS 4 | 0-7   | 0       |
+-----------+-----------------------------+-------+---------+

**Example**

In this example, if there is no available TE-class 3 tunnel, CoS 1-6 traffic will be directed to TE-class 5.
If there is no available TE-class 5 tunnel, CoS 0 and CoS 1-6 traffic will be directed to TE-class 2.
If TE-class 2 tunnels are also unavailable, all CoS traffic (0, 1-6, and 7) will be directed to TE-class 1.
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 0
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 6
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 7


**Removing Configuration**

To revert to the default mapping for a specific CoS ID:
::

    dnRouter(cfg-diffserv-cbts-cos-te-map)# no cos 4

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos_5_te-class.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map cos 5 te-class
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can configure the CoS to TE tunnel mapping. If there is no active TE tunnel matching the traffic CoS, traffic will be forwarded as follows:
-	Over the TE-class that forwards the lowest CoS value
-	If there is no available tunnels for this TE class, the TE-class with the next higher CoS value will be used
-	If there is no available TE-class that matches any of the CoS values, the CBTS constraint will not be applied and the traffic will be forwarded over all available tunnels equally (ECMP).

The default mapping:

+-----+----------+
| CoS | TE-class |
+=====+==========+
| 0   | 0        |
+-----+----------+
| 1   | 0        |
+-----+----------+
| 2   | 0        |
+-----+----------+
| 3   | 0        |
+-----+----------+
| 4   | 0        |
+-----+----------+
| 5   | 0        |
+-----+----------+
| 6   | 0        |
+-----+----------+
| 7   | 0        |
+-----+----------+

You can map multiple CoS values can to the same te-class, but different te-classes may not carry the same CoS value.

Fallback example:
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 0 priority 3**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 5
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 2

tunnels of te-class 1, 2, 3, 5 exist at first
if there are no available tunnel of TE-class 3, forward cos 1-6 to te-class 5
if also there are no available tunnel of TE-class 5, forward cos 0 & 1-6 to te-class 2
if also there are no available tunnel of TE-class 2, forward cos 0 & 1-6 & 7 to te-class 1

To configure the CoS to TE tunnel mapping:

**Command syntax: cos 5 te-class [cos-5]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts cos-te-map

**Parameter table**

+-----------+-----------------------------+-------+---------+
| Parameter | Description                 | Range | Default |
+===========+=============================+=======+=========+
| cos-5     | te-class that carries CoS 5 | 0-7   | 0       |
+-----------+-----------------------------+-------+---------+

**Example**

In this example, if there is no available TE-class 3 tunnel, CoS 1-6 traffic will be directed to TE-class 5.
If there is no available TE-class 5 tunnel, CoS 0 and CoS 1-6 traffic will be directed to TE-class 2.
If TE-class 2 tunnels are also unavailable, all CoS traffic (0, 1-6, and 7) will be directed to TE-class 1.
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 0
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 6
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 7


**Removing Configuration**

To revert to the default mapping for a specific CoS ID:
::

    dnRouter(cfg-diffserv-cbts-cos-te-map)# no cos 5

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos_6_te-class.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map cos 6 te-class
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can configure the CoS to TE tunnel mapping. If there is no active TE tunnel matching the traffic CoS, traffic will be forwarded as follows:
-	Over the TE-class that forwards the lowest CoS value
-	If there is no available tunnels for this TE class, the TE-class with the next higher CoS value will be used
-	If there is no available TE-class that matches any of the CoS values, the CBTS constraint will not be applied and the traffic will be forwarded over all available tunnels equally (ECMP).

The default mapping:

+-----+----------+
| CoS | TE-class |
+=====+==========+
| 0   | 0        |
+-----+----------+
| 1   | 0        |
+-----+----------+
| 2   | 0        |
+-----+----------+
| 3   | 0        |
+-----+----------+
| 4   | 0        |
+-----+----------+
| 5   | 0        |
+-----+----------+
| 6   | 0        |
+-----+----------+
| 7   | 0        |
+-----+----------+

You can map multiple CoS values can to the same te-class, but different te-classes may not carry the same CoS value.

Fallback example:
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 0 priority 3**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 5
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 2

tunnels of te-class 1, 2, 3, 5 exist at first
if there are no available tunnel of TE-class 3, forward cos 1-6 to te-class 5
if also there are no available tunnel of TE-class 5, forward cos 0 & 1-6 to te-class 2
if also there are no available tunnel of TE-class 2, forward cos 0 & 1-6 & 7 to te-class 1

To configure the CoS to TE tunnel mapping:

**Command syntax: cos 6 te-class [cos-6]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts cos-te-map

**Parameter table**

+-----------+-----------------------------+-------+---------+
| Parameter | Description                 | Range | Default |
+===========+=============================+=======+=========+
| cos-6     | te-class that carries CoS 6 | 0-7   | 0       |
+-----------+-----------------------------+-------+---------+

**Example**

In this example, if there is no available TE-class 3 tunnel, CoS 1-6 traffic will be directed to TE-class 5.
If there is no available TE-class 5 tunnel, CoS 0 and CoS 1-6 traffic will be directed to TE-class 2.
If TE-class 2 tunnels are also unavailable, all CoS traffic (0, 1-6, and 7) will be directed to TE-class 1.
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 0
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 6
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 7


**Removing Configuration**

To revert to the default mapping for a specific CoS ID:
::

    dnRouter(cfg-diffserv-cbts-cos-te-map)# no cos 6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos_7_te-class.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map cos 7 te-class
-----------------------------------------------------------------------------

**Minimum user role:** operator

You can configure the CoS to TE tunnel mapping. If there is no active TE tunnel matching the traffic CoS, traffic will be forwarded as follows:
-	Over the TE-class that forwards the lowest CoS value
-	If there is no available tunnels for this TE class, the TE-class with the next higher CoS value will be used
-	If there is no available TE-class that matches any of the CoS values, the CBTS constraint will not be applied and the traffic will be forwarded over all available tunnels equally (ECMP).

The default mapping:

+-----+----------+
| CoS | TE-class |
+=====+==========+
| 0   | 0        |
+-----+----------+
| 1   | 0        |
+-----+----------+
| 2   | 0        |
+-----+----------+
| 3   | 0        |
+-----+----------+
| 4   | 0        |
+-----+----------+
| 5   | 0        |
+-----+----------+
| 6   | 0        |
+-----+----------+
| 7   | 0        |
+-----+----------+

You can map multiple CoS values can to the same te-class, but different te-classes may not carry the same CoS value.

Fallback example:
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2**
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 0 priority 3**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
  **dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5**
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
  dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 5
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 3
  dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 2

tunnels of te-class 1, 2, 3, 5 exist at first
if there are no available tunnel of TE-class 3, forward cos 1-6 to te-class 5
if also there are no available tunnel of TE-class 5, forward cos 0 & 1-6 to te-class 2
if also there are no available tunnel of TE-class 2, forward cos 0 & 1-6 & 7 to te-class 1

To configure the CoS to TE tunnel mapping:

**Command syntax: cos 7 te-class [cos-7]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts cos-te-map

**Parameter table**

+-----------+-----------------------------+-------+---------+
| Parameter | Description                 | Range | Default |
+===========+=============================+=======+=========+
| cos-7     | te-class that carries CoS 7 | 0-7   | 0       |
+-----------+-----------------------------+-------+---------+

**Example**

In this example, if there is no available TE-class 3 tunnel, CoS 1-6 traffic will be directed to TE-class 5.
If there is no available TE-class 5 tunnel, CoS 0 and CoS 1-6 traffic will be directed to TE-class 2.
If TE-class 2 tunnels are also unavailable, all CoS traffic (0, 1-6, and 7) will be directed to TE-class 1.
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 0 te-class 0
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 1 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 2 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 3 te-class 1
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 4 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 5 te-class 4
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 6 te-class 6
    dnRouter(cfg-diffserv-cbts-cos-te-map)# cos 7 te-class 7


**Removing Configuration**

To revert to the default mapping for a specific CoS ID:
::

    dnRouter(cfg-diffserv-cbts-cos-te-map)# no cos 7

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/cbts/cos-te-map/cos-te-map.rst

protocols mpls traffic-engineering diffserv-te cbts cos-te-map
--------------------------------------------------------------

**Minimum user role:** operator

A cos-te-map is the mapping of CoS to a Tunnel TE class.

To configure a cos-te-map, enter its configuration level:

**Command syntax: cos-te-map**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te cbts

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# cbts
    dnRouter(cfg-te-diffserv-cbts)# cos-te-map
    dnRouter(cfg-diffserv-cbts-cos-te-map)#


**Removing Configuration**

To revert to the default mapping:
::

    dnRouter(cfg-te-diffserv-cbts)# no cos-te-map

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/diffserv-te.rst

protocols mpls traffic-engineering diffserv-te
----------------------------------------------

**Minimum user role:** operator

Differentiated services (DiffServ)-aware traffic engineering enables to guarantee different levels of service and bandwidth to different class types over the MPLS network. 
To achieve this, follow these general steps:
#.	Enter DiffServ-te configuration mode (see how below).
#.	Enable DiffServ-te on the system (see "mpls traffic-engineering diffserv-te admin-state")
#.	Select a TE bandwidth-model (RDM) (see "mpls traffic-engineering diffserv-te bandwidth-model")
#.	Enter te-class-map configuration mode (see "mpls traffic-engineering diffserv-te te-class-map")
#.	Map class-type and tunnel priority to each TE class (see "mpls traffic-engineering diffserv-te te-class-map te-class")

To enter the DiffServ configuration hierarchy:

**Command syntax: diffserv-te**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)#


**Removing Configuration**

To revert all DiffServ configuration to the default values:
::

    dnRouter(cfg-protocols-mpls-te)# no diffserv-te

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_0_class-type_priority.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 0 class-type priority
------------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 0 class-type [class-type] priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| class-type | A set of traffic flows that have the same set of bandwidth constraints. When set | \-    | 0       |
|            | to unused, you cannot set priority and the class-type is unusable.               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+
| priority   | The preemption priority for the class-type. You cannot set a priority for        | 0-7   | 7       |
|            | class-type unused.                                                               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_0_class-type_unused.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 0 class-type unused
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 0 class-type unused**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_1_class-type_priority.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 1 class-type priority
------------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 1 class-type [class-type] priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| class-type | A set of traffic flows that have the same set of bandwidth constraints. When set | \-    | 1       |
|            | to unused, you cannot set priority and the class-type is unusable.               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+
| priority   | The preemption priority for the class-type. You cannot set a priority for        | 0-7   | 7       |
|            | class-type unused.                                                               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_1_class-type_unused.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 1 class-type unused
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 1 class-type unused**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_2_class-type_priority.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 2 class-type priority
------------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 2 class-type [class-type] priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| class-type | A set of traffic flows that have the same set of bandwidth constraints. When set | \-    | unused  |
|            | to unused, you cannot set priority and the class-type is unusable.               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+
| priority   | The preemption priority for the class-type. You cannot set a priority for        | 0-7   | \-      |
|            | class-type unused.                                                               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_2_class-type_unused.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 2 class-type unused
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 2 class-type unused**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_3_class-type_priority.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 3 class-type priority
------------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 3 class-type [class-type] priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| class-type | A set of traffic flows that have the same set of bandwidth constraints. When set | \-    | unused  |
|            | to unused, you cannot set priority and the class-type is unusable.               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+
| priority   | The preemption priority for the class-type. You cannot set a priority for        | 0-7   | \-      |
|            | class-type unused.                                                               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_3_class-type_unused.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 3 class-type unused
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 3 class-type unused**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_4_class-type_priority.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 4 class-type priority
------------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 4 class-type [class-type] priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| class-type | A set of traffic flows that have the same set of bandwidth constraints. When set | \-    | 0       |
|            | to unused, you cannot set priority and the class-type is unusable.               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+
| priority   | The preemption priority for the class-type. You cannot set a priority for        | 0-7   | 0       |
|            | class-type unused.                                                               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_4_class-type_unused.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 4 class-type unused
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 4 class-type unused**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_5_class-type_priority.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 5 class-type priority
------------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 5 class-type [class-type] priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| class-type | A set of traffic flows that have the same set of bandwidth constraints. When set | \-    | 1       |
|            | to unused, you cannot set priority and the class-type is unusable.               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+
| priority   | The preemption priority for the class-type. You cannot set a priority for        | 0-7   | 0       |
|            | class-type unused.                                                               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_5_class-type_unused.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 5 class-type unused
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 5 class-type unused**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_6_class-type_priority.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 6 class-type priority
------------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 6 class-type [class-type] priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| class-type | A set of traffic flows that have the same set of bandwidth constraints. When set | \-    | unused  |
|            | to unused, you cannot set priority and the class-type is unusable.               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+
| priority   | The preemption priority for the class-type. You cannot set a priority for        | 0-7   | \-      |
|            | class-type unused.                                                               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_6_class-type_unused.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 6 class-type unused
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 6 class-type unused**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_7_class-type_priority.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 7 class-type priority
------------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 7 class-type [class-type] priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| class-type | A set of traffic flows that have the same set of bandwidth constraints. When set | \-    | unused  |
|            | to unused, you cannot set priority and the class-type is unusable.               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+
| priority   | The preemption priority for the class-type. You cannot set a priority for        | 0-7   | \-      |
|            | class-type unused.                                                               |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class_7_class-type_unused.rst

protocols mpls traffic-engineering diffserv-te te-class-map te-class 7 class-type unused
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The traffic-engineering class is the unique pairing of a class-type with a tunnel priority (see table below for the default TE-class mappings). You can assign a different tunnel priority or class-type for each TE-class, however, the same pairing cannot be assigned to different TE classes.

The default te-class mapping:

+----------+------------+----------+
| TE-Class | Class-Type | Priority |
+==========+============+==========+
| 0        | 0          | 7        |
+----------+------------+----------+
| 1        | 1          | 7        |
+----------+------------+----------+
| 2        | unused     |          |
+----------+------------+----------+
| 3        | unused     |          |
+----------+------------+----------+
| 4        | 0          | 0        |
+----------+------------+----------+
| 5        | 1          | 0        |
+----------+------------+----------+
| 6        | unused     |          |
+----------+------------+----------+
| 7        | unused     |          |
+----------+------------+----------+

For a tunnel to be established, there must be a valid mapping for both tunnel {class-type, setup-priority} and tunnel {class-type, hold-priority}. If the tunnel priority and class-type pair isn't mapped to a te-class the commit will fail with an error message.
If a tunnel matches two te-classes (one for setup priority and one for hold priority), the tunnel's te-class will be based on the hold-priority.

To map class-type and tunnel priority to each TE class:

**Command syntax: te-class 7 class-type unused**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te te-class-map

**Note**

- When changing a te-class mapping, if the new configuration conflicts with existing tunnels, the new configuration will not affect the existing tunnels. In this case, you should clear the tunnels manually to apply the change.

- Diff-serv TE mode is IETF

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 0 class-type 0 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 1 class-type 1 priority 1
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 2 class-type 1 priority 2
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type 1 priority 3
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 4 class-type 0 priority 4
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 5 class-type 0 priority 5
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 6 class-type 0 priority 6
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 7 class-type 0 priority 7

    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)# te-class 3 class-type unused


**Removing Configuration**

To revert to the default te-class mapping (for a specific te-class):
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class 5

**Command History**

+---------+------------------------------------+
| Release | Modification                       |
+=========+====================================+
| 10.0    | Command introduced                 |
+---------+------------------------------------+
| 13.0    | Updated class-type parameter value |
+---------+------------------------------------+

---

### traffic-engineering/diffserv-te/te-class-map/te-class-map.rst

protocols mpls traffic-engineering diffserv-te te-class-map
-----------------------------------------------------------

**Minimum user role:** operator

A te-class-map is the mapping between the class types, priorities, and traffic engineering classes.
To configure different levels of service to different class types:
#.	Enter te-class-map configuration mode
#.	Map class-type and tunnel priority to each TE class (see "mpls traffic-engineering diffserv-te te-class-map te-class").

To enter the te-class-map configuration hierarchy:

**Command syntax: te-class-map**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering diffserv-te

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# diffserv-te
    dnRouter(cfg-mpls-te-diffserv)# te-class-map
    dnRouter(cfg-te-diffserv-te-class-map)#


**Removing Configuration**

To revert to the default mapping:
::

    dnRouter(cfg-mpls-te-diffserv)# no te-class-map

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/igp-protocol.rst

protocols mpls traffic-engineering igp-protocol
-----------------------------------------------

**Minimum user role:** operator

You can use the following to configure the default IGP protocol to be used for CSPF path calculations in RSVP-TE tunnels.
To set the IGP protocol to be used for path calculations:

**Command syntax: igp-protocol [igp-protocol]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Parameter table**

+--------------+--------------------------------------------------+----------+---------+
| Parameter    | Description                                      | Range    | Default |
+==============+==================================================+==========+=========+
| igp-protocol | Default IGP protocol that shall be used for CSPF | | isis   | isis    |
|              |                                                  | | ospf   |         |
+--------------+--------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# igp-protocol ospf

    dnRouter(cfg-protocols-mpls-te)# igp-protocol isis


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-mpls-te)# no igp-protocol

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### traffic-engineering/igp-shortcuts.rst

protocols mpls traffic-engineering igp-shortcuts
------------------------------------------------

**Minimum user role:** operator

IGP shortcuts (IGP-SC) allow the IGP to install routes to indirect destination in the MPLS-NH table in addition to the destination. IGP takes all the destinations in its internal routing table and treats them as if they were directly connected to the local router, thus recreating its topology.

IGP-shortcuts will only enable to resolve BGP and static-route next-hop by a LSP. By default, the BGP and static-route next-hop is first solved by an LSP only if the LSP destination matches the next-hop address. With IGP-shortcuts enabled, BGP and static-route next-hop can be solved by an LSP even if the LSP destination doesnt match the next-hop address. An IGP path is found to the next-hop destination with the option of using LSPs as a connected route for the IGP topology.

An RSVP tunnel always has preference over an LDP LSP for next-hop resolution.

When an RSVP tunnel is configured for a specific igp-instance, only that instance can use the tunnel as shortcut.

Any change in IGP update, including the removal of the IGP protocol, will affect the computed shortcuts.

The IGP-shortcut SPF calculation runs whenever:
 -	IGP SPF calculation runs
 -	A tunnel state changes to up or down, or the tunnel is removed

To enable or disable the use of an LSP (either RSVP tunnels or LDP LSP) to resolve non-MPLS traffic:

**Command syntax: igp-shortcuts [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state of the IGP-shortcut feature. When enabled,              | | enabled    | disabled |
|             | IGP-shortcuts will be used by all IGP instances.                                 | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# igp-shortcuts enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-mpls-te)# no igp-shortcuts

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/interface/admin-group.rst

protocols mpls traffic-engineering interface admin-group
--------------------------------------------------------

**Minimum user role:** operator

You can set multiple admin-groups on an interface to enable multiple RSVP tunnels to pass through the interface.

To set the admin-group on an interface:

**Command syntax: admin-group [admin-group]** [, admin-group, admin-group]

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

- Changing an admin-interface only affects new tunnels.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                                      | Range            | Default |
+=============+==================================================================================+==================+=========+
| admin-group | Specify an existing admin-group name (or multiple admin-group names) to          | | string         | \-      |
|             | associate with the interface. You can set up to 32 admin-groups on an interface. | | length 1-255   |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-1
    dnRouter(cfg-mpls-te-if)# admin-group AFF_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-2
    dnRouter(cfg-mpls-te-if)# admin-group AFF_1, AFF_2


**Removing Configuration**

To remove all admin-groups on the interface:
::

    dnRouter(cfg-mpls-te-if)# no admin-group

To remove an admin-group on the interface:
::

    dnRouter(cfg-mpls-te-if)# no admin-group AFF_2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### traffic-engineering/interface/bandwidth_percent_class-type_0.rst

protocols mpls traffic-engineering interface bandwidth percent class-type 0
---------------------------------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity. You can change the maximum limit for bandwidth reservation for TE on an interface. This limit may exceed the physical limit of the interface. 
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value. Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces. Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces. 
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle. When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.
-	If you configure an interface with a bandwidth value of 0, no tunnels will use the interface, including 0 bandwidth tunnels.
-	For n <= m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.
-	Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.
-	When configuring bandwidth with percent, both class-types must be configured with percent.
-	When traffic-engineering diffserv-te admin-state is enabled, and you want to configure bandwidth for a specifc interface, you must configure bandwidth for all class-types.
-	When traffic-engineering diffserv-te admin-state is disabled, bandwidth for class-type 1 must not be configured (you can only configure bandwidth for class-type 0)

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth percent [bw-percent] class-type 0**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

**Parameter table**

+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+
| Parameter  | Description                                                                      | Range    | Default                                  |
+============+==================================================================================+==========+==========================================+
| bw-percent | The TE available bandwidth on the interface relative to the physical interface   | 0..10000 | As traffic-engineering bandwidth setting |
|            | bandwidth (in %). When used on a bundle interface, if one of the links drops,    |          |                                          |
|            | the TE reserved bandwidth will change accordingly.                               |          |                                          |
+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-2
    dnRouter(cfg-mpls-te-if)# bandwidth percent 90 class-type 0


**Removing Configuration**

To revert bandwidth restrictions to the default values for class type 0:
::

    dnRouter(cfg-mpls-te-if)# no bandwidth percent 90 class-type 0

**Command History**

+---------+-----------------------------------------------------------------+
| Release | Modification                                                    |
+=========+=================================================================+
| 9.0     | Command introduced                                              |
+---------+-----------------------------------------------------------------+
| 10.0    | Added the ability to configure bandwidth limits per class-type. |
+---------+-----------------------------------------------------------------+

---

### traffic-engineering/interface/bandwidth_percent_class-type_1.rst

protocols mpls traffic-engineering interface bandwidth percent class-type 1
---------------------------------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity. You can change the maximum limit for bandwidth reservation for TE on an interface. This limit may exceed the physical limit of the interface. 
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value. Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces. Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces. 
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle. When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.
-	If you configure an interface with a bandwidth value of 0, no tunnels will use the interface, including 0 bandwidth tunnels.
-	For n <= m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.
-	Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.
-	When configuring bandwidth with percent, both class-types must be configured with percent.
-	When traffic-engineering diffserv-te admin-state is enabled, and you want to configure bandwidth for a specifc interface, you must configure bandwidth for all class-types.
-	When traffic-engineering diffserv-te admin-state is disabled, bandwidth for class-type 1 must not be configured (you can only configure bandwidth for class-type 0)

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth percent [bw-percent] class-type 1**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

**Parameter table**

+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+
| Parameter  | Description                                                                      | Range    | Default                                  |
+============+==================================================================================+==========+==========================================+
| bw-percent | The TE available bandwidth on the interface relative to the physical interface   | 0..10000 | As traffic-engineering bandwidth setting |
|            | bandwidth (in %). When used on a bundle interface, if one of the links drops,    |          |                                          |
|            | the TE reserved bandwidth will change accordingly.                               |          |                                          |
+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-2
    dnRouter(cfg-mpls-te-if)# bandwidth percent 95 class-type 1


**Removing Configuration**

To revert bandwidth restrictions to the default values for class type 1:
::

    dnRouter(cfg-mpls-te-if)# no bandwidth percent 95 class-type 1

**Command History**

+---------+-----------------------------------------------------------------+
| Release | Modification                                                    |
+=========+=================================================================+
| 9.0     | Command introduced                                              |
+---------+-----------------------------------------------------------------+
| 10.0    | Added the ability to configure bandwidth limits per class-type. |
+---------+-----------------------------------------------------------------+

---

### traffic-engineering/interface/bandwidth_percent.rst

protocols mpls traffic-engineering interface bandwidth percent
--------------------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity. You can change the maximum limit for bandwidth reservation for TE on an interface. This limit may exceed the physical limit of the interface. 
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value. Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces. Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces. 
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle. When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.
-	If you configure an interface with a bandwidth value of 0, no tunnels will use the interface, including 0 bandwidth tunnels.
-	For n <= m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.
-	Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.
-	When configuring bandwidth with percent, both class-types must be configured with percent.
-	When traffic-engineering diffserv-te admin-state is enabled, and you want to configure bandwidth for a specifc interface, you must configure bandwidth for all class-types.
-	When traffic-engineering diffserv-te admin-state is disabled, bandwidth for class-type 1 must not be configured (you can only configure bandwidth for class-type 0)

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth percent [bw-percent]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

**Parameter table**

+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+
| Parameter  | Description                                                                      | Range    | Default                                  |
+============+==================================================================================+==========+==========================================+
| bw-percent | The TE available bandwidth on the interface relative to the physical interface   | 0..10000 | As traffic-engineering bandwidth setting |
|            | bandwidth (in %). When used on a bundle interface, if one of the links drops,    |          |                                          |
|            | the TE reserved bandwidth will change accordingly.                               |          |                                          |
+------------+----------------------------------------------------------------------------------+----------+------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-2
    dnRouter(cfg-mpls-te-if)# bandwidth percent 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-3
    dnRouter(cfg-mpls-te-if)# bandwidth percent 95

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-4
    dnRouter(cfg-mpls-te-if)# bandwidth percent 125


**Removing Configuration**

To revert bandwidth restrictions to the default values for all classes:
::

    dnRouter(cfg-mpls-te-if)# no bandwidth percent

**Command History**

+---------+-----------------------------------------------------------------+
| Release | Modification                                                    |
+=========+=================================================================+
| 9.0     | Command introduced                                              |
+---------+-----------------------------------------------------------------+
| 10.0    | Added the ability to configure bandwidth limits per class-type. |
+---------+-----------------------------------------------------------------+

---

### traffic-engineering/interface/bandwidth_units_class-type_0.rst

protocols mpls traffic-engineering interface bandwidth
------------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity. You can change the maximum limit for bandwidth reservation for TE on an interface. This limit may exceed the physical limit of the interface. 
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value. Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces. Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces. 
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle. When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.
-	If you configure an interface with a bandwidth value of 0, no tunnels will use the interface, including 0 bandwidth tunnels.
-	For n <= m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.
-	Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.
-	When configuring bandwidth with percent, both class-types must be configured with percent.
-	When traffic-engineering diffserv-te admin-state is enabled, and you want to configure bandwidth for a specifc interface, you must configure bandwidth for all class-types.
-	When traffic-engineering diffserv-te admin-state is disabled, bandwidth for class-type 1 must not be configured (you can only configure bandwidth for class-type 0)

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth [bandwidth-value] [bandwidth-units] class-type 0**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

**Parameter table**

+-----------------+--------------------+--------------+---------+
| Parameter       | Description        | Range        | Default |
+=================+====================+==============+=========+
| bandwidth-value | bandwidth in units | 0-4294967295 | \-      |
+-----------------+--------------------+--------------+---------+
| bandwidth-units | bandwidth units    | | kbps       | \-      |
|                 |                    | | mbps       |         |
|                 |                    | | gbps       |         |
|                 |                    | | percent    |         |
+-----------------+--------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-1
    dnRouter(cfg-mpls-te-if)# bandwidth 900 mbps class-type 0


**Removing Configuration**

To revert to the default bandwidth value for class-type 0:
::

    dnRouter(cfg-mpls-te-if)# no bandwidth 900 mbps class-type 0

**Command History**

+---------+-----------------------------------------------------------------+
| Release | Modification                                                    |
+=========+=================================================================+
| 9.0     | Command introduced                                              |
+---------+-----------------------------------------------------------------+
| 10.0    | Added the ability to configure bandwidth limits per class-type. |
+---------+-----------------------------------------------------------------+

---

### traffic-engineering/interface/bandwidth_units_class-type_1.rst

protocols mpls traffic-engineering interface bandwidth
------------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity. You can change the maximum limit for bandwidth reservation for TE on an interface. This limit may exceed the physical limit of the interface. 
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value. Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces. Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces. 
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle. When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.
-	If you configure an interface with a bandwidth value of 0, no tunnels will use the interface, including 0 bandwidth tunnels.
-	For n <= m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.
-	Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.
-	When configuring bandwidth with percent, both class-types must be configured with percent.
-	When traffic-engineering diffserv-te admin-state is enabled, and you want to configure bandwidth for a specifc interface, you must configure bandwidth for all class-types.
-	When traffic-engineering diffserv-te admin-state is disabled, bandwidth for class-type 1 must not be configured (you can only configure bandwidth for class-type 0)

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth [bandwidth-value] [bandwidth-units] class-type 1**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

**Parameter table**

+-----------------+--------------------+--------------+---------+
| Parameter       | Description        | Range        | Default |
+=================+====================+==============+=========+
| bandwidth-value | bandwidth in units | 0-4294967295 | \-      |
+-----------------+--------------------+--------------+---------+
| bandwidth-units | bandwidth units    | | kbps       | \-      |
|                 |                    | | mbps       |         |
|                 |                    | | gbps       |         |
|                 |                    | | percent    |         |
+-----------------+--------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-1
    dnRouter(cfg-mpls-te-if)# bandwidth 1000 mbps class-type 1


**Removing Configuration**

To revert to the default bandwidth value for class-type 1:
::

    dnRouter(cfg-mpls-te-if)# no bandwidth 1000 mbps class-type 1

**Command History**

+---------+-----------------------------------------------------------------+
| Release | Modification                                                    |
+=========+=================================================================+
| 9.0     | Command introduced                                              |
+---------+-----------------------------------------------------------------+
| 10.0    | Added the ability to configure bandwidth limits per class-type. |
+---------+-----------------------------------------------------------------+

---

### traffic-engineering/interface/bandwidth_units.rst

protocols mpls traffic-engineering interface bandwidth
------------------------------------------------------

**Minimum user role:** operator

By default, an interface that is TE enabled, reserves 75% of the interface's bandwidth capacity. You can change the maximum limit for bandwidth reservation for TE on an interface. This limit may exceed the physical limit of the interface. 
All sub-interface of the same physical or bundle interface must be set with the same bandwidth value. Sub-interfaces share the physical or bundle TE bandwidth resource. When allocating a tunnel over one sub-interface, it also deducts from the available bandwidth in other sub-interfaces. Tunnel allocation in different sub-interfaces can cause preemption in other sub-interfaces. 
When explicitly configuring an interface with bandwidth (an absolute value or percentage) it won't share CAC with other sub-interfaces of the same physical/bundle. When allocating a tunnel to an interface, it will not deduct from the available bandwidth in other sub-inetrfaces and vise versa.
-	If you configure an interface with a bandwidth value of 0, no tunnels will use the interface, including 0 bandwidth tunnels.
-	For n <= m, the bandwidth of class-type n must be equal or greater than the bandwidth of class-type m.
-	Tunnel of class-type n can only allocate bandwidth from class-type n, n+1, n+2, pools.
-	When configuring bandwidth with percent, both class-types must be configured with percent.
-	When traffic-engineering diffserv-te admin-state is enabled, and you want to configure bandwidth for a specifc interface, you must configure bandwidth for all class-types.
-	When traffic-engineering diffserv-te admin-state is disabled, bandwidth for class-type 1 must not be configured (you can only configure bandwidth for class-type 0)

To set a maximum bandwidth reservation limit:

**Command syntax: bandwidth [bandwidth] [unit]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

**Parameter table**

+-----------+----------------------------------------------------------------------------------+----------------------------+------------------------------------------+
| Parameter | Description                                                                      | Range                      | Default                                  |
+===========+==================================================================================+============================+==========================================+
| bandwidth | The TE available bandwidth on the interface. The allocated bandwidth is not      | | 0..4294967295 for kbps   | As traffic-engineering bandwidth setting |
|           | limited by the physical capacity of the physical interface. You may allocate     | | 0..41943030 for mbps     |                                          |
|           | more bandwidth than the physical interface allows (over-subscription).           | | 0..41960 for gbps        |                                          |
+-----------+----------------------------------------------------------------------------------+----------------------------+------------------------------------------+
| unit      | The unit of measurement for the bandwidth.                                       | | kbps                     | As traffic-engineering bandwidth setting |
|           |                                                                                  | | mbps                     |                                          |
|           |                                                                                  | | gbps                     |                                          |
+-----------+----------------------------------------------------------------------------------+----------------------------+------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-1
    dnRouter(cfg-mpls-te-if)# bandwidth 102400 kbps

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-1
    dnRouter(cfg-mpls-te-if)# bandwidth 100 gbps


**Removing Configuration**

To revert bandwidth restrictions to the default values for all classes:
::

    dnRouter(cfg-mpls-te-if)# no bandwidth

**Command History**

+---------+-----------------------------------------------------------------+
| Release | Modification                                                    |
+=========+=================================================================+
| 9.0     | Command introduced                                              |
+---------+-----------------------------------------------------------------+
| 10.0    | Added the ability to configure bandwidth limits per class-type. |
+---------+-----------------------------------------------------------------+

---

### traffic-engineering/interface/interface.rst

protocols mpls traffic-engineering interface
--------------------------------------------

**Minimum user role:** operator

To enable MPLS traffic engineering on an interface and enter its configuration mode:

**Command syntax: interface [interface-name]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

- You must enable both RSVP and MPLS TE on an interface for the system to be able to establish an RSVP session and an LSP through the interface.

- Removing the interface configuration will cause the interface to be removed from the IGP TE database.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+--------------------------------------------------------+---------+
| Parameter      | Description                                                                      | Range                                                  | Default |
+================+==================================================================================+========================================================+=========+
| interface-name | The name of the interface on which to enable TE. This enables the interface for  | | ge{/10/25/40/100}-X/Y/Z                              | \-      |
|                | RSVP signaling and also enables to advertise the IGP-TE database, if TE is       | | ge<interface speed>-<A>/<B>/<C>.<sub-interface id>   |         |
|                | enabled in the IGP protocol.                                                     | | bundle-<bundle-id>                                   |         |
|                |                                                                                  | | bundle-<bundle-id.subinterface>                      |         |
+----------------+----------------------------------------------------------------------------------+--------------------------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-1
    dnRouter(cfg-mpls-te-if)#


**Removing Configuration**

To remove the MPLS TE interface configuration:
::

    dnRouter(cfg-protocols-mpls-te)#  no interface bundle-1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### traffic-engineering/interface/srlg-group.rst

protocols mpls traffic-engineering interface srlg-group
-------------------------------------------------------

**Minimum user role:** operator

A shared risk link group (SRLG) is a set of links that share a common resource. The group members have a shared risk: when the common resource fails, all links in the group are equally affected and if one link fails other links in the group may also fail. 
In MPLS-TE, the SRLG feature ensures that a calculated backup path avoids using links that are in the same SRLG as interfaces that the backup tunnel is protecting.
A link may belong to multiple SRLGs. You can configure up to 128 SRLG groups on an interface. The SRLG attribute is shared between all TE enabled IGP protocols.
To configure an SRLG group for the MPLS-TE interface:

**Command syntax: srlg-group [srlg-id]** [, srlg-id, srlg-id]

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| srlg-id   | The SRLG identifier. Links with the same SRLG identifier belong to the same      | 1-4294967295 | \-      |
|           | SRLG.                                                                            |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-1.1
    dnRouter(cfg-mpls-te-if)# srlg-group 1, 2
    dnRouter(cfg-mpls-te-if)# srlg-group 3

    dnRouter(cfg-protocols-mpls-te)# interface bundle-1.2
    dnRouter(cfg-mpls-te-if)# srlg-group 3


**Removing Configuration**

To remove an SRLG value from the interface:
::

    dnRouter(cfg-mpls-te-if)# no srlg-group 1

To remove all SRLG values from the interface:
::

    dnRouter(cfg-mpls-te-if)# no srlg-group

**Command History**

+---------+----------------------------------------------------------------------+
| Release | Modification                                                         |
+=========+======================================================================+
| 10.0    | Command introduced                                                   |
+---------+----------------------------------------------------------------------+
| 25.1    | Update maximum allowed configured SRLG groups on an interface to 128 |
+---------+----------------------------------------------------------------------+

---

### traffic-engineering/interface/te-metric.rst

protocols mpls traffic-engineering interface te-metric
------------------------------------------------------

**Minimum user role:** operator

By default, the traffic-engineering metric of a link matches the IGP metric assigned for the interface. The traffic-engineering metric is signalled by the IGP protocol as part of the TE parameters.
You can configure a te-metric that is different from the ipv4 metric to result in a traffic-engineering topology that is different than the IGP ipv4 unicast topology.

To set the te-metric:

**Command syntax: te-metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering interface

**Note**

- The command is applicable to the following interface types:

-   - Physical

-   - Physical vlan

-   - Bundle

-   - Bundle vlan

- The te-metric applies to ISIS level-2 only.

**Parameter table**

+-----------+-------------------------------------------------------+------------+---------+
| Parameter | Description                                           | Range      | Default |
+===========+=======================================================+============+=========+
| metric    | Set the te-metric value for a given mpls-te interface | 1-16777215 | \-      |
+-----------+-------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# interface bundle-1.1
    dnRouter(cfg-mpls-te-if)# te-metric 20

    dnRouter(cfg-protocols-mpls-te)# interface ge100-0/0/0
    dnRouter(cfg-mpls-te-if)# te-metric 30


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-mpls-te-if)# no te-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/ipv6-router-id.rst

protocols mpls traffic-engineering ipv6-router-id
-------------------------------------------------

**Minimum user role:** operator

Set the desired lo interface from which the global ipv6 address will be used as an ipv6-te-router-id.

**Command syntax: ipv6-router-id [ipv6-router-id]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- If not set, the default ipv6-router-id will be per the highest IPv6 address from any active loopback interface in the default VRF.

**Parameter table**

+----------------+----------------------------------------------------------------------+----------+---------+
| Parameter      | Description                                                          | Range    | Default |
+================+======================================================================+==========+=========+
| ipv6-router-id | IPv6 Router id of the router to be used for IPv6 traffic engineering | X:X::X:X | \-      |
+----------------+----------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# ipv6-router-id 1717:1717::1


**Removing Configuration**

To revert ipv6-router-id to default value:
::

    dnRouter(cfg-protocols-mpls-te)# no ipv6-router-id

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/load-balancing.rst

protocols mpls traffic-engineering load-balancing
-------------------------------------------------

**Minimum user role:** operator


Equal-cost multi-path routing (ECMP) allows Next-Hop packet forwarding to a single destination to occur over multiple best paths, which tie for the top place in routing metric calculations.
Weighted Equal Cost Multipath (WECMP) for Resource Reservation Protocol (RSVP), an enhancement of ECMP, allows RSVP traffic to be distributed across multiple tunnels with differing weights based on tunnel bandwidth, providing greater flexibility in load balancing and ensuring that traffic is distributed across available paths.
Enables weighted ECMP for TE tunnels forwarding. 
Each of the ECMP tunnel paths will have weight matching the tunnel bandwidth or explicit weight settings.  
Traffic will be load balanced between the different paths per the path weight ratio.

**Command syntax: load-balancing [LB-Type]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- Reconfig of the load-balancing method will not cause traffic loss but may not be performed in the PIC manner.

**Parameter table**

+-----------+---------------------------------------------+-------------------+---------+
| Parameter | Description                                 | Range             | Default |
+===========+=============================================+===================+=========+
| LB-Type   | MPLS TE multiple path load balancing method | | ecmp            | ecmp    |
|           |                                             | | weighted-ecmp   |         |
+-----------+---------------------------------------------+-------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# load-balancing weighted-ecmp


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-mpls-te)# no load-balancing

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/admin-state.rst

protocols mpls traffic-engineering pcep admin-state
---------------------------------------------------

**Minimum user role:** operator

To enable or disable the global PCEP administrative state.
Note: Any PCE admin-state configuration will override this value.

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Parameter table**

+-------------+------------------------------------------------+--------------+----------+
| Parameter   | Description                                    | Range        | Default  |
+=============+================================================+==============+==========+
| admin-state | The administrative state of the PCEP protocol. | | enabled    | disabled |
|             |                                                | | disabled   |          |
+-------------+------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-mpls-te-pcep)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/authentication_disabled.rst

protocols mpls traffic-engineering pcep authentication disabled
---------------------------------------------------------------

**Minimum user role:** operator

To disable protection for all PCEP TCP sessions between PCE and PCC using MD5 authentication algorithm:

**Command syntax: authentication disabled**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Note**

- When authentication is enabled, unauthenticated packets will be dropped.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# authentication disabled


**Removing Configuration**

To revert PCE authentication to the default state:
::

    dnRouter(cfg-mpls-te-pcep)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/authentication_enabled.rst

protocols mpls traffic-engineering pcep authentication enabled password
-----------------------------------------------------------------------

**Minimum user role:** operator

To protect all PCEP TCP sessions between PCE and PCC using MD5 authentication algorithm:

**Command syntax: authentication enabled password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Note**

- When authentication is enabled, unauthenticated packets will be dropped.

- When typing a clear password, the password is not displayed in the CLI terminal. The password is saved encrypted and is always displayed as secret.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter    | Description                                                                      | Range | Default |
+==============+==================================================================================+=======+=========+
| enc-password | The encrypted password. If you do not set an encrypted password, you will be     | \-    | \-      |
|              | prompted to enter a clear password and verify it.                                |       |         |
+--------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# authentication enabled password
    Enter password:
    Enter password for verifications:

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# authentication enabled password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==


**Removing Configuration**

To revert PCE authentication to the default state:
::

    dnRouter(cfg-mpls-te-pcep)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/capability_association.rst

protocols mpls traffic-engineering pcep capability association
--------------------------------------------------------------

**Minimum user role:** operator

Once enabled, DNOS as a PCC utilizes association capability and supports association TLVs to reflect the relations between the LSPs.
An example case is the Path Protection Association (per RFC 8745) to express the relation between Primary LSP and Secondary LSP of the same Tunnel.
To set Association capability:

**Command syntax: capability association [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Note**

- The association is only advertised when there is a need to reflect relations between LSPs. I.E if no Secondary LSP is required, even if the capability association is enabled, it is not advertised for the Primary LSP.

- no command returns the capability association to the default state.

**Parameter table**

+-------------+-------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                 | Range        | Default  |
+=============+=============================================================+==============+==========+
| admin-state | When enabled, PCC will utilize association tlvs per RFC8697 | | enabled    | disabled |
|             |                                                             | | disabled   |          |
+-------------+-------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# capability association enabled


**Removing Configuration**

To return the admin-state to the default value:
::

    dnRouter(cfg-mpls-te-pcep)# no capability association

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/class-of-service.rst

protocols mpls traffic-engineering pcep class-of-service
--------------------------------------------------------

**Minimum user role:** operator

With class of service (CoS) you can classify traffic to provide different service levels to different traffic so that when congestion occurs, you can control which packets receive priority.
To configure a CoS for outgoing PCEP packets:

**Command syntax: class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Parameter table**

+------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter        | Description                                                                      | Range | Default |
+==================+==================================================================================+=======+=========+
| class-of-service | The DSCP value that is used in the IP header to classify the packet and give it  | 0-56  | 48      |
|                  | a priority.                                                                      |       |         |
+------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# class-of-service 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-mpls-te-pcep)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/delegate-protected-bw.rst

protocols mpls traffic-engineering pcep delegate-protected-bw
-------------------------------------------------------------

**Minimum user role:** operator

You can configure all bypass tunnels to advertise their protected-bw to the PCE server via APPLICATION BANDWIDTH Object in the PCEP report (object class 5 object type 5).
The Protected-bw is the aggregated bandwidth of all primary tunnels protected by a given bypass tunnel.
To configure the bypass tunnels to advertise their protected-bw:

**Command syntax: delegate-protected-bw [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Configure all bypass tunnels to advertise thier protected-bw to PCE server via   | | enabled    | disabled |
|             | APPLICATION BANDWIDTH Object                                                     | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# delegate-protected-bw enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-mpls-te-pcep)# no delegate-protected-bw

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.2    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/admin-state.rst

protocols mpls traffic-engineering pcep pce priority address admin-state
------------------------------------------------------------------------

**Minimum user role:** operator

If the PCC connection fails, the PCC will try to reconnect to the PCE after the retry-interval.
The retry-interval is an exponentially increasing timer between 1 second and 64 seconds.
After the first failure, the PCC will attempt to reconnect after 1 second.
Each connection after that increases the timer by 2 seconds.
To set the availability of the PCE server for delegation:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state of the PCE server. When enabled, the PCE is available   | | enabled    | \-      |
|             | for delegation.                                                                  | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-te-pcep-pce)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/authentication_disabled.rst

protocols mpls traffic-engineering pcep pce priority address authentication disabled
------------------------------------------------------------------------------------

**Minimum user role:** operator

To disable protection for the PCEP TCP sessions between the PCE and PCC using MD5 authentication algorithm:

**Command syntax: authentication disabled**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address

**Note**

- When authentication is enabled, unauthenticated packets will be dropped.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# authentication enabled password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVZ-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# authentication disabled


**Removing Configuration**

To revert PCE authentication to the default state (defined by PCEP):
::

    ddnRouter(cfg-te-pcep-pce)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/authentication_enabled.rst

protocols mpls traffic-engineering pcep pce priority address authentication enabled password
--------------------------------------------------------------------------------------------

**Minimum user role:** operator

To protect the PCEP TCP sessions between the PCE and PCC using MD5 authentication algorithm:

**Command syntax: authentication enabled password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address

**Note**

- When authentication is enabled, unauthenticated packets will be dropped.

- When typing a clear password, the password **won't** be displayed in the CLI terminal

- The password is saved encrypted, and always displayed as secret

**Parameter table**

+--------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter    | Description                                                                      | Range | Default |
+==============+==================================================================================+=======+=========+
| enc-password | The encrypted password. If you do not set an encrypted password, you will be     | \-    | \-      |
|              | prompted to enter a clear password and verify it.                                |       |         |
+--------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# authentication enabled password
    Enter password:
    Enter password for verifications:
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# authentication enabled password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# authentication enabled password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# authentication enabled password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKPVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==


**Removing Configuration**

To revert PCE authentication to the default state (defined by PCEP):
::

    dnRouter(cfg-te-pcep-pce)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/passive.rst

protocols mpls traffic-engineering pcep pce priority address passive
--------------------------------------------------------------------

**Minimum user role:** operator

Support PCE in "passive" mode. Passive PCE is never used for delegation, nor by operational failure of active PCEs or via config. PCC will send all PCRpt messages for all LSPs to the Passive PCE
To configure PCE as passive:

**Command syntax: passive [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address

**Parameter table**

+-------------+-----------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                 | Range        | Default  |
+=============+=============================================================================+==============+==========+
| admin-state | set whether the pce server is passive thus no delegation will be pass to it | | enabled    | disabled |
|             |                                                                             | | disabled   |          |
+-------------+-----------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 1 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# passive enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-te-pcep-pce)# no passive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/pce.rst

protocols mpls traffic-engineering pcep pce priority address
------------------------------------------------------------

**Minimum user role:** operator

A path computation element (PCE) is a network entity that is able to calculate a network path based on the network topology. 
Only one PCE is operational at any given time. This is the primary PCE. 
Any other PCE is a backup PCE that will only come into play if the primary PCE fails. 
The PCE with the higher priority (lower configured priority value) will serve as the primary PCE. All other configured PCEs will serve as backups.
A backup PCE does not control LSPs (whether locally initiated by the PCC or by the PCE), but is reported by the PCC on the PCC-initiated LSP status.
Similarly, the PCC will not act upon receiving LSP paths from the backup PCE.
Following a switchover between primary and backup PCE (after session disconnection and timers expiry), there will be no preemption when the primary PCE becomes the backup PCE. 
If the primary PCE returns to operation before redelegation of the backup PCE is established, the delegation of the primary PCE is preserved.
You can configure up to 5 PCE servers.
To configure the PCE server priority and address and enter its configuration mode:

**Command syntax: pce priority [priority] address [ipv4-address]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Parameter table**

+--------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter    | Description                                                                      | Range   | Default |
+==============+==================================================================================+=========+=========+
| priority     | The PCE's priority. A lower value denotes a higher priority PCE. The PCE with a  | 1-255   | \-      |
|              | highest priority serves as the primary PCE.                                      |         |         |
|              | You can configure up to 5 PCE servers, but their priority must be unique.        |         |         |
+--------------+----------------------------------------------------------------------------------+---------+---------+
| ipv4-address | The IP address of the PCE server. The IP address is unique among the PCE         | A.B.C.D | \-      |
|              | servers.                                                                         |         |         |
+--------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 3.3.3.3
    dnRouter(cfg-te-pcep-pce)#


**Removing Configuration**

To remove the PCE server configuration:
::

    dnRouter(cfg-mpls-te-pcep)# no pce priority 3

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/timers/dead-timer.rst

protocols mpls traffic-engineering pcep pce priority address timers dead-timer
------------------------------------------------------------------------------

**Minimum user role:** operator

The dead-timer is another PCEP session maintenance timer that works in tandem with the keep-alive timer (see "mpls traffic-engineering pcep timers keep-alive").
Both PCE and PCC run dead timers and restart them whenever a message is received on the session.
If one session end does not receive a message before the dead timer expires, it declares the session dead.
The dead timer value is negotiated between the PCC and PCE during PCEP session establishment.
If the two timers are not identical, then the timer that will be selected for the session is the maximum between the configured dead-timer and the dead-timer received from the PCE in the OPEN message.
To configure the dead-timer's timeout interval:

**Command syntax: dead-timer [interval]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| interval  | The time (in seconds) that the PCE or PCC waits after receiving a keep-alive     | 0-255 | 40      |
|           | message from its PCEP peer, before declaring the peer dead.                      |       |         |
|           | For the session to be established, the value of the dead-timer interval must be  |       |         |
|           | higher than the PCE keep-alive timer (see "mpls traffic-engineering pcep pce     |       |         |
|           | timers keep-alive")                                                              |       |         |
|           | A value of 0 means that the session will not be timed out, even if keep-alive    |       |         |
|           | messages are no longer received on the session.                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# dead-timer 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-pcep-pce-timers)# no dead-timer

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/timers/keep-alive.rst

protocols mpls traffic-engineering pcep pce priority address timers keep-alive
------------------------------------------------------------------------------

**Minimum user role:** operator

PCEP keep-alive messages are used to maintain PCEP sessions. Once a session is established, the PCE or PCC is periodically informed whether or not its PCEP peer is still available for use. 

Each end of a PCEP session runs a keep-alive timer. When the timer expires, it sends a keep-alive message to its peer and restarts the timer. 
The Keep-alive timer value is negotiated between the PCC and PCE during PCEP session establishment. 
If the two timers are not identical, then the timer that will be selected for the session is the minimum between the configured keep-alive timer and the keep-alive received from the PCE in the OPEN message.

To configure the interval between keep-alive messages between PCC and PCE:

**Command syntax: keep-alive [interval]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address timers

**Note**

- The session can only be established if the received PCE keep-alive < the received PCE dead-timer.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| interval  | The time (in seconds) that the PCE or PCC waits after sending a keep-alive       | 0-255 | 10      |
|           | message to its PCEP peer, before sending another keep-alive message notifying    |       |         |
|           | the peer of its availability.                                                    |       |         |
|           | A value of 0 means that keep-alive messages will not be sent.                    |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# keep-alive 30


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-pcep-pce-timers)# no keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/timers/lsp-state-timeout.rst

protocols mpls traffic-engineering pcep pce priority address timers lsp-state-timeout
-------------------------------------------------------------------------------------

**Minimum user role:** operator

When a PCEP session with a PCE disconnects, the PCC redelegates to an alternative PCE.
The LSP-state-timeout is the amount of time after redelegation that the PCC waits before flushing the LSP states associated with the disconnected PCEP session and reverting to the local default configurations.
This operation is performed in a make-before-break fashion.

To configure the lsp-state-timeout:

**Command syntax: lsp-state-timeout [timeout]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-----------------+-------------------------------+
| Parameter | Description                                                                      | Range           | Default                       |
+===========+==================================================================================+=================+===============================+
| timeout   | time (in seconds) that a path computation client (PCC) must wait before removing | 0-3600/infinity | The TE PCEP lsp-state-timeout |
|           | the LSPs associated with a PCEP session that is disconnected and reverting back  |                 |                               |
|           | to the local defaults attributes/configuration                                   |                 |                               |
+-----------+----------------------------------------------------------------------------------+-----------------+-------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 1 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# lsp-state-timeout 20

    dnRouter(cfg-mpls-te-pcep)# pce priority 2 address 2.2.2.2
    dnRouter(cfg-te-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# lsp-state-timeout infinity


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-pcep-pce-timers)# no lsp-state-timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/timers/redelegation-timeout.rst

protocols mpls traffic-engineering pcep pce priority address timers redelegation-timeout
----------------------------------------------------------------------------------------

**Minimum user role:** operator

The redelegation-timeout interval is the amount of time that a PCC waits before revoking LSP delegations to a PCE with which the PCEP session has terminated unexpectedly and attempting to redelegate the LSPs to an alternate PCE.
If the PCEP session with the original PCE is restored before the redelegation timer expires, the LSP delegations will not be revoked.

To configure the redelegation-timeout interval:

**Command syntax: redelegation-timeout [interval]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------+----------------------------------+
| Parameter | Description                                                                      | Range  | Default                          |
+===========+==================================================================================+========+==================================+
| interval  | time (in seconds) that a path computation client (PCC) must wait before          | 0-3600 | The TE PCEP redelegation-timeout |
|           | re-delegating LSPs after a PCEP session with the active stateful PCE is          |        |                                  |
|           | disconnected                                                                     |        |                                  |
+-----------+----------------------------------------------------------------------------------+--------+----------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# redelegation-timeout 2000


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-pcep-pce-timers)# no redelegation-timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pce/timers/timers.rst

protocols mpls traffic-engineering pcep pce priority address timers
-------------------------------------------------------------------

**Minimum user role:** operator

There are two sets of PCEP timers:
-	Session maintenance timers - used for message transmission between PCC and PCE to notify one another of their availability. The session maintenance timers are based on keep-alive timers (see "mpls traffic-engineering pcep timers keep-alive") and dead timers (see "mpls traffic-engineering pcep timers dead-timer").
-	Session disconnection timers - determining what to do when a session unexpectedly disconnects. These timers are for the redelegation of a new PCE (see "mpls traffic-engineering pcep timers redelegation-timeout") and for removal of the LSPs from the disconnected PCE (see "mpls traffic-engineering pcep timers lsp-state-timeout").
To set timers for messaging between PCC and the specific PCE:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep pce priority address

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# pce priority 3 address 1.1.1.1
    dnRouter(cfg-te-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)#


**Removing Configuration**

To revert all timers to their default values:
::

    dnRouter(cfg-te-pcep-pce)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/pcep.rst

protocols mpls traffic-engineering pcep
---------------------------------------

**Minimum user role:** operator

A path computation element (PCE) is a network entity that is able to calculate a network path based on the network topology. A path computation client (PCC) is a client application that requests a path computation from the PCE. The path computation element protocol (PCEP) is a TCP-based protocol that enables communication between PCEs and between PCE and PCC.
PCEP defines messages and objects for managing PCEP sessions and for requesting and sending path calculations. This includes LSP status reports sent by the PCC and updates on external LSPs sent by the PCE.
In PCEP configuration mode, you can optimize network LSP traffic-engineering paths and provide control over PCC initiated LSPs. A PCC works in hybrid mode when LSP decisions are taken both locally in the PCC and remotely by the PCE. By default, all tunnels are reported to the PCE. Delegated tunnels are also controlled by the PCE (see "rsvp pcep delegation").
The PCE itself does not establish new tunnels; it controls the following LSP attributes:
-	Bandwidth
-	ERO
-	Priority
-	Admin-group
To enter PCEP configuration hierarchy:

**Command syntax: pcep**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Note**

- PCEP sessions use TCP destination port 4189.

- PCEP supports in-band connectivity only.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)#


**Removing Configuration**

To revert PCEP to its default disabled mode and reset all of its configuration:
::

    dnRouter(cfg-protocols-mpls-te)# no pcep

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/source_interface.rst

protocols mpls traffic-engineering pcep source interface
--------------------------------------------------------

**Minimum user role:** operator

To configure the PCEP source (either an IPv4 address or an interface):

**Command syntax: source interface [interface-name]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Parameter table**

+----------------+---------------------------+------------------+---------+
| Parameter      | Description               | Range            | Default |
+================+===========================+==================+=========+
| interface-name | The PCEP source interface | | string         | \-      |
|                |                           | | length 1-255   |         |
+----------------+---------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# source interface lo0


**Removing Configuration**

To revert to the default source address (the MPLS TE router-id):
::

    dnRouter(cfg-mpls-te-pcep)# no source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/source_ipv4_address.rst

protocols mpls traffic-engineering pcep source ipv4-address
-----------------------------------------------------------

**Minimum user role:** operator

To configure the PCEP source (either an IPv4 address or an interface):

**Command syntax: source ipv4-address [ip-address]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Parameter table**

+------------+----------------------------+---------+-----------------------------------+
| Parameter  | Description                | Range   | Default                           |
+============+============================+=========+===================================+
| ip-address | The PCEP source IP address | A.B.C.D | The traffic-engineering router-id |
+------------+----------------------------+---------+-----------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# source ipv4-address 2.2.2.2


**Removing Configuration**

To revert to the default source address (the MPLS TE router-id):
::

    dnRouter(cfg-mpls-te-pcep)# no source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/timers/dead-timer.rst

protocols mpls traffic-engineering pcep timers dead-timer
---------------------------------------------------------

**Minimum user role:** operator

The dead-timer is another PCEP session maintenance timer that works in tandem with the keep-alive timer (see "mpls traffic-engineering pcep timers keep-alive").
Both PCE and PCC run dead timers and restart them whenever a message is received on the session.
If one session end does not receive a message before the dead timer expires, it declares the session dead.
The dead timer value is negotiated between the PCC and PCE during PCEP session establishment.
If the two timers are not identical, then the timer that will be selected for the session is the maximum between the configured dead-timer and the dead-timer received from the PCE in the OPEN message.
To configure the dead-timer's timeout interval:

**Command syntax: dead-timer [interval]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| interval  | The time (in seconds) that the PCE or PCC waits after receiving a keep-alive     | 0-255 | 40      |
|           | message from its PCEP peer, before declaring the peer dead.                      |       |         |
|           | For the session to be established, the value of the dead-timer interval must be  |       |         |
|           | higher than the PCE keep-alive timer (see "mpls traffic-engineering pcep pce     |       |         |
|           | timers keep-alive")                                                              |       |         |
|           | A value of 0 means that the session will not be timed out, even if keep-alive    |       |         |
|           | messages are no longer received on the session.                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# timers
    dnRouter(cfg-te-pcep-timers)# dead-timer 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-te-pcep-timers)# no dead-timer

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/timers/keep-alive.rst

protocols mpls traffic-engineering pcep timers keep-alive
---------------------------------------------------------

**Minimum user role:** operator

PCEP keep-alive messages are used to maintain PCEP sessions. Once a session is established, the PCE or PCC is periodically informed whether or not its PCEP peer is still available for use. 

Each end of a PCEP session runs a keep-alive timer. When the timer expires, it sends a keep-alive message to its peer and restarts the timer. 
The Keep-alive timer value is negotiated between the PCC and PCE during PCEP session establishment. 
If the two timers are not identical, then the timer that will be selected for the session is the minimum between the configured keep-alive timer and the keep-alive received from the PCE in the OPEN message.

To configure the interval between keep-alive messages between PCC and PCE:

**Command syntax: keep-alive [interval]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep timers

**Note**

- The session can only be established if the received PCE keep-alive < the received PCE dead-timer.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| interval  | The time (in seconds) that the PCE or PCC waits after sending a keep-alive       | 0-255 | 10      |
|           | message to its PCEP peer, before sending another keep-alive message notifying    |       |         |
|           | the peer of its availability.                                                    |       |         |
|           | A value of 0 means that keep-alive messages will not be sent.                    |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# timers
    dnRouter(cfg-te-pcep-timers)# keep-alive 30


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-te-pcep-timers)# no keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/timers/lsp-state-timeout.rst

protocols mpls traffic-engineering pcep timers lsp-state-timeout
----------------------------------------------------------------

**Minimum user role:** operator

When a PCEP session with a PCE disconnects, the PCC redelegates to an alternative PCE.
The LSP-state-timeout is the amount of time after redelegation that the PCC waits before flushing the LSP states associated with the disconnected PCEP session and reverting to the local default configurations.
This operation is performed in a make-before-break fashion.

To configure the lsp-state-timeout:

**Command syntax: lsp-state-timeout [timeout]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-----------------+---------+
| Parameter | Description                                                                      | Range           | Default |
+===========+==================================================================================+=================+=========+
| timeout   | time (in seconds) that a path computation client (PCC) must wait before removing | 0-3600/infinity | 60      |
|           | the LSPs associated with a PCEP session that is disconnected and reverting back  |                 |         |
|           | to the local defaults attributes/configuration                                   |                 |         |
+-----------+----------------------------------------------------------------------------------+-----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# timers
    dnRouter(cfg-te-pcep-timers)# lsp-state-timeout 20

    dnRouter(cfg-te-pcep-timers)# lsp-state-timeout infinity


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-te-pcep-timers)# no lsp-state-timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/timers/redelegation-timeout.rst

protocols mpls traffic-engineering pcep timers redelegation-timeout
-------------------------------------------------------------------

**Minimum user role:** operator

The redelegation-timeout interval is the amount of time that a PCC waits before revoking LSP delegations to a PCE with which the PCEP session has terminated unexpectedly and attempting to redelegate the LSPs to an alternate PCE.
If the PCEP session with the original PCE is restored before the redelegation timer expires, the LSP delegations will not be revoked.

To configure the redelegation-timeout interval:

**Command syntax: redelegation-timeout [interval]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------+---------+
| Parameter | Description                                                                      | Range  | Default |
+===========+==================================================================================+========+=========+
| interval  | time (in seconds) that a path computation client (PCC) must wait before          | 0-3600 | 30      |
|           | re-delegating LSPs after a PCEP session with the active stateful PCE is          |        |         |
|           | disconnected                                                                     |        |         |
+-----------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# timers
    dnRouter(cfg-te-pcep-timers)# redelegation-timeout 2000


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-te-pcep-timers)# no redelegation-timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/pcep/timers/timers.rst

protocols mpls traffic-engineering pcep timers
----------------------------------------------

**Minimum user role:** operator

There are two sets of PCEP timers:
-	Session maintenance timers - used for message transmission between PCC and PCE to notify one another of their availability. The session maintenance timers are based on keep-alive timers (see "mpls traffic-engineering pcep timers keep-alive") and dead timers (see "mpls traffic-engineering pcep timers dead-timer").
-	Session disconnection timers - determining what to do when a session unexpectedly disconnects. These timers are for the redelegation of a new PCE (see "mpls traffic-engineering pcep timers redelegation-timeout") and for removal of the LSPs from the disconnected PCE (see "mpls traffic-engineering pcep timers lsp-state-timeout").
To set global timers for messaging between PCC and PCE:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering pcep

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# pcep
    dnRouter(cfg-mpls-te-pcep)# timers
    dnRouter(cfg-te-pcep-timers)#


**Removing Configuration**

To revert all timers to their default values:
::

    dnRouter(cfg-mpls-te-pcep)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### traffic-engineering/router-id.rst

protocols mpls traffic-engineering router-id
--------------------------------------------

**Minimum user role:** operator

You can set a router ID for the OSPF process, or you can use the default router ID.
The traffic-engineering router-id must be a re-routable IPv4 unicast address matching one of the DNOS router local addresses.
To set the router ID for traffic-engineering:

**Command syntax: router-id [router-id]**

**Command mode:** config

**Hierarchies**

- protocols mpls traffic-engineering

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+-------------------------------------------+
| Parameter | Description                                                                      | Range   | Default                                   |
+===========+==================================================================================+=========+===========================================+
| router-id | Set the network unique traffic engineering router   ID. This command overrides   | A.B.C.D | routing-options router-id, if configured. |
|           | the configured router identifier.                                                |         |                                           |
|           | The router-id is identical in all IGP instances.                                 |         |                                           |
+-----------+----------------------------------------------------------------------------------+---------+-------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# router-id 1.1.1.1


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-mpls-te)#  no router-id

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### traffic-engineering/traffic-engineering.rst

protocols mpls traffic-engineering
----------------------------------

**Minimum user role:** operator

Traffic engineering (TE) is a method for the effective use of available network resources by controlling the path that data packets follow across the MPLS network. TE is based on building label-switched paths (LSPs) among routers using RSVP and creating administrative groups that you can either include or exclude in the traffic engineering database.
TE requires an IGP for routing decisions. System TE relies on IS-IS. Therefore, only interfaces on which IS-IS is enabled can be used for TE.
The TE configuration commands allow you to enable TE on an interface, and to create admin-group-maps for grouping links into classes.
To set traffic engineering parameters, you must first enter MPLS traffic engineering configuration mode. 

**Command syntax: traffic-engineering**

**Command mode:** config

**Hierarchies**

- protocols mpls

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)#


**Removing Configuration**

To remove all traffic engineering configurations:
::

    dnRouter(cfg-protocols-mpls)# no traffic-engineering

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### ttl-propagate.rst

protocols mpls ttl-propagate
----------------------------

**Minimum user role:** operator

MPLS TTL propagation allows disabling the default TTL propagation in the IP-MPLS architecture. 
When the admin-state is enabled (default), TTL propagation works in uniform mode. Ingress LSR copies the IP TTL to the MPLS header and decrements it by 1. Each transit LSR performing a swap operation decrements the MPLS TTL value in the MPLS header of the packet by 1. MPLS to IP behavior depends on TTL propagation mode and performed operation. When the IP header value reaches 0, the packet is dropped. When the admin-state is disabled, then TTL propagation works in pipe mode, ingress LSR sets the MPLS TTL to 255, and each transit LSR performing a swap operation decrements the MPLS TTL value by 1. MPLS to IP behavior depends on TTL propagation mode and operation performed.
By default, IP MPLS TTL propagation is enabled. To disable it, use the following command in MPLS configuration mode:

**Command syntax: ttl-propagate [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols mpls

**Parameter table**

+-------------+------------------------------------------------------+----------------------------+-----------------------+
| Parameter   | Description                                          | Range                      | Default               |
+=============+======================================================+============================+=======================+
| admin-state | Sets the administrative state of the TTL propagation | | consts.OPTION_ENABLED    | consts.OPTION_ENABLED |
|             |                                                      | | consts.OPTION_DISABLED   |                       |
+-------------+------------------------------------------------------+----------------------------+-----------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# ttl-propagate enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# ttl-propagate disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-mpls)# no ttl-propagate

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---


## SECTION 2.J: MSDP

Files in this section: 28

### class-of-service.rst

protocols msdp class-of-service
-------------------------------

**Minimum user role:** operator

You can use the following command to set the DSCP value for outgoing MSDP Mtrace packets class of service.

The class-of-service set for the packet determines how the packet is treated through the network.

**Command syntax: class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols msdp

**Note**
IPP is set accordingly. i.e DSCP 48 is mapped to 6.

**Parameter table**

+------------------+-------------------------------+-------+---------+
| Parameter        | Description                   | Range | Default |
+==================+===============================+=======+=========+
| class-of-service | MSDP packets class of service | 0-56  | 48      |
+------------------+-------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# class-of-service 50


**Removing Configuration**

To return the dscp-value to the default:
::

    dnRouter(cfg-protocols-msdp)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### default-peer/admin-state.rst

protocols msdp default-peer admin-state
---------------------------------------

**Minimum user role:** operator

To administratively enable/disable the MSDP default-peer, use the following command:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols msdp default-peer

**Parameter table**

+-------------+----------------------------------------+--------------+---------+
| Parameter   | Description                            | Range        | Default |
+=============+========================================+==============+=========+
| admin-state | Admin Enable/Disable MSDP default-peer | | enabled    | enabled |
|             |                                        | | disabled   |         |
+-------------+----------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 61.32.4.1
    dnRouter(cfg-protocols-msdp-default-peer)# admin-state disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 61.32.4.1
    dnRouter(cfg-protocols-msdp-default-peer)# admin-state enabled


**Removing Configuration**

To revert the default-peer admin-state to its default configuration:
::

    dnRouter(cfg-protocols-msdp-default-peer)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### default-peer/default-peer.rst

protocols msdp default-peer
---------------------------

**Minimum user role:** operator

A default peer is an MSDP peer from which all MSDP SA messages are accepted. You can use this command to define a MSDP default-peer and enter its configuration.

**Command syntax: default-peer [default-peer]**

**Command mode:** config

**Hierarchies**

- protocols msdp

**Note**
- Default-peer config will not pass commit unless the mandatory "remote-as" configuration is applied

- Default-peer address must be unique for all msdp groups or default-peers.

**Parameter table**

+--------------+--------------------------+---------+---------+
| Parameter    | Description              | Range   | Default |
+==============+==========================+=========+=========+
| default-peer | Set an MSDP default-peer | A.B.C.D | \-      |
+--------------+--------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 121.17.4.1
    dnRouter(cfg-protocols-msdp-default-peer)#


**Removing Configuration**

To remove the default-peer configuration:
::

    dnRouter(cfg-protocols-msdp)# no default-peer 121.17.4.1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### default-peer/peer-timers/hold-time.rst

protocols msdp default-peer peer-timers hold-time
-------------------------------------------------

**Minimum user role:** operator

You can use this command to set the MSDP peering connectivity hold-time timer. The command can also be invoked under the MSDP default-peer and MSDP mesh-group peer hierarchies. The hold-time timer is set to time-out the connection in the event that no TLV is received from the related peer. The timer is defined per MSDP peer connection. Every MSDP TLV received from the related MSDP peer resets the hold-time. Once a timer expires, the MSDP connection on the router is timed-out and the MSDP TCP connection is torn down.

**Command syntax: hold-time [hold-time-timer]**

**Command mode:** config

**Hierarchies**

- protocols msdp default-peer peer-timers

**Note**
- The hold-time timer must be greater than the keep-alive timer. The user is warned in case the keep-alive timer is greater or equal to hold-time.

**Parameter table**

+-----------------+-----------------+--------+---------+
| Parameter       | Description     | Range  | Default |
+=================+=================+========+=========+
| hold-time-timer | hold-time-timer | 20-180 | \-      |
+-----------------+-----------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)# hold-time 90

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-default-peer-peer-timers)# hold-time 90

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-mesh-group)# peer 2.2.2.2
    dnRouter(cfg-protocols-msdp-mesh-group-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-mesh-group-peer-peer-timers)# hold-time 90


**Removing Configuration**

To return the hold-time setting to its default value:
::

    dnRouter(cfg-protocols-msdp-peer-timers)# no hold-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### default-peer/peer-timers/keep-alive.rst

protocols msdp default-peer peer-timers keep-alive
--------------------------------------------------

**Minimum user role:** operator

You can use this command to set the MSDP peering connectivity keep-alive timer. The command can also be invoked under the MSDP default-peer and MSDP mesh-group peer hierarchies. The keep-alive timer is set to time-out the connection in the event that a keepalive TLV is sent to a certain MSDP peer. In that event, the MSDP daemon sets a keep alive timer for that connection and the expiration of the timer should trigger an additional keepalive TLV (unless a different TLV is sent to the specific MSDP peer, which in turn will reset the keepalive timer for that specific MSDP peer connection).

**Command syntax: keep-alive [keep-alive-timer]**

**Command mode:** config

**Hierarchies**

- protocols msdp default-peer peer-timers

**Note**
- This command may be also be invoked inside mesh-group peer or inside default-peer configuration hierarchy.

- The hold-time timer must be greater than the keep-alive timer. The user is warned in case the keep-alive timer is greater or equal to hold-time.

**Parameter table**

+------------------+------------------+-------+---------+
| Parameter        | Description      | Range | Default |
+==================+==================+=======+=========+
| keep-alive-timer | keep-alive-timer | 10-60 | \-      |
+------------------+------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)# keep-alive 30
    dnRouter(cfg-protocols-msdp-peer-timers)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-default-peer-peer-timers)# keep-alive 30

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-mesh-group)# peer 2.2.2.2
    dnRouter(cfg-protocols-msdp-mesh-group-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-mesh-group-peer-peer-timers)# keep-alive 30


**Removing Configuration**

To return the keep-alive setting to its default value:
::

    dnRouter(cfg-protocols-msdp-peer-timers)# no keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### default-peer/peer-timers/peer-timers.rst

protocols msdp default-peer peer-timers
---------------------------------------

**Minimum user role:** operator

You can use this command to configure the MSDP peer timers hierarchy.

The timers hierarchy also exists under msdp default-peer and msdp mesh-group.

**Command syntax: peer-timers**

**Command mode:** config

**Hierarchies**

- protocols msdp default-peer

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)#


**Removing Configuration**

To disable the peer-timers process:
::

    dnRouter(cfg-protocols-msdp)# no peer-timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### default-peer/policy_in.rst

protocols msdp default-peer policy in
-------------------------------------

**Minimum user role:** operator

Use the command to set the MSDP SA filter "IN" policy for the MSDP default policy. The 'group-prefix-list' defines the allowed/denied filter for SA Group addresses. The 'rps-prefix-list' defines the allowed/denied RP addresses.

**Command syntax: policy in {rps [source-rps-prefix-list], group [group-prefix-list]}**

**Command mode:** config

**Hierarchies**

- protocols msdp default-peer

**Note**
- The 'group-prefix-list' defines the allowed/denied filter for SA Group addresses.

- The 'rps-prefix-list' defines the allowed/denied RP addresses.

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter              | Description                                                                      | Range            | Default |
+========================+==================================================================================+==================+=========+
| source-rps-prefix-list | The prefix-list name which uniquely identify the SA source RP IPv4 address SA    | | string         | \-      |
|                        | filter policy that contains one or more policy rules used to accept or reject    | | length 1-255   |         |
|                        | MSDP SA from certain Source RP IP addresses. If a policy is not specified, MSDP  |                  |         |
|                        | SA from all RP sources are accepted.                                             |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| group-prefix-list      | The prefix-list name which uniquely identify a group address SA filter policy    | | string         | \-      |
|                        | that contains one or more policy rules used to accept or reject MSDP SA with     | | length 1-255   |         |
|                        | certain multicast groups. If a policy is not specified, MSDP SA with all group   |                  |         |
|                        | addresses are accepted.                                                          |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# policy in group SA-FILTER-IN-Prefix-List

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# policy in rps RPS-FILTER-IN-Prefix-List


**Removing Configuration**

To clear all SA in filtering policies:
::

    dnRouter(cfg-protocols-msdp-default-peer)# no policy in

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### default-peer/policy_out.rst

protocols msdp default-peer policy out
--------------------------------------

**Minimum user role:** operator

Use the command to set the MSDP SA filter "OUT" policy for the MSDP default policy. The 'group-prefix-list' defines the allowed/denied filter for SA Group addresses. The 'rps-prefix-list' defines the allowed/denied RP addresses.

**Command syntax: policy out {rps [source-rps-prefix-list], group [group-prefix-list]}**

**Command mode:** config

**Hierarchies**

- protocols msdp default-peer

**Note**
- The 'group-prefix-list' defines the allowed/denied filter for SA Group addresses.

- The 'rps-prefix-list' defines the allowed/denied RP addresses.

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter              | Description                                                                      | Range            | Default |
+========================+==================================================================================+==================+=========+
| source-rps-prefix-list | The prefix-list name which uniquely identify the SA source RP IPv4 address SA    | | string         | \-      |
|                        | filter policy that contains one or more policy rules used to accept or reject    | | length 1-255   |         |
|                        | MSDP SA from certain Source RP IP addresses. If a policy is not specified, MSDP  |                  |         |
|                        | SA from all RP sources are accepted.                                             |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| group-prefix-list      | The prefix-list name which uniquely identify a group address SA filter policy    | | string         | \-      |
|                        | that contains one or more policy rules used to accept or reject MSDP SA with     | | length 1-255   |         |
|                        | certain multicast groups. If a policy is not specified, MSDP SA with all group   |                  |         |
|                        | addresses are accepted.                                                          |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# policy out group SA-FILTER-OUT-Prefix-List

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# policy out rps RPS-FILTER-OUT-Prefix-List


**Removing Configuration**

To clear all SA out filtering policies:
::

    dnRouter(cfg-protocols-msdp-default-peer)# no policy out

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### default-peer/remote-as.rst

protocols msdp default-peer remote-as
-------------------------------------

**Minimum user role:** operator

You can use the following command to set the number of the MSDP default-peer remote-as. The remote-as is only used as a reference number.

**Command syntax: remote-as [remote-as]**

**Command mode:** config

**Hierarchies**

- protocols msdp default-peer

**Note**
- The remote-as parameter is only used for presentation and not for any practical purpose.

- There is no default value for remote-as.

**Parameter table**

+-----------+------------------------+--------------+---------+
| Parameter | Description            | Range        | Default |
+===========+========================+==============+=========+
| remote-as | AS number of the peer. | 1-4294967295 | \-      |
+-----------+------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# remote-as 5000


**Removing Configuration**

To remove the remote-as number:
::

    dnRouter(cfg-protocols-msdp-default-peer)# no remote-as

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### default-peer/update-source.rst

protocols msdp default-peer update-source
-----------------------------------------

**Minimum user role:** operator

You can use the following command to set the default-peer source IP address. The source IP can be set either by specifying the source IP or the interface on which the desired IP is set.

**Command syntax: update-source {source-address [source-ip], interface [interface-name]}**

**Command mode:** config

**Hierarchies**

- protocols msdp default-peer

**Note**
- There is no default setting for update-source. Once the update-source is defined, the default-peer or mesh-group are set.

- These is no remove option for update-source. You can only change the assigned address of the update-source, unless the whole default-peer or mesh-groups are removed.

**Parameter table**

+----------------+----------------------------------------------------------------------+------------------+---------+
| Parameter      | Description                                                          | Range            | Default |
+================+======================================================================+==================+=========+
| source-ip      | specify the source address to use for the MSDP  session to this peer | A.B.C.D          | \-      |
+----------------+----------------------------------------------------------------------+------------------+---------+
| interface-name | Interface from which the source address is taken                     | | string         | \-      |
|                |                                                                      | | length 1-255   |         |
+----------------+----------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# update-source source-address 3.3.3.3

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# update-source interface lo0


**Removing Configuration**

To return the update-source to the default:
::

    dnRouter(cfg-protocols-msdp-default-peer)# no update-source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### maximum-sa-states.rst

protocols msdp maximum-sa-states
--------------------------------

**Minimum user role:** operator

When a PIM Register (S,G) message is received from the RPF, an SA state is created.

You can use the following command to configure the maximum number of SA states.

**Command syntax: maximum-sa-states [maximum]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols msdp

**Note**
- Threshold - the percentage of the value specified by **maximum**

- 'no maximum-sa-states' command reverts back both the maximum-sa-states and threshold to their default values.

**Parameter table**

+-----------+-----------------------------+---------+---------+
| Parameter | Description                 | Range   | Default |
+===========+=============================+=========+=========+
| maximum   | maximum limit of SA states  | 1-60000 | 60000   |
+-----------+-----------------------------+---------+---------+
| threshold | percentage of maximum limit | 1-100   | 75      |
+-----------+-----------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# maximum-sa-states 18000
    dnRouter(cfg-protocols-msdp)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# maximum-sa-states 20000 threshold 90
    dnRouter(cfg-protocols-msdp)#


**Removing Configuration**

To return the maximum-sa-states to the default value:
::

    dnRouter(cfg-protocols-msdp)# no maximum-sa-states

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/admin-state.rst

protocols msdp mesh-group admin-state
-------------------------------------

**Minimum user role:** operator

To administratively enable/disable the MSDP mesh-group, use the following command.

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group

**Parameter table**

+-------------+--------------------------------------+--------------+---------+
| Parameter   | Description                          | Range        | Default |
+=============+======================================+==============+=========+
| admin-state | Admin Enable/Disable MSDP mesh-group | | enabled    | enabled |
|             |                                      | | disabled   |         |
+-------------+--------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# admin-state disabled

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-protocols-msdp-group)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/mesh-group.rst

protocols msdp mesh-group
-------------------------

**Minimum user role:** operator

A mesh-group is a group of MSDP peers. MSDP SA messages received by a peer in the mesh-group are not forwarded to other peers in the group, and by so the number of SA messages are reduced and prevent flooding. You can use this command to define a MSDP mesh-group and enter its configuration. 

**Command syntax: mesh-group [mesh-group]**

**Command mode:** config

**Hierarchies**

- protocols msdp

**Note**
- Peers declared inside a mesh-group, by default will share the same mesh-group configuration

- Mesh group name cannot be all numbers and must contain at least one non-numerical character

- Mesh group peer configurations may differ from the mesh-group configuration.

**Parameter table**

+------------+------------------+-------+---------+
| Parameter  | Description      | Range | Default |
+============+==================+=======+=========+
| mesh-group |  MSDP mesh-group | \-    | \-      |
+------------+------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)#


**Removing Configuration**

To remove the mesh-group configuration:
::

    dnRouter(cfg-protocols-msdp)# no mesh-group MSDP_Domain_X

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/peer/admin-state.rst

protocols msdp mesh-group peer admin-state
------------------------------------------

**Minimum user role:** operator

Use the following command to administratively enable/disable the MSDP mesh-group peer:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group peer

**Note**

- By default the peer's admin-state is inherited from the mesh-group admin-state configuration, unless it is explicitly configured for the peer.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | Administrative enabling / disabling of the connection with the MSDP mesh-group   | | enabled    | \-      |
|             | peer                                                                             | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# peer 2.3.4.5
    dnRouter(cfg-protocols-msdp-group-peer)# admin-state disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# peer 2.3.4.5
    dnRouter(cfg-protocols-msdp-group-peer)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-protocols-msdp-group-peer)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### mesh-group/peer/peer-timers/hold-time.rst

protocols msdp mesh-group peer peer-timers hold-time
----------------------------------------------------

**Minimum user role:** operator

You can use this command to set the MSDP peering connectivity hold-time timer. The command can also be invoked under the MSDP default-peer and MSDP mesh-group peer hierarchies. The hold-time timer is set to time-out the connection in the event that no TLV is received from the related peer. The timer is defined per MSDP peer connection. Every MSDP TLV received from the related MSDP peer resets the hold-time. Once a timer expires, the MSDP connection on the router is timed-out and the MSDP TCP connection is torn down.

**Command syntax: hold-time [hold-time-timer]**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group peer peer-timers

**Note**
- The hold-time timer must be greater than the keep-alive timer. The user is warned in case the keep-alive timer is greater or equal to hold-time.

**Parameter table**

+-----------------+-----------------+--------+---------+
| Parameter       | Description     | Range  | Default |
+=================+=================+========+=========+
| hold-time-timer | hold-time-timer | 20-180 | \-      |
+-----------------+-----------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)# hold-time 90

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-default-peer-peer-timers)# hold-time 90

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-mesh-group)# peer 2.2.2.2
    dnRouter(cfg-protocols-msdp-mesh-group-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-mesh-group-peer-peer-timers)# hold-time 90


**Removing Configuration**

To return the hold-time setting to its default value:
::

    dnRouter(cfg-protocols-msdp-peer-timers)# no hold-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/peer/peer-timers/keep-alive.rst

protocols msdp mesh-group peer peer-timers keep-alive
-----------------------------------------------------

**Minimum user role:** operator

You can use this command to set the MSDP peering connectivity keep-alive timer. The command can also be invoked under the MSDP default-peer and MSDP mesh-group peer hierarchies. The keep-alive timer is set to time-out the connection in the event that a keepalive TLV is sent to a certain MSDP peer. In that event, the MSDP daemon sets a keep alive timer for that connection and the expiration of the timer should trigger an additional keepalive TLV (unless a different TLV is sent to the specific MSDP peer, which in turn will reset the keepalive timer for that specific MSDP peer connection).

**Command syntax: keep-alive [keep-alive-timer]**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group peer peer-timers

**Note**
- This command may be also be invoked inside mesh-group peer or inside default-peer configuration hierarchy.

- The hold-time timer must be greater than the keep-alive timer. The user is warned in case the keep-alive timer is greater or equal to hold-time.

**Parameter table**

+------------------+------------------+-------+---------+
| Parameter        | Description      | Range | Default |
+==================+==================+=======+=========+
| keep-alive-timer | keep-alive-timer | 10-60 | \-      |
+------------------+------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)# keep-alive 30
    dnRouter(cfg-protocols-msdp-peer-timers)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-default-peer-peer-timers)# keep-alive 30

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-mesh-group)# peer 2.2.2.2
    dnRouter(cfg-protocols-msdp-mesh-group-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-mesh-group-peer-peer-timers)# keep-alive 30


**Removing Configuration**

To return the keep-alive setting to its default value:
::

    dnRouter(cfg-protocols-msdp-peer-timers)# no keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/peer/peer-timers/peer-timers.rst

protocols msdp mesh-group peer peer-timers
------------------------------------------

**Minimum user role:** operator

You can use this command to configure the MSDP peer timers hierarchy.

The timers hierarchy also exists under msdp default-peer and msdp mesh-group.

**Command syntax: peer-timers**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group peer

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)#


**Removing Configuration**

To disable the peer-timers process:
::

    dnRouter(cfg-protocols-msdp)# no peer-timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/peer/peer.rst

protocols msdp mesh-group peer
------------------------------

**Minimum user role:** operator

You can use this command to define a MSDP mesh-group peer address and enter its configuration.

**Command syntax: peer [peer]**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group

**Note**
- The mesh group peer address must be unique throughout all MSDP mesh-groups and default-peer members.

**Parameter table**

+-----------+--------------------------------+---------+---------+
| Parameter | Description                    | Range   | Default |
+===========+================================+=========+=========+
| peer      | set the MSDP peer IPv4 address | A.B.C.D | \-      |
+-----------+--------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# peer 2.3.4.5
    dnRouter(cfg-protocols-msdp-group-peer)#


**Removing Configuration**

To remove the peer from the mesh-group:
::

    dnRouter(cfg-protocols-msdp-group)# no peer 2.3.4.5

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/policy_in.rst

protocols msdp mesh-group policy in
-----------------------------------

**Minimum user role:** operator

Use the command to set the MSDP SA filter "IN" policy for the MSDP mesh-group. The 'group-prefix-list' defines the allowed/denied filter for SA Group addresses. The 'rps-prefix-list' defines the allowed/denied RP addresses.

**Command syntax: policy in {rps [source-rps-prefix-list], group [group-prefix-list]}**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter              | Description                                                                      | Range            | Default |
+========================+==================================================================================+==================+=========+
| source-rps-prefix-list | The prefix-list name which uniquely identify the SA source RP IPv4 address SA    | | string         | \-      |
|                        | filter policy that contains one or more policy rules used to accept or reject    | | length 1-255   |         |
|                        | MSDP SA from certain Source RP IP addresses. If a policy is not specified, MSDP  |                  |         |
|                        | SA from all RP sources are accepted.                                             |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| group-prefix-list      | The prefix-list name which uniquely identify a group address SA filter policy    | | string         | \-      |
|                        | that contains one or more policy rules used to accept or reject MSDP SA with     | | length 1-255   |         |
|                        | certain multicast groups. If a policy is not specified, MSDP SA with all group   |                  |         |
|                        | addresses are accepted.                                                          |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# policy in group SA-FILTER-IN-Prefix-List

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# policy in rps RPS-FILTER-IN-Prefix-List


**Removing Configuration**

To clear the SA in RP/Group filtering policies:
::

    dnRouter(cfg-protocols-msdp-group)# no policy in

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/policy_out.rst

protocols msdp mesh-group policy out
------------------------------------

**Minimum user role:** operator

Use the command to set the MSDP SA filter "OUT" policy for the MSDP group policy. The 'group-prefix-list' defines the allowed/denied filter for SA Group addresses. The 'rps-prefix-list' defines the allowed/denied RP addresses.

**Command syntax: policy out {rps [source-rps-prefix-list], group [group-prefix-list]}**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter              | Description                                                                      | Range            | Default |
+========================+==================================================================================+==================+=========+
| source-rps-prefix-list | The prefix-list name which uniquely identify the SA source RP IPv4 address SA    | | string         | \-      |
|                        | filter policy that contains one or more policy rules used to accept or reject    | | length 1-255   |         |
|                        | MSDP SA from certain Source RP IP addresses. If a policy is not specified, MSDP  |                  |         |
|                        | SA from all RP sources are accepted.                                             |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| group-prefix-list      | The prefix-list name which uniquely identify a group address SA filter policy    | | string         | \-      |
|                        | that contains one or more policy rules used to accept or reject MSDP SA with     | | length 1-255   |         |
|                        | certain multicast groups. If a policy is not specified, MSDP SA with all group   |                  |         |
|                        | addresses are accepted.                                                          |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# policy out group SA-FILTER-OUT-Prefix-List

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# policy out rps RPS-FILTER-OUT-Prefix-List


**Removing Configuration**

To clear the SA in RP/Group filtering policies:
::

    dnRouter(cfg-protocols-msdp-group)# no policy out

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/remote-as.rst

protocols msdp mesh-group remote-as
-----------------------------------

**Minimum user role:** operator

You can use the following command to set the number of the MSDP mesh-group remote-as. The remote-as is only used as a reference number.

**Command syntax: remote-as [remote-as]**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group

**Note**
- The remote-as parameter is only used for presentation and is not used for any practical purpose.

- There is no default value for remote-as.

**Parameter table**

+-----------+------------------------+--------------+---------+
| Parameter | Description            | Range        | Default |
+===========+========================+==============+=========+
| remote-as | AS number of the peer. | 1-4294967295 | \-      |
+-----------+------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# remote-as 5000


**Removing Configuration**

To remove the remote-as number:
::

    dnRouter(cfg-protocols-msdp-group)# no remote-as

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### mesh-group/update-source.rst

protocols msdp mesh-group update-source
---------------------------------------

**Minimum user role:** operator

You can use the following command to set the default-peer source IP address. The source IP can be set either by specifying the source IP or the interface on which the desired IP is set.

**Command syntax: update-source {source-address [source-ip], interface [interface-name]}**

**Command mode:** config

**Hierarchies**

- protocols msdp mesh-group

**Note**
- The command may be invoked inside the configuration hierarchy of a MSDP mesh-group or inside a MSDP default-peer

- There is no default setting for update-source. Once the update-source is defined, the default-peer or mesh-group are set

- These is no remove option for update-source. You can only change the assigned address of the update-source, unless the whole default-peer or mesh-groups are removed.

**Parameter table**

+----------------+----------------------------------------------------------------------+------------------+---------+
| Parameter      | Description                                                          | Range            | Default |
+================+======================================================================+==================+=========+
| source-ip      | specify the source address to use for the MSDP  session to this peer | A.B.C.D          | \-      |
+----------------+----------------------------------------------------------------------+------------------+---------+
| interface-name | Interface from which the source address is taken                     | | string         | \-      |
|                |                                                                      | | length 1-255   |         |
+----------------+----------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# update-source source-address 3.3.3.3

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-group)# update-source interface lo10


**Removing Configuration**

To return the update-source to the default:
::

    dnRouter(cfg-protocols-msdp-group)# no update-source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### msdp.rst

protocols msdp
--------------

**Minimum user role:** operator

Enters the MSDP configuration hierarchy level.

**Command syntax: msdp**

**Command mode:** config

**Hierarchies**

- protocols

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)#


**Removing Configuration**

To disable the MSDP protocol:
::

    dnRouter(cfg-protocols)# no msdp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### originator-rp.rst

protocols msdp originator-rp
----------------------------

**Minimum user role:** operator

You can use this command to enable setting the IP address or specify the interface to be the RP address of the MSDP SA messages originated by the local MSDP router.

**Command syntax: originator-rp {source-address [source-address], interface [interface-name]}**

**Command mode:** config

**Hierarchies**

- protocols msdp

**Note**
- The originator-rp must have default or be configured. If it is not configured, the default originator-rp will be the router-id.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter      | Description                                                                      | Range            | Default |
+================+==================================================================================+==================+=========+
| source-address | specify the originator ID source address to use for the MSDP session to this     | A.B.C.D          | \-      |
|                | peer                                                                             |                  |         |
+----------------+----------------------------------------------------------------------------------+------------------+---------+
| interface-name | Specify the interface name from which the MSDP originator RP IP address shall be | | string         | \-      |
|                | taken                                                                            | | length 1-255   |         |
+----------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# originator-rp interface lo0
    dnRouter(cfg-protocols-msdp)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# originator-rp source-address 1.1.1.1
    dnRouter(cfg-protocols-msdp)#


**Removing Configuration**

To return the originator-rp setting to its default value:
::

    dnRouter(cfg-protocols-msdp)# no originator-rp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### peer-timers/hold-time.rst

protocols msdp peer-timers hold-time
------------------------------------

**Minimum user role:** operator

You can use this command to set the MSDP peering connectivity hold-time timer. The command can also be invoked under the MSDP default-peer and MSDP mesh-group peer hierarchies. The hold-time timer is set to time-out the connection in the event that no TLV is received from the related peer. The timer is defined per MSDP peer connection. Every MSDP TLV received from the related MSDP peer resets the hold-time. Once a timer expires, the MSDP connection on the router is timed-out and the MSDP TCP connection is torn down.

**Command syntax: hold-time [hold-time-timer]**

**Command mode:** config

**Hierarchies**

- protocols msdp peer-timers

**Note**
- The hold-time timer must be greater than the keep-alive timer. The user is warned in case the keep-alive timer is greater or equal to hold-time.

**Parameter table**

+-----------------+-----------------+--------+---------+
| Parameter       | Description     | Range  | Default |
+=================+=================+========+=========+
| hold-time-timer | hold-time-timer | 20-180 | 80      |
+-----------------+-----------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)# hold-time 90

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-default-peer-peer-timers)# hold-time 90

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-mesh-group)# peer 2.2.2.2
    dnRouter(cfg-protocols-msdp-mesh-group-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-mesh-group-peer-peer-timers)# hold-time 90


**Removing Configuration**

To return the hold-time setting to its default value:
::

    dnRouter(cfg-protocols-msdp-peer-timers)# no hold-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### peer-timers/keep-alive.rst

protocols msdp peer-timers keep-alive
-------------------------------------

**Minimum user role:** operator

You can use this command to set the MSDP peering connectivity keep-alive timer. The command can also be invoked under the MSDP default-peer and MSDP mesh-group peer hierarchies. The keep-alive timer is set to time-out the connection in the event that a keepalive TLV is sent to a certain MSDP peer. In that event, the MSDP daemon sets a keep alive timer for that connection and the expiration of the timer should trigger an additional keepalive TLV (unless a different TLV is sent to the specific MSDP peer, which in turn will reset the keepalive timer for that specific MSDP peer connection).

**Command syntax: keep-alive [keep-alive-timer]**

**Command mode:** config

**Hierarchies**

- protocols msdp peer-timers

**Note**
- This command may be also be invoked inside mesh-group peer or inside default-peer configuration hierarchy.

- The hold-time timer must be greater than the keep-alive timer. The user is warned in case the keep-alive timer is greater or equal to hold-time.

**Parameter table**

+------------------+------------------+-------+---------+
| Parameter        | Description      | Range | Default |
+==================+==================+=======+=========+
| keep-alive-timer | keep-alive-timer | 10-60 | 60      |
+------------------+------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)# keep-alive 30
    dnRouter(cfg-protocols-msdp-peer-timers)#

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# default-peer 12.1.40.111
    dnRouter(cfg-protocols-msdp-default-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-default-peer-peer-timers)# keep-alive 30

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# mesh-group MSDP_Domain_X
    dnRouter(cfg-protocols-msdp-mesh-group)# peer 2.2.2.2
    dnRouter(cfg-protocols-msdp-mesh-group-peer)# peer-timers
    dnRouter(cfg-protocols-msdp-mesh-group-peer-peer-timers)# keep-alive 30


**Removing Configuration**

To return the keep-alive setting to its default value:
::

    dnRouter(cfg-protocols-msdp-peer-timers)# no keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### peer-timers/peer-timers.rst

protocols msdp peer-timers
--------------------------

**Minimum user role:** operator

You can use this command to configure the MSDP peer timers hierarchy.

The timers hierarchy also exists under msdp default-peer and msdp mesh-group.

**Command syntax: peer-timers**

**Command mode:** config

**Hierarchies**

- protocols msdp

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# peer-timers
    dnRouter(cfg-protocols-msdp-peer-timers)#


**Removing Configuration**

To disable the peer-timers process:
::

    dnRouter(cfg-protocols-msdp)# no peer-timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### sa-hold-time.rst

protocols msdp sa-hold-time
---------------------------

**Minimum user role:** operator

When a new MSDP SA TLV is accepted, the router caches the entry and sets its hold timer to sa-hold-time. If the MSDP SA TLV with the same (S,G,RP) is revived before the timer expires, its hold time is reset to sa-hold-time. In any other case, the entry is removed from the cache.

**Command syntax: sa-hold-time [sa-hold-time]**

**Command mode:** config

**Hierarchies**

- protocols msdp

**Note**
- The hold-time timer must be greater than the keep-alive timer. The user is warned in case the keep-alive timer is greater or equal to hold-time.

**Parameter table**

+--------------+--------------------------------------------+----------+---------+
| Parameter    | Description                                | Range    | Default |
+==============+============================================+==========+=========+
| sa-hold-time | Sets the MSDP received SA state hold time. | 150-3600 | 150     |
+--------------+--------------------------------------------+----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# msdp
    dnRouter(cfg-protocols-msdp)# sa-hold-time 250


**Removing Configuration**

To revert the sa-hold-time to its default value:
::

    dnRouter(cfg-protocols-msdp)# no sa-hold-time

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---


## SECTION 2.K: OSPF

Files in this section: 129

### dynamic-spf/admin-state.rst

protocols ospf dynamic-spf admin-state
--------------------------------------

**Minimum user role:** operator

This setting controls the way OSPFv2 schedules its internal SPF related calculations.
When enabled, OSPFv2 puts a cap on the maximum CPU time that these calculations can use in a given window of time. This is achieved by using additional dynamic throttling when necessary. As long as the CPU limit is not exceeded, OSPFv2 runs any SPF calculation that is pending and ready, thus optimizing convergence time.
This prevents CPU starvation while processing topology changes, thus avoiding unwanted side effects like adjacencies flapping due to HELLO messages not being generated.
Note that unicast SPF respects both its own throttling configuration and the maximum CPU time cap.
When Dynamic-SPF is disabled (the default setting), the OSPFv2 behavior is unchanged and each SPF calculation has a predefined throttling mechanism, irrespective of CPU load.

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf dynamic-spf

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | When the value of this leaf is set to true (default), dynamic SPF is enabled on  | | enabled    | disabled |
|             | the local system. The system will schedule calculations based on the             | | disabled   |          |
|             | max-cpu-utilization and cpu-utilization-window parameters. When the value of     |              |          |
|             | this lead is set to false, dynamic SPF is disabled. The system will use regular  |              |          |
|             | mode and regular timers for SPF calculations.                                    |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# dynamic-spf
    dnRouter(cfg-protocols-ospf-dyn-spf)# admin-state enabled


**Removing Configuration**

To revert the admin-state to the default value:
::

    dnRouter(cfg-protocols-ospf-dyn-spf)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### dynamic-spf/cpu-utilization-window.rst

protocols ospf dynamic-spf cpu-utilization-window
-------------------------------------------------

**Minimum user role:** operator

This window is the time interval for which Dynamic-SPF calculates the CPU usage for SPF calculations.
Shorter windows should ensure shorter CPU spikes, but may increase overall convergence time for large topologies. Also, for Dynamic-SPF to work properly, the window should be significantly greater than any given SPF calculation completion time.
Larger windows should ensure faster convergence time, but they allow longer CPU spikes which might cause unwanted side effects.
The default window size is correlated with the minimum configurable OSPFv2 dead time. Modifying it should take into account the minimum configured OSPFv2 dead time.

**Command syntax: cpu-utilization-window [cpu-utilization-window]**

**Command mode:** config

**Hierarchies**

- protocols ospf dynamic-spf

**Note**

- The 'no cpu-utilization-window' returns the cpu-utilization-window to its default values.

**Parameter table**

+------------------------+-----------------------------------------+------------+---------+
| Parameter              | Description                             | Range      | Default |
+========================+=========================================+============+=========+
| cpu-utilization-window | CPU utilization window in milliseconds. | 1000-60000 | 3000    |
+------------------------+-----------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# dynamic-spf
    dnRouter(cfg-protocols-ospf-dyn-spf)# cpu-utilization-window 5000


**Removing Configuration**

To return the cpu-utilization-window to its default value:
::

    dnRouter(cfg-protocols-ospf-dyn-spf)# no cpu-utilization-window

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### dynamic-spf/dynamic-spf.rst

protocols ospf dynamic-spf
--------------------------

**Minimum user role:** operator

OSPFv2 Dynamic-SPF enables dynamic SPF calculations

**Command syntax: dynamic-spf**

**Command mode:** config

**Hierarchies**

- protocols ospf

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# dynamic-spf
    dnRouter(cfg-protocols-ospf-dyn-spf)#


**Removing Configuration**

To revert all ospf dynamic-spf parameters to their default values:
::

    dnRouter(cfg-protocols-ospf)# no dynamic-spf

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### dynamic-spf/max-cpu-utilization.rst

protocols ospf dynamic-spf max-cpu-utilization
----------------------------------------------

**Minimum user role:** operator

This is the maximum CPU usage allowed by Dynamic-SPF for SPF calculations during the time window.
A lower value should ensure lower CPU usage, but may increase overall convergence time for large topologies.
A larger value should ensure faster convergence time, but it increases the risk for CPU spikes which might cause unwanted side effects.

**Command syntax: max-cpu-utilization [max-cpu-utilization]**

**Command mode:** config

**Hierarchies**

- protocols ospf dynamic-spf

**Note**

- The 'no max-cpu-utilization' returns the max-cpu-utilization to its default values.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter           | Description                                                                      | Range  | Default |
+=====================+==================================================================================+========+=========+
| max-cpu-utilization | maximum CPU utilization percentage. Scheduler will maintain utilisation at       | 10-100 | 70      |
|                     | max-cpu-utilization% of cpu-utilization-window.                                  |        |         |
+---------------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# dynamic-spf
    dnRouter(cfg-protocols-ospf-dyn-spf)# max-cpu-utilization 50


**Removing Configuration**

To return the max-cpu-utilization to its default value:
::

    dnRouter(cfg-protocols-ospf-dyn-spf)# no max-cpu-utilization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### graceful-restart/cisco-helper-mode-admin-state.rst

protocols ospf graceful-restart helper-mode cisco admin-state
-------------------------------------------------------------

**Minimum user role:** operator

Configures OSPF graceful restart cisco restarting-mode admin-state. The command enables/disables the graceful restart restarter behavior on the router.

**Command syntax: helper-mode cisco admin-state [cisco-helper-mode-admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf graceful-restart

**Parameter table**

+-------------------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter                     | Description                                                                      | Range        | Default |
+===============================+==================================================================================+==============+=========+
| cisco-helper-mode-admin-state | Graceful Restart: Cisco helper mode admin state. When this leaf is set to true,  | | enabled    | enabled |
|                               | the local system will listen to the peer Link Local Signaling field and          | | disabled   |         |
|                               | cooperate with peer - when it sets the LLS Restart bit - to do LSDB              |              |         |
|                               | re-synchronization when it receives empty neighbor list from that peer           |              |         |
+-------------------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# graceful-restart
    dnRouter(cfg-protocols-ospf-gr)# helper-mode cisco admin-state enabled
    dnRouter(cfg-protocols-ospf-gr)# helper-mode cisco admin-state disabled


**Removing Configuration**

To revert helper-mode and admin-state to their default values
::

    dnRouter(cfg-protocols-ospf-gr)# no helper-mode cisco

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### graceful-restart/graceful-restart.rst

protocols ospf graceful-restart
-------------------------------

**Minimum user role:** operator

OSPF graceful restart enables a router undergoing a restart to inform its adjacent OSPF neighbors of its restarting condition. During a graceful restart period, the restarting device and its neighbors continue to forward packets without disrupting network performance. Because neighboring devices assist in the restart (these are helper routers), the restarting device can resume routing operation without impacting forwarding of packets in the data-path.

**Command syntax: graceful-restart**

**Command mode:** config

**Hierarchies**

- protocols ospf

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# graceful-restart
    dnRouter(cfg-protocols-ospf-gr)#


**Removing Configuration**

To reverts all ospf graceful restart parameters to their default values: 
::

    dnRouter(cfg-protocols-ospf)# no graceful-restart

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### graceful-restart/ietf-helper-mode-admin-state.rst

protocols ospf graceful-restart helper-mode ietf admin-state
------------------------------------------------------------

**Minimum user role:** operator

Configures OSPF graceful restart IETF restarting-mode admin-state. The command enables/disables the graceful restart restarter behavior on the router.

**Command syntax: helper-mode ietf admin-state [ietf-helper-mode-admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf graceful-restart

**Parameter table**

+------------------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter                    | Description                                                                      | Range        | Default |
+==============================+==================================================================================+==============+=========+
| ietf-helper-mode-admin-state | Graceful Restart standard IETF helper mode admin state. When this leaf is set to | | enabled    | enabled |
|                              | true, the local system will accept Grace-LSAs from remote systems, and suppress  | | disabled   |         |
|                              | withdrawl of adjacencies of the system for the grace period specified            |              |         |
+------------------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# graceful-restart
    dnRouter(cfg-protocols-ospf-gr)# helper-mode ietf admin-state enabled
    dnRouter(cfg-protocols-ospf-gr)# helper-mode ietf admin-state disabled


**Removing Configuration**

To revert helper-mode and admin-state to their default values
::

    dnRouter(cfg-protocols-ospf-gr)# no helper-mode ietf

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### graceful-restart/ietf-helper-strict-lsa-checking_admin-state.rst

protocols ospf graceful-restart ietf-helper-strict-lsa-checking admin-state
---------------------------------------------------------------------------

**Minimum user role:** operator

Indicates whether or not an OSPF restart helper (for IETF mode) should terminate the graceful restart when there is a change to an LSA that could be flooded
to the restarting router or when there is a changed LSA on the restarting router's retransmission list when the graceful restart is initiated.  
Default admin-state is enabled.
To configure ietf-helper-strict-lsa-checking admin-state:

**Command syntax: ietf-helper-strict-lsa-checking admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf graceful-restart

**Note**

- To reduce the risk of data loss for a stand-alone system hot-patch upgrade of the routing service, the operator is advised to disable the LSA strict checking on neighbors.

**Parameter table**

+-------------+--------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                        | Range        | Default |
+=============+====================================================================+==============+=========+
| admin-state | Configure Strict LSA checking of IETF NSF per RFC 3623 Section B.2 | | enabled    | enabled |
|             |                                                                    | | disabled   |         |
+-------------+--------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# graceful-restart
    dnRouter(cfg-protocols-ospf-gr)# ietf-helper-strict-lsa-checking admin-state disabled


**Removing Configuration**

To revert ietf-helper-strict-lsa-checking admin-state to the default value
::

    dnRouter(cfg-protocols-ospf-gr)# no ietf-helper-strict-lsa-checking admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### graceful-restart/restarting-mode/admin-state.rst

protocols ospf graceful-restart restarting-mode admin-state
-----------------------------------------------------------

**Minimum user role:** operator

Configures OSPF graceful restart IETF restarting-mode admin-state. The command enables/disables the graceful restart restarter behavior on the router.

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf graceful-restart restarting-mode

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | When the value of this leaf is set to true, graceful restart restarting-mode is  | | enabled    | disabled |
|             | enabled on the local system. In this case, the system will use Grace-LSAs to     | | disabled   |          |
|             | signal that it is restarting to its neighbors.                                   |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# graceful-restart
    dnRouter(cfg-protocols-ospf-gr)# restarting-mode
    dnRouter(cfg-ospf-gr-restarting-mode)# admin-state enabled
    dnRouter(cfg-ospf-gr-restarting-mode)# admin-state disabled


**Removing Configuration**

To revert admin-state to its default value
::

    dnRouter(cfg-protocols-ospf-gr-restarting-mode)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### graceful-restart/restarting-mode/grace-interval.rst

protocols ospf graceful-restart restarting-mode grace-interval
--------------------------------------------------------------

**Minimum user role:** operator

Configures OSPF graceful restart restarting-mode grace-interval, which is the minimum interval between two consecutive graceful-restart events, below which the router must not enter restarting-mode.

**Command syntax: grace-interval [grace-ineterval]**

**Command mode:** config

**Hierarchies**

- protocols ospf graceful-restart restarting-mode

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter       | Description                                                                      | Range   | Default |
+=================+==================================================================================+=========+=========+
| grace-ineterval | Specifying Graceful Restart restarting-mode grace interval. The minimum allowed  | 60-3600 | 60      |
|                 | interval between consecutive graceful restart events.                            |         |         |
+-----------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# graceful-restart
    dnRouter(cfg-protocols-ospf-gr)# restarting-mode
    dnRouter(cfg-protocols-ospf-gr-restarting-mode)# grace-interval 1200


**Removing Configuration**

To revert restarting grace-interval to its default value
::

    dnRouter(cfg-ospf-gr-restarting-mode)# no grace-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### graceful-restart/restarting-mode/grace-period.rst

protocols ospf graceful-restart restarting-mode grace-period
------------------------------------------------------------

**Minimum user role:** operator

Configures OSPF graceful restart restarting-mode grace-period.

**Command syntax: grace-period [grace-period]**

**Command mode:** config

**Hierarchies**

- protocols ospf graceful-restart restarting-mode

**Parameter table**

+--------------+-----------------------------------------------------------+---------+---------+
| Parameter    | Description                                               | Range   | Default |
+==============+===========================================================+=========+=========+
| grace-period | Specifying Graceful Restart restarting-mode grace period. | 60-1800 | 120     |
+--------------+-----------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# graceful-restart
    dnRouter(cfg-protocols-ospf-gr)# restarting-mode
    dnRouter(cfg-protocols-ospf-gr-restarting-mode)# grace-period 200


**Removing Configuration**

To revert restarting grace-period to its default value
::

    dnRouter(cfg-ospf-gr-restarting-mode)# no grace-period

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### graceful-restart/restarting-mode/restarting-mode.rst

protocols ospf graceful-restart restarting-mode
-----------------------------------------------

**Minimum user role:** operator

Configures OSPF graceful restart restarting-mode. The command configures the minimum interval between two consecutive graceful restart events, below which the router must not enter restart mode.

**Command syntax: restarting-mode**

**Command mode:** config

**Hierarchies**

- protocols ospf graceful-restart

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# graceful-restart
    dnRouter(cfg-protocols-ospf-gr)# restarting-mode
    dnRouter(cfg-protocols-ospf-gr-restarting-mode)#


**Removing Configuration**

To revert restarting-mode to its default value
::

    dnRouter(cfg-protocols-ospf-gr)# no restarting-mode

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### instance/administrative-distance-external.rst

protocols ospf instance administrative-distance external
--------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the OSPF administrative distance for all routes:

**Command syntax: administrative-distance external [administrative-distance-external]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- An admin-distance of 255 will cause the router to remove the route from the forwarding table and not use it

**Parameter table**

+----------------------------------+----------------------------------------------------------+-------+---------+
| Parameter                        | Description                                              | Range | Default |
+==================================+==========================================================+=======+=========+
| administrative-distance-external | Set the administrative distance for ospf external routes | 1-255 | \-      |
+----------------------------------+----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# administrative-distance external 120


**Removing Configuration**

To revert all distances to their default value:
::

    dnRouter(cfg-protocols-ospf)# no administrative-distance

To revert a specific distance to its default value:
::

    dnRouter(cfg-protocols-ospf)# no administrative-distance external

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/administrative-distance-inter.rst

protocols ospf instance administrative-distance inter-area
----------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the OSPF administrative distance for all routes:

**Command syntax: administrative-distance inter-area [administrative-distance-inter-area]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- An admin-distance of 255 will cause the router to remove the route from the forwarding table and not use it

**Parameter table**

+------------------------------------+------------------------------------------------------------+-------+---------+
| Parameter                          | Description                                                | Range | Default |
+====================================+============================================================+=======+=========+
| administrative-distance-inter-area | Set the administrative distance for ospf inter-area routes | 1-255 | \-      |
+------------------------------------+------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# administrative-distance inter-area 200


**Removing Configuration**

To revert all distances to their default value:
::

    dnRouter(cfg-protocols-ospf)# no administrative-distance

To revert a specific distance to its default value:
::

    dnRouter(cfg-protocols-ospf)# no administrative-distance inter-area

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/administrative-distance-intra.rst

protocols ospf instance administrative-distance intra-area
----------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the OSPF administrative distance for all routes:

**Command syntax: administrative-distance intra-area [administrative-distance-intra-area]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- An admin-distance of 255 will cause the router to remove the route from the forwarding table and not use it

**Parameter table**

+------------------------------------+------------------------------------------------------------+-------+---------+
| Parameter                          | Description                                                | Range | Default |
+====================================+============================================================+=======+=========+
| administrative-distance-intra-area | Set the administrative distance for ospf intra-area routes | 1-255 | \-      |
+------------------------------------+------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# administrative-distance intra-area 150


**Removing Configuration**

To revert all distances to their default value:
::

    dnRouter(cfg-protocols-ospf)# no administrative-distance

To revert a specific distance to its default value:
::

    dnRouter(cfg-protocols-ospf)# no administrative-distance intra-area

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/administrative-distance.rst

protocols ospf instance administrative-distance
-----------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the OSPF administrative distance for all routes:

**Command syntax: administrative-distance [administrative-distance]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- An admin-distance of 255 will cause the router to remove the route from the forwarding table and not use it

**Parameter table**

+-------------------------+------------------------------------------+-------+---------+
| Parameter               | Description                              | Range | Default |
+=========================+==========================================+=======+=========+
| administrative-distance | Set the administrative distance for ospf | 1-255 | 110     |
+-------------------------+------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# administrative-distance 20
    dnRouter(cfg-protocols-ospf)# administrative-distance external 22
    dnRouter(cfg-protocols-ospf)# administrative-distance inter-area 25
    dnRouter(cfg-protocols-ospf)# administrative-distance intra-area 30


**Removing Configuration**

To revert administrative distances to the default value:
::

    dnRouter(cfg-protocols-ospf)# no administrative-distance

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/aggregate-route/aggregate-route.rst

protocols ospf instance area aggregate-route
--------------------------------------------

**Minimum user role:** operator

The aggregate route is advertised as an inter-area route. Aggregation reduces the number of inter-area routes, by advertising shorter summary routes to other areas.
The summarizing ABR node will create an aggregate route with a next-hop null 0 (discard) in the OSPFv2 routing table and advertise it when a more specific intra-area route exists in OSPF.
To create route aggregation:

**Command syntax: aggregate-route [ipv4-prefix]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Parameter table**

+-------------+-------------------------------+-----------+---------+
| Parameter   | Description                   | Range     | Default |
+=============+===============================+===========+=========+
| ipv4-prefix | IP aggregation summary prefix | A.B.C.D/x | \-      |
+-------------+-------------------------------+-----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# aggregate-route 3.3.0.0/16
    dnRouter(cfg-ospf-area-aggregate)#


**Removing Configuration**

To remove route aggregation:
::

    dnRouter(cfg-protocols-ospf-area)# no aggregate-route 3.3.0.0/16

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/aggregate-route/summary-only.rst

protocols ospf instance area aggregate-route summary-only
---------------------------------------------------------

**Minimum user role:** operator

To advertise only the aggregate route and not the contributing individual summary routes:

**Command syntax: summary-only**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area aggregate-route

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# aggregate-route 3.3.0.0/16
    dnRouter(cfg-ospf-area-aggregate)# summary-only


**Removing Configuration**

To revert to default behavior:
::

    dnRouter(cfg-ospf-area-aggregate)# no summary-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/area.rst

protocols ospf instance area
----------------------------

**Minimum user role:** operator

DNOS supports participating in the OSPFv2 backbone area (Area 0), non-backbone areas (Other than area 0), backbone-area (Area 0, in multiple areas  acting as an area border router), and NSSa and stub areas. 
NSSA and stub are supported both for ABR roles and for non-ABR roles.
To set an OSPF area ID and enter its configuration mode:

**Command syntax: area [area-id]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- No command disables the ospf process for the specified area.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| area-id   | An identifier for the OSPFv2 area - described as either a 32-bit unsigned        | \-    | \-      |
|           | integer, or a dotted-quad                                                        |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)#
    dnRouter(cfg-protocols-ospf)# area 0.0.0.0
    dnRouter(cfg-protocols-ospf-area)#


**Removing Configuration**

To disable the ospf process for the specified area:
::

    dnRouter(cfg-protocols-ospf)# no area 0.0.0.0

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/authentication.rst

protocols ospf instance area authentication
-------------------------------------------

**Minimum user role:** operator

Use authentication to guarantee that only trusted devices participate in the areas routing.
To configure authentication:

**Command syntax: authentication [authentication-type]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Note**

- Authentication is disabled by default

- clear-text - sets "clear-text" as the expected authentication on all area interfaces

- md5 - sets "md5" as the expected authentication on all area interfaces

**Parameter table**

+---------------------+-------------------------------------------------------+----------------+-------------------+
| Parameter           | Description                                           | Range          | Default           |
+=====================+=======================================================+================+===================+
| authentication-type | Set the authentication type that is used in the area. | | clear-text   | no authentication |
|                     |                                                       | | md5          |                   |
|                     |                                                       | | ipsec        |                   |
+---------------------+-------------------------------------------------------+----------------+-------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# authentication-type md5


**Removing Configuration**

To disable authentication requirement:
::

    dnRouter(cfg-ospf-area)# no authentication

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/bfd/admin-state.rst

protocols ospf instance area bfd admin-state
--------------------------------------------

**Minimum user role:** operator

To set the OSPF BFD admin state for the interface:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area bfd

**Note**
- Per area interface bfd admin-state configuration
- 'no'command returns admin-state to its default settings

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-ospf-area)# bfd
    dnRouter(cfg-ospf-area-bfd)# admin-state enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-ospf-area)# bfd
    dnRouter(cfg-ospf-area-bfd)# admin-state disabled


**Removing Configuration**

To return the admin-state to its default value: 
::

    dnRouter(cfg-ospf-area-bfd)# no admin-state

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/bfd/bfd.rst

protocols ospf instance area bfd
--------------------------------

**Minimum user role:** operator

Enters ospf area bfd configuration level.


**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Note**

- The Area BFD level is the default per-area interface BFD configuration level

- OSPF BFD session type is Single-hop

- BFD source address is the ospf interface source address. BFD destination address is the ospf peer address

- Upon BFD session down, ospf session will be closed and all routes learnt from neighbor will be withdrawn.

- BFD works in asynchronous mode. Bfd established before the OSPF adjacency, only once OSPF adj. is FULL it will be dependent on BFD.

- BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations.

- Detection-time = negotiated-received-interval X received multiplier

- This is the maximum amount of time that can elapse without receipt of a BFD control packet before the session is declared down.

- BFD neighbor can signal session state down, and upon receipt local bfd session will immediately switch to DOWN state

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# bfd
    dnRouter(cfg-ospf-area-bfd)#


**Removing Configuration**

To disable the ospf area bfd:
::

    dnRouter(cfg-protocols-ospf-area)# no bfd

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/bfd/min-rx.rst

protocols ospf instance area bfd min-rx
---------------------------------------

**Minimum user role:** operator

To set the OSPF BFD default minimum receive interval for the area:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area bfd

**Note**
- 'no' command returns to default settings

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | 300     |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area)# bfd
    dnRouter(cfg-ospf-area-bfd)# min-rx 400


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ospf-area)# no min-rx

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/bfd/min-tx.rst

protocols ospf instance area bfd min-tx
---------------------------------------

**Minimum user role:** operator

To set the OSPF BFD minimum transmit interval for the interface:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area bfd

**Note**
- Due to hardware limitation, maximum supported transmit rate is 1700msec, and negotiated transmit interval higher than 1700msec will result in actual transmit rate of 1700msec.
- 'no' command returns to default settings

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | 300     |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-ospf-area)# bfd
    dnRouter(cfg-ospf-area-bfd)# min-tx 400


**Removing Configuration**

To return the min-tx interval to its default value: 
::

    dnRouter(cfg-ospf-area-bfd)# no min-tx

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/bfd/multiplier.rst

protocols ospf instance area bfd multiplier
-------------------------------------------

**Minimum user role:** operator

To set the OSPF BFD default multiplier for the area:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area bfd

**Note**
- 'no' command returns to default settings

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-ospf-area)# bfd
    dnRouter(cfg-ospf-area-bfd)# multiplier 2


**Removing Configuration**

To return to the default value:
::

    dnRouter(cfg-ospf-area-bfd)# no multiplier

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/bfd/rsvp-dependency.rst

protocols ospf instance area bfd rsvp-dependency
------------------------------------------------

**Minimum user role:** operator

In the event of a failure of BFD protecting an OSPF adjacency over an interface with RSVP enabled, RSVP will consider the interface as down and will trigger a bypass of the interface. The FIB will also react and will perform Fast Re-Routing (FRR) for all tunnels using that egress interface.
To enable RSVP dependency on an area:

**Command syntax: rsvp-dependency [rsvp-dependency]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area bfd

**Note**
- 'no' command returns to default settings

**Parameter table**

+-----------------+-------------------------------------------------------+--------------+----------+
| Parameter       | Description                                           | Range        | Default  |
+=================+=======================================================+==============+==========+
| rsvp-dependency | Set that BFD for OSPF will trigger RSVP-TE FRR events | | enabled    | disabled |
|                 |                                                       | | disabled   |          |
+-----------------+-------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-ospf-area)# bfd
    dnRouter(cfg-ospf-area-bfd)# rsvp-dependency enabled


**Removing Configuration**

To return the rsvp dependency admin-state to its default value: 
::

    dnRouter(cfg-ospf-area-bfd)# no rsvp-dependency

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/adjacency-sid/adjacency-sid.rst

protocols ospf instance area interface adjacency-sid
----------------------------------------------------

**Minimum user role:** operator

When OSPF forms an adjacency over a given link, it is advertised by the Adj-SID Sub-TLVs of the Extended Link TLV.
Segment-routing adjacency-sid allocates a specific SID, e.g label, to forward incoming matching mpls traffic over the adjacency. I.E, to forward traffic over a specific egress interface to a known next-hop
A configured adjacency-sid will be persistent, and will hold the SID value for as long as it is configured, including system reboot. The persistent adjacency-sid is advertised with P-flag set (RFC8667)
To configure a persistent adjacency-sid:

**Command syntax: adjacency-sid [SID type] [sid-index/sid-label]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**
- Configured SID value (i.e expected label value) must be within the configured SRLB range
- Configured SID value (i.e expected label value) must be unique on the OSPF interface (due to combination of type & value)
- Configured SID value (i.e expected label value) must be unique between all OSPF interfaces
- Support up to two configured adjacency-sids per interface.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+---------------------------+---------+
| Parameter           | Description                                                                      | Range                     | Default |
+=====================+==================================================================================+===========================+=========+
| SID type            | Sid type absolute or index                                                       | | index                   | \-      |
|                     |                                                                                  | | label                   |         |
+---------------------+----------------------------------------------------------------------------------+---------------------------+---------+
| sid-index/sid-label | sid-index: Assigns the adjacency-sid label according to the index of the         | | sid-index: 0-7999       | \-      |
|                     | Segment-Routing Local Block used by OSPF. The value must be within the SRLB      | | sid-label: 8000-15999   |         |
|                     | range.                                                                           |                           |         |
|                     | sid-label: Assigns the adjacency-sid label as an absolute value. The value must  |                           |         |
|                     | be within the SRLB range.                                                        |                           |         |
+---------------------+----------------------------------------------------------------------------------+---------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance ospf1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# interface bundle-1
    dnRouter(cfg-inst-area-if)# adjacency-sid index 10
    dnRouter(cfg-area-if-adj-sid)#

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance ospf1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# interface bundle-1
    dnRouter(cfg-inst-area-if)# adjacency-sid label 8500
    dnRouter(cfg-area-if-adj-sid)#



**Removing Configuration**

To remove configured adjacency-sid:
::

    dnRouter(cfg-inst-area-if)# no adjacency-sid label 8500

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### instance/area/interface/adjacency-sid/protection-eligible.rst

protocols ospf instance area interface adjacency-sid protection-eligible
------------------------------------------------------------------------

**Minimum user role:** operator

* For adjacency-sid configured without protection-eligible (default behavior), SID is always advertised with B flag unset, regardless of protection status in OSPF. Such adjacency-sid will not be protected and will not hold alternate path.
* For adjacency-sid configured with protected flag, sid is always advertised with B flag set. Regardless of protection status in OSPF (i.e if LFA/TI-LFA is enabled - same behavior in Cisco).

To set the adjacency-sid as protection-eligible:

**Command syntax: protection-eligible**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface adjacency-sid

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance ospf1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# interface bundle-1
    dnRouter(cfg-inst-area-if)# adjacency-sid index 10
    dnRouter(cfg-area-if-adj-sid)# protection-eligible


**Removing Configuration**

To return to default behavior:
::

    dnRouter(cfg-area-if-adj-sid)# no protection-eligible

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### instance/area/interface/authentication-key_md5_key-id_password.rst

protocols ospf instance area interface authentication-key md5 key-id password
-----------------------------------------------------------------------------

**Minimum user role:** operator

To set a password for authenticating the neighbor, peer group neighbors, or the neighbor in a peer group:

**Command syntax: authentication-key md5 key-id [key-id] password [secret]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- no command deletes key configuration.

- This configuration must be set if OSPF area authentication configuration is set.

- If no enc-password is set, the user must enter a clear password and verify it.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter | Description                                                                      | Range            | Default |
+===========+==================================================================================+==================+=========+
| key-id    | md5 key id                                                                       | 1-255            | \-      |
+-----------+----------------------------------------------------------------------------------+------------------+---------+
| secret    | The encrypted password. If you do not set an encrypted password, you will be     | | string         | \-      |
|           | prompted to enter a clear password and verify it.                                | | length 1-255   |         |
+-----------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1
    dnRouter(cfg-ospf-area-if)#  authentication-key md5 key-id 1 password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==
    dnRouter(cfg-ospf-area-if)#  authentication-key md5 key-id 2 password
    Enter password:
    Enter password for verification:


**Removing Configuration**

To delete the key configuration:
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no authentication-key md5 key-id 1

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/authentication-key_password.rst

protocols ospf instance area interface authentication-key password
------------------------------------------------------------------

**Minimum user role:** operator

If the OSPF area authentication is configured, you must set the OSPF authentication key to a cryptographic password for the interface.
To configure the interface authentication key:

**Command syntax: authentication-key password [secret]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- no command deletes key configuration.

- This configuration must be set if OSPF area authentication configuration is set.

- If no enc-password is set, the user must enter a clear password and verify it.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter | Description                                                                      | Range            | Default |
+===========+==================================================================================+==================+=========+
| secret    | The encrypted password. If you do not set an encrypted password, you will be     | | string         | \-      |
|           | prompted to enter a clear password and verify it.                                | | length 1-255   |         |
+-----------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)#  authentication-key password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==


**Removing Configuration**

To delete the key configuration: 
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)#  no authentication-key password

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/authentication.rst

protocols ospf instance area interface authentication
-----------------------------------------------------

**Minimum user role:** operator

To configure the OSPF authentication method for an OSPF enabled interface:

**Command syntax: authentication [authentication-type]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- The authentication default is determined by the area authentication configuration.

- The OSPF authentication is disabled by default.

- clear-text - clear-text is the expected authentication on all area interfaces.

- md5 - md5 is the expected authentication on all area interfaces.

- no authentication - return authentication to the default state according to the area authentication settings.

**Parameter table**

+---------------------+-------------------------------------------------------+----------------+-------------------+
| Parameter           | Description                                           | Range          | Default           |
+=====================+=======================================================+================+===================+
| authentication-type | Set the authentication type that is used in the area. | | clear-text   | no authentication |
|                     |                                                       | | md5          |                   |
+---------------------+-------------------------------------------------------+----------------+-------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# authentication clear-text
    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1
    dnRouter(cfg-ospf-area-if)# authentication md5


**Removing Configuration**

To return the authentication type to its default value:
::

    dnRouter(cfg-ospf-area-if)# no authentication 

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/bfd/admin-state.rst

protocols ospf instance area interface bfd admin-state
------------------------------------------------------

**Minimum user role:** operator

To set the OSPF BFD admin state for the interface:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface bfd

**Note**
- Per area interface bfd admin-state configuration
- 'no'command returns admin-state to its default settings

**Parameter table**

+-------------+--------------------------------------------------+--------------+---------+
| Parameter   | Description                                      | Range        | Default |
+=============+==================================================+==============+=========+
| admin-state | Sets the OSPF BFD admin state for the interface. | | enabled    | \-      |
|             |                                                  | | disabled   |         |
+-------------+--------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# bfd
    dnRouter(cfg-ospf-area-if-bfd)# admin-state enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# bfd
    dnRouter(cfg-ospf-area-if-bfd)# admin-state disabled


**Removing Configuration**

To return the admin-state to its default value: 
::

    dnRouter(cfg-ospf-area-if-bfd)# no admin-state

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/bfd/bfd.rst

protocols ospf instance area interface bfd
------------------------------------------

**Minimum user role:** operator

Enters the OSPF area BFD configuration level.


**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- The Area BFD level is the default per-area interface BFD configuration level.

- The OSPF BFD session type is Single-hop.

- The BFD source address is the OSPF interface source address. The BFD destination address is the OSPF peer address.

- Upon BFD session down, the OSPF session closes and all the routes learnt from the neighbor are withdrawn.

- BFD works in asynchronous mode. When BFD is established before the OSPF adjacency, only once the OSPF adj is full will it be dependent on BFD.

- BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations.

- Detection-time = negotiated-received-interval X received multiplier

- This is the maximum amount of time that can elapse without receipt of a BFD control packet before the session is declared down.

- BFD neighbor can signal session state down, and upon receipt the local BFD session will immediately switch to DOWN state.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if-bfd)# bfd
    dnRouter(cfg-ospf-area-if-bfd)#


**Removing Configuration**

To disable the ospf area bfd:
::

    dnRouter(cfg-ospf-area-if-bfd)# no bfd

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/bfd/min-rx.rst

protocols ospf instance area interface bfd min-rx
-------------------------------------------------

**Minimum user role:** operator

To set the OSPF BFD minimum receive interval for the interface:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface bfd

**Note**
- 'no' command returns to default settings

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | \-      |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# bfd
    dnRouter(cfg-ospf-area-if-bfd)# min-rx 400


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-ospf-area-if-bfd)# no min-rx

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 17.0    | Min range changed                            |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/bfd/min-tx.rst

protocols ospf instance area interface bfd min-tx
-------------------------------------------------

**Minimum user role:** operator

To set the OSPF BFD minimum transmit interval for the interface:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface bfd

**Note**
- 'no' command returns to default settings

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | \-      |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# bfd
    dnRouter(cfg-ospf-area-if-bfd)# min-tx 400


**Removing Configuration**

To return the min-tx interval to its default value: 
::

    dnRouter(cfg-ospf-area-if-bfd)# no min-tx

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 17.0    | Min range changed                            |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/bfd/multiplier.rst

protocols ospf instance area interface bfd multiplier
-----------------------------------------------------

**Minimum user role:** operator

To set the OSPF BFD minimum receive interval for the interface:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface bfd

**Note**
- 'no' command returns to default settings

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | \-      |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# bfd
    dnRouter(cfg-ospf-area-if-bfd)# multiplier 2


**Removing Configuration**

To return to the default value:
::

    dnRouter(cfg-ospf-area-if-bfd)# no multiplier

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/bfd/rsvp-dependency.rst

protocols ospf instance area interface bfd rsvp-dependency
----------------------------------------------------------

**Minimum user role:** operator

In the event of a failure of BFD protecting an OSPF adjacency over an interface with RSVP enabled, RSVP will consider the interface as down and will trigger a bypass of the interface. The FIB will also react and will perform Fast Re-Routing (FRR) for all tunnels using that egress interface.
To enable RSVP dependency on an interface:

**Command syntax: rsvp-dependency [rsvp-dependency]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface bfd

**Note**
- 'no' command returns to default settings

**Parameter table**

+-----------------+-----------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                     | Range        | Default |
+=================+=================================================================+==============+=========+
| rsvp-dependency | Set that BFD for OSPF interface will trigger RSVP-TE FRR events | | enabled    | \-      |
|                 |                                                                 | | disabled   |         |
+-----------------+-----------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# bfd
    dnRouter(cfg-ospf-area-if-bfd)# rsvp-dependency enabled


**Removing Configuration**

To return the rsvp dependency admin-state to its default value: 
::

    dnRouter(cfg-ospf-area-if-bfd)# no rsvp-dependency

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 15.0    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/cost-mirroring.rst

protocols ospf instance area interface cost-mirroring
-----------------------------------------------------

**Minimum user role:** operator

OSPF cost mirroring automatically sets an interface OSPF cost according to the adjacent neighbor OSPF LSA update for the local interface. When an adjacent OSPF neighbor is applied with an OSPF lag-cost-fallback which dynamically sets the OSPF cost of a bundle interface according to the number of members in the bundle, a local OSPF neighbor can adjust the OSPF cost on the local bundle interface to accommodate the change without the need to support OSPF lag-cost-fallback locally. Cost mirroring can also accommodate automatic equal OSPF cost on both ends of a network link, thus simplifying a network OSPF configuration. Automatic setting of OSPF cost using cost mirroring takes precedence over a local OSPF cost configuration.
To configure the interface cost under an area:

**Command syntax: cost-mirroring [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- No command return cost-mirroring to default state.

**Parameter table**

+-------------+--------------------------------+--------------+----------+
| Parameter   | Description                    | Range        | Default  |
+=============+================================+==============+==========+
| admin-state | Enable mirroring neighbor cost | | enabled    | disabled |
|             |                                | | disabled   |          |
+-------------+--------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# cost-mirroring enabled


**Removing Configuration**

To return cost-mirroring to its default value:
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no cost-mirroring

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/cost.rst

protocols ospf instance area interface cost
-------------------------------------------

**Minimum user role:** operator

Set link cost for the specified interface. The cost value is set to router-LSAs metric field and is used for SPF calculation. When the area default-cost is configured, the interface default cost value equals the configured area default-cost.
To set the link cost:

**Command syntax: cost [cost]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**
- no command returns the cost to its default value.
- Default cost value for a specific interface bandwidth is calculated by :math:`\frac{reference - bandwidth}{interface - bandwidth}` where reference-bandwidth, interface-bandwidth units are Mbits/s. when area default-cost is configured, default cost values equals area default cost
- User can configure the cost for the interface regardless if the cost-mirroring is enabled or not. The cost configuration will take place in the following cases:
* OSPF cost-mirroring is disabled
* OSPF adjacency is not yet up.

**Parameter table**

+-----------+------------------------------------------------+---------+---------+
| Parameter | Description                                    | Range   | Default |
+===========+================================================+=========+=========+
| cost      | set interface cost for interface under an area | 1-65535 | \-      |
+-----------+------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# cost 12050


**Removing Configuration**

To return the cost to its default value:
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no cost

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/dead-interval.rst

protocols ospf instance area interface dead-interval
----------------------------------------------------

**Minimum user role:** operator

To configure the amount of time to wait for a hello-packet from the neighbor before declaring that neighbor dead:

**Command syntax: dead-interval [dead-interval]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**
- If the hello-interval was set (see "ospf area interface hello-interval"), the dead-interval should be four times bigger than the hello-interval.
- no command sets the dead interval to its default value.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter     | Description                                                                      | Range   | Default |
+===============+==================================================================================+=========+=========+
| dead-interval | Dead interval:  this defines how long (in seconds) we should wait for hello      | 1-65535 | 40      |
|               | packets before we declare the neighbor dead                                      |         |         |
+---------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# dead-interval 120


**Removing Configuration**

To return the dead interval to its default value:
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no dead-interval

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/delay-normalization/delay-normalization.rst

protocols ospf instance area interface delay-normalization
----------------------------------------------------------

**Minimum user role:** operator

Performance monitoring (PM) measures various link characteristics like packet loss, delay and jitter. Such characteristics can be used by OSPF as a metric for Flexible Algorithm computation. Low latency routing, using dynamic delay measurement, is one of the primary use cases for the Flexible Algorithm technology.
The delay is measured in microseconds. If the delay values are taken as measured and used as link metrics during the OSPF topology computation, some valid ECMP paths might be unused because of the negligible difference in the link delay.
The Delay Normalization feature computes a normalized delay value and uses the normalized value instead. This value is advertised and used as a metric during the Flexible Algorithm computation.
The normalization is performed when the delay is received from the delay measurement component. When the next value is received, it is normalized and compared to the previous saved normalized value. If the values are different, then the LSA generation is triggered.
The following formula is used to calculate the normalized value:
- Dm: measured Delay
- Int: configured normalized Interval
- Off: configured normalized Offset (must be less than the normalized interval Int)
- Dn: normalized Delay
- a = Dm / Int (rounded down)
- b = a * Int + Off
If the measured delay (Dm) is less than or equal to b, then the normalized delay (Dn) is equal to b. Otherwise, Dn is b + Int.
To configure OSPFv2 interface delay normalization and enter the delay normalization configuration mode:

**Command syntax: delay-normalization**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface ge100-0/0/0
    dnRouter(cfg-ospf-area-interface)# delay-normalization
    dnRouter(cfg-area-interface-normalization)#


**Removing Configuration**

To revert all delay normalization configuration to its default values:
::

    dnRouter(cfg-ospf-area-interface)# no delay-normalization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### instance/area/interface/delay-normalization/interval.rst

protocols ospf instance area interface delay-normalization interval
-------------------------------------------------------------------

**Minimum user role:** operator

To configure the OSPFv2 delay normalization interval on the interface:


**Command syntax: interval [delay-normalization-interval]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface delay-normalization

**Parameter table**

+------------------------------+----------------------------------------------------------------+--------------+---------+
| Parameter                    | Description                                                    | Range        | Default |
+==============================+================================================================+==============+=========+
| delay-normalization-interval | The value of the delay normalization interval in microseconds. | 1-4294967295 | \-      |
+------------------------------+----------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface ge100-0/0/0
    dnRouter(cfg-ospf-area-interface)# delay-normalization
    dnRouter(cfg-area-interface-normalization)# interval 5


**Removing Configuration**

To remove the delay normalization interval configuration:
::

    dnRouter(cfg-area-interface-normalization)# no interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### instance/area/interface/delay-normalization/offset.rst

protocols ospf instance area interface delay-normalization offset
-----------------------------------------------------------------

**Minimum user role:** operator

To configure the OSPFv2 delay normalization offset on the interface:


**Command syntax: offset [delay-normalization-offset]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface delay-normalization

**Parameter table**

+----------------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter                  | Description                                                                      | Range        | Default |
+============================+==================================================================================+==============+=========+
| delay-normalization-offset | The value of the delay normalization offset in microseconds. This value must be  | 0-4294967294 | 0       |
|                            | smaller than the value of normalized interval.                                   |              |         |
+----------------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface ge100-0/0/0
    dnRouter(cfg-ospf-area-interface)# delay-normalization
    dnRouter(cfg-area-interface-normalization)# offset 3


**Removing Configuration**

To revert the delay normalization offset configuration to its default value:
::

    dnRouter(cfg-area-interface-normalization)# no offset

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### instance/area/interface/fast-reroute_backup-candidate.rst

protocols ospf instance area interface fast-reroute backup-candidate
--------------------------------------------------------------------

**Minimum user role:** operator

The command defines whether an OSPF interface will be included or excluded from being a candidate for repair path calculation.
When excluded, the interface will not be used for repair paths. The interface will be used for loop-free alternate calculations when the OSPF fast-reroute is globally enabled.

The behavior applies for both OSPF unicast fast-reroute and OSPF segment-routing based ti-fast-reroute (ti-lfa).
To define the administrative state of the fast reroute backup-candidate per OSPF interface:

**Command syntax: fast-reroute backup-candidate [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | including or excluding an interface for being candidate for repair path          | | enabled    | \-      |
|             | calculation.                                                                     | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# interface bundle-1
    dnRouter(cfg-inst-area-if)# fast-reroute backup-candidate enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-inst-area-if)# no fast-reroute backup-candidate

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### instance/area/interface/hello-interval.rst

protocols ospf instance area interface hello-interval
-----------------------------------------------------

**Minimum user role:** operator

To configure the frequency of sending hello packets:

**Command syntax: hello-interval [hello-interval]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**
- If dead-interval was set (see "ospf area interface dead-interval"), hello interval should be four times smaller than the dead-interval.
- No command sets the hello interval to its default value.

**Parameter table**

+----------------+------------------------------------------------------------------------------+---------+---------+
| Parameter      | Description                                                                  | Range   | Default |
+================+==============================================================================+=========+=========+
| hello-interval | Hello interval: this defines how often (in seconds) we send the hello packet | 1-16383 | 10      |
+----------------+------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# hello-interval 200


**Removing Configuration**

To return the hello interval to its default value:
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no hello-interval

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/interface.rst

protocols ospf instance area interface
--------------------------------------

**Minimum user role:** operator

To enable OSPF on an interface and enter interface OSPF configuration mode:


**Command syntax: interface [interface]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Note**
- no command disables the ospf process for a specific interface.
- An interface can only be configured to a single area. when trying to configure an already in use interface to another area the following error should be displayed: "Error: unable to set interface <interface-name>. Interface attached to area < area-id >".


**Parameter table**

+-----------+------------------------+----------------------------------------+---------+
| Parameter | Description            | Range                                  | Default |
+===========+========================+========================================+=========+
| interface | ospf enabled interface | | geX-<f>/<n>/<p>                      | \-      |
|           |                        | | geX-<f>/<n>/<p>.<sub-interface-id>   |         |
|           |                        | | bundle-<bundle-id>                   |         |
|           |                        | | bundle-<bundle-id.sub-bundle-id>     |         |
|           |                        | | loX                                  |         |
|           |                        | | irb<0-65535>                         |         |
+-----------+------------------------+----------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)#
    dnRouter(cfg-protocols-ospf-area)# interface bundle-2.1012
    dnRouter(cfg-ospf-area-if)#


**Removing Configuration**

To disable authentication requirement:
::

    dnRouter(cfg-protocols-ospf-area)# no interface ge100-1/2/1

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/ldp-sync.rst

protocols ospf instance area interface ldp-sync
-----------------------------------------------

**Minimum user role:** operator

Synchronization between LDP and IGP ensures that LDP is fully established prior to forwarding traffic using the IGP path. All links along the IP shortest path, via the core network, must have operational LDP sessions between all LDP peers. When an LDP does not cover a portion of the network, services depending on MPLS forwarding will fail.
In the following cases IGP will avoid advertising the true cost of a link and will use the maximum cost, thus discouraging traffic forwarding through it:
- LDP is not configured on a link
- The LDP session is down
- The LDP Hello adjacency is down.

max-hold-time: When max-hold-time is set, the advertisement of max-metric in an IGP interface due to LDP-sync logic (lack of an LDP neighbor over interface) will be no more than the max-hold-time timer [in seconds].
               If the LDP session recovers earlier and the LDP-sync logic no longer requires max-metric to be advertised , the interface returns to the configured metric value.

To enable/disable LDP synchronization:

**Command syntax: ldp-sync [admin-state]** max-hold-time [max-hold-time]

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- No command returns the LDP-sync to its default state.

**Parameter table**

+---------------+--------------------------------------------------------------------+--------------+----------+
| Parameter     | Description                                                        | Range        | Default  |
+===============+====================================================================+==============+==========+
| admin-state   | OSPFv2 parameter relating to LDP/IGP synchronization               | | enabled    | disabled |
|               |                                                                    | | disabled   |          |
+---------------+--------------------------------------------------------------------+--------------+----------+
| max-hold-time | maximum time to hold interface at max-metric due to ldp-sync logic | 1-65535      | \-       |
+---------------+--------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# ldp-sync enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# ldp-sync enabled max-hold-time 300


**Removing Configuration**

To return the ldp-sync to its default value:
::

    dnRouter(cfg-ospf-area-if)# no ldp-sync

To disable max-hold-time:
::

    dnRouter(cfg-ospf-area-if)# no ldp-sync enabled max-hold-time

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 18.1    | Add max-hold-time optional config            |
+---------+----------------------------------------------+

---

### instance/area/interface/mtu-ignore.rst

protocols ospf instance area interface mtu-ignore
-------------------------------------------------

**Minimum user role:** operator

To disable the MTU mismatch detection:

**Command syntax: mtu-ignore**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- The MTU-ignore is disabled by default.

- no MTU-ignore - returns the MTU mismatch detection.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# mtu-ignore


**Removing Configuration**

To return the mtu mismatch to its default value: 
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no mtu-ignore

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/network-type.rst

protocols ospf instance area interface network-type
---------------------------------------------------

**Minimum user role:** operator

Set OSPF area interface network type.

**Command syntax: network-type [network]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**
- 'no network-type' command sets the network to its default value - point-to-point.
- Broadcast network type cannot be configured on interfaces with interface-level MPLS enabled.
- Broadcast network type cannot be configured on interfaces with Segment Routing (SR) enabled on the OSPF instance or area.
- Broadcast network type cannot be configured on interfaces or areas with Bidirectional Forwarding Detection (BFD) enabled.
- Broadcast network type cannot be configured on interfaces when Fast Reroute (FRR/LFA) is enabled on the OSPF instance.
- Broadcast network type cannot be configured on interfaces associated with Stub or NSSA areas.
- Broadcast network type cannot be configured on interfaces with Label Distribution Protocol (LDP) enabled.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------------+----------------+
| Parameter | Description                                                                      | Range              | Default        |
+===========+==================================================================================+====================+================+
| network   | Enables OSPF on an interface and set enters interface ospf parameters            | | broadcast        | point-to-point |
|           | configuration                                                                    | | point-to-point   |                |
+-----------+----------------------------------------------------------------------------------+--------------------+----------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# network-type point-to-point


**Removing Configuration**

To return network-type to its default value:
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no network-type

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| TBD     | Added broadcast network type                 |
+---------+----------------------------------------------+

---

### instance/area/interface/passive.rst

protocols ospf instance area interface passive
----------------------------------------------

**Minimum user role:** operator

Setting an OSPF interface as passive disables the sending of routing updates on that interface, hence adjacencies will not be formed in OSPF. However, the particular subnet will continue to be advertised to other interfaces.
To set the interface to passive mode:

**Command syntax: passive [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- No command returns passive to its default disabled state.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Suppress routing updates on interface, thus disables the sending of routing      | | enabled    | disabled |
|             | updates on that interface                                                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# passive enabled


**Removing Configuration**

To return the passive mode admin-state to its default value:
::

    dnRouter(cfg-protocols-ospf-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no passive

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/prefix-sid_strict-spf.rst

protocols ospf instance area interface prefix-sid strict-spf
------------------------------------------------------------

**Minimum user role:** operator

A prefix-SID is a type of a SID that is attached to an IP prefix. There are two types of Prefix-SIDs: Node-SID, which must be globally unique, and anycast-SID, which can be duplicated and can allow a type of very coarse traffic engineering.
The node SID uses the node's loopback address as the prefix.
It is recommended to set the node-SID on the same loopback interface used for "routing-options router-id".
When choosing strict-spf, the SID will be advertised with a strict-spf algorithm, enforcing all nodes to utilize a unicast spf forwarding solution when designating traffic towards the SID.
To allocate a prefix SID to a loopback interface address:

**Command syntax: prefix-sid strict-spf [sid-type] [sid-index]** prefix-type [prefix-sid-type] explicit-null

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- The command is applicable only to loopback interfaces

- By default, the prefix-sid is assigned a node-sid

- It is recommended that you set the Node-SID on the same loopback interface used for "routing-options router-id"

- Configured Prefix-SID will be compared with the configured SRGB value. If found out of block range (by either index or label), the commit will fail

- Configured Prefix-SID will be compared with the currently in used SRGB value. If found out of block range (by either index or label), the SID will not be used and PREFIX_SID_OUT_OF_RANGE syslog will be sent after the commit is applied

- Cannot configure (commit validation) same sid-index or label for different prefix-sids, i.e for different algorithm prefix-sid or among different loopback interfaces.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| sid-type        | Sid type absolute or index                                                       | | index      | \-      |
|                 |                                                                                  | | absolute   |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| sid-index       | Sid value                                                                        | 0-1040383    | \-      |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| prefix-sid-type | Prefix Sid type                                                                  | | node       | node    |
|                 |                                                                                  | | anycast    |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| explicit-null   | When set, the penultimate hop must swap the prefix SID for the relevant explicit | Boolean      | False   |
|                 | null label before forwarding the packet.                                         |              |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface lo0
    dnRouter(cfg-ospf-area-interface)# prefix-sid strict-spf index 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface lo0
    dnRouter(cfg-ospf-area-interface)# prefix-sid strict-spf label 16001 explicit-null

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface lo0
    dnRouter(cfg-ospf-area-interface)# prefix-sid strict-spf index 3000 prefix-type anycast


**Removing Configuration**

To remove the prefix-sid settings:
::

    dnRouter(cfg-ospf-area-interface)# no prefix-sid strict-spf

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.0    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/prefix-sid-flex-algo.rst

protocols ospf instance area interface prefix-sid flex-algo
-----------------------------------------------------------

**Minimum user role:** operator

A prefix-SID is a type of a SID that is attached to an IP prefix.
There are two types of Prefix-SID: A Node-SID, which must be globally unique, and an Anycast-SID, which can be duplicated and can allow a type of very coarse traffic engineering.
The node SID uses the node's loopback address as the prefix.
Assigning a prefix-sid Flex-Algo, will allow prefix-sid reachability only in the assigned Flex-Algo id domain. It is recommended to set the node-SID on the same loopback interface used for "routing-options router-id".

To allocate a prefix SID Flex-Algo to a loopback interface address:

**Command syntax: prefix-sid flex-algo [flex-algo id] [sid-type] [sid-index/sid-label]** prefix-type [prefix-type] explicit-null

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**
- The command is applicable only to loopback interfaces.
- By default, the prefix-sid is assigned a Node-Sid.
- Can set multiple prefix-sids of different Flex-Algo identifiers for the same loopback interface. All sids must have different local labels.
- It is recommended that you set the Node-SID on the same loopback interface used for "routing-options router-id".
.. - The configured Prefix-SID will be compared with the configured SRGB value, if found out of block range (by either index or label), the commit will fail.
.. - The configured Prefix-SID will be compared with the currently in used SRGB value, if found out of block range (by either index or label), the SID will not be used and the PREFIX_SID_OUT_OF_RANGE syslog will be sent after the commit is applied.
.. -  Cannot configure (commit validation) the same sid-index or label for different prefix-sids. i.e for different algorithm prefix-sid or among different loopback interfaces.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| Parameter           | Description                                                                      | Range                    | Default |
+=====================+==================================================================================+==========================+=========+
| flex-algo id        | flex algorithm identifier                                                        | 128-255                  | \-      |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| sid-type            | Sid type absolute or index                                                       | | index                  | \-      |
|                     |                                                                                  | | label                  |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| sid-index/sid-label | sid-index: Assigns the prefix-SID label according to the index of the            | | sid-index: 0-255999    | \-      |
|                     | Segment-Routing Global Block used by OSPF. The value must be within the SRGB     | | sid-label: 16-955999   |         |
|                     | range.                                                                           |                          |         |
|                     | sid-label: Assigns the prefix-SID label as an absolute value. The value must be  |                          |         |
|                     | within the SRGB range.                                                           |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| prefix-type         | The type of SID for the router:                                                  | | node                   | node    |
|                     | node - The SID is used to identify the node in the network. The "node" type can  | | anycast                |         |
|                     | only be used for interfaces with an address of /32 (ipv4) or /128 (ipv6).        |                          |         |
|                     | anycast - This SID type may be identical on several routers, helping in creating |                          |         |
|                     | ECMP aware SFP paths                                                             |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+
| explicit-null       | When set, a penultimate hop neighbor of the Prefix-SID originator will replace   | Boolean                  | False   |
|                     | the Prefix-SID with a Prefix-SID that has an Explicit NULL value.                |                          |         |
|                     | When not used, the default behavior is implicit-null.                            |                          |         |
+---------------------+----------------------------------------------------------------------------------+--------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF-1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# interface lo0
    dnRouter(cfg-inst-area-if)# prefix-sid flex-algo 128 index 1

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF-1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# interface lo0
    dnRouter(cfg-inst-area-if)# prefix-sid flex-algo 128 index 100

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF-1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# interface lo0
    dnRouter(cfg-inst-area-if)# prefix-sid flex-algo 128 label 16001 explicit-null

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF-1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# interface lo1
    dnRouter(cfg-inst-area-if)# prefix-sid flex-algo 128 index 3000 prefix-type anycast


**Removing Configuration**

To revert prefix-sid optional to its default value:
::

    dnRouter(cfg-inst-if-afi)# no prefix-sid flex-algo 128 index 1 explicit-null

To remove a prefix-sid of a specific flex-algo
::

    dnRouter(cfg-inst-if-afi)# no prefix-sid flex-algo 128

To remove all flex-algo prefix-sids
::

    dnRouter(cfg-inst-if-afi)# no prefix-sid flex-algo

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 18.0    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 19.1    | Add support for flex-algo prefix-sid         |
+---------+----------------------------------------------+

---

### instance/area/interface/prefix-sid.rst

protocols ospf instance area interface prefix-sid
-------------------------------------------------

**Minimum user role:** operator

A prefix-SID is a type of a SID that is attached to an IP prefix. There are two types of Prefix-SIDs: Node-SID, which must be globally unique, and anycast-SID, which can be duplicated and can allow a type of very coarse traffic engineering.
The node SID uses the node's loopback address as the prefix.
It is recommended to set the node-SID on the same loopback interface used for "routing-options router-id".

To allocate a prefix SID to a loopback interface address:

**Command syntax: prefix-sid [sid-type] [sid-index]** prefix-type [prefix-sid-type] explicit-null

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**

- The command is applicable only to loopback interfaces.

- By default, the prefix-SID is assigned a node-SID.

- It is recommended that you set the Node-SID on the same loopback interface used for "routing-options router-id".

- Configured Prefix-SID will be compared with the configured SRGB value. If found out of block range (by either index or label), the commit will fail.

- Configured Prefix-SID will be compared with the currently used SRGB value. If found out of block range (by either index or label), the SID will not be used and a PREFIX_SID_OUT_OF_RANGE syslog will be sent after the commit is applied.

- Cannot configure (commit validation) the same sid-index or label for different prefix-sids, i.e for different algorithm prefix-sid or among different loopback interfaces.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| sid-type        | Sid type absolute or index                                                       | | index      | \-      |
|                 |                                                                                  | | absolute   |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| sid-index       | Sid value                                                                        | 0-1040383    | \-      |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| prefix-sid-type | Prefix Sid type                                                                  | | node       | node    |
|                 |                                                                                  | | anycast    |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| explicit-null   | When set, the penultimate hop must swap the prefix SID for the relevant explicit | Boolean      | False   |
|                 | null label before forwarding the packet.                                         |              |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface lo0
    dnRouter(cfg-ospf-area-interface)# prefix-sid index 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface lo0
    dnRouter(cfg-ospf-area-interface)# prefix-sid label 16001 explicit-null

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area
    dnRouter(cfg-protocols-ospf-area)# interface lo0
    dnRouter(cfg-ospf-area-interface)# prefix-sid index 3000 prefix-type anycast


**Removing Configuration**

To remove the prefix-sid settings:
::

    dnRouter(cfg-ospf-area-interface)# no prefix-sid

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.0    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/interface/priority.rst

protocols ospf instance area interface priority
-----------------------------------------------

**Minimum user role:** operator

Set the OSPF router priority on an interface. Higher priority is preferred.

**Command syntax: priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area interface

**Note**
- The 'no priority' command resets the priority to its default value (1).

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| priority  | Router priority for OSPF DR/BDR election. Higher values increase the likelihood  | 0-255 | 1       |
|           | of becoming DR.                                                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# interface ge100-1/2/1
    dnRouter(cfg-ospf-area-if)# priority 100


**Removing Configuration**

To return priority to its default value (1):
::

    dnRouter(cfg-ospf-area-if)# no priority

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| TBD     | Command introduced |
+---------+--------------------+

---

### instance/area/mpls_traffic-engineering_admin-state.rst

protocols ospf instance area mpls traffic-engineering admin-state
-----------------------------------------------------------------

**Minimum user role:** operator

OSPFv2 Traffic-Engineer (TE) provides a way of describing the traffic engineering topology (including bandwidth and administrative constraints) and distributing this information within a given OSPF area. This allows building a traffic engineering MPLS topology using RSVP-TE in OSPF areas.
To set the OSPFv2 MPLS traffic-engineering admin-state:

**Command syntax: mpls traffic-engineering admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Parameter table**

+-------------+-------------------------------------------+--------------+----------+
| Parameter   | Description                               | Range        | Default  |
+=============+===========================================+==============+==========+
| admin-state | OSPF MPLS Traffic Engineering admin state | | enabled    | disabled |
|             |                                           | | disabled   |          |
+-------------+-------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# mpls traffic-engineering admin-state enabled
    dnRouter(cfg-protocols-ospf-area)# mpls traffic-engineering admin-state disabled


**Removing Configuration**

To revert the admin-state to its default setting:
::

    dnRouter(cfg-ospf-area-mpls-te)# no mpls traffic-engineering admin-state

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/area/nssa/admin-state.rst

protocols ospf instance area nssa admin-state
---------------------------------------------

**Minimum user role:** operator

This command enables/disables NSSA for the OSPF area.

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area nssa

**Parameter table**

+-------------+---------------------------------------+--------------+----------+
| Parameter   | Description                           | Range        | Default  |
+=============+=======================================+==============+==========+
| admin-state | Enable NSSA for OSPF in a given area. | | enabled    | disabled |
|             |                                       | | disabled   |          |
+-------------+---------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-protocols-ospf-inst)# area 2
    dnRouter(cfg-ospf-inst-area)# nssa admin-state enabled
    dnRouter(cfg-inst-area-nssa)#


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-inst-area-nssa)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/nssa/default-route/admin-state.rst

protocols ospf instance area nssa default-route admin-state
-----------------------------------------------------------

**Minimum user role:** operator

This command enables/disables a default-route for NSSA in the OSPF area.

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area nssa default-route

**Parameter table**

+-------------+-----------------------------------------------------+--------------+----------+
| Parameter   | Description                                         | Range        | Default  |
+=============+=====================================================+==============+==========+
| admin-state | Enable default-route for nssa in a given OSPF area. | | enabled    | disabled |
|             |                                                     | | disabled   |          |
+-------------+-----------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-protocols-ospf-inst)# area 2
    dnRouter(cfg-ospf-inst-area)# nssa
    dnRouter(cfg-inst-area-nssa)# admin-state enabled
    dnRouter(cfg-inst-area-nssa)# default-route
    dnRouter(cfg-area-nssa-default-route)# admin-state enabled
    dnRouter(cfg-area-nssa-default-route)#


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-area-nssa-default-route)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/nssa/default-route/default-route.rst

protocols ospf instance area nssa default-route
-----------------------------------------------

**Minimum user role:** operator

When acting as an ABR for the NSSA area, by default the ABR will not advertise the inter-area default-route (LSA type 3).
The user can choose to advertise the inter-area default-route.

**Command syntax: default-route**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area nssa

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-ospf-area-inst)# area 2
    dnRouter(cfg-ospf-inst-area)# nssa
    dnRouter(cfg-inst-area-nssa)# default-route
    dnRouter(cfg-area-nssa-default-route)#


**Removing Configuration**

To revert all default-route configuration to default:
::

    dnRouter(cfg-inst-area-nssa)# no default-route

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/nssa/default-route/metric.rst

protocols ospf instance area nssa default-route metric
------------------------------------------------------

**Minimum user role:** operator

Set the NSSA default-route metric. Default metric value is 1.

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area nssa default-route

**Parameter table**

+-----------+---------------------------------------------------------------+------------+---------+
| Parameter | Description                                                   | Range      | Default |
+===========+===============================================================+============+=========+
| metric    | Set the nssa default-route metric.  Default metric value is 1 | 1-16777215 | 1       |
+-----------+---------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 2
    dnRouter(cfg-protocols-ospf-inst)# area 1
    dnRouter(cfg-ospf-inst-area)# nssa
    dnRouter(cfg-inst-area-nssa)# default-route
    dnRouter(cfg-area-nssa-default-route)# admin-state enabled
    dnRouter(cfg-area-nssa-default-route)# metric
    dnRouter(cfg-area-nssa-default-route)#


**Removing Configuration**

To return the metric to its default value: 
::

    dnRouter(cfg-area-nssa-default-route)# no metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/nssa/default-route/no-summary.rst

protocols ospf instance area nssa default-route no-summary
----------------------------------------------------------

**Minimum user role:** operator

When a given area is NSSA and the inter-area default-route is desired, the user can set the area with  a "no-summary" option.

When set, the ABR will prevent propagation of inter-area routes (LSA type 3) into the area.

This will result in the area becoming totally-nssa.

**Command syntax: no-summary**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area nssa default-route

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 2
    dnRouter(cfg-protocols-ospf-inst)# area 1
    dnRouter(cfg-ospf-inst-area)# nssa
    dnRouter(cfg-inst-area-nssa)# default-route
    dnRouter(cfg-area-nssa-default-route)# admin-state enabled
    dnRouter(cfg-area-nssa-default-route)# no-summary
    dnRouter(cfg-area-nssa-default-route)#


**Removing Configuration**

To return the no-summary to its default value: 
::

    dnRouter(cfg-area-nssa-default-route)# no no-summary

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/nssa/default-route/type-7.rst

protocols ospf instance area nssa default-route type-7
------------------------------------------------------

**Minimum user role:** operator

When a default-route advertisement is required by an ABR for an NSSA area, the user may control the default-route being advertised as a type 7 external route (instead of the default type 3).

The default metric type for the default route is 2. The user may change the metric type to 1.

**Command syntax: type-7** metric-type [metric-type]

**Command mode:** config

**Hierarchies**

- protocols ospf instance area nssa default-route

**Parameter table**

+-------------+----------------------------------------------------+-------+---------+
| Parameter   | Description                                        | Range | Default |
+=============+====================================================+=======+=========+
| metric-type | Configure type7 metric type  --> 1 or 2 (N1 or N2) | | 1   | 2       |
|             |                                                    | | 2   |         |
+-------------+----------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 2
    dnRouter(cfg-protocols-ospf-inst)# area 1
    dnRouter(cfg-ospf-inst-area)# nssa
    dnRouter(cfg-inst-area-nssa)# default-route
    dnRouter(cfg-area-nssa-default-route)# admin-state enabled
    dnRouter(cfg-area-nssa-default-route)# type-7
    dnRouter(cfg-area-nssa-default-route)# type-7 metric-type 1
    dnRouter(cfg-area-nssa-default-route)#


**Removing Configuration**

To return the admin-state to its default value: 
::

    dnRouter(cfg-area-nssa-default-route)# no type-7

To return the metric-type to its default value: 
::

    dnRouter(cfg-area-nssa-default-route)# no type-7 metric-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/nssa/no-redistribution.rst

protocols ospf instance area nssa no-redistribution
---------------------------------------------------

**Minimum user role:** operator

When acting as an ASBR, prevent advertising redistributed routes into the NSSA area.
i.e prevent LSA type 7 advertisments.

**Command syntax: no-redistribution**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area nssa

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 2
    dnRouter(cfg-protocols-ospf-inst)# area 3
    dnRouter(cfg-ospf-inst-area)# nssa
    dnRouter(cfg-inst-area-nssa)# no-redistribution
    dnRouter(cfg-inst-area-nssa)#


**Removing Configuration**

To return the nssa no-redistribution to its default value: 
::

    dnRouter(cfg-ospf-area-nssa)# no no-redistribution

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/nssa/nssa.rst

protocols ospf instance area nssa
---------------------------------

**Minimum user role:** operator

DNOS supports participating in the OSPFv2 backbone area (Area 0), non-backbone areas (Other than area 0), backbone-area (Area 0, in multiple areas  acting as an area border router), and NSSa and stub areas. NSSA and stub are supported both for ABR roles and for non-ABR roles.

**Command syntax: nssa**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Note**

- Configuration will be mutually exclusive (i.e setting one will cancel the other).

- A commit validation is required to ensure the stub/NSSA is set for the area not equal to 0 or 0.0.0.0.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-protocols-ospf-inst)# area 2
    dnRouter(cfg-ospf-inst-area)# nssa
    dnRouter(cfg-inst-area-nssa)# admin-state enabled
    dnRouter(cfg-inst-area-nssa)#


**Removing Configuration**

To revert all nssa configuration to default:
::

    dnRouter(cfg-ospf-inst-area)# no nssa

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/nssa/translate-type7-always.rst

protocols ospf instance area nssa translate-type7-always
--------------------------------------------------------

**Minimum user role:** operator

When acting as an ABR, the router should always support type 7 to type 5 LSA translation, regardless of the translator election logic.

**Command syntax: translate-type7-always**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area nssa

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-protocols-ospf-inst)# area 2
    dnRouter(cfg-ospf-inst-area)# nssa
    dnRouter(cfg-inst-area-nssa)# admin-state enabled
    dnRouter(cfg-inst-area-nssa)# translate-type7-always
    dnRouter(ccfg-inst-area-nssa)#


**Removing Configuration**

To return the translate-type7-always to its default value: 
::

    dnRouter(cfg-ospf-area-nssa)# no translate-type7-always

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/segment-routing_admin-state.rst

protocols ospf instance area segment-routing admin-state
--------------------------------------------------------

**Minimum user role:** operator

This command enables/disables segment-routing in an OSPF area for source routing using the MPLS SID.
When enabled, segment-routing information is exchanged with all OSPF neighbors.
Default behavior is per the OSPF instance segment-routing settings.
To enable/disable segment-routing:

**Command syntax: segment-routing admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Parameter table**

+-------------+-------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                   | Range        | Default |
+=============+===============================================================================+==============+=========+
| admin-state | Enable SR for OSPF in a given area. Default behavior is per instance settings | | enabled    | \-      |
|             |                                                                               | | disabled   |         |
+-------------+-------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# area 0
    dnRouter(cfg-protocols-ospf-area)# segment-routing enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

     dnRouter(cfg-protocols-ospf-area)# no segment-routing

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### instance/area/stub/admin-state.rst

protocols ospf instance area stub admin-state
---------------------------------------------

**Minimum user role:** operator

This command enables/disables stub for the OSPF area.

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area stub

**Parameter table**

+-------------+---------------------------------------+--------------+----------+
| Parameter   | Description                           | Range        | Default  |
+=============+=======================================+==============+==========+
| admin-state | Enable STUB for OSPF in a given area. | | enabled    | disabled |
|             |                                       | | disabled   |          |
+-------------+---------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-protocols-ospf-inst)# area area-id
    dnRouter(cfg-ospf-inst-area)# stub
    dnRouter(cfg-inst-area-stub)# admin-state enabled
    dnRouter(cfg-inst-area-stub)#


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-inst-area-stub)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/stub/default-route-metric.rst

protocols ospf instance area stub default-route-metric
------------------------------------------------------

**Minimum user role:** operator

When acting as an ABR for a stub area, DNOS will advertise the LSA type 3 default route into the stub area (regardless if it is stub or totally-stub).

The user can control the desired metric for the advertised default route by setting the default-route-metric.

The default matric value is 1.

**Command syntax: default-route-metric [default-route-metric]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area stub

**Parameter table**

+----------------------+----------------------------------------------------------------------------------+------------+---------+
| Parameter            | Description                                                                      | Range      | Default |
+======================+==================================================================================+============+=========+
| default-route-metric | User can control the desired metric for the advertised default route by setting  | 1-16777215 | 1       |
|                      | the default-route-metric. Default metric value is 1                              |            |         |
+----------------------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-protocols-ospf-inst)# area 1
    dnRouter(cfg-ospf-inst-area)# stub
    dnRouter(cfg-inst-area-stub)# default-route-metric 999
    dnRouter(cfg-inst-area-stub)#


**Removing Configuration**

To return the default-route-metric to its default value:
::

    dnRouter(cfg-inst-area-stub)# no default-route-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/stub/no-summary.rst

protocols ospf instance area stub no-summary
--------------------------------------------

**Minimum user role:** operator

When a given area is stub and the area is set with a "no-summary" option, the ABR will prevent propagation of the inter-area routes (LSA type 3) into the area.

This will result in the area becoming totally-stub.

**Command syntax: no-summary**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area stub

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-protocols-ospf-inst)# area 1
    dnRouter(cfg-ospf-inst-area)# stub
    dnRouter(cfg-inst-area-stub)# no-summary
    dnRouter(cfg-inst-area-stub)#


**Removing Configuration**

To return the no-summary to its default value: 
::

    dnRouter(cfg-inst-area-stub)# no no-summary

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/stub/stub.rst

protocols ospf instance area stub
---------------------------------

**Minimum user role:** operator

To set an OSPFv2 area as a stub.

**Command syntax: stub**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Note**

- For a given NON BACKBONE area the user will be able to set  the area as either stub or NSSA.

- Configuration will be mutually exclusive (i.e setting one will cancel the other).

- A commit validation is required to ensure the stub/NSSA is set for the area not equal to 0 or 0.0.0.0.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 1
    dnRouter(cfg-protocols-ospf-inst)# area 2
    dnRouter(cfg-ospf-inst-area)# stub
    dnRouter(cfg-inst-area-stub)# admin-state enabled
    dnRouter(cfg-inst-area-stub)#


**Removing Configuration**

To revert all stub configuration to default:
::

    dnRouter(cfg-ospf-inst-area)# no stub

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/area/summarization-policy.rst

protocols ospf instance area summarization-policy
-------------------------------------------------

**Minimum user role:** operator

Apply policy to control route summarization as ABR and to modify certain summarized (LSA type 3) routes metric, or filter specific prefixes from being advertised as inter-area routes.

**Command syntax: summarization-policy [summarization-policy]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance area

**Note**
- By default, assuming a no totally stub/NSSA area, all the intra-area routes will be summarized and advertised as inter-area routes.

- Supported actions in the policy:

--  match ipv4 prefix.

--  set ospf-metric.

-  all other actions are ignored, and continue policy processing.

**Parameter table**

+----------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter            | Description                                                                      | Range            | Default |
+======================+==================================================================================+==================+=========+
| summarization-policy | When acting as ABR, impose route policy to filter or modify summary routes (lsa  | | string         | \-      |
|                      | type 3)                                                                          | | length 1-255   |         |
+----------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)# area 0
    dnRouter(cfg-ospf-inst-area)# summarization-policy MY_POLICY_1


**Removing Configuration**

To return the attribute to the default state:
::

    dnRouter(cfg-ospf-inst-area)# no summarization-policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/auto-cost.rst

protocols ospf instance auto-cost reference-bandwidth
-----------------------------------------------------

**Minimum user role:** operator

You can set the reference bandwidth for cost calculations, where this bandwidth is considered equivalent to an OSPF cost of 1 (specified in Mbps). The default is 100 Mbps (i.e. a link of bandwidth 100 Mbps or higher will have a cost of 1. Cost of lower bandwidth links will be scaled with reference to this cost.

**Command syntax: auto-cost reference-bandwidth [auto-cost-reference-bandwidth]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Parameter table**

+-------------------------------+----------------------------------------------------------------------------------+-----------+---------+
| Parameter                     | Description                                                                      | Range     | Default |
+===============================+==================================================================================+===========+=========+
| auto-cost-reference-bandwidth | This sets the reference bandwidth for cost calculations, where this bandwidth is | 1-4294967 | 100     |
|                               | considered equivalent to an OSPF cost of 1, specified in Mbits/s. The default is |           |         |
|                               | 100Mbit/s (i.e. a link of bandwidth 100Mbit/s or higher will have a cost of 1.   |           |         |
|                               | Cost of lower bandwidth links will be scaled with reference to this cost).       |           |         |
+-------------------------------+----------------------------------------------------------------------------------+-----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# auto-cost reference-bandwidth 100000


**Removing Configuration**

To return the reference bandwidth to its default value: 
::

    dnRouter(cfg-protocols-ospf)# no auto-cost reference-bandwidth

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/class-of-service.rst

protocols ospf instance class-of-service
----------------------------------------

**Minimum user role:** operator

Set dscp value for outgoing OSPF packets. 
IPP is set accordingly. i.e DSCP 48 is mapped to 6.

**Command syntax: class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- No command returns dscp-value to default

**Parameter table**

+------------------+--------------------------------------+-------+---------+
| Parameter        | Description                          | Range | Default |
+==================+======================================+=======+=========+
| class-of-service | dscp value for outgoing OSPF packets | 0-56  | 48      |
+------------------+--------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# class-of-service 48


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ospf)# no class-of-service

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/default-originate.rst

protocols ospf instance default-originate
-----------------------------------------

**Minimum user role:** operator

To force the router to generate an OSPF AS-External (type-5) LSA, describing a default route into all external-routing capable areas, of the specified metric and metric type.

**Command syntax: default-originate** always metric [metric] metric-type [metric-type] policy [policy-name]

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- If always is set, the default-route is originated with default metric 0. The Metric can be modified by a user configuration or policy logic.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                                      | Range            | Default |
+=============+==================================================================================+==================+=========+
| always      | when true, the default is always advertised, even when there is no default       | Boolean          | False   |
|             | present in the routing table                                                     |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+
| metric      | Used for generating the default route, this parameter specifies the cost for     | 0-16777214       | \-      |
|             | reaching the rest of the world through this route.                               |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-type | Specifies how the cost of a neighbor metric is determined                        | | 1              | 2       |
|             |                                                                                  | | 2              |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+
| policy-name | set routing policy                                                               | | string         | \-      |
|             |                                                                                  | | length 1-255   |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# default-originate
    dnRouter(cfg-protocols-ospf)# default-originate metric 10000
    dnRouter(cfg-protocols-ospf)# default-originate metric 10000 metric-type 2
    dnRouter(cfg-protocols-ospf)# default-originate metric 10000 metric-type 2 policy MY_POL
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# default-originate always
    dnRouter(cfg-protocols-ospf)# default-originate always metric 10000
    dnRouter(cfg-protocols-ospf)# default-originate always metric 10000 metric-type 2
    dnRouter(cfg-protocols-ospf)# default-originate metric-type 2 metric 3000 always
    dnRouter(cfg-protocols-ospf)# default-originate always metric 10000 metric-type 2 policy MY_POL  - dnRouter# configure


**Removing Configuration**

default-originate is disabled by default
::

    no default-originate - disables default-information originate

**Command History**

+---------+---------------------------------------------------+
| Release | Modification                                      |
+=========+===================================================+
| 11.6    | Command introduced                                |
+---------+---------------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance      |
+---------+---------------------------------------------------+
| 25.0    | Expected metric behavior note under 'always' knob |
+---------+---------------------------------------------------+

---

### instance/distribute_bgp-link-state.rst

protocols ospf instance distribute bgp-link-state id
----------------------------------------------------

**Minimum user role:** operator

This command is part of the BGP-LS feature for Traffic Engineering. In order to support Traffic engineering tunnel delegation to a centralize entity, the network must provide the centralized entity an ongoing full view of the network TE link state. 
BGP-LS is used to send IGP-TE link information to a remote controller. The remote controller, known as PCE, will in turn use this information to create, update and remove TE tunnels in the network.
This command instructs the system to export the OSPFv2 TE database to BGP-LS. The network information, topology, bandwidth, segment-routing attributes, and link cost are all sent to the path computation element through BGP.

To distribute the OSPFv2 database to BGP-LS:

**Command syntax: distribute bgp-link-state id [id]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| id        | A unique identifier to distinguish the OSPFv2 instance in BGP-LS updates. Must   | 0-65535 | \-      |
|           | be unique for all OSPFv2 instances.                                              |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance INST_1
    dnRouter(cfg-protocols-ospf-inst)# distribute bgp-link-state id 1


**Removing Configuration**

To stop exporting the OSPFv2 database to BGP-LS:
::

    dnRouter(cfg-protocols-ospf-inst)# no distribute bgp-link-state

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 19.0    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/fast-reroute_backup-candidate.rst

protocols ospf instance fast-reroute backup-candidate
-----------------------------------------------------

**Minimum user role:** operator

The command defines whether all OSPF interfaces will be included or excluded from being a candidate for repair path calculation.
When excluded, the interfaces will not be used for repair paths. The interfaces will be used for loop-free alternate calculations when the OSPF fast-reroute is globally enabled.

The behavior applies for both OSPF unicast fast-reroute and OSPF segment-routing based ti-fast-reroute (ti-lfa).
To define the administrative state of fast reroute backup-candidate per all OSPF interfaces:

**Command syntax: fast-reroute backup-candidate [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | including or excluding all interfaces for being candidate for repair path        | | enabled    | enabled |
|             | calculation. Used as default behavior for all interfaces, unless more specific   | | disabled   |         |
|             | config exist                                                                     |              |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)# fast-reroute backup-candidate enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-protocols-ospf-inst)# no fast-reroute backup-candidate

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### instance/fast-reroute.rst

protocols ospf instance fast-reroute
------------------------------------

**Minimum user role:** operator

Enables fast reroute per prefix for OSPF:

**Command syntax: fast-reroute [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**
- Cannot be enabled together with the ti-fast-reroute.

**Parameter table**

+-------------+----------------------------------------+--------------+----------+
| Parameter   | Description                            | Range        | Default  |
+=============+========================================+==============+==========+
| admin-state | Enable OSPF LFA (fast-reroute) setting | | enabled    | disabled |
|             |                                        | | disabled   |          |
+-------------+----------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)# fast-reroute enabled


**Removing Configuration**

To revert to the default admin-state and level:
::

    dnRouter(cfg-protocols-ospf-inst)# no fast-reroute

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/flex-algo.rst

protocols ospf instance flex-algo
---------------------------------

**Minimum user role:** operator

Flex-Algo allows IGP constraint-based computation and creates separate IGP algorithms according to the defined set of constraints and metric types.
It compliments the SR-TE solution by adding new prefix segments with specific optimization objectives and constraints.
* Metric types: Minimize IGP-metric, te-metric, or delay.
* Exclude certain SRLGs, include/exclude link admin groups.
To have the DNOS Router join Flex-Algo within the OSPF instance, configure the Flex-Algo participation.

To configure the flexible algorithm, enter the Flex-Algo configuration mode:

**Command syntax: flex-algo**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- Flex-Algo routes are OSPF routes with matching OSPF segment-routing administrative-distance.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf <instance name>
    dnRouter(cfg-protocols-ospf-inst)# flex-algo
    dnRouter(cfg-ospf-inst-flex-algo)#


**Removing Configuration**

To revert all flex-algo configurations to default:
::

    dnRouter(cfg-protocols-ospf-inst)# no flex-algo

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/advertise.rst

protocols ospf instance flex-algo participate advertise
-------------------------------------------------------

**Minimum user role:** operator

To configure the flexible algorithm profile definition to be advertised within the Flex-Algo domain:

**Command syntax: advertise [flex-algo definition name]** priority [priority]

**Command mode:** config

**Hierarchies**

- protocols ospf instance flex-algo participate

**Note**

- Priority is used to define the router priority among the Flex-Algo domain as the selected router to set the Flex-Algo definition.

- The FAD with the highest priority is selected.

**Parameter table**

+---------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter                 | Description                                                                      | Range            | Default |
+===========================+==================================================================================+==================+=========+
| flex-algo definition name | The local flex algo profile to be advertise for a specific flex algo id          | | string         | \-      |
|                           | participation                                                                    | | length 1-255   |         |
+---------------------------+----------------------------------------------------------------------------------+------------------+---------+
| priority                  | Indicates the priority for this algorithm                                        | 0-255            | 128     |
+---------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF-1
    dnRouter(cfg-protocols-ospf-inst)# flex-algo
    dnRouter(cfg-ospf-inst-flex-algo)# participate 130
    dnRouter(cfg-inst-flex-algo-participate)# advertise MIN_DELAY_130

    dnRouter(cfg-protocols-ospf-inst)# flex-algo
    dnRouter(cfg-ospf-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# advertise MIN_DELAY_130 priority 1


**Removing Configuration**

To revert advertisment priority to default value:
::

    dnRouter(cfg-flex-algo-participate)# no advertise MIN_DELAY_130 priority

To remove advertise configuration:
::

    dnRouter(cfg-flex-algo-participate)# no advertise

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/color-no-fallback.rst

protocols ospf instance flex-algo participate color no-fallback
---------------------------------------------------------------

**Minimum user role:** operator


By default, participation in the Flex-Algo domain will result in MPLS routes (ILM) for the algorithm known prefix-sids. When the color is set, associate an SR-TE color definition for the Flex-Algo routing domain.
Flex-algo domain routes will be installed in color-mpls-nh table with the configured color, allowing usage to resolve services over the desired color.
Once no fallback is set, it creates a default-route (0.0.0.0/0) with matching color in the color-mpls-nh table. The default-route will be changed to null0, intended for traffic drop.
As a result traffic matching required color, will be dropped if no better solution exists in the mpls-nh table. No fallback to other colors or mpls-nh table will be possible.
Once disqualify-color-routes is set, the no-fallback route in color-mpls-nh or color-mpls-nh-ipv6 table will be considered unreachable.
As result, colored bgp routes resolved over matching color nexthop will be considered unreachable and will not be accepted

To configure color:

**Command syntax: color [color] no-fallback** disqualify-color-routes

**Command mode:** config

**Hierarchies**

- protocols ospf instance flex-algo participate

**Note**

- The color must be unique between all Flex-Algo participation on the same OSPF instance.

**Parameter table**

+-------------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter               | Description                                                                      | Range        | Default |
+=========================+==================================================================================+==============+=========+
| color                   | The sr-te color to be assosiated with segment-routing flex-algo routes installed | 0-4294967295 | \-      |
|                         | in color-mpls-nh table.                                                          |              |         |
+-------------------------+----------------------------------------------------------------------------------+--------------+---------+
| disqualify-color-routes | Set policy to disqualify color routes matching this no-fallback route.           | boolean      | \-      |
+-------------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF1
    dnRouter(cfg-protocols-ospf-inst)# flex-algo
    dnRouter(cfg-ospf-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# color 130

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF-1
    dnRouter(cfg-protocols-ospf-inst)# flex-algo
    dnRouter(cfg-ospf-inst-flex-algo)# participate 100
    dnRouter(cfg-flex-algo-participate)# color 100 no-fallback
    dnRouter(cfg-flex-algo-participate)# color 100 no-fallback disqualify-color-routes


**Removing Configuration**

To remove color:
::

    dnRouter(cfg-flex-algo-participate)# no color

To remove color no-fallback:
::

    dnRouter(cfg-flex-algo-participate)# no color 100 no-fallback

To remove color no-fallback and disqualify-color-routes:
::

    dnRouter(cfg-flex-algo-participate)# no color 100 no-fallback disqualify-color-routes

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 19.1    | Command introduced            |
+---------+-------------------------------+
| TBD     | disqualify-color-routes added |
+---------+-------------------------------+

---

### instance/flex-algo/participate/color.rst

protocols ospf instance flex-algo participate color
---------------------------------------------------

**Minimum user role:** operator


By default, participation in the Flex-Algo domain will result in MPLS routes (ILM) for the algorithm known prefix-sids. When the color is set, associate an SR-TE color definition for the Flex-Algo routing domain.
Flex-algo domain routes will be installed in color-mpls-nh table with the configured color, allowing usage to resolve services over the desired color.

To configure color:

**Command syntax: color [color]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance flex-algo participate

**Note**

- The color must be unique between all Flex-Algo participation on the same OSPF instance.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| color     | The sr-te color to be assosiated with segment-routing flex-algo routes installed | 0-4294967295 | \-      |
|           | in color-mpls-nh table.                                                          |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF1
    dnRouter(cfg-protocols-ospf-inst)# flex-algo
    dnRouter(cfg-ospf-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# color 130


**Removing Configuration**

To remove color:
::

    dnRouter(cfg-flex-algo-participate)# no color

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/description.rst

protocols ospf instance flex-algo participate description
---------------------------------------------------------

**Minimum user role:** operator

When configuring multiple OSPF Flex-Algo participations, it may be helpful to add a description for each participation.

To configure a description for the OSPF Flex-Algo:


**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance flex-algo participate

**Parameter table**

+-------------+---------------------------------------------+-------+---------+
| Parameter   | Description                                 | Range | Default |
+=============+=============================================+=======+=========+
| description | Add a description for the OSPF flex-algo.   | \-    | \-      |
+-------------+---------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF1
    dnRouter(cfg-protocols-ospf-inst)# flex-algo
    dnRouter(cfg-ospf-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)# description "Min Delay Flex-Algo"


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-flex-algo-participate)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/flex-algo/participate/participate.rst

protocols ospf instance flex-algo participate
---------------------------------------------

**Minimum user role:** operator

To have the DNOS Router join the Flex-Algo within the OSPF instance, configure the Flex-Algo participation for the desired Flex-Algo identifier:

**Command syntax: participate [Flex-Algo ID]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance flex-algo

**Parameter table**

+--------------+---------------------------+---------+---------+
| Parameter    | Description               | Range   | Default |
+==============+===========================+=========+=========+
| Flex-Algo ID | flex algorithm identifier | 128-255 | \-      |
+--------------+---------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf instance OSPF1
    dnRouter(cfg-protocols-ospf-inst)# flex-algo
    dnRouter(cfg-ospf-inst-flex-algo)# participate 130
    dnRouter(cfg-flex-algo-participate)#


**Removing Configuration**

To remove participation configuration:
::

    dnRouter(cfg-inst-flex-algo)# no participate 130

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### instance/instance.rst

protocols ospf instance
-----------------------

**Minimum user role:** operator

OSPF instances allow you to set different OSPF configuration per instance, using the same router-id and loopback interfaces.
However, each instance must be configured with a different administrative-distance, and non-loopback interfaces. Each instance operates as  a separate IGP domain. 
However, connectivity between instances can only be achieved using MPLS with BGP-LU, as native IP leaking between instances is impossible.
You can configure up to 5 OSPF instances, each with a unique name.

To configure an OSPF instance:

**Command syntax: instance [ospf-instance-name]**

**Command mode:** config

**Hierarchies**

- protocols ospf

**Note**

- The OSPF router-id is identical in all ospf instances.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter          | Description                                                                      | Range            | Default |
+====================+==================================================================================+==================+=========+
| ospf-instance-name | The OSPFv2 instance name identifies the specific OSPF protocol instance. The     | | string         | \-      |
|                    | name cannot be changed. If you need to change it, you must delete the OSPF       | | length 1-255   |         |
|                    | protocol instance using the no instance [ospf-instance-name] command and         |                  |         |
|                    | reconfigure with a different name.                                               |                  |         |
+--------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_2
    dnRouter(cfg-protocols-ospf-inst)#


**Removing Configuration**

To remove all OSPF protocol instances:
::

    dnRouter(cfg-protocols-ospf)# no instance

To remove a specific OSPF protocol instance:
::

    dnRouter(cfg-protocols-ospf)# no instance INSTANCE_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/max-metric-router-lsa-administrative-external-lsa.rst

protocols ospf instance max-metric router-lsa administrative external-lsa
-------------------------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the OSPF administrative distance for all routes:

**Command syntax: max-metric router-lsa administrative external-lsa** external-lsa-metric [external-lsa-metric]

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- The 'external-lsa' option is used to override the external-LSA metric with the max-metric value or with the [external-lsa] metric value.

**Parameter table**

+---------------------+---------------------------------------+------------+----------+
| Parameter           | Description                           | Range      | Default  |
+=====================+=======================================+============+==========+
| external-lsa-metric | The external-lsa metric to advertise. | 1-16777215 | 16711680 |
+---------------------+---------------------------------------+------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# max-metric router-lsa administrative external-lsa external-lsa-metric 120000


**Removing Configuration**

To stop the automatic max-metric advertisement:
::

    dnRouter(cfg-protocols-ospf)# no max-metric router-lsa administrative external-lsa

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/max-metric-router-lsa-administrative-include-stub.rst

protocols ospf instance max-metric router-lsa administrative include-stub
-------------------------------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa administrative include-stub**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- The 'include-stub' option is used to advertise stub-links in router-LSA with the max-metric value.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# max-metric router-lsa administrative include-stub


**Removing Configuration**

To stop the automatic max-metric advertisement:
::

    dnRouter(cfg-protocols-ospf)# no max-metric router-lsa administrative

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/max-metric-router-lsa-administrative.rst

protocols ospf instance max-metric router-lsa administrative
------------------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa administrative**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- This option is disabled by default.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# max-metric router-lsa administrative
    dnRouter(cfg-protocols-ospf-mm-admin)#


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospf)# no max-metric router-lsa administrative

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/max-metric-router-lsa-metric-types.rst

protocols ospf instance max-metric router-lsa metric-types
----------------------------------------------------------

**Minimum user role:** operator

By default, only igp metric will be modified to the configured max-metric once max-metric is desired (administrative, on start-up). 
Operator can select if max-metric value will be imposed for igp metric, te-metric or link delay
To set a new max-metric value:


**Command syntax: max-metric router-lsa metric-types {igp [igp-admin-state], te [te-admin-state], delay [delay-admin-state]}**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- At least one metric type must be configured

- Require at least one of the 3 metric types must be enabled (can be due to default enabled)

**Parameter table**

+-------------------+---------------------------------------------------------------------------+--------------+----------+
| Parameter         | Description                                                               | Range        | Default  |
+===================+===========================================================================+==============+==========+
| igp-admin-state   | Set IGP metric with max-metric value when such is desired                 | | enabled    | enabled  |
|                   |                                                                           | | disabled   |          |
+-------------------+---------------------------------------------------------------------------+--------------+----------+
| te-admin-state    | Set Traffic Engineering metric with max-metric value when such is desired | | enabled    | disabled |
|                   |                                                                           | | disabled   |          |
+-------------------+---------------------------------------------------------------------------+--------------+----------+
| delay-admin-state | Set Link Delay with max-metric value when such is desired                 | | enabled    | disabled |
|                   |                                                                           | | disabled   |          |
+-------------------+---------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance area_1
    dnRouter(cfg-protocols-ospf-inst)# max-metric router-lsa metric-types delay enabled

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance area_1
    dnRouter(cfg-protocols-ospf-inst)# max-metric router-lsa metric-types igp disabled te enabled


**Removing Configuration**

To revert all types to the default value:
::

    dnRouter(cfg-protocols-ospf-inst)# no max-metric router-lsa metric-types

To revert specific metric type to the default value:
::

    dnRouter(cfg-protocols-ospf-inst)# no max-metric router-lsa metric-types te

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### instance/max-metric-router-lsa-on-startup-external-lsa.rst

protocols ospf instance max-metric router-lsa on-startup external-lsa
---------------------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the OSPF administrative distance for all routes:

**Command syntax: max-metric router-lsa on-startup external-lsa** external-lsa-metric [external-lsa-metric]

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- The 'external-lsa' option is used to override the external-LSA metric with the max-metric value or with the [external-lsa] metric value.

**Parameter table**

+---------------------+---------------------------------------+------------+----------+
| Parameter           | Description                           | Range      | Default  |
+=====================+=======================================+============+==========+
| external-lsa-metric | The external-lsa metric to advertise. | 1-16777215 | 16711680 |
+---------------------+---------------------------------------+------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# max-metric router-lsa on-startup external-lsa external-lsa-metric 120000


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospf)# no max-metric router-lsa on-startup external-lsa

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/max-metric-router-lsa-on-startup-include-stub.rst

protocols ospf instance max-metric router-lsa on-startup include-stub
---------------------------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa on-startup include-stub**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- The 'include-stub' option is used to advertise stub-links in router-LSA with the max-metric value.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# max-metric router-lsa on-startup
    dnRouter(cfg-protocols-ospf-mm-startup)# include-stub


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospf)# no max-metric router-lsa on-startup

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/max-metric-router-lsa-on-startup-interval.rst

protocols ospf instance max-metric router-lsa on-startup interval
-----------------------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa on-startup interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Parameter table**

+-----------+------------------------------------------+---------+---------+
| Parameter | Description                              | Range   | Default |
+===========+==========================================+=========+=========+
| interval  | time in seconds for advertise on startup | 5-86400 | 600     |
+-----------+------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# max-metric router-lsa on-startup
    dnRouter(cfg-protocols-ospf-mm-startup)# interval 3600


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospf)# no max-metric router-lsa on-startup

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/max-metric-router-lsa-on-startup.rst

protocols ospf instance max-metric router-lsa on-startup
--------------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa on-startup** interval [interval]

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Parameter table**

+-----------+------------------------------------------+---------+---------+
| Parameter | Description                              | Range   | Default |
+===========+==========================================+=========+=========+
| interval  | time in seconds for advertise on startup | 5-86400 | 600     |
+-----------+------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# max-metric router-lsa on-startup
    dnRouter(cfg-protocols-ospf-mm-startup)# interval 3600


**Removing Configuration**

To stop the automatic max-metric advertisement:
::

    dnRouter(cfg-protocols-ospf)# no max-metric router-lsa on-startup

To return the interval to its default value:
::

    dnRouter(cfg-protocols-ospf)# no max-metric router-lsa on-startup interval

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/maximum-ecmp-paths.rst

protocols ospf instance maximum-ecmp-paths
------------------------------------------

**Minimum user role:** operator

To configure the OSPF maximum ECMP path limit:

**Command syntax: maximum-ecmp-paths [maximum-ecmp-paths]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- On-startup and On-shutdown may be configured simultaneously and are mutually exclusive with "administrative".

**Parameter table**

+--------------------+-------------------------------------------+-------+---------+
| Parameter          | Description                               | Range | Default |
+====================+===========================================+=======+=========+
| maximum-ecmp-paths | Maximum ECMP paths that OSPF can support. | 1-32  | 32      |
+--------------------+-------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# maximum-ecmp-paths 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ospf)# no maximum-ecmp-paths

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/maximum-redistributed-prefixes.rst

protocols ospf instance maximum-redistributed-prefixes
------------------------------------------------------

**Minimum user role:** operator

You can use the following command to configure the OSPF maximum redistributed prefixes limit and threshold limit. Scale is aggregated across all address-families. A single system-event notification is generated in the following cases:
	When the threshold is crossed
	When the threshold is cleared
	When the maximum is reached (no further prefixes are redistributed and a system-event notification is generated)
	When the redistributed prefixes decreases below the maximum.

**Command syntax: maximum-redistributed-prefixes [maximum]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**
The 'no maximum-redistributed-prefixes' returns the maximum and threshold to their default values.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| maximum   | maximum allowed number prefixes redistribute below which no more prefixes are    | 1-32000 | 10000   |
|           | allowed.                                                                         |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+
| threshold | threshold as a percentage of system maximum allowed redistributed prefixes.      | 1-100   | 75      |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# maximum-redistributed-prefixes 30000
    dnRouter(cfg-protocols-ospf)# maximum-redistributed-prefixes 30000 threshold 80


**Removing Configuration**

To return the maximum and threshold to their default values: 
::

    dnRouter(cfg-protocols-ospf)# no maximum-redistributed-prefixes

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 13.1    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/microloop-avoidance/admin-state.rst

protocols ospf instance microloop-avoidance admin-state
-------------------------------------------------------

**Minimum user role:** operator

To enable microloop avoidance:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance microloop-avoidance

**Parameter table**

+-------------+----------------------------+--------------+----------+
| Parameter   | Description                | Range        | Default  |
+=============+============================+==============+==========+
| admin-state | Enable microloop avoidance | | enabled    | disabled |
|             |                            | | disabled   |          |
+-------------+----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)# microloop-avoidance
    dnRouter(cfg-ospf-inst-uloop)# admin-state enabled


**Removing Configuration**

To revert admin-state to default:
::

    dnRouter(cfg-ospf-inst-uloop)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/microloop-avoidance/fib-delay.rst

protocols ospf instance microloop-avoidance fib-delay
-----------------------------------------------------

**Minimum user role:** operator

To set the required delay (in milliseconds) between the SR-TE micoloop-avoidance path installation and the post-convergance OSPF unicast path installation:

**Command syntax: fib-delay [fib-delay]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance microloop-avoidance

**Note**

- Microloop avoidance fib-delay parameter is per OSPF topology.

- Thefib-delaytimer should be configured to a value that corresponds to the worst-case IGP convergence in a given network domain.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| fib-delay | Delay time until installing post convergance OSPFv2 paths. Within this time      | 1000-60000 | 5000    |
|           | microloop paths will be used                                                     |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)# microloop-avoidance
    dnRouter(cfg-ospf-inst-uloop)# fib-delay 10000


**Removing Configuration**

To revert fib-delay to the default value:
::

    dnRouter(cfg-ospf-inst-uloop)# no fib-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/microloop-avoidance/maximum-labels.rst

protocols ospf instance microloop-avoidance maximum-labels
----------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the SR-TE microloop-avoidance constructed label stack.
If the calculated path exceeds the allowed maximum, than a microloop-avoidance path will not be provided by OSPF.
To set the maximum-labels:

**Command syntax: maximum-labels [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance microloop-avoidance

**Note**

- The microloop avoidance maximum-labels parameter is per OSPF topology.

**Parameter table**

+----------------+-----------------------------------------------------------+-------+---------+
| Parameter      | Description                                               | Range | Default |
+================+===========================================================+=======+=========+
| maximum-labels | Maximum allowed labels to be added for the microloop path | 1-3   | 3       |
+----------------+-----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)# microloop-avoidance
    dnRouter(cfg-ospf-inst-uloop)# maximum-labels 1


**Removing Configuration**

To revert maximum-labels to the default value:
::

    dnRouter(cfg-inst-afi-uloop)# no maximum-labels

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/microloop-avoidance/microloop-avoidance.rst

protocols ospf instance microloop-avoidance
-------------------------------------------

**Minimum user role:** operator

Microloops are brief packet loops that occur in the network following a topology change (link down, link up, or metric change events).
Microloops are caused by the non-simultaneous convergence of different nodes in the network.
If the nodes have converge and send traffic to a neighbor node that does not have converged yet, traffic may be looped between these two nodes, resulting in packet loss, jitter, and out-of-order packets.

The Segment Routing Microloop Avoidance feature detects if microloops are possible following a topology change.
If a node computes that a microloop could occur on the new topology, the node creates a loop-free SR-TE path to the destination using a list of segments.
After the FIB update delay timer expires, the SR-TE path is replaced with regular forwarding paths.

To configure microloop-avoidance, enter microloop-avoidance configuration mode:

**Command syntax: microloop-avoidance**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance INSTANCE_1
    dnRouter(cfg-protocols-ospf-inst)# microloop-avoidance
    dnRouter(cfg-ospf-inst-uloop)#


**Removing Configuration**

To revert all microloop-avoidance configuration to the default value:
::

    dnRouter(cfg-protocols-ospf-inst)# no microloop-avoidance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### instance/redistribute_bgp.rst

protocols ospf instance redistribute bgp
----------------------------------------

**Minimum user role:** operator

You can set the router to advertise directly bgp routes:

**Command syntax: redistribute bgp** metric [metric] metric-type [metric-type] policy [redistribute-policy] tag [tag] nssa-only

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- By default no redistribution is done.

- The metric default value is set by redistribute-metric <#ospf redistribute-metric> configuration.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter           | Description                                                                      | Range            | Default |
+=====================+==================================================================================+==================+=========+
| metric              | sets metric value for the redistributed route                                    | 0-16777214       | \-      |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-type         | sets metric-type for the redistributed route                                     | | 1              | 2       |
|                     |                                                                                  | | 2              |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| redistribute-policy | policy (route-map) for filtering the routes                                      | | string         | \-      |
|                     |                                                                                  | | length 1-255   |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| tag                 | The tag value. Tag zero means no tagging is done. If, for example, a static      | 0-4294967295     | \-      |
|                     | route has tag and it is redistributed tag 0 means it is kept with the same tag   |                  |         |
|                     | on the redistributed tag. A non zero tag should override the original static     |                  |         |
|                     | route tag,                                                                       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| nssa-only           | When set, redistributed routes will be advertised only for nssa areas, and will  | \-               | \-      |
|                     | have P bit unset for generated LSA 7 to prevent translation for type 5 LSA       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 2
    dnRouter(cfg-protocols-ospf-inst)# redistribute bgp
    dnRouter(cfg-protocols-ospf-inst)# redistribute bgp metric 1 metric-type 2 policy MY_POL tag 2341


**Removing Configuration**

To return the attribute to the default state:
::

    dnRouter(cfg-protocols-ospf-inst)# no redistribute bgp

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 18.1    | nssa-only added                              |
+---------+----------------------------------------------+

---

### instance/redistribute_connected.rst

protocols ospf instance redistribute connected
----------------------------------------------

**Minimum user role:** operator

You can set the router to advertise directly connected routes:

**Command syntax: redistribute connected** metric [metric] metric-type [metric-type] policy [redistribute-policy] tag [tag] nssa-only

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- By default no redistribution is done.

- The metric default value is set by the redistribute-metric <#ospf redistribute-metric> configuration.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter           | Description                                                                      | Range            | Default |
+=====================+==================================================================================+==================+=========+
| metric              | sets metric value for the redistributed route                                    | 0-16777214       | \-      |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-type         | sets metric-type for the redistributed route                                     | | 1              | 2       |
|                     |                                                                                  | | 2              |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| redistribute-policy | policy (route-map) for filtering the routes                                      | | string         | \-      |
|                     |                                                                                  | | length 1-255   |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| tag                 | The tag value. Tag zero means no tagging is done. If, for example, a static      | 0-4294967295     | \-      |
|                     | route has tag and it is redistributed tag 0 means it is kept with the same tag   |                  |         |
|                     | on the redistributed tag. A non zero tag should override the original static     |                  |         |
|                     | route tag,                                                                       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| nssa-only           | When set, redistributed routes will be advertised only for nssa areas, and will  | \-               | \-      |
|                     | have P bit unset for generated LSA 7 to prevent translation for type 5 LSA       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 2
    dnRouter(cfg-protocols-ospf-inst)# redistribute connected
    dnRouter(cfg-protocols-ospf-inst)# redistribute connected metric 1 metric-type 2 policy MY_POL tag 2341	nssa-only


**Removing Configuration**

To return the attribute to the default state:
::

    dnRouter(cfg-protocols-ospf)# no redistribute connected

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 18.1    | nssa-only added                              |
+---------+----------------------------------------------+

---

### instance/redistribute_static.rst

protocols ospf instance redistribute static
-------------------------------------------

**Minimum user role:** operator

You can set the router to advertise directly static routes:

**Command syntax: redistribute static** metric [metric] metric-type [metric-type] policy [redistribute-policy] tag [tag] nssa-only

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- By default no redistribution is done.

- The metric default value is set by the redistribute-metric <#ospf redistribute-metric> configuration.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter           | Description                                                                      | Range            | Default |
+=====================+==================================================================================+==================+=========+
| metric              | sets metric value for the redistributed route                                    | 0-16777214       | \-      |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-type         | sets metric-type for the redistributed route                                     | | 1              | 2       |
|                     |                                                                                  | | 2              |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| redistribute-policy | policy (route-map) for filtering the routes                                      | | string         | \-      |
|                     |                                                                                  | | length 1-255   |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| tag                 | The tag value. Tag zero means no tagging is done. If, for example, a static      | 0-4294967295     | \-      |
|                     | route has tag and it is redistributed tag 0 means it is kept with the same tag   |                  |         |
|                     | on the redistributed tag. A non zero tag should override the original static     |                  |         |
|                     | route tag,                                                                       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| nssa-only           | When set, redistributed routes will be advertised only for nssa areas, and will  | \-               | \-      |
|                     | have P bit unset for generated LSA 7 to prevent translation for type 5 LSA       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance 2
    dnRouter(cfg-protocols-ospf-inst)# redistribute static
    dnRouter(cfg-protocols-ospf-inst)# redistribute static metric 1 metric-type 2 policy MY_POL tag 2341	nssa-only


**Removing Configuration**

To return the attribute to the default state:
::

    dnRouter(cfg-protocols-ospf)# no redistribute static

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 18.1    | nssa-only added                              |
+---------+----------------------------------------------+

---

### instance/redistribute-metric.rst

protocols ospf instance redistribute-metric
-------------------------------------------

**Minimum user role:** operator

You can use the following command to configure the OSPF maximum redistributed prefixes limit and threshold limit.\n
Scale is aggregated across all address-families. A single system-event notification is generated in the following cases:\n
	When the threshold is crossed
	When the threshold is cleared
	When the maximum is reached (no further prefixes are redistributed and a system-event notification is generated)
	When the redistributed prefixes decreases below the maximum.

**Command syntax: redistribute-metric [redistribute-metric]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- No command returns metric to its default value

**Parameter table**

+---------------------+-------------------------------------------------------------------------+------------+---------+
| Parameter           | Description                                                             | Range      | Default |
+=====================+=========================================================================+============+=========+
| redistribute-metric | Sets the default metric value for the OSPFv2 or OSPFv3 routing protocol | 0-16777214 | \-      |
+---------------------+-------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# redistribute-metric 1


**Removing Configuration**

To return the metric to its default value: 
::

    dnRouter(cfg-protocols-ospf)# no redistribute-metric

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/router-id.rst

protocols ospf instance router-id
---------------------------------

**Minimum user role:** operator

Use the following command to set the OSPF router-id as the network unique router ID

**Command syntax: router-id [router-id]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- The 'no router-id' command will restore the ospf router-id to its default value.

- When changing the router-id, the OSPF process will restart with the current configuration.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| router-id | A 32-bit number represented as a dotted quad assigned to each router running the | A.B.C.D | \-      |
|           | OSPFv2 protocol. This number should be unique within the autonomous system. the  |         |         |
|           | default value should be the highest IP address on the lowest routers Loopback    |         |         |
|           | Interfaces. If there is no Loopback Interfaces configured, then highest IP       |         |         |
|           | address on its active interfaces                                                 |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# router-id 100.70.1.45


**Removing Configuration**

To restore the ospf router-id to its default value:
::

    no router-id

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/seamless-bfd/reflector/advertise.rst

protocols ospf instance seamless-bfd reflector advertise
--------------------------------------------------------

**Minimum user role:** operator

To enable or disable advertising the Seamless BFD reflector discriminator.

**Command syntax: advertise [advertise]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance seamless-bfd reflector

**Parameter table**

+-----------+-------------------------------------------+--------------+----------+
| Parameter | Description                               | Range        | Default  |
+===========+===========================================+==============+==========+
| advertise | Set to enable to advertise this reflector | | enabled    | disabled |
|           |                                           | | disabled   |          |
+-----------+-------------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance ospf1
    dnRouter(cfg-protocols-ospf-inst)# seamless-bfd
    dnRouter(cfg-ospf-inst-s_bfd)# reflector reflector1
    dnRouter(cfg-inst-s_bfd-reflector)# advertise enabled
    dnRouter(cfg-inst-s_bfd-reflector)#


**Removing Configuration**

To stop advertising the reflector discriminator.
::

    dnRouter(ccfg-inst-s_bfd-reflector)# no advertise

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/seamless-bfd/reflector/reflector.rst

protocols ospf instance seamless-bfd reflector
----------------------------------------------

**Minimum user role:** operator

Provide the seamless BFD reflector that should be advertised by OSPF.

**Command syntax: reflector [reflector-list-to-advertise]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance seamless-bfd

**Parameter table**

+-----------------------------+-----------------------+-------+---------+
| Parameter                   | Description           | Range | Default |
+=============================+=======================+=======+=========+
| reflector-list-to-advertise | Name of the reflector | \-    | \-      |
+-----------------------------+-----------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance ospf1
    dnRouter(cfg-protocols-ospf-inst)# seamless-bfd
    dnRouter(cfg-ospf-inst-s_bfd)# reflector reflector1
    dnRouter(cfg-inst-s_bfd-reflector)#


**Removing Configuration**

To remove this reflector from being advertised.
::

    dnRouter(cfg-ospf-inst-s_bfd)# no reflector

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/seamless-bfd/seamless-bfd.rst

protocols ospf instance seamless-bfd
------------------------------------

**Minimum user role:** operator

To configure OSPF to advertise seamless-BFD reflector discriminators:

**Command syntax: seamless-bfd**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# instance ospf1
    dnRouter(cfg-protocols-ospf-inst)# seamless-bfd
    dnRouter(cfg-ospf-inst-s_bfd)#


**Removing Configuration**

To stop the ospf process from advertising seamless-bfd relector discriminators
::

    dnRouter(cfg-protocols-ospf-inst)# no seamless-bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### instance/segment-routing/admin-state.rst

protocols ospf instance segment-routing admin-state
---------------------------------------------------

**Minimum user role:** operator

This command enables/disables segment-routing in OSPF for source routing using the MPLS SID.
When enabled, segment-routing information is exchanged with all OSPF neighbors.
To enable/disable segment-routing:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance segment-routing

**Parameter table**

+-------------+--------------------+--------------+----------+
| Parameter   | Description        | Range        | Default  |
+=============+====================+==============+==========+
| admin-state | Enable SR for OSPF | | enabled    | disabled |
|             |                    | | disabled   |          |
+-------------+--------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# segment-routing
    dnRouter(cfg-protocols-ospf-sr)# admin-state disabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-protocols-ospf-sr)# no admin-state

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.0    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/segment-routing/administrative-distance.rst

protocols ospf instance segment-routing administrative-distance
---------------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, the administrative distance will be compared and the preference will be given to the routes with the lower administrative distance.
This setting affects which protocol is preferred in mpls-nexthop table in the RIB.

To configure the administrative distance for OSPF segment routing:

**Command syntax: administrative-distance [administrative-distance]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance segment-routing

**Parameter table**

+-------------------------+--------------------------------------------------+-------+---------+
| Parameter               | Description                                      | Range | Default |
+=========================+==================================================+=======+=========+
| administrative-distance | Set AD for OSPF-SR routes (mpls-nh & mpls table) | 1-255 | 107     |
+-------------------------+--------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# segment-routing
    dnRouter(cfg-protocols-ospf-sr)# administrative-distance 120


**Removing Configuration**

To revert the administrative-distance to its default value:
::

    dnRouter(cfg-protocols-ospf-sr)# no administrative-distance

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.0    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/segment-routing/mapping-server/mapping-server.rst

protocols ospf instance segment-routing mapping-server
------------------------------------------------------

**Minimum user role:** operator

A mapping-server with advertise enabled will advertise the binding SIDs defined in "segment-routing mpls mapping-server prefix-sid-map". A mapping-server with receive enabled is a mapping-client and will accept binding SIDs as if there were prefix-SID advertised from network nodes. See "ospf instance segment-routing mapping-server prefix-sid-map advertise" and "ospf instance segment-routing mapping-server prefix-sid-map receive".

To configure the segment routing mapping server:

**Command syntax: mapping-server**

**Command mode:** config

**Hierarchies**

- protocols ospf instance segment-routing

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF_1
    dnRouter(cfg-protocols-ospf-inst)# segment-routing
    dnRouter(cfg-ospf-inst-sr)# mapping-server
    dnRouter(cfg-inst-sr-mapping)#


**Removing Configuration**

To revert all mapping-server configuration to their default values:
::

    dnRouter(cfg-ospf-inst-sr)# no mapping-server

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/segment-routing/mapping-server/preference.rst

protocols ospf instance segment-routing mapping-server preference
-----------------------------------------------------------------

**Minimum user role:** operator

You can change the preference value of the mapping server - the higher the value the more preferred the server.

To configure the preference value for the mapping server:

**Command syntax: preference [preference]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance segment-routing mapping-server

**Note**

- Segment-routing can be enabled for a single OSPF instance only.

**Parameter table**

+------------+----------------------------------------------------------------------------------+----------------+---------+
| Parameter  | Description                                                                      | Range          | Default |
+============+==================================================================================+================+=========+
| preference | The new preference value to be advertised                                        | 0-255/disabled | 128     |
|            | A value of 0 indicates that advertisements from this node must not be used. The  |                |         |
|            | preference TLV will not be advertised.                                           |                |         |
+------------+----------------------------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF_1
    dnRouter(cfg-protocols-ospf-inst)# segment-routing
    dnRouter(cfg-ospf-inst-sr)# mapping-server
    dnRouter(cfg-inst-sr-mapping)# preference 200

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF_1
    dnRouter(cfg-protocols-ospf-inst)# segment-routing
    dnRouter(cfg-ospf-inst-sr)# mapping-server
    dnRouter(cfg-inst-sr-mapping)# preference disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-sr-mapping)# no preference

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/segment-routing/mapping-server/prefix-sid-map-advertise.rst

protocols ospf instance segment-routing mapping-server prefix-sid-map advertise
-------------------------------------------------------------------------------

**Minimum user role:** operator

This command enables the node as a mapping server. The router will advertise binding SIDs according to the configured mapping.

To enable/disable the node as a mapping server:

**Command syntax: prefix-sid-map advertise [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance segment-routing mapping-server

**Note**

- When mapping server is enabled, the router will always use the local mapping, even if the mapping client functionality is disabled.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | The administrative state of the mapping-server. When enabled, the router will    | | enabled    | disabled |
|             | act as a segment-routing mapping server and will always use the local mapping,   | | disabled   |          |
|             | even if the mapping client functionality is disabled.                            |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF_1
    dnRouter(cfg-protocols-ospf-inst)# segment-routing
    dnRouter(cfg-ospf-inst-sr)# mapping-server
    dnRouter(cfg-inst-sr-mapping)# prefix-sid-map advertise enabled


**Removing Configuration**

To revert to the default advertise admin-state:
::

    dnRouter(cfg-inst-afi-sr)# no prefix-sid-map advertise

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/segment-routing/mapping-server/prefix-sid-map-receive.rst

protocols ospf instance segment-routing mapping-server prefix-sid-map receive
-----------------------------------------------------------------------------

**Minimum user role:** operator

This command enables the node as a mapping client. A mapping client can serve multiple mapping servers.

To enable/disable the node as a mapping client:

**Command syntax: prefix-sid-map receive [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance segment-routing mapping-server

**Note**

- When mapping server is enabled, the router will always use the local mapping, even if the mapping client functionality is disabled.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | The administrative state of the mapping-client. When enabled, the router will    | | enabled    | enabled |
|             | act as a segment-routing mapping client.                                         | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# instance OSPF_1
    dnRouter(cfg-protocols-ospf-inst)# segment-routing
    dnRouter(cfg-ospf-inst-sr)# mapping-server
    dnRouter(cfg-inst-sr-mapping)# prefix-sid-map receive enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-inst-afi-sr)# no prefix-sid-map receive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/segment-routing/segment-routing.rst

protocols ospf instance segment-routing
---------------------------------------

**Minimum user role:** operator

A router in a Segment Routing network can select any path to forward traffic, whether explicit or Interior Gateway Protocol (IGP) shortest path. Each segment in the path to a network destination has an identifier (a segment ID - SID) that is distributed throughout the network via IGP extensions.

To use segment routing with OSPF, you need to configure these commands:

#.	Optional, set the segment routing global block (SRGB) and segment routing local block (SRLB) label ranges that will be used by each segment routing-enabled router in the network. You can do this globally for all IGPs (see "routing-options segment-routing mpls global-block" and "routing-options segment-routing mpls local-block") or within the IGP (see "isis instance segment-routing global-block" and "isis instance segment-routing local-block"). If you do not explicitly configure the label block ranges, default ranges will be used.

#.	Enable segment routing for the OSPF.

#.	Set the router's node-SID under the OSPF loopback interface.

#.	Optional, set the administrative-distance for OSPF segment-routing. If you do not explicitly configure the administrative-distance, the default value will be used.

To enter OSPF segment-routing configuration level:

**Command syntax: segment-routing**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# segment-routing
    dnRouter(cfg-protocols-ospf-sr)#


**Removing Configuration**

To revert all segment-routing configuration to default:
::

    dnRouter(cfg-protocols-ospf)# no segment-routing

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.0    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/ti-fast-reroute/admin-state.rst

protocols ospf instance ti-fast-reroute admin-state
---------------------------------------------------

**Minimum user role:** operator

To enable ti-lfa fast-reroute:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance ti-fast-reroute

**Parameter table**

+-------------+---------------------------------------+--------------+----------+
| Parameter   | Description                           | Range        | Default  |
+=============+=======================================+==============+==========+
| admin-state | Set to enable ti-lfa in a given level | | enabled    | disabled |
|             |                                       | | disabled   |          |
+-------------+---------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# admin-state enabled


**Removing Configuration**

To revert the admin-state to the default value:
::

    dnRouter(cfg-protocols-ospf-ti-frr)# no admin-state

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.1    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/ti-fast-reroute/maximum-labels.rst

protocols ospf instance ti-fast-reroute maximum-labels
------------------------------------------------------

**Minimum user role:** operator

Sets the maximum allowed number of labels on the TI-LFA constructed label stack.
If the calculated path exceeds the allowed maximum, an LFA path will not be provided by OSPF and no alternate path will be installed.
To set the maximum-labels:

**Command syntax: maximum-labels [maximum-labels]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance ti-fast-reroute

**Parameter table**

+----------------+------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                            | Range | Default |
+================+========================================================================+=======+=========+
| maximum-labels | Set the maximum number of allowed additional labels in the SR LFA path | 1-5   | 3       |
+----------------+------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# maximum-labels 2


**Removing Configuration**

To revert maximum-labels to the default value:
::

    dnRouter(cfg-protocols-ospf-ti-frr)# no maximum-labels

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.1    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/ti-fast-reroute/protection-mode.rst

protocols ospf instance ti-fast-reroute protection-mode
-------------------------------------------------------

**Minimum user role:** operator

Sets the required ti-fast-reroute protection.  
For link protection, it will try to provide link protection. If none are found, no TI-LFA will be provided. Note that the solution might protect the remote node as well, in which case it will be displayed as node protection.
For node protection, it will first try to find a node protection path. If none are found, it will search for a link protection path.

Configuring Shared Risk Link Group (SRLG) protection in TI-LFA Fast-reroute for segment routing allows for a fast reroute backup path that shares no common SRLG with the protected (primary) path.
Links with the same SRLG configuration typically share a common fiber, meaning they may fail if the fiber breaks. TI-LFA SRLG-disjoint protection attempts to find a backup path that excludes the SRLG of the protected path. In case of full path, all links of the protected path that share any SRLG with the candidate backup paths are excluded.
SRLG-disjoint - Once set, the fast-reroute LFA path will be SRLG-disjoint with the primary path egress interface SRLG value.
The SRLG mode can be configured with srlg-mode command.

To set the ti-fast-reroute protection:

**Command syntax: protection-mode [protection-mode]** srlg-disjoint

**Command mode:** config

**Hierarchies**

- protocols ospf instance ti-fast-reroute

**Note**

- Node protection calculation has higher calculation complexity and may risk that OSPF will find LFA path in the required time.

**Parameter table**

+-----------------+------------------------------------+----------+---------+
| Parameter       | Description                        | Range    | Default |
+=================+====================================+==========+=========+
| protection-mode | the desired ti-lfa protection type | | link   | link    |
|                 |                                    | | node   |         |
+-----------------+------------------------------------+----------+---------+
| srlg-disjoint   | srlg-disjoint configuration        | \-       | \-      |
+-----------------+------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# protection-mode node
    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# protection-mode link srlg-disjoint


**Removing Configuration**

To revert protection-mode to the default value:
::

    dnRouter(cfg-protocols-ospf-ti-frr)# no protection-mode

To revert the srlg-disjoint constraint:
::

    dnRouter(cfg-protocols-ospf-ti-frr)# no protection-mode node srlg-disjoint

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.1    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+
| 25.2    | Add SRLG disjoint support                    |
+---------+----------------------------------------------+

---

### instance/ti-fast-reroute/srlg-mode.rst

protocols ospf instance ti-fast-reroute srlg-mode
-------------------------------------------------

**Minimum user role:** operator

Define the SRLG disjointment constraint.
loose (default) - Require srlg disjoint between protected egress interface and protecting path local egress interface. If disjoint alternate path is not found, DNOS will provide an LFA path (assuming one exists) without ANY SRLG consideration.
loose-full-path - Require srlg disjoint between protected egress interface and all links of protecting path. If disjoint alternate path is not found, DNOS will provide an LFA path (assuming one exists) without ANY SRLG consideration.
strict - Require srlg disjoint between protected egress interface and protecting path local egress interface. If disjoint alternate path is not found, no alternate path will be provided.
strict-full-path - Require srlg disjoint between protected egress interface and all links of protecting path. If disjoint alternate path is not found, no alternate path will be provided.

To set SRLG-mode:

**Command syntax: srlg-mode [srlg-mode]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance ti-fast-reroute

**Note**

- loose-full-path/strict-full-path mode has compute resource penalty and it will take longer to find ti-fast-reroute alternate paths

- The configuration has no effect if the protection mode is not SRLG disjoint.

**Parameter table**

+-----------+-----------------------------------------+----------------------+---------+
| Parameter | Description                             | Range                | Default |
+===========+=========================================+======================+=========+
| srlg-mode | Define the srlg disjointment constraint | | loose              | loose   |
|           |                                         | | loose-full-path    |         |
|           |                                         | | strict             |         |
|           |                                         | | strict-full-path   |         |
+-----------+-----------------------------------------+----------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# srlg-mode strict
    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# srlg-mode loose-full-path


**Removing Configuration**

To revert the srlg-mode to the default behavior:
::

    dnRouter(cfg-protocols-ospf-ti-frr)# no srlg-mode

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ti-fast-reroute/srlg-over-node.rst

protocols ospf instance ti-fast-reroute srlg-over-node
------------------------------------------------------

**Minimum user role:** operator

When protection mode is node-protection" and a slrg-disjoint is required, the system (by default) will try and find an lfa path according to the following phases:
1. Find a protection path that provides both srlg-disjoint and node protection.
2. If none are found, find a protection path that provides node protection (assuming srlg-mode is not strict).
3. If none are found, find a protection path that provides both srlg-disjoint and link protection.
4. If none are found, find a protection path that provides link protection (assuming srlg-mode is not strict).

If srlg disjointment is preferred over providing node protection, the user must enable the srlg-over-node. This will result in the system trying to find an lfa path according to the following phases:
1. Find a protection path that provides both srlg-disjoint and node protection.
2. If none are found, find a protection path that provides both srlg-disjoint and link protection.
3. If none are found, find a protection path that provides node protection (assuming srlg-mode is not strict).
4. If none are found, find a protection path that provides link protection (assuming srlg-mode is not strict).

To enable srlg-over-node:

**Command syntax: srlg-over-node [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance ti-fast-reroute

**Note**

- The configuration has no effect if protection mode is not "node-protection", or if the srlg-mode is strict.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | In case node protection with srlg-disjoint is required, define that              | | enabled    | disabled |
|             | srlg-disjointment is more important to be provided than node protection          | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# srlg-over-node enabled
    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# srlg-over-node disabled


**Removing Configuration**

To revert the srlg-over-node to the default value:
::

    dnRouter(cfg-protocols-ospf-ti-frr)# no srlg-over-node

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### instance/ti-fast-reroute/strict-spf-protection.rst

protocols ospf instance ti-fast-reroute strict-spf-protection
-------------------------------------------------------------

**Minimum user role:** operator

To set if segment-routing can utilize the TI-LFA path for protection of strict-spf prefix-sids:

**Command syntax: strict-spf-protection [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance ti-fast-reroute

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Set if segment-routing can utilize the TI-LFA path for protection of strict-spf  | | enabled    | disabled |
|             | prefix-sids                                                                      | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)# strict-spf-protection enabled


**Removing Configuration**

To revert strict-spf-protection to the default value:
::

    dnRouter(cfg-protocols-ospf-ti-frr)# no strict-spf-protection

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.1    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/ti-fast-reroute/ti-fast-reroute.rst

protocols ospf instance ti-fast-reroute
---------------------------------------

**Minimum user role:** operator

Topology-Independent Loop-Free-Alternate can be used to construct alternate paths using Segment-Routing lsps to provide sub 50msec fast reroute recovery.
With TI-LFA a per-prefix alternate path will be created.
The alternate path may utilize usage of SR labels to construct a specific SR lsp to forward the packet to the desired merge-point with the goal of using the post-convergence path.
By doing so, an alternate path can be provided for any required topology.
To configure ti-lfa, enter ti-lfa configuration mode:

**Command syntax: ti-fast-reroute**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Note**

- For ti-fast-reroute to work, segment-routing must be enabled.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# ti-fast-reroute
    dnRouter(cfg-protocols-ospf-ti-frr)#


**Removing Configuration**

To revert all ti-fast-reroute configuration to the default value:
::

    dnRouter(cfg-protocols-ospf)# no ti-fast-reroute

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 17.1    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/timers/lsa-arrival.rst

protocols ospf instance timers lsa-arrival
------------------------------------------

**Minimum user role:** operator

Sets the minimum interval to accept the same LSA, in milliseconds.

**Command syntax: lsa-arrival [timer-lsa-arrival]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance timers

**Parameter table**

+-------------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter         | Description                                                                      | Range  | Default |
+===================+==================================================================================+========+=========+
| timer-lsa-arrival | the minimum interval in which the software accepts the same link-state           | 0-1000 | 1000    |
|                   | advertisement (LSA) from OSPF neighbors                                          |        |         |
+-------------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# timers lsa-arrival 600


**Removing Configuration**

To revert to the default timer value
::

    dnRouter(cfg-protocols-ospf)# no timers lsa-arrival

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/timers/refresh.rst

protocols ospf instance timers refresh
--------------------------------------

**Minimum user role:** operator

OSPF link states have an age, indicating whether the link state is still valid. When the link state reaches the maximum age, it is discarded. During the aging process, the originating router periodically sends a refresh packet to refresh the link state and keep it from expiring.

**Command syntax: refresh [refresh-timer]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance timers

**Parameter table**

+---------------+----------------------------------------------------+-----------+---------+
| Parameter     | Description                                        | Range     | Default |
+===============+====================================================+===========+=========+
| refresh-timer | Sets the time of the OSPF link-state refresh timer | 1800-2700 | 1800    |
+---------------+----------------------------------------------------+-----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# timers refresh 2000


**Removing Configuration**

To revert to the default timer value
::

    dnRouter(cfg-protocols-ospf)# no timers refresh

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/timers/throttle-lsa-all.rst

protocols ospf instance timers throttle lsa all hold-interval start-interval max-interval
-----------------------------------------------------------------------------------------

**Minimum user role:** operator

OSPF LSA throttling provides a dynamic mechanism to slow down link-state advertisement (LSA) updates in OSPF during times of network instability. It also allows faster OSPF convergence by providing LSA rate limiting in milliseconds.
The first LSA that is generated uses the start-interval timer, so it is generated after start-interval milliseconds. If the same LSA has to be re-generated, it will use the lsa-hold value instead. When the LSA has to be generated the third time, the lsa-hold value will double.
Each time the LSA is re-generated, the lsa-hold value will double until it reaches the lsa-max value.
An LSA is considered the same if the following three values are the same: (1) LSA ID number (2) LSA type (3) advertising router ID.

**Command syntax: throttle lsa all hold-interval [hold-interval] start-interval [start-interval] max-interval [max-interval]**

**Command mode:** config

**Hierarchies**

- protocols ospf instance timers

**Parameter table**

+----------------+------------------------------+----------+---------+
| Parameter      | Description                  | Range    | Default |
+================+==============================+==========+=========+
| hold-interval  | timer for second LSA message | 0-500000 | 200     |
+----------------+------------------------------+----------+---------+
| start-interval | Initial LSA schedule delay.  | 0-500000 | 50      |
+----------------+------------------------------+----------+---------+
| max-interval   | timer for second LSA message | 0-500000 | 5000    |
+----------------+------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# timers throttle lsa all hold-interval 100 start-interval 5 max-interval 5000


**Removing Configuration**

The no timers throttle lsa all command reverts LSA throttling timers to their default values.
::

    dnRouter(cfg-protocols-ospf)# no timers throttle lsa all

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/timers/throttle-spf.rst

protocols ospf instance timers throttle spf
-------------------------------------------

**Minimum user role:** operator

When an OSPF router receives an updated LSA, it doesnt immediately run SPF but schedules it, in case there is a change in the topology. Because several routers may be affected by the change, it is likely that multiple updated LSAs are received. The router waits for a short while so that it only has to run SPF once for all updated LSAs.
To prevent the router from repeatedly running SPF if the topology change results from a flapping link, the delay in running SPF will keep increasing as long as updated LSAs keep arriving and up to a maximum holdtime interval.

**Command syntax: throttle spf {delay [delay], max-holdtime [max-holdtime], min-holdtime [min-holdtime]}**

**Command mode:** config

**Hierarchies**

- protocols ospf instance timers

**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                      | Range    | Default |
+==============+==================================================================================+==========+=========+
| delay        | Initial SPF schedule delay in milliseconds                                       | 0-600000 | 50      |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| max-holdtime | Maximum wait time between two consecutive SPF calculations Must be lower than    | 0-600000 | 5000    |
|              | max-holdtime                                                                     |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| min-holdtime | Minimum hold time between two consecutive SPF calculations must be higher than   | 0-600000 | 200     |
|              | min-holdtime                                                                     |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# timers throttle spf delay 1 min-holdtime 1000 max-holdtime 90000


**Removing Configuration**

The no timers throttle spf command reverts SPF throttling timers to their default values.
::

    dnRouter(cfg-protocols-ospf)# no timers throttle spf

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### instance/timers/timers.rst

protocols ospf instance timers
------------------------------

**Minimum user role:** operator

Configure timers

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols ospf instance

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# timers
    dnRouter(cfg-protocols-ospf-timers)#


**Removing Configuration**

To revert all timers parameters to their default values: 
::

    dnRouter(cfg-protocols-ospf)# no timers

**Command History**

+---------+----------------------------------------------+
| Release | Modification                                 |
+=========+==============================================+
| 11.6    | Command introduced                           |
+---------+----------------------------------------------+
| 18.1    | Hierarchy changed to protocols ospf instance |
+---------+----------------------------------------------+

---

### maximum-adjacencies.rst

protocols ospf maximum-adjacencies
----------------------------------

**Minimum user role:** operator

You can use the following command to configure the OSPF maximum adjacencies and threshold limit.

**Command syntax: maximum-adjacencies [maximum]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols ospf

**Note**

- When the threshold is crossed, a single system-event OSPF_MAXIMUM_ADJACENCIES_THRESHOLD_EXCEEDED notification is generated.

- When the threshold is cleared, a single system-event OSPF_MAXIMUM_ADJACENCIES_THRESHOLD_CLEARED notification is generated.

- When the maximum threshold is crossed, a system-event OSPF_MAXIMUM_ADJACENCIES_LIMIT_REACHED notification is generated.

- When the maximum threshold is cleared, a single system-event OSPF_MAXIMUM_ADJACENCIES_LIMIT_CLEARED notification is generated.

**Parameter table**

+-----------+-----------------------------------------------------------+---------+---------+
| Parameter | Description                                               | Range   | Default |
+===========+===========================================================+=========+=========+
| maximum   | maximum number of adjacencies.                            | 1-65535 | 500     |
+-----------+-----------------------------------------------------------+---------+---------+
| threshold | threshold as a percentage of maximum allowed adjacencies. | 1-100   | 75      |
+-----------+-----------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# maximum-adjacencies 433
    dnRouter(cfg-protocols-ospf)# maximum-adjacencies 433 threshold 65


**Removing Configuration**

To return the maximum and threshold to their default values: 
::

    dnRouter(cfg-protocols-ospf)# no maximum-adjacencies

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.1    | Command introduced |
+---------+--------------------+

---

### maximum-routes.rst

protocols ospf maximum-routes
-----------------------------

**Minimum user role:** operator

You can use the following command to configure the OSPF maximum routes and threshold limit.

**Command syntax: maximum-routes [maximum]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols ospf

**Note**

- The 'no maximum-routes' returns the maximum and threshold to their default values.

**Parameter table**

+-----------+------------------------------------------------------+--------------+---------+
| Parameter | Description                                          | Range        | Default |
+===========+======================================================+==============+=========+
| maximum   | maximum number of routes.                            | 1-4294967295 | 32000   |
+-----------+------------------------------------------------------+--------------+---------+
| threshold | threshold as a percentage of maximum allowed routes. | 1-100        | 75      |
+-----------+------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)# maximum-routes 90000
    dnRouter(cfg-protocols-ospf)# maximum-routes 90000 threshold 80


**Removing Configuration**

To return the maximum and threshold to their default values: 
::

    dnRouter(cfg-protocols-ospf)# no maximum-routes

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.1    | Command introduced |
+---------+--------------------+

---

### nsr.rst

protocols ospf nsr
------------------

**Minimum user role:** operator

OSPF nonstop routing (NSR) enables an OSPF speaker to maintain OSPF adjacencies, state and database, while undergoing a switchover at the CPU level (e.g. NCC switchover). Unlike OSPF graceful-restart (GR), which requires support from an OSPF neighbor as GR helper, NSR recovery is transparent to the network and connected neighbors.
OSPF NSR is supported for cluster (external NCC) and stand-alone setups.
Configuration applies for all OSPFv2 instances in all VRFs.
To enable/disable OSPF NSR:

**Command syntax: nsr [nsr]**

**Command mode:** config

**Hierarchies**

- protocols ospf

**Note**

- NSR is mutually exclusive with GR support. OSPF NSR and OSPF graceful restart in restarting mode cannot be enabled at the same time.

**Parameter table**

+-----------+---------------------------+--------------+---------+
| Parameter | Description               | Range        | Default |
+===========+===========================+==============+=========+
| nsr       | Set OSPF Non Stop Routing | | enabled    | enabled |
|           |                           | | disabled   |         |
+-----------+---------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospf
    dnRouter(cfg-protocols-ospf)# nsr enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ospf)# no nsr

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### ospf overview.rst

Open Shortest Path First (OSPF) Overview
----------------------------------------
Open Shortest Path First (OSPF) is a link-state routing protocol that operates within a single autonomous system. Each OSPF router maintains an identical database describing the routers' topology. Each router communicates its topology to other routers using link state advertisements (LSA). A topology of the area is constructed from these LSAs and is stored in the database. From this database, each router constructs a tree of shortest paths with itself as a root, giving the route to each destination in the autonomous system. OSPF recalculates routes quickly and dynamically in the face of topological changes, utilizing a minimum of routing protocol traffic.

The OSPF protocol is enabled with equal-cost multi-path routing (ECMP) so that packet forwarding to a single destination can spread across multiple next-hops as opposed to a single best.

The following commands are common to OSPFv2 (IPv4 OSPF version) and OSPFv3 (IPv6 OSPF version).

The following table maps the commands available per OSPF version:

+-------------------------------------------------------+------+--------+
| Command                                               | OSPF | OSPFv3 |
+-------------------------------------------------------+------+--------+
| clear ospf statistics                                 | v    | v      |
+-------------------------------------------------------+------+--------+
| clear ospf routes                                     | v    | v      |
+-------------------------------------------------------+------+--------+
| clear ospf process                                    | v    | v      |
+-------------------------------------------------------+------+--------+
| clear ospf database                                   | v    | v      |
+-------------------------------------------------------+------+--------+
| clear ospf interfaces                                 | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface hello-interval                    | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf auto-cost reference-bandwidth                    | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf class-of-service                                 | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf default-originate                                | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd admin-state                             | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd min-rx                                  | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd min-tx                                  | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd multiplier                              | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd                                         | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf max-metric router-lsa-administrative             | v    |        |
+-------------------------------------------------------+------+--------+
| ospf max-metric router-lsa on-startup                 | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd                               | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd admin-state                   | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd min-rx                        | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd min-tx                        | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd multiplier                    | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf maximum-ecmp-paths                               | v    |        |
+-------------------------------------------------------+------+--------+
| ospf maximum-redistributed-prefixes                   | v    |        |
+-------------------------------------------------------+------+--------+
| ospf redistribute                                     | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf redistribute-metric                              | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf timers refresh                                   | v    |        |
+-------------------------------------------------------+------+--------+
| ospf timers throttle lsa all                          | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf timers lsa-arrival                               | v    |        |
+-------------------------------------------------------+------+--------+
| ospf timers throttle spf                              | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf administrative distance                          | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface cost                              | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface dead-interval                     | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface mtu-ignore                        | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface network                           | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface passive                           | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface                                   | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area                                             | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf log-adjacency-changes                            | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf router-id                                        | v    | v      |
+-------------------------------------------------------+------+--------+
| protocols ospf                                        | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf mpls ldp-sync                                    | v    |        |
+-------------------------------------------------------+------+--------+
| ospf graceful-restart                                 | v    |        |
+-------------------------------------------------------+------+--------+
| ospf fast-reroute                                     | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area network                                     | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area authentication                              | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area filter-list in/out                          | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface authentication                    | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface authentication-key authentication | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface authentication-key md5            | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface fast-reroute-candidate            | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface cost-mirroring                    | v    |        |
+-------------------------------------------------------+------+--------+
---

### ospf.rst

protocols ospf
--------------

**Minimum user role:** operator

Enters the OSPF configuration hierarchy level.

**Command syntax: ospf**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- The no command will remove the ospf protocol.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospf
    dnRouter(cfg-protocols-ospf)#


**Removing Configuration**

To remove the OSPF protocol
::

    dnRouter(cfg-protocols)# no ospf

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---


## SECTION 2.L: OSPFV3

Files in this section: 60

### administrative-distance-external.rst

protocols ospfv3 administrative-distance external
-------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.
To configure the administrative distance for ospfv3:

**Command syntax: administrative-distance external [administrative-distance-external]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- An admin-distance of 255 will cause the router to remove the route from the forwarding table and not use it.

**Parameter table**

+----------------------------------+----------------------------------------------------------+-------+---------+
| Parameter                        | Description                                              | Range | Default |
+==================================+==========================================================+=======+=========+
| administrative-distance-external | Set the administrative distance for ospf external routes | 1-255 | \-      |
+----------------------------------+----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# administrative-distance external 120


**Removing Configuration**

To revert all distances to their default value:
::

    dnRouter(cfg-protocols-ospfv3)# no administrative-distance

To revert a specific distance to its default value:
::

    dnRouter(cfg-protocols-ospfv3)# no administrative-distance external

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### administrative-distance-inter.rst

protocols ospfv3 administrative-distance inter-area
---------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.
To configure the administrative distance for ospfv3:

**Command syntax: administrative-distance inter-area [administrative-distance-inter-area]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- An admin-distance of 255 will cause the router to remove the route from the forwarding table and not use it.

**Parameter table**

+------------------------------------+------------------------------------------------------------+-------+---------+
| Parameter                          | Description                                                | Range | Default |
+====================================+============================================================+=======+=========+
| administrative-distance-inter-area | Set the administrative distance for ospf inter-area routes | 1-255 | \-      |
+------------------------------------+------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# administrative-distance inter-area 200


**Removing Configuration**

To revert all distances to their default value:
::

    dnRouter(cfg-protocols-ospfv3)# no administrative-distance

To revert a specific distance to its default value:
::

    dnRouter(cfg-protocols-ospfv3)# no administrative-distance inter-area

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### administrative-distance-intra.rst

protocols ospfv3 administrative-distance intra-area
---------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.
To configure the administrative distance for ospfv3:

**Command syntax: administrative-distance intra-area [administrative-distance-intra-area]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- An admin-distance of 255 will cause the router to remove the route from the forwarding table and not use it.

**Parameter table**

+------------------------------------+------------------------------------------------------------+-------+---------+
| Parameter                          | Description                                                | Range | Default |
+====================================+============================================================+=======+=========+
| administrative-distance-intra-area | Set the administrative distance for ospf intra-area routes | 1-255 | \-      |
+------------------------------------+------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# administrative-distance intra-area 150


**Removing Configuration**

To revert all distances to their default value:
::

    dnRouter(cfg-protocols-ospfv3)# no administrative-distance

To revert a specific distance to its default value:
::

    dnRouter(cfg-protocols-ospfv3)# no administrative-distance intra-area

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### administrative-distance.rst

protocols ospfv3 administrative-distance
----------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.
To configure the administrative distance for ospfv3:

**Command syntax: administrative-distance [administrative-distance]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- An admin-distance of 255 will cause the router to remove the route from the forwarding table and not use it.

**Parameter table**

+-------------------------+------------------------------------------+-------+---------+
| Parameter               | Description                              | Range | Default |
+=========================+==========================================+=======+=========+
| administrative-distance | Set the administrative distance for ospf | 1-255 | 110     |
+-------------------------+------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# administrative-distance 20
    dnRouter(cfg-protocols-ospfv3)# administrative-distance external 22
    dnRouter(cfg-protocols-ospfv3)# administrative-distance inter-area 25
    dnRouter(cfg-protocols-ospfv3)# administrative-distance intra-area 30


**Removing Configuration**

To revert administrative distances to the default value:
::

    dnRouter(cfg-protocols-ospfv3)# no administrative-distance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/area.rst

protocols ospfv3 area
---------------------

**Minimum user role:** operator

To set an OSPFV3 area ID and enter its configuration mode:

**Command syntax: area [area-id]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- No command disables the ospfv3 process for the specified area.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| area-id   | An identifier for the OSPFv3 area - described as either a 32-bit unsigned        | \-    | \-      |
|           | integer, or a dotted-quad                                                        |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)#
    dnRouter(cfg-protocols-ospfv3)# area 0.0.0.0
    dnRouter(cfg-protocols-ospfv3-area)#


**Removing Configuration**

To disable the ospfv3 process for the specified area:
::

    dnRouter(cfg-protocols-ospfv3)# no area 0.0.0.0

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/authentication.rst

protocols ospfv3 area authentication spi
----------------------------------------

**Minimum user role:** operator

Use authentication to guarantee that only trusted devices participate in the areas routing.
To configure the default authentication method for the OSPFv3 interfaces in the area:

**Command syntax: authentication [authentication-type] spi [spi] [ipsec-authentication-algorithm] password [secret]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area

**Note**

- Authentication is disabled by default.

- IPsec - IPsec is the expected authentication for all OSPFv3 packets over the interface.

- If the authentication secret is not entered with the command, then the user will be prompted to enter a clear-text password and verify it. This password will be saved in encrypted format.

- When using the same SPI value across multiple areas or interfaces, the same password must be used. Different passwords with the same SPI will be rejected.

**Parameter table**

+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+
| Parameter                      | Description                                                                      | Range            | Default                                       |
+================================+==================================================================================+==================+===============================================+
| authentication-type            | The authentication type that is used on the interface.                           | ipsec            | no authentication unless default set for area |
+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+
| spi                            | The Security Parameter Index (SPI) value.                                        | 256-4294967295   | \-                                            |
+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+
| ipsec-authentication-algorithm | The IPsec AH authentication algorithm.                                           | md5              | \-                                            |
+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+
| secret                         | The encrypted password. If you do not set an encrypted password, you will be     | | string         | \-                                            |
|                                | prompted to enter a clear password and verify it.                                | | length 1-255   |                                               |
+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# authentication ipsec spi 256 md5 password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# authentication ipsec spi 256 md5 password
    Enter password:
    Enter password for verification:


**Removing Configuration**

To disable the authentication requirement for OSPFv3 packets on the area:
::

    dnRouter(cfg-ospfv3-area-if)# no authentication

**Command History**

+---------+-----------------------------------------------+
| Release | Modification                                  |
+=========+===============================================+
| 17.0    | Command introduced                            |
+---------+-----------------------------------------------+
| 18.1    | Added SPI, IPSEC-authentication, and password |
+---------+-----------------------------------------------+

---

### area/bfd/admin-state.rst

protocols ospfv3 area bfd admin-state
-------------------------------------

**Minimum user role:** operator

To set the OSPFV3 BFD admin state for the interface:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area bfd

**Note**
- Per area interface bfd admin-state configuration
- 'no'command returns admin-state to its default settings

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-ospfv3-area)# bfd
    dnRouter(cfg-ospfv3-area-bfd)# admin-state enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-ospfv3-area)# bfd
    dnRouter(cfg-ospfv3-area-bfd)# admin-state disabled


**Removing Configuration**

To return the admin-state to its default value: 
::

    dnRouter(cfg-ospfv3-area-bfd)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/bfd/bfd.rst

protocols ospfv3 area bfd
-------------------------

**Minimum user role:** operator

Enters ospfv3 area bfd configuration level.


**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area

**Note**

- The Area BFD level is the default per-area interface BFD configuration level.

- OSPFV3 BFD session type is Single-hop.

- BFD source address is the ospfv3 interface source address. BFD destination address is the ospfv3 peer address.

- Upon BFD session down, ospfv3 session will be closed and all routes learnt from neighbor will be withdrawn.

- BFD works in asynchronous mode. Bfd established before the OSPFV3 adjacency, only once OSPFV3 adj. is FULL it will be dependent on BFD.

- BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations.

- Detection-time = negotiated-received-interval X received multiplier.

- This is the maximum amount of time that can elapse without receipt of a BFD control packet before the session is declared down.

- BFD neighbor can signal session state down, and upon receipt local bfd session will immediately switch to DOWN state.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# bfd
    dnRouter(cfg-ospfv3-area-bfd)#


**Removing Configuration**

To disable the ospf area bfd:
::

    dnRouter(cfg-protocols-ospfv3-area)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/bfd/min-rx.rst

protocols ospfv3 area bfd min-rx
--------------------------------

**Minimum user role:** operator

To set the OSPFv3 BFD default minimum receive interval for the area:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area bfd

**Note**
- The 'no' command returns to the default settings.

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | 300     |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area)# bfd
    dnRouter(cfg-ospfv3-area-bfd)# min-rx 400


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ospfv3-area)# no min-rx

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 11.6    | Command introduced                |
+---------+-----------------------------------+
| 15.1    | Added support for 5msec interval  |
+---------+-----------------------------------+

---

### area/bfd/min-tx.rst

protocols ospfv3 area bfd min-tx
--------------------------------

**Minimum user role:** operator

To set the OSPFv3 BFD default minimum transmit interval for the area:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area bfd

**Note**
- The 'no' command returns to the default settings.

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | 300     |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-ospfv3-area)# bfd
    dnRouter(cfg-ospfv3-area-bfd)# min-tx 400


**Removing Configuration**

To return the min-tx interval to its default value: 
::

    dnRouter(cfg-ospfv3-area-bfd)# no min-tx

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 11.6    | Command introduced                |
+---------+-----------------------------------+
| 15.1    | Added support for 5msec interval  |
+---------+-----------------------------------+

---

### area/bfd/multiplier.rst

protocols ospfv3 area bfd multiplier
------------------------------------

**Minimum user role:** operator

To set the OSPFv3 BFD default multiplier for the area:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area bfd

**Note**
- The 'no' command returns to the default settings.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-ospfv3-area)# bfd
    dnRouter(cfg-ospfv3-area-bfd)# multiplier 2


**Removing Configuration**

To return to the default value:
::

    dnRouter(cfg-ospfv3-area-bfd)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/authentication-disable.rst

protocols ospfv3 area interface authentication disable
------------------------------------------------------

**Minimum user role:** operator

If OSPFv3 authentication is configured, you must set the OSPF authentication key to a cryptographic password for the interface.
To configure the interface authentication key:

**Command syntax: authentication disable**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1
    dnRouter(cfg-ospfv3-area-if)# authentication disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1
    dnRouter(cfg-ospfv3-area-if)# authentication disabled
    Enter password:
    Enter password for verification:


**Removing Configuration**

To remove the disable option on authentication requirement for OSPFv3 packets on the interface:
::

    dnRouter(cfg-ospfv3-area-if)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### area/interface/authentication.rst

protocols ospfv3 area interface authentication spi
--------------------------------------------------

**Minimum user role:** operator

If OSPFv3 authentication is configured, you must set the OSPF authentication key to a cryptographic password for the interface.
To configure the interface authentication key:

**Command syntax: authentication [authentication-type] spi [spi] [ipsec-authentication-algorithm] password [secret]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**

- Authentication is disabled by default.

- IPsec - IPsec is the expected authentication for all OSPFv3 packets over the interface.

- If the authentication secret is not entered with the command, then the user will be prompted to enter a clear-text password and verify it. This password will be saved in encrypted format.

- When using the same SPI value across multiple areas or interfaces, the same password must be used. Different passwords with the same SPI will be rejected.

**Parameter table**

+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+
| Parameter                      | Description                                                                      | Range            | Default                                       |
+================================+==================================================================================+==================+===============================================+
| authentication-type            | The authentication type that is used on the interface.                           | ipsec            | no authentication unless default set for area |
+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+
| spi                            | The Security Parameter Index (SPI) value.                                        | 256-4294967295   | \-                                            |
+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+
| ipsec-authentication-algorithm | The IPsec AH authentication algorithm.                                           | md5              | \-                                            |
+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+
| secret                         | The encrypted password. If you do not set an encrypted password, you will be     | | string         | \-                                            |
|                                | prompted to enter a clear password and verify it.                                | | length 1-255   |                                               |
+--------------------------------+----------------------------------------------------------------------------------+------------------+-----------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1
    dnRouter(cfg-ospfv3-area-if)# authentication ipsec spi 256 md5 password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1
    dnRouter(cfg-ospfv3-area-if)# authentication ipsec spi 256 md5 password
    Enter password:
    Enter password for verification:


**Removing Configuration**

To disable the authentication requirement for OSPFv3 packets on the interface:
::

    dnRouter(cfg-ospfv3-area-if)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### area/interface/bfd/admin-state.rst

protocols ospfv3 area interface bfd admin-state
-----------------------------------------------

**Minimum user role:** operator

To set the OSPFv3 BFD admin state for the interface:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface bfd

**Note**
- Per area interface bfd admin-state configuration.
- The 'no'command returns admin-state to its default settings.

**Parameter table**

+-------------+--------------------------------------------------+--------------+---------+
| Parameter   | Description                                      | Range        | Default |
+=============+==================================================+==============+=========+
| admin-state | Sets the OSPF BFD admin state for the interface. | | enabled    | \-      |
|             |                                                  | | disabled   |         |
+-------------+--------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# bfd
    dnRouter(cfg-ospfv3-area-if-bfd)# admin-state enabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# bfd
    dnRouter(cfg-ospfv3-area-if-bfd)# admin-state disabled


**Removing Configuration**

To return the admin-state to its default value: 
::

    dnRouter(cfg-ospfv3-area-if-bfd)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/bfd/bfd.rst

protocols ospfv3 area interface bfd
-----------------------------------

**Minimum user role:** operator

To enable BFD protection for ospfv3, use the following command on the interface on which you enabled OSPFv3:


**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**

- The ospfv3 BFD session type is Single Hop.

- The BFD source address is the ospfv3 interface source address, and the BFD destination address is the ospfv3 peer address.

- When a BFD session is down, the ospfv3 session will be closed and all routes learned from the a neighbor will be withdrawn.

- BFD works in asynchronous mode. BFD established before the ospfv3 adjacency will depend on BFD only once ospfv3 adjacency is full.

- The BFD failure detection time is calculated out of the negotiated received interval and the remote multiplier configurations. The Detection-time = negotiated-received-interval X received multiplier. This is the maximum amount of time that can elapse without receiving a BFD control packet before the session is declared as down.

- A BFD neighbor can signal session state down, and upon receiving a local BFD session, it will immediately switch to DOWN state.

- no bfd command returns the interface bfd paramaters to their default which is taken from the related area BFD configuration.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if-bfd)# bfd
    dnRouter(cfg-ospfv3-area-if-bfd)#


**Removing Configuration**

To disable the ospf area bfd:
::

    dnRouter(cfg-ospfv3-area-if-bfd)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/bfd/min-rx.rst

protocols ospfv3 area interface bfd min-rx
------------------------------------------

**Minimum user role:** operator

To set the OSPFv3 BFD minimum receive interval for the interface:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface bfd

**Note**
- The 'no' command returns to the default settings.

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | \-      |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# bfd
    dnRouter(cfg-ospfv3-area-if-bfd)# min-rx 400


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-ospfv3-area-if-bfd)# no min-rx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+
| 17.0    | Min range changed  |
+---------+--------------------+

---

### area/interface/bfd/min-tx.rst

protocols ospfv3 area interface bfd min-tx
------------------------------------------

**Minimum user role:** operator

To set the OSPFv3 BFD minimum transmit interval for the interface:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface bfd

**Note**
- The 'no' command returns to the default settings.

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | \-      |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# bfd
    dnRouter(cfg-ospfv3-area-if-bfd)# min-tx 400


**Removing Configuration**

To return the min-tx interval to its default value: 
::

    dnRouter(cfg-ospfv3-area-if-bfd)# no min-tx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/bfd/multiplier.rst

protocols ospfv3 area interface bfd multiplier
----------------------------------------------

**Minimum user role:** operator

To set the OSPFv3 BFD minimum receive interval for the interface:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface bfd

**Note**
- The 'no' command returns to the default settings.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | \-      |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# bfd
    dnRouter(cfg-ospfv3-area-if-bfd)# multiplier 2


**Removing Configuration**

To return to the default value:
::

    dnRouter(cfg-ospfv3-area-if-bfd)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/cost.rst

protocols ospfv3 area interface cost
------------------------------------

**Minimum user role:** operator

Set link cost for the specified interface. The cost value is set to router-LSAs metric field and is used for SPF calculation. When the area default-cost is configured, the interface default cost value equals the configured area default-cost.
To set the link cost:

**Command syntax: cost [cost]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**
- The 'no' command returns the cost to its default value.
- Default cost value for a specific interface bandwidth is calculated by :math:`\frac{reference - bandwidth}{interface - bandwidth}` where reference-bandwidth, interface-bandwidth units are Mbits/s. when area default-cost is configured, default cost values equals area default cost
- User can configure the cost for the interface regardless if the cost-mirroring is enabled or not. The cost configuration will take place in the following cases:
* ospfv3 cost-mirroring is disabled
* ospfv3 adjacency is not yet up.

**Parameter table**

+-----------+------------------------------------------------+---------+---------+
| Parameter | Description                                    | Range   | Default |
+===========+================================================+=========+=========+
| cost      | set interface cost for interface under an area | 1-65535 | \-      |
+-----------+------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# cost 12050


**Removing Configuration**

To return the cost to its default value:
::

    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospfv3-area-if)# no cost

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/dead-interval.rst

protocols ospfv3 area interface dead-interval
---------------------------------------------

**Minimum user role:** operator

To configure the amount of time to wait for a hello-packet from the neighbor before declaring that neighbor dead:

**Command syntax: dead-interval [dead-interval]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**
- If the hello-interval was set (see "ospfv3 area interface hello-interval"), the dead-interval should be four times bigger than the hello-interval.
- The 'no' command sets the dead interval to its default value.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter     | Description                                                                      | Range   | Default |
+===============+==================================================================================+=========+=========+
| dead-interval | Dead interval:  this defines how long (in seconds) we should wait for hello      | 1-65535 | 40      |
|               | packets before we declare the neighbor dead                                      |         |         |
+---------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# dead-interval 120


**Removing Configuration**

To return the dead interval to its default value:
::

    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospfv3-area-if)# no dead-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/hello-interval.rst

protocols ospfv3 area interface hello-interval
----------------------------------------------

**Minimum user role:** operator

To configure the frequency of sending hello packets:

**Command syntax: hello-interval [hello-interval]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**
- If dead-interval was set (see "ospfv3 area interface dead-interval"), hello interval should be four times smaller than the dead-interval.
- The 'no' command sets the hello interval to its default value.

**Parameter table**

+----------------+------------------------------------------------------------------------------+---------+---------+
| Parameter      | Description                                                                  | Range   | Default |
+================+==============================================================================+=========+=========+
| hello-interval | Hello interval: this defines how often (in seconds) we send the hello packet | 1-16383 | 10      |
+----------------+------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# hello-interval 200


**Removing Configuration**

To return the hello interval to its default value:
::

    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospf-area-if)# no hello-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/interface.rst

protocols ospfv3 area interface
-------------------------------

**Minimum user role:** operator

To enable OSPFV3 on an interface and enter interface OSPFV3 configuration mode:


**Command syntax: interface [interface]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area

**Note**
- The 'no' command disables the ospfv3 process for a specific interface.
- An interface can only be configured to a single area. when trying to configure an already in use interface to another area the following error should be displayed: "Error: unable to set interface <interface-name>. Interface attached to area < area-id >".


**Parameter table**

+-----------+--------------------------+----------------------------------------+---------+
| Parameter | Description              | Range                                  | Default |
+===========+==========================+========================================+=========+
| interface | ospfv3 enabled interface | | geX-<f>/<n>/<p>                      | \-      |
|           |                          | | geX-<f>/<n>/<p>.<sub-interface-id>   |         |
|           |                          | | bundle-<bundle-id>                   |         |
|           |                          | | bundle-<bundle-id.sub-bundle-id>     |         |
|           |                          | | loX                                  |         |
|           |                          | | irb<0-65535>                         |         |
+-----------+--------------------------+----------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)#
    dnRouter(cfg-protocols-ospfv3-area)# interface bundle-2.1012
    dnRouter(cfg-ospfv3-area-if)#


**Removing Configuration**

To disable authentication requirement:
::

    dnRouter(cfg-protocols-ospfv3-area)# no interface ge100-1/2/1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/mtu-ignore.rst

protocols ospfv3 area interface mtu-ignore
------------------------------------------

**Minimum user role:** operator

To disable the MTU mismatch detection:

**Command syntax: mtu-ignore**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**

- The MTU-ignore is disabled by default.

- no MTU-ignore - returns the MTU mismatch detection.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# mtu-ignore


**Removing Configuration**

To return the mtu mismatch to its default value: 
::

    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospfv3-area-if)# no mtu-ignore

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/network-type.rst

protocols ospfv3 area interface network-type
--------------------------------------------

**Minimum user role:** operator

Set the OSPF area interface network type.

**Command syntax: network-type [network]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**
- The 'no network-type' command sets the network to its default value - point-to-point.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------------+----------------+
| Parameter | Description                                                                      | Range              | Default        |
+===========+==================================================================================+====================+================+
| network   | Enables OSPF on an interface and set enters interface ospf parameters            | | broadcast        | point-to-point |
|           | configuration                                                                    | | point-to-point   |                |
+-----------+----------------------------------------------------------------------------------+--------------------+----------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# network-type point-to-point


**Removing Configuration**

To return network-type to its default value:
::

    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospfv3-area-if)# no network-type

**Command History**

+---------+------------------------------+
| Release | Modification                 |
+=========+==============================+
| 11.6    | Command introduced           |
+---------+------------------------------+
| TBD     | Added broadcast network type |
+---------+------------------------------+

---

### area/interface/passive.rst

protocols ospfv3 area interface passive
---------------------------------------

**Minimum user role:** operator

Setting an OSPFV3 interface as passive disables the sending of routing updates on that interface, hence adjacencies will not be formed in OSPFV3. However, the particular subnet will continue to be advertised to other interfaces.
To set the interface to passive mode:

**Command syntax: passive [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**
-The 'no' command returns passive to its default disabled state.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Suppress routing updates on interface, thus disables the sending of routing      | | enabled    | disabled |
|             | updates on that interface                                                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# passive enabled


**Removing Configuration**

To return the passive mode admin-state to its default value:
::

    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-2/1/1

::

    dnRouter(cfg-ospfv3-area-if)# no passive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### area/interface/priority.rst

protocols ospfv3 area interface priority
----------------------------------------

**Minimum user role:** operator

Set the OSPFv3 router priority on an interface. Higher priority is preferred.

**Command syntax: priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 area interface

**Note**
- The 'no priority' command resets the priority to its default value (1).

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| priority  | Router priority for OSPF DR/BDR election. Higher values increase the likelihood  | 0-255 | 1       |
|           | of becoming DR.                                                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# area 0
    dnRouter(cfg-protocols-ospfv3-area)# interface ge100-1/2/1
    dnRouter(cfg-ospfv3-area-if)# priority 100


**Removing Configuration**

To return priority to its default value (1):
::

    dnRouter(cfg-ospfv3-area-if)# no priority

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| TBD     | Command introduced |
+---------+--------------------+

---

### auto-cost.rst

protocols ospfv3 auto-cost reference-bandwidth
----------------------------------------------

**Minimum user role:** operator

You can set the reference bandwidth for cost calculations, where this bandwidth is considered equivalent to an OSPFv3 cost of 1 (specified in Mbps). The default is 100 Mbps (i.e. a link of bandwidth 100 Mbps or higher will have a cost of 1. Cost of lower bandwidth links will be scaled with reference to this cost. 
To configure the reference bandwidth:

**Command syntax: auto-cost reference-bandwidth [auto-cost-reference-bandwidth]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Parameter table**

+-------------------------------+----------------------------------------------------------------------------------+-----------+---------+
| Parameter                     | Description                                                                      | Range     | Default |
+===============================+==================================================================================+===========+=========+
| auto-cost-reference-bandwidth | This sets the reference bandwidth for cost calculations, where this bandwidth is | 1-4294967 | 100     |
|                               | considered equivalent to an OSPF cost of 1, specified in Mbits/s. The default is |           |         |
|                               | 100Mbit/s (i.e. a link of bandwidth 100Mbit/s or higher will have a cost of 1.   |           |         |
|                               | Cost of lower bandwidth links will be scaled with reference to this cost).       |           |         |
+-------------------------------+----------------------------------------------------------------------------------+-----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# auto-cost reference-bandwidth 100000


**Removing Configuration**

To return the reference bandwidth to its default value: 
::

    dnRouter(cfg-protocols-ospfv3)# no auto-cost reference-bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### class-of-service.rst

protocols ospfv3 class-of-service
---------------------------------

**Minimum user role:** operator

Set dscp value for outgoing OSPFv3 packets. 
IPP is set accordingly. i.e DSCP 48 is mapped to 6.

**Command syntax: class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- No command returns dscp-value to default

**Parameter table**

+------------------+--------------------------------------+-------+---------+
| Parameter        | Description                          | Range | Default |
+==================+======================================+=======+=========+
| class-of-service | dscp value for outgoing OSPF packets | 0-56  | 48      |
+------------------+--------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# class-of-service 48


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ospfv3)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### default-originate.rst

protocols ospfv3 default-originate
----------------------------------

**Minimum user role:** operator

To force the router to generate an OSPFv3 AS-External (type-5) LSA, describing a default route into all external-routing capable areas, of the specified metric and metric type:

**Command syntax: default-originate** always metric [metric] metric-type [metric-type] policy [policy-name]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- default-originate is disabled by default.

- no default-originate - disables default-information originate.

- no default-originate [attribute] - return attribute to default state.

- If always is set, the default-route is originated with default metric 0. The Metric can be modified by a user configuration or policy logic.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter   | Description                                                                      | Range            | Default |
+=============+==================================================================================+==================+=========+
| always      | when true, the default is always advertised, even when there is no default       | Boolean          | False   |
|             | present in the routing table                                                     |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+
| metric      | Used for generating the default route, this parameter specifies the cost for     | 0-16777214       | \-      |
|             | reaching the rest of the world through this route.                               |                  |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-type | Specifies how the cost of a neighbor metric is determined                        | | 1              | 2       |
|             |                                                                                  | | 2              |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+
| policy-name | set routing policy                                                               | | string         | \-      |
|             |                                                                                  | | length 1-255   |         |
+-------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# default-originate
    dnRouter(cfg-protocols-ospfv3)# default-originate metric 10000
    dnRouter(cfg-protocols-ospfv3)# default-originate metric 10000 metric-type 2
    dnRouter(cfg-protocols-ospfv3)# default-originate metric 10000 metric-type 2 policy MY_POL
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# default-originate always
    dnRouter(cfg-protocols-ospfv3)# default-originate always metric 10000
    dnRouter(cfg-protocols-ospfv3)# default-originate always metric 10000 metric-type 2
    dnRouter(cfg-protocols-ospfv3)# default-originate metric-type 2 metric 3000 always
    dnRouter(cfg-protocols-ospfv3)# default-originate always metric 10000 metric-type 2 policy MY_POL  - dnRouter# configure


**Removing Configuration**

default-originate is disabled by default
::

    no default-originate - disables default-information originate

**Command History**

+---------+---------------------------------------------------+
| Release | Modification                                      |
+=========+===================================================+
| 11.6    | Command introduced                                |
+---------+---------------------------------------------------+
| 13.1    | Added support for OSPFv3                          |
+---------+---------------------------------------------------+
| 25.0    | Expected metric behavior note under 'always' knob |
+---------+---------------------------------------------------+

---

### graceful-restart/cisco-helper-mode-admin-state.rst

protocols ospfv3 graceful-restart helper-mode cisco admin-state
---------------------------------------------------------------

**Minimum user role:** operator

Configures OSPFv3 graceful restart cisco restarting-mode admin-state. The command enables/disables the graceful restart restarter behavior on the router.

**Command syntax: helper-mode cisco admin-state [cisco-helper-mode-admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 graceful-restart

**Parameter table**

+-------------------------------+----------------------------------------------------------------------------------+------------+---------+
| Parameter                     | Description                                                                      | Range      | Default |
+===============================+==================================================================================+============+=========+
| cisco-helper-mode-admin-state | Graceful Restart: Cisco helper mode admin state. When this leaf is set to true,  | enabled    | enabled |
|                               | the local system will listen to the peer Link Local Signaling field and          | disabled   |         |
|                               | cooperate with peer - when it sets the LLS Restart bit - to do LSDB              |            |         |
|                               | re-synchronization when it receives empty neighbor list from that peer           |            |         |
+-------------------------------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# graceful-restart
    dnRouter(cfg-protocols-ospfv3-gr)# helper-mode cisco admin-state enabled
    dnRouter(cfg-protocols-ospfv3-gr)# helper-mode cisco admin-state disabled


**Removing Configuration**

To revert helper-mode and admin-state to their default values
::

    dnRouter(cfg-protocols-ospfv3-gr)# no helper-mode cisco

**Command History**

+---------+--------------------------+
| Release | Modification             |
+=========+==========================+
| 11.6    | Command introduced       |
+---------+--------------------------+
| 13.1    | Added support for OSPFv3 |
+---------+--------------------------+

---

### graceful-restart/graceful-restart.rst

protocols ospfv3 graceful-restart
---------------------------------

**Minimum user role:** operator

OSPFV3 graceful restart enables a router undergoing a restart to inform its adjacent OSPFV3 neighbors of its restarting condition. During a graceful restart period, the restarting device and its neighbors continue to forward packets without disrupting network performance. Because neighboring devices assist in the restart (these are helper routers), the restarting device can resume routing operation without impacting forwarding of packets in the data-path.
To enable OSPFV3 graceful restart:

**Command syntax: graceful-restart**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# graceful-restart
    dnRouter(cfg-protocols-ospfv3-gr)#


**Removing Configuration**

To reverts all ospfv3 graceful restart parameters to thier default values:
::

    dnRouter(cfg-protocols-ospfv3)# no graceful-restart

**Command History**

+---------+--------------------------+
| Release | Modification             |
+=========+==========================+
| 11.6    | Command introduced       |
+---------+--------------------------+
| 13.1    | Added support for OSPFv3 |
+---------+--------------------------+

---

### graceful-restart/ietf-helper-mode-admin-state.rst

protocols ospfv3 graceful-restart helper-mode admin-state
---------------------------------------------------------

**Minimum user role:** operator

Configures OSPFv3 graceful restart IETF restarting-mode admin-state. The command enables/disables the graceful restart restarter behavior on the router.

**Command syntax: helper-mode admin-state [ietf-helper-mode-admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 graceful-restart

**Parameter table**

+------------------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter                    | Description                                                                      | Range        | Default |
+==============================+==================================================================================+==============+=========+
| ietf-helper-mode-admin-state | Graceful Restart standard IETF helper mode admin state. When this leaf is set to | | enabled    | enabled |
|                              | true, the local system will accept Grace-LSAs from remote systems, and suppress  | | disabled   |         |
|                              | withdrawl of adjacencies of the system for the grace period specified            |              |         |
+------------------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# graceful-restart
    dnRouter(cfg-protocols-ospfv3-gr)# helper-mode admin-state enabled
    dnRouter(cfg-protocols-ospfv3-gr)# helper-mode admin-state disabled


**Removing Configuration**

To revert helper-mode and admin-state to their default values
::

    dnRouter(cfg-protocols-ospfv3-gr)# no helper-mode

**Command History**

+---------+--------------------------+
| Release | Modification             |
+=========+==========================+
| 11.6    | Command introduced       |
+---------+--------------------------+
| 13.1    | Added support for OSPFv3 |
+---------+--------------------------+

---

### graceful-restart/ietf-helper-strict-lsa-checking_admin-state.rst

protocols ospfv3 graceful-restart ietf-helper-strict-lsa-checking admin-state
-----------------------------------------------------------------------------

**Minimum user role:** operator

Indicates whether or not an OSPFv3 restart helper (for IETF mode) should terminate the graceful restart when there is a change to an LSA that could be flooded
to the restarting router or when there is a changed LSA on the restarting router's retransmission list when the graceful restart is initiated.  
Default admin-state is enabled.
To configure ietf-helper-strict-lsa-checking admin-state:

**Command syntax: ietf-helper-strict-lsa-checking admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 graceful-restart

**Note**

- To reduce the risk of data loss for a stand-alone system hot-patch upgrade of the routing service, the operator is advised to disable LSA strict checking on neighbors.

**Parameter table**

+-------------+--------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                        | Range        | Default |
+=============+====================================================================+==============+=========+
| admin-state | Configure Strict LSA checking of IETF NSF per RFC 3623 Section B.2 | | enabled    | enabled |
|             |                                                                    | | disabled   |         |
+-------------+--------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# graceful-restart
    dnRouter(cfg-protocols-ospfv3-gr)# ietf-helper-strict-lsa-checking admin-state disabled


**Removing Configuration**

To revert ietf-helper-strict-lsa-checking admin-state to the default value
::

    dnRouter(cfg-protocols-ospfv3-gr)# no ietf-helper-strict-lsa-checking admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### graceful-restart/restarting-mode/admin-state.rst

protocols ospfv3 graceful-restart restarting-mode admin-state
-------------------------------------------------------------

**Minimum user role:** operator

Configures OSPFv3 graceful restart IETF restarting-mode admin-state. The command enables/disables the graceful restart restarter behavior on the router.

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 graceful-restart restarting-mode

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | When the value of this leaf is set to true, graceful restart restarting-mode is  | | enabled    | disabled |
|             | enabled on the local system. In this case, the system will use Grace-LSAs to     | | disabled   |          |
|             | signal that it is restarting to its neighbors.                                   |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# graceful-restart
    dnRouter(cfg-protocols-ospfv3-gr)# restarting-mode
    dnRouter(cfg-ospfv3-gr-restarting-mode)# admin-state enabled
    dnRouter(cfg-ospfv3-gr-restarting-mode)# admin-state disabled


**Removing Configuration**

To revert admin-state to its default value
::

    dnRouter(cfg-protocols-ospfv3-gr-restarting-mode)# no admin-state

**Command History**

+---------+------------------------------------------------+
| Release | Modification                                   |
+=========+================================================+
| 13.1    | Command introduced                             |
+---------+------------------------------------------------+
| 25.0    | Changed default value from enabled to disabled |
+---------+------------------------------------------------+

---

### graceful-restart/restarting-mode/grace-interval.rst

protocols ospfv3 graceful-restart restarting-mode grace-interval
----------------------------------------------------------------

**Minimum user role:** operator

Configures OSPFV3 graceful restart restarting-mode grace-interval, which is the minimum interval between two consecutive graceful-restart events, below which the router must not enter restarting-mode.
To enable OSPFV3 graceful restart restarting-mode:

**Command syntax: grace-interval [grace-ineterval]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 graceful-restart restarting-mode

**Note**
- 'no grace-interval' - reverts restarting grace-interval to its default value.

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter       | Description                                                                      | Range   | Default |
+=================+==================================================================================+=========+=========+
| grace-ineterval | Specifying Graceful Restart restarting-mode grace interval. The minimum allowed  | 60-3600 | 60      |
|                 | interval between consecutive graceful restart events.                            |         |         |
+-----------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# graceful-restart
    dnRouter(cfg-protocols-ospfv3-gr)# restarting-mode
    dnRouter(cfg-protocols-ospfv3-gr-restarting-mode)# grace-interval 1200


**Removing Configuration**

To revert restarting grace-interval to its default value
::

    dnRouter(cfg-ospfv3-gr-restarting-mode)# no grace-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.1    | Command introduced |
+---------+--------------------+

---

### graceful-restart/restarting-mode/grace-period.rst

protocols ospfv3 graceful-restart restarting-mode grace-period
--------------------------------------------------------------

**Minimum user role:** operator

Configures OSPFV3 graceful restart restarting-mode grace-period.

**Command syntax: grace-period [grace-period]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 graceful-restart restarting-mode

**Note**
- 'no grace-period' - reverts restarting grace-period to its default value.

**Parameter table**

+--------------+-----------------------------------------------------------+---------+---------+
| Parameter    | Description                                               | Range   | Default |
+==============+===========================================================+=========+=========+
| grace-period | Specifying Graceful Restart restarting-mode grace period. | 60-1800 | 120     |
+--------------+-----------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# graceful-restart
    dnRouter(cfg-protocols-ospfv3-gr)# restarting-mode
    dnRouter(cfg-protocols-ospfv3-gr-restarting-mode)# grace-period 200


**Removing Configuration**

To revert restarting grace-period to its default value
::

    dnRouter(cfg-ospfv3-gr-restarting-mode)# no grace-period

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.1    | Command introduced |
+---------+--------------------+

---

### graceful-restart/restarting-mode/restarting-mode.rst

protocols ospfv3 graceful-restart restarting-mode
-------------------------------------------------

**Minimum user role:** operator

Configures OSPFv3 graceful restart restarting-mode. The command configures the minimum interval between two consecutive graceful restart events, below which the router must not enter restart mode.

**Command syntax: restarting-mode**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 graceful-restart

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# graceful-restart
    dnRouter(cfg-protocols-ospfv3-gr)# restarting-mode
    dnRouter(cfg-protocols-ospfv3-gr-restarting-mode)#


**Removing Configuration**

To revert restarting-mode to its default value
::

    dnRouter(cfg-protocols-ospfv3-gr)# no restarting-mode

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.1    | Command introduced |
+---------+--------------------+

---

### max-metric-router-lsa-administrative-external-lsa.rst

protocols ospfv3 max-metric router-lsa administrative external-lsa
------------------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the OSPF administrative distance for all routes:

**Command syntax: max-metric router-lsa administrative external-lsa** external-lsa-metric [external-lsa-metric]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- The 'external-lsa' option is used to override the external-LSA metric with the max-metric value or with the [external-lsa] metric value.

**Parameter table**

+---------------------+---------------------------------------+------------+----------+
| Parameter           | Description                           | Range      | Default  |
+=====================+=======================================+============+==========+
| external-lsa-metric | The external-lsa metric to advertise. | 1-16777215 | 16711680 |
+---------------------+---------------------------------------+------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# max-metric router-lsa administrative external-lsa external-lsa-metric 120000


**Removing Configuration**

To stop the automatic max-metric advertisement:
::

    dnRouter(cfg-protocols-ospfv3)# no max-metric router-lsa administrative external-lsa

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### max-metric-router-lsa-administrative-include-stub.rst

protocols ospfv3 max-metric router-lsa administrative include-stub
------------------------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa administrative include-stub**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- The 'include-stub' option is used to advertise stub-links in router-LSA with the max-metric value.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# max-metric router-lsa administrative include-stub


**Removing Configuration**

To stop the automatic max-metric advertisement:
::

    dnRouter(cfg-protocols-ospfv3)# no max-metric router-lsa administrative

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### max-metric-router-lsa-administrative.rst

protocols ospfv3 max-metric router-lsa administrative
-----------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa administrative**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- This option is disabled by default.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# max-metric router-lsa administrative
    dnRouter(cfg-protocols-ospfv3-mm-admin)#


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospfv3)# no max-metric router-lsa administrative

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### max-metric-router-lsa-on-startup-external-lsa.rst

protocols ospfv3 max-metric router-lsa on-startup external-lsa
--------------------------------------------------------------

**Minimum user role:** operator

If a router learns about a destination from more than one routing protocol, administrative distance is compared and the preference is given to the routes with lower administrative distance.

To change the OSPF administrative distance for all routes:

**Command syntax: max-metric router-lsa on-startup external-lsa** external-lsa-metric [external-lsa-metric]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- The 'external-lsa' option is used to override the external-LSA metric with the max-metric value or with the [external-lsa] metric value.

**Parameter table**

+---------------------+---------------------------------------+------------+----------+
| Parameter           | Description                           | Range      | Default  |
+=====================+=======================================+============+==========+
| external-lsa-metric | The external-lsa metric to advertise. | 1-16777215 | 16711680 |
+---------------------+---------------------------------------+------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# max-metric router-lsa on-startup external-lsa external-lsa-metric 120000


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospfv3)# no max-metric router-lsa on-startup external-lsa

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### max-metric-router-lsa-on-startup-include-stub.rst

protocols ospfv3 max-metric router-lsa on-startup include-stub
--------------------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa on-startup include-stub**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- The 'include-stub' option is used to advertise stub-links in router-LSA with the max-metric value.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# max-metric router-lsa on-startup
    dnRouter(cfg-protocols-ospfv3-mm-startup)# include-stub


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospfv3)# no max-metric router-lsa on-startup

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### max-metric-router-lsa-on-startup-interval.rst

protocols ospfv3 max-metric router-lsa on-startup interval
----------------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa on-startup interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Parameter table**

+-----------+------------------------------------------+---------+---------+
| Parameter | Description                              | Range   | Default |
+===========+==========================================+=========+=========+
| interval  | time in seconds for advertise on startup | 5-86400 | 600     |
+-----------+------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# max-metric router-lsa on-startup
    dnRouter(cfg-protocols-ospfv3-mm-startup)# interval 3600


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospfv3)# no max-metric router-lsa on-startup

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### max-metric-router-lsa-on-startup.rst

protocols ospfv3 max-metric router-lsa on-startup
-------------------------------------------------

**Minimum user role:** operator

The OSPF process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router.
To configure the OSPF protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: max-metric router-lsa on-startup**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- This option is disabled by default.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# max-metric router-lsa on-startup
    dnRouter(cfg-protocols-ospfv3-mm-startup)#


**Removing Configuration**

To stop the automatic max-metric advertisement and return the interval to its default value:
::

    dnRouter(cfg-protocols-ospfv3)# no max-metric router-lsa on-startup

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### maximum-adjacencies.rst

protocols ospfv3 maximum-adjacencies
------------------------------------

**Minimum user role:** operator

You can use the following command to configure the OSPFV3 maximum adjacencies and threshold limit.

**Command syntax: maximum-adjacencies [maximum]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- When the threshold is crossed, a single system-event OSPFV3_MAXIMUM_ADJACENCIES_THRESHOLD_EXCEEDED notification is generated.

- When the threshold is cleared, a single system-event OSPFV3_MAXIMUM_ADJACENCIES_THRESHOLD_CLEARED notification is generated.

- When the maximum threshold is crossed, a system-event OSPFV3_MAXIMUM_ADJACENCIES_LIMIT_REACHED notification is generated.

- When the maximum threshold is cleared, a single system-event OSPFV3_MAXIMUM_ADJACENCIES_LIMIT_CLEARED notification is generated.

**Parameter table**

+-----------+-----------------------------------------------------------+---------+---------+
| Parameter | Description                                               | Range   | Default |
+===========+===========================================================+=========+=========+
| maximum   | maximum number of adjacencies.                            | 1-65535 | 500     |
+-----------+-----------------------------------------------------------+---------+---------+
| threshold | threshold as a percentage of maximum allowed adjacencies. | 1-100   | 75      |
+-----------+-----------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# maximum-adjacencies 433
    dnRouter(cfg-protocols-ospfv3)# maximum-adjacencies 433 threshold 65


**Removing Configuration**

To return the maximum and threshold to their default values: 
::

    dnRouter(cfg-protocols-ospfv3)# no maximum-adjacencies

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.1    | Command introduced |
+---------+--------------------+

---

### maximum-ecmp-paths.rst

protocols ospfv3 maximum-ecmp-paths
-----------------------------------

**Minimum user role:** operator

To configure the OSPFV3 maximum ECMP path limit:

**Command syntax: maximum-ecmp-paths [maximum-ecmp-paths]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- On-startup and On-shutdown may be configured simultaneously and are mutually exclusive with "administrative".

**Parameter table**

+--------------------+-------------------------------------------+-------+---------+
| Parameter          | Description                               | Range | Default |
+====================+===========================================+=======+=========+
| maximum-ecmp-paths | Maximum ECMP paths that OSPF can support. | 1-32  | 32      |
+--------------------+-------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# maximum-ecmp-paths 20


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ospfv3)# no maximum-ecmp-paths

**Command History**

+---------+---------------------------+
| Release | Modification              |
+=========+===========================+
| 11.6    | Command introduced        |
+---------+---------------------------+
| 13.1    | Added support for OSPFv3  |
+---------+---------------------------+

---

### maximum-redistributed-prefixes.rst

protocols ospfv3 maximum-redistributed-prefixes
-----------------------------------------------

**Minimum user role:** operator

You can use the following command to configure the OSPFV3 maximum redistributed prefixes limit and threshold limit. Scale is aggregated across all address-families. A single system-event notification is generated in the following cases:
	When the threshold is crossed
	When the threshold is cleared
	When the maximum is reached (no further prefixes are redistributed and a system-event notification is generated)
	When the redistributed prefixes decreases below the maximum.

**Command syntax: maximum-redistributed-prefixes [maximum]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**
The 'no maximum-redistributed-prefixes' returns the maximum and threshold to their default values.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| maximum   | maximum allowed number prefixes redistribute below which no more prefixes are    | 1-32000 | 10000   |
|           | allowed.                                                                         |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+
| threshold | threshold as a percentage of system maximum allowed redistributed prefixes.      | 1-100   | 75      |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# maximum-redistributed-prefixes 30000
    dnRouter(cfg-protocols-ospfv3)# maximum-redistributed-prefixes 30000 threshold 80


**Removing Configuration**

To return the maximum and threshold to their default values: 
::

    dnRouter(cfg-protocols-ospfv3)# no maximum-redistributed-prefixes

**Command History**

+---------+--------------------------+
| Release | Modification             |
+=========+==========================+
| 11.6    | Command introduced       |
+---------+--------------------------+
| 13.1    | Added support for OSPFv3 |
+---------+--------------------------+

---

### maximum-routes.rst

protocols ospfv3 maximum-routes
-------------------------------

**Minimum user role:** operator

You can use the following command to configure the OSPFV3 maximum routes and threshold limit.

**Command syntax: maximum-routes [maximum]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- The 'no maximum-routes' returns the maximum and threshold to their default values.

**Parameter table**

+-----------+------------------------------------------------------+--------------+---------+
| Parameter | Description                                          | Range        | Default |
+===========+======================================================+==============+=========+
| maximum   | maximum number of routes.                            | 1-4294967295 | 9000    |
+-----------+------------------------------------------------------+--------------+---------+
| threshold | threshold as a percentage of maximum allowed routes. | 1-100        | 75      |
+-----------+------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# maximum-routes 90000
    dnRouter(cfg-protocols-ospfv3)# maximum-routes 90000 threshold 80


**Removing Configuration**

To return the maximum and threshold to their default values: 
::

    dnRouter(cfg-protocols-ospfv3)# no maximum-routes

**Command History**

+---------+-------------------------------------------------------+
| Release | Modification                                          |
+=========+=======================================================+
| 13.1    | Command introduced                                    |
+---------+-------------------------------------------------------+
| TBD     | Add default values for maximum routes and adjacencies |
+---------+-------------------------------------------------------+

---

### nsr.rst

protocols ospfv3 nsr
--------------------

**Minimum user role:** operator

OSPFv3 nonstop routing (NSR) enables an OSPFv3 speaker to maintain OSPFv3 adjacencies, state and database, while undergoing a switchover at the CPU level (e.g. NCC switchover). Unlike OSPFv3 graceful-restart (GR), which requires support from an OSPFv3 neighbor as GR helper, NSR recovery is transparent to the network and connected neighbors.
OSPFv3 NSR is supported for cluster (external NCC) and stand-alone setups.
Configuration applies for all OSPFv3 instances in all VRFs.
To enable/disable OSPFv3 NSR:

**Command syntax: nsr [nsr]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- NSR is mutually exclusive with GR support. OSPFv3 NSR and OSPFv3 graceful restart in restarting mode cannot be enabled at the same time.

**Parameter table**

+-----------+-----------------------------+--------------+---------+
| Parameter | Description                 | Range        | Default |
+===========+=============================+==============+=========+
| nsr       | Set OSPFv3 Non Stop Routing | | enabled    | enabled |
|           |                             | | disabled   |         |
+-----------+-----------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# nsr enabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-ospfv3)# no nsr

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.0    | Command introduced |
+---------+--------------------+

---

### ospfv3 overview.rst

Open Shortest Path First (OSPFv3) Overview
------------------------------------------

Open Shortest Path First (OSPFv3) is a link-state routing protocol that operates within a single autonomous system. Each OSPF router maintains an identical database describing the routers' topology. Each router communicates its topology to other routers using link state advertisements (LSA). A topology of the area is constructed from these LSAs and is stored in the database. From this database, each router constructs a tree of shortest paths with itself as a root, giving the route to each destination in the autonomous system. OSPF recalculates routes quickly and dynamically in the face of topological changes, utilizing a minimum of routing protocol traffic.

The OSPF protocol is enabled with equal-cost multi-path routing (ECMP) so that packet forwarding to a single destination can spread across multiple next-hops as opposed to a single best.

The following commands are common to OSPFv2 (IPv4 OSPF version) and OSPFv3 (IPv6 OSPF version).

The following table maps the commands available per OSPF version:

+-------------------------------------------------------+------+--------+
| Command                                               | OSPF | OSPFv3 |
+-------------------------------------------------------+------+--------+
| clear ospf statistics                                 | v    | v      |
+-------------------------------------------------------+------+--------+
| clear ospf routes                                     | v    | v      |
+-------------------------------------------------------+------+--------+
| clear ospf process                                    | v    | v      |
+-------------------------------------------------------+------+--------+
| clear ospf database                                   | v    | v      |
+-------------------------------------------------------+------+--------+
| clear ospf interfaces                                 | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface hello-interval                    | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf auto-cost reference-bandwidth                    | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf class-of-service                                 | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf default-originate                                | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd admin-state                             | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd min-rx                                  | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd min-tx                                  | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd multiplier                              | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area bfd                                         | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf max-metric router-lsa-administrative             | v    |        |
+-------------------------------------------------------+------+--------+
| ospf max-metric router-lsa on-startup                 | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd                               | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd admin-state                   | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd min-rx                        | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd min-tx                        | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface bfd multiplier                    | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf maximum-ecmp-paths                               | v    |        |
+-------------------------------------------------------+------+--------+
| ospf maximum-redistributed-prefixes                   | v    |        |
+-------------------------------------------------------+------+--------+
| ospf redistribute                                     | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf redistribute-metric                              | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf timers refresh                                   | v    |        |
+-------------------------------------------------------+------+--------+
| ospf timers throttle lsa all                          | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf timers lsa-arrival                               | v    |        |
+-------------------------------------------------------+------+--------+
| ospf timers throttle spf                              | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf administrative distance                          | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface cost                              | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface dead-interval                     | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface mtu-ignore                        | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface network                           | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface passive                           | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area interface                                   | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf area                                             | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf log-adjacency-changes                            | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf router-id                                        | v    | v      |
+-------------------------------------------------------+------+--------+
| protocols ospf                                        | v    | v      |
+-------------------------------------------------------+------+--------+
| ospf mpls ldp-sync                                    | v    |        |
+-------------------------------------------------------+------+--------+
| ospf graceful-restart                                 | v    |        |
+-------------------------------------------------------+------+--------+
| ospf fast-reroute                                     | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area network                                     | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area authentication                              | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area filter-list in/out                          | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface authentication                    | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface authentication-key authentication | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface authentication-key md5            | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface fast-reroute-candidate            | v    |        |
+-------------------------------------------------------+------+--------+
| ospf area interface cost-mirroring                    | v    |        |
+-------------------------------------------------------+------+--------+

---

### ospfv3.rst

protocols ospfv3
----------------

**Minimum user role:** operator

Enters the OSPFV3 configuration hierarchy level.

**Command syntax: ospfv3**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- The 'no' command will remove the ospf protocol.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)#


**Removing Configuration**

To remove the OSPFv3 protocol
::

    dnRouter(cfg-protocols)# no ospfv3

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### redistribute_bgp.rst

protocols ospfv3 redistribute bgp
---------------------------------

**Minimum user role:** operator

You can use the following command to redistribute OSPFV3 routes of the specified protocol or kind into OSPF/OSPFv3, with the metric type and metric set if specified, and filtering the routes using the given policy (if specified).
If indicated, you can add the specified tag:

**Command syntax: redistribute bgp** metric [metric] metric-type [metric-type] policy [redistribute-policy] tag [tag]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- By default no redistribution is done.

- The metric default value is set by `redistribute-metric <#ospfv3 redistribute-metric>` configuration.

- no redistribute [protocol] - stops redistribution of a given protocols.

- no redistribute [protocol] [attribute] - return attribute to default state.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter           | Description                                                                      | Range            | Default |
+=====================+==================================================================================+==================+=========+
| metric              | sets metric value for the redistributed route                                    | 0-16777214       | \-      |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-type         | sets metric-type for the redistributed route                                     | | 1              | 2       |
|                     |                                                                                  | | 2              |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| redistribute-policy | policy (route-map) for filtering the routes                                      | | string         | \-      |
|                     |                                                                                  | | length 1-255   |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| tag                 | The tag value. Tag zero means no tagging is done. If, for example, a static      | 0-4294967295     | \-      |
|                     | route has tag and it is redistributed tag 0 means it is kept with the same tag   |                  |         |
|                     | on the redistributed tag. A non zero tag should override the original static     |                  |         |
|                     | route tag,                                                                       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# redistribute bgp
    dnRouter(cfg-protocols-ospfv3)# redistribute bgp metric 1 metric-type 2 policy MY_POL tag 2341


**Removing Configuration**

To return the attribute to the default state:
::

    dnRouter(cfg-protocols-ospfv3)# no redistribute bgp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### redistribute_connected.rst

protocols ospfv3 redistribute connected
---------------------------------------

**Minimum user role:** operator

You can use the following command to redistribute OSPFV3 routes of the specified protocol or kind into OSPF/OSPFv3, with the metric type and metric set if specified, and filtering the routes using the given policy (if specified).
If indicated, you can add the specified tag:

**Command syntax: redistribute connected** metric [metric] metric-type [metric-type] policy [redistribute-policy] tag [tag]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- By default no redistribution is done.

- The metric default value is set by `redistribute-metric <#ospfv3 redistribute-metric>` configuration.

- no redistribute [protocol] - stops redistribution of a given protocols.

- no redistribute [protocol] [attribute] - return attribute to default state.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter           | Description                                                                      | Range            | Default |
+=====================+==================================================================================+==================+=========+
| metric              | sets metric value for the redistributed route                                    | 0-16777214       | \-      |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-type         | sets metric-type for the redistributed route                                     | | 1              | 2       |
|                     |                                                                                  | | 2              |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| redistribute-policy | policy (route-map) for filtering the routes                                      | | string         | \-      |
|                     |                                                                                  | | length 1-255   |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| tag                 | The tag value. Tag zero means no tagging is done. If, for example, a static      | 0-4294967295     | \-      |
|                     | route has tag and it is redistributed tag 0 means it is kept with the same tag   |                  |         |
|                     | on the redistributed tag. A non zero tag should override the original static     |                  |         |
|                     | route tag,                                                                       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# redistribute static
    dnRouter(cfg-protocols-ospfv3)# redistribute static metric 1 metric-type 2 policy MY_POL tag 2341


**Removing Configuration**

To return the attribute to the default state:
::

    dnRouter(cfg-protocols-ospfv3)# no redistribute connected

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### redistribute_static.rst

protocols ospfv3 redistribute static
------------------------------------

**Minimum user role:** operator

You can use the following command to redistribute OSPFV3 routes of the specified protocol or kind into OSPF/OSPFv3, with the metric type and metric set if specified, and filtering the routes using the given policy (if specified).
If indicated, you can add the specified tag:

**Command syntax: redistribute static** metric [metric] metric-type [metric-type] policy [redistribute-policy] tag [tag]

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- By default no redistribution is done.

- The metric default value is set by `redistribute-metric <#ospfv3 redistribute-metric>` configuration.

- no redistribute [protocol] - stops redistribution of a given protocols.

- no redistribute [protocol] [attribute] - return attribute to default state.

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter           | Description                                                                      | Range            | Default |
+=====================+==================================================================================+==================+=========+
| metric              | sets metric value for the redistributed route                                    | 0-16777214       | \-      |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| metric-type         | sets metric-type for the redistributed route                                     | | 1              | 2       |
|                     |                                                                                  | | 2              |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| redistribute-policy | policy (route-map) for filtering the routes                                      | | string         | \-      |
|                     |                                                                                  | | length 1-255   |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+
| tag                 | The tag value. Tag zero means no tagging is done. If, for example, a static      | 0-4294967295     | \-      |
|                     | route has tag and it is redistributed tag 0 means it is kept with the same tag   |                  |         |
|                     | on the redistributed tag. A non zero tag should override the original static     |                  |         |
|                     | route tag,                                                                       |                  |         |
+---------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# redistribute static
    dnRouter(cfg-protocols-ospfv3)# redistribute static metric 1 metric-type 2 policy MY_POL tag 2341


**Removing Configuration**

To return the attribute to the default state:
::

    dnRouter(cfg-protocols-ospfv3)# no redistribute static

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### redistribute-metric.rst

protocols ospfv3 redistribute-metric
------------------------------------

**Minimum user role:** operator

You can use the following command to configure the OSPFV3 maximum redistributed prefixes limit and threshold limit. Scale is aggregated across all address-families. A single system-event notification is generated in the following cases:

	When the threshold is crossed
	When the threshold is cleared
	When the maximum is reached (no further prefixes are redistributed and a system-event notification is generated)
	When the redistributed prefixes decreases below the maximum.

**Command syntax: redistribute-metric [redistribute-metric]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- No command returns metric to its default value.

**Parameter table**

+---------------------+-------------------------------------------------------------------------+------------+---------+
| Parameter           | Description                                                             | Range      | Default |
+=====================+=========================================================================+============+=========+
| redistribute-metric | Sets the default metric value for the OSPFv2 or OSPFv3 routing protocol | 0-16777214 | \-      |
+---------------------+-------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# redistribute-metric 1


**Removing Configuration**

To return the metric to its default value: 
::

    dnRouter(cfg-protocols-ospfv3)# no redistribute-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### router-id.rst

protocols ospfv3 router-id
--------------------------

**Minimum user role:** operator

Use the following command to set the OSPFV3 router-id as the network unique router ID:

**Command syntax: router-id [router-id]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Note**

- The 'no router-id' command will restore the ospfv3 router-id to its default value.

- When changing the router-id, the OSPFv3 process will restart with the current configuration.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| router-id | A 32-bit number represented as a dotted quad assigned to each router running the | A.B.C.D | \-      |
|           | OSPFv2 protocol. This number should be unique within the autonomous system. the  |         |         |
|           | default value should be the highest IP address on the lowest routers Loopback    |         |         |
|           | Interfaces. If there is no Loopback Interfaces configured, then highest IP       |         |         |
|           | address on its active interfaces                                                 |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# ospfv3
    dnRouter(cfg-protocols-ospfv3)# router-id 100.70.1.45


**Removing Configuration**

To restore the ospfv3 router-id to its default value:
::

    no router-id

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### timers/refresh.rst

protocols ospfv3 timers refresh
-------------------------------

**Minimum user role:** operator

OSPFV3 link states have an age, indicating whether the link state is still valid. When the link state reaches the maximum age, it is discarded. During the aging process, the originating router periodically sends a refresh packet to refresh the link state and keep it from expiring.
To configure the refresh timer:

**Command syntax: refresh [refresh-timer]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 timers

**Parameter table**

+---------------+----------------------------------------------------+-----------+---------+
| Parameter     | Description                                        | Range     | Default |
+===============+====================================================+===========+=========+
| refresh-timer | Sets the time of the OSPF link-state refresh timer | 1800-2700 | 1800    |
+---------------+----------------------------------------------------+-----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# timers refresh 2000


**Removing Configuration**

To revert to the default timer value
::

    dnRouter(cfg-protocols-ospfv3)# no timers refresh

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### timers/throttle-lsa-all.rst

protocols ospfv3 timers throttle lsa all hold-interval start-interval max-interval
----------------------------------------------------------------------------------

**Minimum user role:** operator

The OSPFV3 process describes its transit links in its router-LSA as having infinite distance so that other routers will avoid calculating transit paths through the router while still being able to reach networks through the router. 
To configure the OSPFV3 protocol to advertise a router-LSA with a maximum metric value (65535) on system startup for all links for the configured time interval:

**Command syntax: throttle lsa all hold-interval [hold-interval] start-interval [start-interval] max-interval [max-interval]**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 timers

**Parameter table**

+----------------+------------------------------+----------+---------+
| Parameter      | Description                  | Range    | Default |
+================+==============================+==========+=========+
| hold-interval  | timer for second LSA message | 0-500000 | 200     |
+----------------+------------------------------+----------+---------+
| start-interval | Initial LSA schedule delay.  | 0-500000 | 50      |
+----------------+------------------------------+----------+---------+
| max-interval   | timer for second LSA message | 0-500000 | 5000    |
+----------------+------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# timers throttle lsa all hold-interval 100 start-interval 5 max-interval 5000


**Removing Configuration**

The no timers throttle lsa all command reverts LSA throttling timers to their default values.
::

    dnRouter(cfg-protocols-ospfv3)# no timers throttle lsa all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### timers/throttle-spf.rst

protocols ospfv3 timers throttle spf
------------------------------------

**Minimum user role:** operator

When an OSPFV3 router receives an updated LSA, it doesnt immediately run SPF but schedules it, in case there is a change in the topology. Because several routers may be affected by the change, it is likely that multiple updated LSAs are received. The router waits for a short while so that it only has to run SPF once for all updated LSAs.
To prevent the router from repeatedly running SPF if the topology change results from a flapping link, the delay in running SPF will keep increasing as long as updated LSAs keep arriving and up to a maximum holdtime interval.
To set the OSPFV3 SPF throttling timers:

**Command syntax: throttle spf {delay [delay], max-holdtime [max-holdtime], min-holdtime [min-holdtime]}**

**Command mode:** config

**Hierarchies**

- protocols ospfv3 timers

**Note**

- The 'no timers throttle spf' reverts SPF throttling timers to thier default value.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                      | Range    | Default |
+==============+==================================================================================+==========+=========+
| delay        | Initial SPF schedule delay in milliseconds                                       | 0-600000 | 50      |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| max-holdtime | Maximum wait time between two consecutive SPF calculations Must be lower than    | 0-600000 | 5000    |
|              | max-holdtime                                                                     |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+
| min-holdtime | Minimum hold time between two consecutive SPF calculations must be higher than   | 0-600000 | 200     |
|              | min-holdtime                                                                     |          |         |
+--------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# timers throttle spf delay 1 min-holdtime 1000 max-holdtime 90000


**Removing Configuration**

The no timers throttle spf command reverts SPF throttling timers to their default values.
::

    dnRouter(cfg-protocols-ospfv3)# no timers throttle spf

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---

### timers/timers.rst

protocols ospfv3 timers
-----------------------

**Minimum user role:** operator

Configure timers

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols ospfv3

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols ospfv3
    dnRouter(cfg-protocols-ospfv3)# timers
    dnRouter(cfg-protocols-ospfv3-timers)#


**Removing Configuration**

To revert all timers parameters to their default values: 
::

    dnRouter(cfg-protocols-ospfv3)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.6    | Command introduced |
+---------+--------------------+

---


## SECTION 2.M: PIM

Files in this section: 23

### address-family/address-family.rst

protocols pim address-family
----------------------------

**Minimum user role:** operator

To enter the PIM address-family interface configuration hierarchy:

**Command syntax: address-family [address-family]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Parameter table**

+----------------+----------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                    | Range | Default |
+================+================================================================+=======+=========+
| address-family | PIM address-family and enters the PIM address-family hierarchy | ipv4  | \-      |
+----------------+----------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-rp)#


**Removing Configuration**

To remove the PIM address-family configuration:
::

    dnRouter(cfg-protocols-pim)# no address-family ipv4

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family/interface_loopback/admin-state.rst

protocols pim address-family interface admin-state
--------------------------------------------------

**Minimum user role:** operator

To enable/disable PIM on an interface:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family interface

**Note**
- Using 'admin-state disabled' command disables pim on the interface; using the 'no' command also removes the interface from the PIM protocol scope.

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | Enables/disables PIM on an interface | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface bundle-20.101
    dnRouter(cfg-protocols-pim-af4-if)# admin-state enabled
    dnRouter(cfg-protocols-pim-af4-if)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface ge100-1/2/1 admin-state enabled
    dnRouter(cfg-protocols-pim-af4)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface bundle-23.1
    dnRouter(cfg-protocols-pim-af4-if)# admin-state disabled
    dnRouter(cfg-protocols-pim-af4-if)#


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-pim-af4)# no interface bundle-3.1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family/interface_loopback/interface_loopback.rst

protocols pim address-family interface
--------------------------------------

**Minimum user role:** operator

To enter the PIM address-family interface configuration hierarchy:

**Command syntax: interface [loopback-interface]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family

**Parameter table**

+--------------------+------------------+------------------+---------+
| Parameter          | Description      | Range            | Default |
+====================+==================+==================+=========+
| loopback-interface | PIM on interface | | string         | \-      |
|                    |                  | | length 1-255   |         |
+--------------------+------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface ge100-1/2/1
    dnRouter(cfg-protocols-pim-af4-if)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface bundle-20.101
    dnRouter(cfg-protocols-pim-af4-if)#


**Removing Configuration**

To disable PIM on the interface and clear the PIM related configuration:
::

    dnRouter(cfg-protocols-pim-af4)# no interface bundle-3.1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family/interface_non_loopback/admin-state.rst

protocols pim address-family interface admin-state
--------------------------------------------------

**Minimum user role:** operator

To enable/disable PIM on an interface:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family interface

**Note**
- Using 'admin-state disabled' command disables pim on the interface; using the 'no' command also removes the interface from the PIM protocol scope.

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | Enables/disables PIM on an interface | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface bundle-20.101
    dnRouter(cfg-protocols-pim-af4-if)# admin-state enabled
    dnRouter(cfg-protocols-pim-af4-if)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface ge100-1/2/1 admin-state enabled
    dnRouter(cfg-protocols-pim-af4)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface bundle-23.1
    dnRouter(cfg-protocols-pim-af4-if)# admin-state disabled
    dnRouter(cfg-protocols-pim-af4-if)#


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-pim-af4)# no interface bundle-3.1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family/interface_non_loopback/boundary.rst

protocols pim address-family interface boundary
-----------------------------------------------

**Minimum user role:** operator

Setting an IP multicast boundary policy controls the IP multicast forwarding for a predefined multicast group range. The boundary policy applies to the interface under which it is defined.

To configure an IP multicast boundary policy on an interface:

**Command syntax: boundary [boundary-policy-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family interface

**Note**
- The default boundary policy is 'allow' for all group ranges.

**Parameter table**

+-----------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter                   | Description                                                                      | Range            | Default |
+=============================+==================================================================================+==================+=========+
| boundary-policy-prefix-list | The prefix-list name which uniquely identify a boundary policy that contains one | | string         | \-      |
|                             | or more policy rules used to accept or reject certain multicast groups. If a     | | length 1-255   |         |
|                             | policy is not specified, PIM join with all group addresses are accepted.         |                  |         |
+-----------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface ge100-1/2/1
    dnRouter(cfg-protocols-pim-af4-if)# boundary BOUNDARY_LOCAL_MC_POL


**Removing Configuration**

To delete the boundary policy:
::

    dnRouter(cfg-protocols-pim-af4-if)# no boundary

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family/interface_non_loopback/hello-interval.rst

protocols pim address-family interface hello-interval
-----------------------------------------------------

**Minimum user role:** operator

To configure the hello interval on a specific PIM interface:

**Command syntax: hello-interval [hello-interval]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family interface

**Note**
- The derived hello hold-time is 3.5 x hello-interval and it must be greater than the graceful-restart-time.

**Parameter table**

+----------------+--------------------------------------+--------+---------+
| Parameter      | Description                          | Range  | Default |
+================+======================================+========+=========+
| hello-interval | Periodic interval for Hello messages | 1-3600 | \-      |
+----------------+--------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface ge100-1/2/1
    dnRouter(cfg-protocols-pim-af4-if)# hello-interval 24
    dnRouter(cfg-protocols-pim-af4-if)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface bundle-20.101
    dnRouter(cfg-protocols-pim-af4-if)# hello-interval 100
    dnRouter(cfg-protocols-pim-af4-if)#


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-pim-af4-if)# no hello-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family/interface_non_loopback/interface_non_loopback.rst

protocols pim address-family interface
--------------------------------------

**Minimum user role:** operator

To enter the PIM address-family interface configuration hierarchy:

**Command syntax: interface [non-loopback-interface]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family

**Parameter table**

+------------------------+------------------+------------------+---------+
| Parameter              | Description      | Range            | Default |
+========================+==================+==================+=========+
| non-loopback-interface | PIM on interface | | string         | \-      |
|                        |                  | | length 1-255   |         |
+------------------------+------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface ge100-1/2/1
    dnRouter(cfg-protocols-pim-af4-if)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-af4)# interface bundle-20.101
    dnRouter(cfg-protocols-pim-af4-if)#


**Removing Configuration**

To disable PIM on the interface and clear the PIM related configuration:
::

    dnRouter(cfg-protocols-pim-af4)# no interface bundle-3.1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family/mofrr/mofrr.rst

protocols pim address-family mofrr
----------------------------------

**Minimum user role:** operator

To enter the PIM MoFRR configuration hierarchy:

**Command syntax: mofrr**

**Command mode:** config

**Hierarchies**

- protocols pim address-family

**Example**
::

    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-address-family)# mofrr
    dnRouter(cfg-pim-address-family-mofrr)#


**Removing Configuration**

To return the PIM MoFRR configuration to its default values:
::

    dnRouter(cfg-protocols-pim-address-family)# no mofrr

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### address-family/mofrr/protected-groups.rst

protocols pim address-family mofrr protected-groups
---------------------------------------------------

**Minimum user role:** operator

The MoFRR protected-groups is a prefix list that defines the group ranges to be protected. The command enables MoFRR on all new and existing (S,G) PIM states within the protected group.

To configure MoFRR protected-groups prefix list:

**Command syntax: protected-groups [prefix-list-name]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family mofrr

**Note**
- The default MoFRR protected group range is an empty group.

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| prefix-list-name | MoFRR protected groups addresses. The prefix-list name which specifies the group | | string         | \-      |
|                  | addresses G's, which any (S,G) PIM state with these Group addresses will be      | | length 1-255   |         |
|                  | MoFRR protected by PIM.                                                          |                  |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-address-family)# mofrr
    dnRouter(cfg-pim-address-family-mofrr)# protected-groups MOFRR_PROTECTED_GROUPS


**Removing Configuration**

To clear a specific set of protected groups and disable MoFRR on existing (S,G) PIM entries:
::

    dnRouter(cfg-pim-address-family-mofrr)# no protected-groups MOFRR_PROTECTED_GROUPS

To clear all protected groups and disable MoFRR on existing (S,G) PIM entries:
::

    dnRouter(cfg-pim-address-family-mofrr)# no protected-groups

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### address-family/mofrr/umh-selection-mode.rst

protocols pim address-family mofrr umh-selection-mode
-----------------------------------------------------

**Minimum user role:** operator

Upstream multicast hop (UMH) selection-mode operates in either ECMP mode or non-ECMP mode:

In ECMP-mode, the selected standby-UMH will only be an ECMP path to the primary if exists.
In Non-ECMP mode, the standby-UMH will preferably be an uplink node-disjoint LFA alternative (in order to minimize the chance that an upstream node failure will impact the MoFRR success). In case there is no node disjoint LFA, the fallback is link disjoint LFA path, and the last fallback is ECMP in the event that niether node nor link disjoint LFA exist.

To configure MoFRR UMH selection mode:

**Command syntax: umh-selection-mode [umh-selection-mode]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family mofrr

**Parameter table**

+--------------------+--------------------------------+--------------+----------+
| Parameter          | Description                    | Range        | Default  |
+====================+================================+==============+==========+
| umh-selection-mode | The type of UMH selection-mode | | ecmp       | non-ecmp |
|                    |                                | | non-ecmp   |          |
+--------------------+--------------------------------+--------------+----------+

**Example**
::

    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-address-family)# mofrr
    dnRouter(cfg-pim-address-family-mofrr)# umh-selection-mode ecmp

    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-address-family)# mofrr
    dnRouter(cfg-pim-address-family-mofrr)# umh-selection-mode non-ecmp


**Removing Configuration**

To revert the UMH selection mode configuration to default:
::

    dnRouter(cfg-pim-address-family-mofrr)# no umh-selection-mode

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 14.0    | Command introduced |
+---------+--------------------+

---

### address-family/mofrr/use-bgp-lfa.rst

protocols pim address-family mofrr use-bgp-lfa
----------------------------------------------

**Minimum user role:** operator

To consider BGP in the MoFRR standby selection:

**Command syntax: use-bgp-lfa [use-bgp-lfa]**

**Command mode:** config

**Hierarchies**

- protocols pim address-family mofrr

**Note**
This command is applicable for non-ecmp UMH selection mode

**Parameter table**

+-------------+----------------------------------------+--------------+----------+
| Parameter   | Description                            | Range        | Default  |
+=============+========================================+==============+==========+
| use-bgp-lfa | Use BGP LFA in MoFRR standby selection | | enabled    | disabled |
|             |                                        | | disabled   |          |
+-------------+----------------------------------------+--------------+----------+

**Example**
::

    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-address-family)# mofrr
    dnRouter(cfg-pim-address-family-mofrr)# use-bgp-lfa enabled

    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# address-family ipv4
    dnRouter(cfg-protocols-pim-address-family)# mofrr
    dnRouter(cfg-pim-address-family-mofrr)# use-bgp-lfa disabled


**Removing Configuration**

To revert use-bgp-lfa to its default value:
::

    dnRouter(cfg-pim-address-family-mofrr)# no use-bgp-lfa

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### asm-override.rst

protocols pim asm-override
--------------------------

**Minimum user role:** operator

When sub-ranges from SSM group ranges are statically or dynamically mapped to RPs, enable ASM override.

To enable the ASM override for SSM group ranges:

**Command syntax: asm-override [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Note**
- PIM register and MSDP SA messages are not accepted, generated, or forwarded for group addresses within the SSM range, unless asm-override is enabled and SSM group sub-ranges are mapped to RPs.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | When enabled the PIM SSM ranges should also be allowed for ASM and Join(\*,G)    | | enabled    | disabled |
|             | for G in the SSM ranges shall be accpeted                                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# asm-override enabled
    dnRouter(cfg-protocols-pim)#


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-pim)# no asm-override

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### class-of-service.rst

protocols pim class-of-service
------------------------------

**Minimum user role:** operator

To set the DSCP value for outgoing PIM packets:

**Command syntax: class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Note**
- The IPP is set accordingly. I.e DSCP 48 is mapped to 6.

**Parameter table**

+------------------+------------------------------+-------+---------+
| Parameter        | Description                  | Range | Default |
+==================+==============================+=======+=========+
| class-of-service | PIM packets class of service | 0-56  | 48      |
+------------------+------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# class-of-service 48
    dnRouter(cfg-protocols-pim)#


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-pim)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### graceful-restart-timer.rst

protocols pim graceful-restart-timer
------------------------------------

**Minimum user role:** operator

The graceful restart time is the time limit to maintain stale PIM-originated multicast forwarding entries before they are cleared. Multicast forwarding entries become stale following a PIM process restart (for example, following a restart of the routing engine or a cluster NCC failover event). After the grace time, all stale PIM join/prune states are discarded and the related multicast RIB and FIB entries are removed.

To configure the PIM graceful restart timeout:

**Command syntax: graceful-restart-timer [graceful-restart-timer]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Note**
- The graceful restart time must be lower than the hello-holdtime, or lower than the maximum interface hello-interval times 3.5 seconds to ensure non-stop routing with all peer PIM neighbors.

- In the event that PIM NSR is enabled, its timer shall be used instead of the configured PIM graceful restart time.

**Parameter table**

+------------------------+----------------------------------------------+---------+---------+
| Parameter              | Description                                  | Range   | Default |
+========================+==============================================+=========+=========+
| graceful-restart-timer | Maximum time for graceful restart to finish. | 30-3600 | 180     |
+------------------------+----------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# graceful-restart-time 100
    dnRouter(cfg-protocols-pim)#


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-pim)# no graceful-restart-time

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 12.0    | Command introduced                                      |
+---------+---------------------------------------------------------+
| 18.1    | Changed graceful-restart-time to graceful-restart-timer |
+---------+---------------------------------------------------------+

---

### hello-interval.rst

protocols pim hello-interval
----------------------------

**Minimum user role:** operator

The graceful restart time is the time limit to maintain stale PIM-originated multicast forwarding entries before they are cleared. Multicast forwarding entries become stale following a PIM process restart (for example, following a restart of the routing engine or a cluster NCC failover event). After the grace time, all stale PIM join/prune states are discarded and the related multicast RIB and FIB entries are removed.

To configure the PIM graceful restart timeout:

**Command syntax: hello-interval [hello-interval]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Note**
- Any change in the pim hello interval will take effect immediately if the new value is lower than the previous value. Otherwise, it will only take effect after the derived timers, such as PIM hello hold-time, are updated and sent to peer routers at least once.

- The derived hello hold-time is 3.5 x hello-interval and it must be greater than the graceful-restart-time.

**Parameter table**

+----------------+--------------------------------------+--------+---------+
| Parameter      | Description                          | Range  | Default |
+================+======================================+========+=========+
| hello-interval | Periodic interval for Hello messages | 1-3600 | 30      |
+----------------+--------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# hello-interval 100
    dnRouter(cfg-protocols-pim)#


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-pim)# no hello-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### join-prune-interval.rst

protocols pim join-prune-interval
---------------------------------

**Minimum user role:** operator

To set the join-prune-interval value for outgoing PIM packets:

**Command syntax: join-prune-interval [join-prune-interval]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter           | Description                                                                      | Range  | Default |
+=====================+==================================================================================+========+=========+
| join-prune-interval | Periodic interval between Join/Prune messages. The hold-time associated with the | 10-600 | 60      |
|                     | PIM-Join message is 3.5 times the pim join-prune-interval                        |        |         |
+---------------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# join-prune-interval 180
    dnRouter(cfg-protocols-pim)#


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-pim)# no join-prune-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### load-split.rst

protocols pim load-split admin-state
------------------------------------

**Minimum user role:** operator

To take advantage of multiple paths throughout the network, traffic from a multicast source or sources is load split across ECMP paths.

To enable/disable PIM's load-split:

**Command syntax: load-split admin-state [load-split-admin-state]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Parameter table**

+------------------------+--------------------------------+--------------+---------+
| Parameter              | Description                    | Range        | Default |
+========================+================================+==============+=========+
| load-split-admin-state | The PIM Load Split admin state | | enabled    | enabled |
|                        |                                | | disabled   |         |
+------------------------+--------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# load-split admin-state disabled
    dnRouter(cfg-protocols-pim)#


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-pim)# no load-split admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### maximum-mfib-routes.rst

protocols pim maximum-mfib-routes
---------------------------------

**Minimum user role:** operator

To configure the PIM maximum MFIB routes limit:

**Command syntax: maximum-mfib-routes [maximum]** threshold [threshold]

**Command mode:** config

**Hierarchies**

- protocols pim

**Parameter table**

+-----------+----------------------------------+---------+---------+
| Parameter | Description                      | Range   | Default |
+===========+==================================+=========+=========+
| maximum   | maximum limit of PIM MFIB routes | 1-60000 | 60000   |
+-----------+----------------------------------+---------+---------+
| threshold | percentage of maximum limit      | 1-100   | 75      |
+-----------+----------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# maximum-mfib-routes 50000
    dnRouter(cfg-protocols-pim)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# maximum-mfib-routes 40000 threshold 90
    dnRouter(cfg-protocols-pim)#


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-pim)# no maximum-mfib-routes

**Command History**

+---------+---------------------+
| Release | Modification        |
+=========+=====================+
| 12.0    | Command introduced  |
+---------+---------------------+
| 18.2.1  | Renamed the command |
+---------+---------------------+

---

### nsr.rst

protocols pim nsr
-----------------

**Minimum user role:** operator

You can use this command to enable PIM non-stop-routing. To enable or disable PIM NSR:

**Command syntax: nsr [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Note**

- By default, PIM NSR is enabled.

**Parameter table**

+-------------+-------------------------+--------------+---------+
| Parameter   | Description             | Range        | Default |
+=============+=========================+==============+=========+
| admin-state | The PIM NSR admin state | | enabled    | enabled |
|             |                         | | disabled   |         |
+-------------+-------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# nsr enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# nsr disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim


**Removing Configuration**

To revert PIM NSR to the default value:
::

    dnRouter(cfg-protocols-pim)# no nsr

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### pim.rst

protocols pim
-------------

**Minimum user role:** operator

Protocol Independent Multicast (PIM) is a collection of protocols used in a multicast environment. The main PIM protocols are: PIM Sparse Mode (PIM-SM) and PIM Dense Mode (PIM-DM). A combination of the two (PIM Sparse-Dense mode) is also sometimes used.

In PIM-SM, routers need to explicitly announce that they want to receive multicast messages from multicast groups, while PIM-DM protocols assumes that all routers want to receive multicast messages unless they state otherwise.
PIM-SM is the method used to route multicast packets from a source to multicast groups. It is used when only some of the recipients want to receive the multicast packet. In PIM-SM, a Rendezvous Point (RP) is used to receive multicast packets from the source and deliver them to the recipient.

Each domain in PIM-SM has a set of routers acting as RPs, which can be viewed as an exchange point where the source and recipients meet. First-hop routers are responsible for registering the sources to the RP and the latter is responsible for building a shortest path tree (SPT) to the source once it receives traffic from the source, thus creating a (S,G) entry between the router and the source. Last-hop routers are responsible for registering the recipients to the RP by creating a (\*,G) entry between the recipient and the RP. When a source transmits multicast data, the traffic flows to the RP and then to the recipients.

Enters the PIM configuration hierarchy level:

**Command syntax: pim**

**Command mode:** config

**Hierarchies**

- protocols

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)#


**Removing Configuration**

To remove all PIM configuration:
::

    dnRouter(cfg-protocols)# no pim

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### ssm-ranges.rst

protocols pim ssm-ranges
------------------------

**Minimum user role:** operator

Use the following command to configure the PIM-SSM group ranges:

**Command syntax: ssm-ranges [range-policy-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Note**
- PIM register and MSDP SA messages are not accepted, generated, or forwarded for group addresses within the SSM range, unless asm-override is enabled and SSM group sub-ranges are mapped to RPs.

**Parameter table**

+--------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter                | Description                                                                      | Range            | Default |
+==========================+==================================================================================+==================+=========+
| range-policy-prefix-list | The prefix-list name which uniquely identify a policy that contains one or more  | | string         | \-      |
|                          | policy rules used to accept or reject certain multicast groups. The groups       | | length 1-255   |         |
|                          | accepted by this policy define the multicast group rang used by SSM. If a policy |                  |         |
|                          | is not specified, the default SSM multicast group rang is used. The default SSM  |                  |         |
|                          | multicast group range is 232.0.0.0/8 for IPv4                                    |                  |         |
+--------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# ssm-ranges SSM-Ranges-Pref-List


**Removing Configuration**

To revert PIM maximum-mfib-routes to default value:
::

    dnRouter(cfg-protocols-pim)# no ssm-ranges

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### static-rp/group.rst

protocols pim static-rp group
-----------------------------

**Minimum user role:** operator

Use the following command to configure the group ranges for a static RP.

**Command syntax: group [rp-group-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols pim static-rp

**Note**
- A static RP on which no prefix list is configured is mapped by default to the whole 224.0.0.0/4 range subtract the condigured SSM range. If ASM override is configured, the whole 224.0.0.0/4 range is assigned. 

- Only one static-rp is allowed with no-prefix-list.

- Assigning the same prefix list to two different static-RP addresses is not allowed.

- A static-rp can be assigned only with a single prefix-list. The second configured prefix-list will override the first.

- Two static-rps each defined with a different but overlapping prefix-list will be rejected.

**Parameter table**

+----------------------+--------------------------------------------------------------------------------+------------------+---------+
| Parameter            | Description                                                                    | Range            | Default |
+======================+================================================================================+==================+=========+
| rp-group-prefix-list | The prefix-list name which defines the group address ranges handled by the RP. | | string         | \-      |
|                      |                                                                                | | length 1-255   |         |
+----------------------+--------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# static-rp 2.2.2.2
    dnRouter(cfg-protocols-pim-rp)# group RP-2222-GROUP-MAPPING
    dnRouter(cfg-protocols-pim-rp)#


**Removing Configuration**

To remove the RP address group mapping thereby mapping the static RP address to the default non-SSM 224.0.0.0/4 group range:
::

    dnRouter(cfg-protocols-pim-rp)# no group RP-2222-GROUP-MAPPING

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### static-rp/static-rp.rst

protocols pim static-rp
-----------------------

**Minimum user role:** operator

Use the following command to configure the static RP IP address. The IP address is typically a loopback IP address. It can be a local IP address, in which case the local router is defined as the RP, or a different router-id IP address. If the RP address is configured without a defined range, it will be mapped to all of the IP multicast 224.0.0.0/4 group ranges.

**Command syntax: static-rp [static-rp]**

**Command mode:** config

**Hierarchies**

- protocols pim

**Parameter table**

+-----------+---------------+---------+---------+
| Parameter | Description   | Range   | Default |
+===========+===============+=========+=========+
| static-rp | PIM static RP | A.B.C.D | \-      |
+-----------+---------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# pim
    dnRouter(cfg-protocols-pim)# static-rp 2.2.2.2
    dnRouter(cfg-protocols-pim-rp)#


**Removing Configuration**

To remove the RP address group mapping:
::

    dnRouter(cfg-protocols-pim)# no static-rp 2.2.2.2

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---


## SECTION 2.N: RSVP

Files in this section: 237

### admin-group_exclude-all.rst

protocols rsvp admin-group exclude-all
--------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group exclude-all**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### admin-group_exclude.rst

protocols rsvp admin-group
--------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group [exclude-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| exclude-type     | exclude options                    | | exclude-any      | \-      |
|                  |                                    | | exclude-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### admin-group_include.rst

protocols rsvp admin-group
--------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. By default, admin-group constraints are ignored in path calculation.
To define global link include admin-group attributes for all tunnels:

**Command syntax: admin-group [include-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set include-all or include-any or include-strict admin-group list

.. -  cannot be set together with admin-group exclude

.. -  'no admin-group include-all [admin-group-name]', 'no admin-group include-strict [admin-group-name]' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group include-any', 'no admin-group include-strict' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| include-type     | rsvp global admin groups           | | include-all      | \-      |
|                  |                                    | | include-any      |         |
|                  |                                    | | include-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-all RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-strict BLUE


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-any RED

To remove all admin-groups from the admin group list:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### administrative-distance.rst

protocols rsvp administrative-distance
--------------------------------------

**Minimum user role:** operator

The command sets the RSVP administrative-distance. This allows you to control the way RSVP tunnels take preference over other protocols (for example, LDP) in RIB tables.
To define the RSVP administrative-distance:

**Command syntax: administrative-distance [administrative-distance]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
-  An administrative distance of 255 will cause the route to be removed from the forwarding table and will not be used.

.. -  When reconfiguring administrative-distance, user should run clear rsvp tunnel, new administrative-distance values will only apply to new rsvp tunnels installed in RIB

.. - no command return to default value

**Parameter table**

+-------------------------+----------------------------------+-------+---------+
| Parameter               | Description                      | Range | Default |
+=========================+==================================+=======+=========+
| administrative-distance | administrative distance for RSVP | 1-255 | 100     |
+-------------------------+----------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# administrative-distance 90


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp)# no administrative-distance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/adjust-interval.rst

protocols rsvp auto-bandwidth adjust-interval
---------------------------------------------

**Minimum user role:** operator

The adjust interval is the time-frame in which the samples' calculated average-rates are compared. The highest calculated average-rate within the adjust-interval time-frame will be used in the adjustment threshold decision.
To configure the adjust-interval:

**Command syntax: adjust-interval [adjust-interval]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
.. -  must adjust-interval > sampling-interval

- Changing the interval configuration will reset the timer.

.. -  no command restores adjust-interval to its default value

**Parameter table**

+-----------------+--------------------------------------------------------------+---------+---------+
| Parameter       | Description                                                  | Range   | Default |
+=================+==============================================================+=========+=========+
| adjust-interval | time interval that traffic average-rate samples are gathered | 5-10080 | 1440    |
+-----------------+--------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-interval 5


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no adjust-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/adjust-threshold/adjust-threshold.rst

protocols rsvp auto-bandwidth adjust-threshold
----------------------------------------------

**Minimum user role:** operator

At the end of the adjust-interval (AI) window, the highest average rate within the AI window (maxAvgRate) is compared against the configured adjust-threshold. The adjust-threshold sets the required difference before requesting a change in bandwidth. If maxAvgRate is below or above the threshold, then an attempt is made to signal a new path for the tunnel with the calculated maxAvg bandwidth.
To configure the threshold:

**Command syntax: adjust-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the adjust-threshold configuration will take effect on the next sampling.

.. -  set bandwidth=0 or percent=0 to ignore one of the terms.

.. -  cannot set both bandwidth and percent to 0

.. -  when both bandwidth and percent are configured with a non-zero value, perform bandwidth adjustments when **both** terms are met.

.. -  Units can only be set with bandwidth

.. -  'adjust-threshold' , 'no adjust-threshold', 'no adjust-threshold bandwidth percent' - return bandwidth and percent to their default values

.. -  'no adjust-threshold bandwidth' - return bandwidth to its default value

.. -  'no adjust-threshold percent - return percent to its default value

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 100 mbps percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 0 percent 10
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 10 kbps percent 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 20 percent 0


**Removing Configuration**

dnRouter(cfg-protocols-rsvp-auto-bw)# no adjust-threshold bandwidth
::

    dnRouter(cfg-protocols-rsvp)# no adjust-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### auto-bandwidth/adjust-threshold/bandwidth.rst

protocols rsvp auto-bandwidth adjust-threshold bandwidth
--------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth adjust-threshold
- protocols rsvp tunnel auto-bandwidth adjust-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | 10000   |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/adjust-threshold/percent.rst

protocols rsvp auto-bandwidth adjust-threshold percent
------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth adjust-threshold
- protocols rsvp tunnel auto-bandwidth adjust-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | 5       |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/admin-state.rst

protocols rsvp auto-bandwidth admin-state
-----------------------------------------

**Minimum user role:** operator

To enable auto-bandwidth globally:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Parameter table**

+-------------+-----------------------+--------------+----------+
| Parameter   | Description           | Range        | Default  |
+=============+=======================+==============+==========+
| admin-state | enable auto-bandwidth | | enabled    | disabled |
|             |                       | | disabled   |          |
+-------------+-----------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/auto-bandwidth.rst

protocols rsvp auto-bandwidth
-----------------------------

**Minimum user role:** operator

Tunnels reserve a fixed bandwidth based on the bandwidth setting, regardless of utilization. Auto-bandwidth allocation enables to dynamically adjust the bandwidth allocation based on the volume of traffic running through the tunnel. This allows the tunnel to reserve a minimum bandwidth and adjust the bandwidth as necessary, according to actual traffic patterns. The bandwidth adjustments do not interrupt traffic flow through the tunnel.
A tunnel with auto-bandwidth enabled is configured with a sampling interval. The traffic running through the tunnel is measured at each sampling interval and the average rate is calculated. At the end of the adjust-interval (AI) window, the highest average rate within the AI window (maxAvgRate) is compared against the configured adjust-threshold. The adjust-threshold sets the required difference before requesting a change in bandwidth. If maxAvgRate is below or above the threshold, the an attempt is made to signal a new path for the tunnel with the calculated maxAvg bandwidth.

The wider the AI window, the longer it takes to adjust to changes in traffic. Overflow and underflow thresholds allow the tunnel to react quickly to significant changes in traffic volume. These thresholds use the same mechanism as the adjust-threshold, except they operate at every sample-interval.
A new requested bandwidth reservation is always within the configured minimum and maximum limits. So if the sampled average rate is greater than the configured maximum, the requested bandwidth will be for the set maximum limit. Similarly, if the sampled average rate is lower than the configured minimum, the requested bandwidth will be for the configured minimum limit.

Once a new request for bandwidth is made, if the new path is successfully established, the old path is removed and the tunnel will switch over to the new path. Otherwise, the tunnel will continue using the existing path until the next sampling interval, when another attempt will be made to signal a new path.

The global configuration sets the default behavior for all tunnels. You can configure a specific behavior per tunnel using the rsvp tunnel auto-bandwidth hierarchy

To configure auto-bandwidth:

1.	Enable auto-bandwidth on tunnels.
2.	Configure the sampling interval (globally only).
3.	Configure adjust-interval and threshold.
4.	Configure overflow and underflow thresholds.
5.	Configure minimum and maximum bandwidth.
6.	Optional. Set the auto-bandwidth feature to monitor only.

To configure auto-bandwidth globally, enter auto-bandwidth configuration mode:

**Command syntax: auto-bandwidth**

**Command mode:** config

**Hierarchies**

- protocols rsvp
- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
.. -  rsvp auto-bandwidth global configuration set default behavior for all tunnel. when a tunnel is configured specific using "rsvp tunnel auto-bandwidth" the specific configuration takes precedence.

.. -  'no auto-bandwidth' restores all auto-bandwidth configuration to their default status and disables auto-bandwidth

- Auto-bandwidth parameters apply to primary headend tunnels (manual or auto-mesh) only. They do not apply to bypass tunnels (neither manual nor auto-bypass).

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)


**Removing Configuration**

To revert all auto-bandwidth configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no auto-bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/maximum-bandwidth.rst

protocols rsvp auto-bandwidth maximum-bandwidth
-----------------------------------------------

**Minimum user role:** operator

A new requested bandwidth reservation is always within the configured minimum and maximum limits. So if the sampled average rate is greater than the configured maximum, the requested bandwidth will be for the set maximum limit. Similarly, if the sampled average rate is lower than the configured minimum, the requested bandwidth will be for the configured minimum limit. A change to the maximum-bandwidth configuration will take effect on the next sampling. To configure the maximum limit:

**Command syntax: maximum-bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
-  The minimum-bandwidth value must be lower or equal to maximum-bandwidth

.. -  'no maximum-bandwidth' - return bandwidth to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------------+------------+
| Parameter | Description                                                                      | Range         | Default    |
+===========+==================================================================================+===============+============+
| bandwidth | tunnel bandwidth                                                                 | 0-42949672950 | 4194303000 |
+-----------+----------------------------------------------------------------------------------+---------------+------------+
| units     | The units used for maximum-bandwidth. If you do not specify the unit, mpbs will  | | kbps        | kbps       |
|           | be used.                                                                         | | mbps        |            |
|           |                                                                                  | | gbps        |            |
+-----------+----------------------------------------------------------------------------------+---------------+------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# maximum-bandwidth 10000000

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# maximum-bandwidth 1000 gbps


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no maximum-bandwidth

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 18.2.5  | Bandwidth range update |
+---------+------------------------+

---

### auto-bandwidth/minimum-bandwidth.rst

protocols rsvp auto-bandwidth minimum-bandwidth
-----------------------------------------------

**Minimum user role:** operator

A new requested bandwidth reservation is always within the configured minimum and maximum limits. So if the sampled average rate is greater than the configured maximum, the requested bandwidth will be for the set maximum limit. Similarly, if the sampled average rate is lower than the configured minimum, the requested bandwidth will be for the configured minimum limit. A change to the minimum-bandwidth configuration will take effect on the next sampling. To configure the minimum limit:

**Command syntax: minimum-bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
-  The minimum-bandwidth value must be lower or equal to maximum-bandwidth

.. -  'no minimum-bandwidth' - return bandwidth to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | tunnel bandwidth                                                                 | 0-4294967295 | 0       |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for minimum-bandwidth. If you do not specify the unit, mpbs will  | | kbps       | kbps    |
|           | be used.                                                                         | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# minimum-bandwidth 10

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# minimum-bandwidth 10000 kbps


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no minimum-bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/monitor-only.rst

protocols rsvp auto-bandwidth monitor-only
------------------------------------------

**Minimum user role:** operator

This command instructs RSVP to do all the auto-bandwidth calculations according to the configuration and record them, but without actually performing any changes. The recorded information is available in show commands.
To enable/disable monitoring-only:

**Command syntax: monitor-only [monitor-only]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
.. -  'no monitor-only' - return to disabled state

-  No adjustments will be made even if you explicitly run the "run rsvp auto-bandwidth adjust" command.

**Parameter table**

+--------------+------------------------------------------------------------------------------+--------------+----------+
| Parameter    | Description                                                                  | Range        | Default  |
+==============+==============================================================================+==============+==========+
| monitor-only | maximum sampled traffic rate is monitored but doesnt effect tunnel bandwidth | | enabled    | disabled |
|              |                                                                              | | disabled   |          |
+--------------+------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# monitor-only enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no monitor-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/overflow-threshold/bandwidth.rst

protocols rsvp auto-bandwidth overflow-threshold bandwidth
----------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp tunnel auto-bandwidth overflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | 10000   |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/overflow-threshold/limit.rst

protocols rsvp auto-bandwidth overflow-threshold limit
------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: limit [limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp tunnel auto-bandwidth overflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold

**Note**
-  You may set a new limit while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no limit - return delay to its default value

**Parameter table**

+-----------+------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                            | Range | Default |
+===========+========================================================================+=======+=========+
| limit     | the amount of consecutive sampling-interval in which overflow happened | 1-10  | 1       |
+-----------+------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# limit 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/overflow-threshold/overflow-threshold.rst

protocols rsvp auto-bandwidth overflow-threshold
------------------------------------------------

**Minimum user role:** operator

The overflow thresholds allows the tunnel to react quickly to significant changes in traffic volume. It uses the same mechanism as the adjust-threshold, except it operates at every sample-interval. The traffic rate is measured at every sampling-interval. If the traffic rate exceeds the configured threshold, a new LSP with updated bandwidth is signaled immediately. To configure the overflow threshold:

**Command syntax: overflow-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the overflow-threshold configuration will take effect on the next sampling.

- A change to the limit takes effect on the current sampling.

- If you do not specify a parameter, the default value is assumed.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 100 percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 0 percent 10 limit 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 kbps percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 kbps limit 2


**Removing Configuration**

To revert all overflow-threshold configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no overflow-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### auto-bandwidth/overflow-threshold/percent.rst

protocols rsvp auto-bandwidth overflow-threshold percent
--------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp tunnel auto-bandwidth overflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | 5       |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/sampling-interval.rst

protocols rsvp auto-bandwidth sampling-interval
-----------------------------------------------

**Minimum user role:** operator

The sampling interval is the time-frame in which the average rate of the traffic flowing through the tunnel is calculated. The average rate is calculated as follows: byte/interval.
To configure the sampling interval:

**Command syntax: sampling-interval [sampling-interval]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth

**Note**
- The sampling-interval also defines the sampling rate for which the traffic rate is calculated for the rsvp tunnel statistics.

- Changing the interval configuration will reset the timer.

**Parameter table**

+-------------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter         | Description                                                                      | Range   | Default |
+===================+==================================================================================+=========+=========+
| sampling-interval | the sampling interval over which the average-rate of traffic flowing through a   | 1-10080 | 1       |
|                   | tunnel is calculated                                                             |         |         |
+-------------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# sampling-interval 5


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no sampling-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/underflow-threshold/bandwidth.rst

protocols rsvp auto-bandwidth underflow-threshold bandwidth
-----------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp tunnel auto-bandwidth underflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | 10000   |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/underflow-threshold/limit.rst

protocols rsvp auto-bandwidth underflow-threshold limit
-------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: limit [limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp tunnel auto-bandwidth underflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold

**Note**
-  You may set a new limit while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no limit - return delay to its default value

**Parameter table**

+-----------+------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                            | Range | Default |
+===========+========================================================================+=======+=========+
| limit     | the amount of consecutive sampling-interval in which overflow happened | 1-10  | 1       |
+-----------+------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# limit 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/underflow-threshold/percent.rst

protocols rsvp auto-bandwidth underflow-threshold percent
---------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp tunnel auto-bandwidth underflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | 5       |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bandwidth/underflow-threshold/underflow-threshold.rst

protocols rsvp auto-bandwidth underflow-threshold
-------------------------------------------------

**Minimum user role:** operator

The underflow thresholds allows the tunnel to react quickly to significant changes in traffic volume. It uses the same mechanism as the adjust-threshold, except it operates at every sample-interval. The traffic rate is measured at every sampling-interval. If the traffic rate drops below the configured threshold, a new LSP with updated bandwidth is signaled immediately. To configure the overflow threshold:

**Command syntax: underflow-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the underflow-threshold configuration will take effect on the next sampling.

- A change to the limit takes effect on the current sampling.

- If you do not specify a parameter, the default value is assumed.

..-  must set either bandwidth or percent to enable threshold feature.
..
..-  when both bandwidth and percent are configured with a non-zero value, perform bandwidth adjustments when **both** terms are met.
..
..-  Units can only be set with bandwidth
..
..-  'underflow-threshold' , 'no underflow-threshold', 'no underflow-threshold bandwidth percent limit' - return bandwidth and percent to their default values
..
..-  'no underflow-threshold bandwidth' - return bandwidth to its default value
..
..-  'no underflow-threshold percent - return percent to its default value
..
..-  'no underflow-threshold limit - return limit to its default value

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 100 percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 0 percent 10 limit 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 10 percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 10 kbps percent 5 limit 1


**Removing Configuration**

To revert all underflow-threshold configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no underflow-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### auto-bypass/admin-state.rst

protocols rsvp auto-bypass admin-state
--------------------------------------

**Minimum user role:** operator

You can enable or disable tunnel optimization globally for all tunnel types, or per tunnel. To enable/disable tunnel optimization per tunnel, see "rsvp tunnel optimization".
To enable/disable tunnel optimization globally:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass

**Note**
- Disabling the optimization while optimization is running will stop all running optimization attempts.

.. -  'no admin-state' - return admin-state to default value

**Parameter table**

+-------------+----------------------------+--------------+---------+
| Parameter   | Description                | Range        | Default |
+=============+============================+==============+=========+
| admin-state | enable auto-bypass tunnels | | enabled    | enabled |
|             |                            | | disabled   |         |
+-------------+----------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/auto-bypass.rst

protocols rsvp auto-bypass
--------------------------

**Minimum user role:** operator

An auto-bypass tunnel is an automatically generated LSP profile. The tunnel is created the moment that a protection request arrives from a primary RSVP tunnel. The following are the properties of an auto-bypass tunnel profile:

- It inherently includes a constraint to avoid the interface it bypasses.

- Its source address is the IPv4 address of the interface it protects (non-configurable). This address must differ from the source-address of the primary LSP it protects.

- Its path and destination is according to the LSP it protects (the RRO) and if link or node protection is needed.

- The default parameter values for a manual bypass tunnel are:

  - name - automatically assigned using this format: "tunnel_bypass_<link/node>-<interface>_<ID>"

  - Link/node are set per bypass-tunnel protection type (see "rsvp protection" and "rsvp interface protection")

  - interface - the name of the interface that the tunnel protects

  - ID - a number incremented at tunnel creation

  - bandwidth = 0 mbps

  - exclude-srlg = strict

  - class-type = 0

  - igp-instance - the IGP instance of the interface configured in IGP (e.g. IS-IS)

  - cspf-calculation = enabled, the equal-cost mode is according to the RSVP global cspf-calculation equal-cost settings

  - hop-limit = 255

You can configure admin-group constraints for auto-bypass tunnels, overriding the "requesting" primary LSP constraints.

To enter auto-bypass tunnel configuration mode:

**Command syntax: auto-bypass**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- You cannot remove a manual bypass tunnel if it is attached to an RSVP interface.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)


**Removing Configuration**

To revert all auto-bypass tunnel profile configuration to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no auto-bypass

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/bfd/admin-state.rst

protocols rsvp auto-bypass bfd admin-state
------------------------------------------

**Minimum user role:** operator

Enables a BFD over MPLS session for tunnel LSP protection.

To enable/disable a tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp tunnel bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

.. -  no command returns admin-state to default value

.. -  configuring bfd parameter will trigger LSP make-before-break to comply with new BFD state

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-bypass/bfd/bfd.rst

protocols rsvp auto-bypass bfd
------------------------------

**Minimum user role:** operator

An RSVP tunnel is a label-switched path (LSP) that can carry inside other RSVP LSPs in order to provide network end-to-end traffic engineering. Each tunnel LSP can have a unique BFD session. 

BFD is supported for all tunnel types (primary, manual bypass, auto bypass and auto mesh).

To establish the BFD session, LSP-Ping is used to sync the peers on session BFD discriminators.
Before activating an LSP, verify the data path by establishing BFD session over LSP and ensure that tunnel can carry data traffic. Only after the BFD session is up the LSP will be used for forwarding.

Install delay: before installing the new LSP as the active tunnel path in the data path, wait for "rsvp make-before-break install-delay" time to verify that LSP is stable as BFD session remain UP for install-delay time. 

After the time period, if the BFD is still up, install the tunnel in the data path.

Upon BFD failure:

- At head LER - Remove LSP, invoke Break Before Make and remove LSP from data path.
- At tail LER - Only Respond with BFD down
- BFD for RSVP isn't a trigger for bypass protection

In the case that RSVP FRR is enabled, BFD timers should be configured to at least 3 x 300 ms so that FRR mechanism can operate as expected and provide fast switchover to a bypass tunnel. it applies to any router acting as PLR, including the case where the head is the PLR of the tunnel.

BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations. Detection-time = negotiated-received-interval X received multiplier.

This is the maximum amount of time that can elapse without receipt of a BFD control packet before the session is declared down.

BFD neighbor can signal session state down, and upon receipt, local BFD session will immediately switch to DOWN state.

To enter BFD configuration level:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass
- protocols rsvp tunnel bypass
- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
.. -  BFD is supported for all tunnel types (primary, manual bypass, auto bypass, auto-mesh)

.. -  no command returns all bfd configuration to their default settings

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)#


**Removing Configuration**

To revert all bfd configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-bypass/bfd/min-tx.rst

protocols rsvp auto-bypass bfd min-tx
-------------------------------------

**Minimum user role:** operator

To set minimum transmit interval for BFD session:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp tunnel bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

- Due to hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+---------+---------+
| Parameter | Description                                           | Range   | Default |
+===========+=======================================================+=========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 50-1700 | 300     |
+-----------+-------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# min-tx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# min-tx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# min-tx 350


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no min-tx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-bypass/bfd/mix-rx.rst

protocols rsvp auto-bypass bfd min-rx
-------------------------------------

**Minimum user role:** operator

To set desired minimum receive interval for BFD session:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

**Parameter table**

+-----------+------------------------------------------------------+---------+---------+
| Parameter | Description                                          | Range   | Default |
+===========+======================================================+=========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 50-1700 | 300     |
+-----------+------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# min-rx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# min-rx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# min-rx 350


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no min-rx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-bypass/bfd/multiplier.rst

protocols rsvp auto-bypass bfd multiplier
-----------------------------------------

**Minimum user role:** operator

The multiplier defines the number of min-rx intervals in which a BFD packet is not received before the session goes down. Using the example below, if min-rx is configured to 100 msec and the multiplier is 4, this means that if BFD packets stop arriving the session will go down after 400 msec.

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp tunnel bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# multiplier 4

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# multiplier 4

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# multiplier 4


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-bypass/optimization.rst

protocols rsvp auto-bypass optimization
---------------------------------------

**Minimum user role:** operator

Enable ldp sync for all tunnels set with ldp-tunneling. When enabled, rsvp tunnel is excluded to be used for ldp tunneling, by either shortcut of forwarding-adjecency, if targeted LDP peer is missing.

**Command syntax: optimization [optimization]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass

**Parameter table**

+--------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter    | Description                                                                      | Range        | Default |
+==============+==================================================================================+==============+=========+
| optimization | Run sequential path calculations for tunnels in UP state to find an optimized    | | enabled    | \-      |
|              | path                                                                             | | disabled   |         |
+--------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization enabled


**Removing Configuration**

To return the optimization to the default:
::

    dnRouter(cfg-protocols-rsvp)# no optimization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### auto-bypass/pcep_delegation.rst

protocols rsvp auto-bypass pcep delegation
------------------------------------------

**Minimum user role:** operator

PCEP delegation enables to configure the use of PCEP to delegate tunnel settings to a remote PCE. See additional information on PCE and PCEP in "mpls traffic-engineering pcep.
When a new LSP is established for a tunnel, the path computation client (PCC) revokes the PCE's explicit route object (ERO) constraint. This may result in a new path with a different ERO for the tunnel. To prevent this behavior, use the sticky-ero attribute. With sticky-ero enabled, the following behavior is observed:

- The path computation client (PCC) keeps the last successfully established ERO received from the PCE for new established LSPs for the tunnel. All other LSP parameters (e.g. bandwidth, admin-groups, etc.) remain unchanged.

- When the user applies a new path configuration (ERO) to the tunnel, the tunnel will continue using the ERO provided by the PCE. The new path will be used when the tunnel is no longer delegated or RSVP has restarted.

To configure PCEP delegation globally:

**Command syntax: pcep delegation [admin-state]** sticky-ero [sticky-ero]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass

**Note**
.. -  'delegation disable' - disable delegation. sticky-ero-admin-state configuration remain unchanged

.. -  'no pcep delegation [delegation-admin-state] sticky-ero', 'no pcep delegation [delegation-admin-state] sticky-ero [sticky-ero-admin-state]' - return sticky-ero-admin-state to default settings

.. -  'no pcep delegation', 'no pcep delegation [delegation-admin-state]' - return both delegation-admin-state and sticky-ero-admin-state to default values

- When PCEP delegation is enabled, you still have control over tunnel configuration.

**Parameter table**

+-------------+------------------------+--------------+---------+
| Parameter   | Description            | Range        | Default |
+=============+========================+==============+=========+
| admin-state | tunnel delegation mode | | enabled    | \-      |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+
| sticky-ero  | tunnel delegation mode | | enabled    | \-      |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled sticky-ero enabled


**Removing Configuration**

To revert to the default sticky-ero state:
::

    dnRouter(cfg-protocols-rsvp)# no pcep delegation enabled sticky-ero

To revert to the default delegation state and sticky-ero-admin-state:
::

    dnRouter(cfg-protocols-rsvp)# no pcep delegation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/admin-group_exclude-all.rst

protocols rsvp auto-bypass primary admin-group exclude-all
----------------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group exclude-all**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/admin-group_exclude.rst

protocols rsvp auto-bypass primary admin-group
----------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group [exclude-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| exclude-type     | exclude options                    | | exclude-any      | \-      |
|                  |                                    | | exclude-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/admin-group_ignore.rst

protocols rsvp auto-bypass primary admin-group ignore
-----------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group ignore**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or ignore

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group ignore' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group ignore


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group ignore

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/admin-group_include.rst

protocols rsvp auto-bypass primary admin-group
----------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. By default, admin-group constraints are ignored in path calculation.
To define global link include admin-group attributes for all tunnels:

**Command syntax: admin-group [include-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set include-all or include-any or include-strict admin-group list

.. -  cannot be set together with admin-group exclude

.. -  'no admin-group include-all [admin-group-name]', 'no admin-group include-strict [admin-group-name]' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group include-any', 'no admin-group include-strict' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| include-type     | rsvp global admin groups           | | include-all      | \-      |
|                  |                                    | | include-any      |         |
|                  |                                    | | include-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-all RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-strict BLUE


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-any RED

To remove all admin-groups from the admin group list:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/bandwidth.rst

protocols rsvp auto-bypass primary bandwidth
--------------------------------------------

**Minimum user role:** operator

This command reserves the bandwidth on the tunnel. When a bandwidth reservation is configured, reservation messages propagate the bandwidth value throughout the tunnel. Routers must reserve the bandwidth specified across the link for the particular LSP. The reservation is done independently of the traffic that runs through the tunnel. 

To configure the bandwidth requirements for the tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: bandwidth [bandwidth-value]** [bandwidth-units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- The total bandwidth cannot exceed the bandwidth ranges.

- Reconfiguring the tunnel's bandwidth will reset the tunnel, unless "soft preemption" is configured.

.. -  tunnel bandwidth 0 mbps will result in 0 BW reservation for a tunnel (best-effort traffic). Tunnels with 0 bandwidth setting can be allocated on every bandwidth pool (matching .. their class) even if the pool is with 0 bandwidth. This applies toalltunnel types
..
.. -  considering **bandwidth units,** total bandwidth amount cannot exceed 4294967295 kbps. i.e for mbps max range is 4194303, for gbps 4096
..
.. -  reconfiguring tunnel bandwidth will reset the tunnel, unless "soft preemption" is configured
..
.. -  'no bandwidth [bandwidth] kbps' - return to default units
..
.. -  'no bandwidth' - set tunnel to default 0 mbps bandwidth

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| bandwidth-value | tunnel bandwidth value                                                           | 0-4294967295 | 0       |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| bandwidth-units | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|                 |                                                                                  | | mbps       |         |
|                 |                                                                                  | | gbps       |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# bandwidth 10000 kbps

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# bandwidth 20000


**Removing Configuration**

To revert to the default tunnel bandwidth reservation (i.e. 0 mbps):
::

    dnRouter(cfg-rsvp-tunnel-primary)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/class-type.rst

protocols rsvp auto-bypass primary class-type
---------------------------------------------

**Minimum user role:** operator

A class type is a set of traffic flows that have the same set of bandwidth constraints. Tunnels of the same class type allocate bandwidth from the same bandwidth pool and tunnels from different class-types will reserve bandwidth from different pools according to the resource allocation model.

The following table shows the class-type to bandwidth pool mapping:

+--------------------+----------------+
|                    |                |
| Bandwidth Pool     | Class-type     |
+====================+================+
| bc0                | 0              |
+--------------------+----------------+
| bc1                | 1              |
+--------------------+----------------+

If the combination of priority (both setup and hold) and class-type is not mapped to a te-class for a tunnel (see "mpls traffic-engineering diffserv-te te-class-map te-class"), the commit will fail.

To assign a tunnel, manual bypass tunnel, or auto-bypass tunnel to a class-type:

**Command syntax: class-type [class-type]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- Changing the tunnel's class-type for an existing tunnel will cause the tunnel to tear-down before reestablishing it.

- If a bypass tunnel does not satisfy the primary tunnel's constraint, it will not be used for protection.

.. -  if, for any tunnel, the combination priority (both setup and hold) & class-type isn't mapped to a te-class (according to traffic-engineering te-class) commit will fail with .. error message: "No defined TE-Class for tunnel <tunnel-name> with setup-priority <setup-priority> and class-type <class-type>, no bandwidth pool to match".
..
.. -  reconfiguring tunnel class-type for an existing tunnel will cause tunnel to tear-down before reestablishing it.
..
.. -  In case a bypass tunnel doesn't satisfy the primary tunnel constraint, it will not be used for protection
..
.. -  no command returns default class-type

.. -  default tunnel class-type is class-type 0.
..
.. -  class-type to bandwidth pool mapping:

**Parameter table**

+------------+-------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                 | Range | Default |
+============+=============================================================+=======+=========+
| class-type | Assign a tunnel to a class-type when diffserv-te is enabled | 0-1   | 0       |
+------------+-------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# class-type 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# class-type 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# class-type 1


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no class-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/exclude-srlg.rst

protocols rsvp auto-bypass primary exclude-srlg
-----------------------------------------------

**Minimum user role:** operator

You can configure a bypass-tunnel to avoid interfaces that have the same SRLG-ID as the main path (see "mpls traffic-engineering interface srlg-group").
There are 3 exclusion modes, each has a slightly different effect:

- Strict - a path will not be accepted if it traverses in a link with the same SRLG-ID

- Avoid - the path with the least number of links that have SRLG conflict will be selected

- Ignore - SRLG will be ignored for CSPF path calculation

To set this behavior:

**Command syntax: exclude-srlg [exclude-srlg]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel bypass primary

**Parameter table**

+--------------+-------------------+------------+---------+
| Parameter    | Description       | Range      | Default |
+==============+===================+============+=========+
| exclude-srlg | exclude srlg mode | | strict   | strict  |
|              |                   | | avoid    |         |
|              |                   | | ignore   |         |
+--------------+-------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# exclude-srlg ignore

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# exclude-srlg ignore


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-auto-bypass-primary)# no exclude-srlg

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/hop-limit.rst

protocols rsvp auto-bypass primary hop-limit
--------------------------------------------

**Minimum user role:** operator

You can set the maximum number of nodes that the LSP can traverse, including head-end and tail-end nodes. Setting a hop-limit value will add a CSPF constraint that the tunnel path cannot exceed the set number of hops.

To configure the limitation on the number of hops that LSPs can traverse:

**Command syntax: hop-limit [hop-limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Parameter table**

+-----------+-----------------------------------------+-------+---------+
| Parameter | Description                             | Range | Default |
+===========+=========================================+=======+=========+
| hop-limit | the time-to-live value for the mpls lsp | 2-255 | 255     |
+-----------+-----------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# hop-limit 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# hop-limit 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# hop-limit 100


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no hop-limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/mpls-oam_profile.rst

protocols rsvp auto-bypass primary mpls-oam profile
---------------------------------------------------

**Minimum user role:** operator

This command associates an MPLS-OAM profile ("services mpls-oam profile") defining a periodic LSP ping test with the specific tunnel. When a profile is associated with the tunnel, and the profile is enabled ("services mpls-oam profile admin-state"), MPLS echo request packets will be sent over the tunnel as part of the periodic probe. 

To associate a profile with a primary tunnel:

**Command syntax: mpls-oam profile [mpls-oam-profile]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
.. -  Available for all tunnel types
..
.. -  Changing mpls-oam profile configuration, attaching a different profile or removing the currently atteched profile will immiditaly stop current running probe an act by the probe .. result.
..
.. -  'no mpls-oam profile' - remove all mpls-oam profile attached to the tunnel

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| mpls-oam-profile | The profile name of the mpls oam service - the profile is atteched for an mpls   | | string         | \-      |
|                  | protocol (e.g RSVP)                                                              | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# mpls-oam profile P_1


**Removing Configuration**

To remove the profile association:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no mpls-oam profile

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/path-selection.rst

protocols rsvp auto-bypass primary path-selection
-------------------------------------------------

**Minimum user role:** operator

Set which type of metric cspf should consider when finding an LSP path.

The metric-types are:

- te-metric - The interface traffic-engineering metric, signaled as part of the traffic-engineering information by the igp protocol.

- igp-metric - The interface igp-metric.

To configure the metric-type:

**Command syntax: path-selection [path-selection]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Parameter table**

+----------------+-------------------------------------------------------------+----------------+---------+
| Parameter      | Description                                                 | Range          | Default |
+================+=============================================================+================+=========+
| path-selection | Set which metric should cspf consider whan finding lsp path | | te-metric    | \-      |
|                |                                                             | | igp-metric   |         |
+----------------+-------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-selection te-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# path-selection igp-metric


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no path-selection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### auto-bypass/primary/primary.rst

protocols rsvp auto-bypass primary
----------------------------------

**Minimum user role:** operator

To configure a primary tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: primary**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass
- protocols rsvp tunnel
- protocols rsvp tunnel bypass
- protocols rsvp auto-mesh tunnel-template

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)#


**Removing Configuration**

To revert all primary LSP's configuration to default:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no primary

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 9.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 10.0    | Added support for bypass tunnels (manual and auto) |
+---------+----------------------------------------------------+

---

### auto-bypass/primary/priority.rst

protocols rsvp auto-bypass primary priority setup hold
------------------------------------------------------

**Minimum user role:** operator

Tunnel priority allows you to configure the reservation setup and hold priority:

- Setup priority: the priority used when signaling an LSP for this tunnel to determine which existing tunnels can be preempted. A lower value indicates a higher priority. An LSP -  preempt any LSP with a lower priority.

- Hold priority: the priority used to determine if the LSP can be preempted by other signaled LSPs. A lower value indicates a higher priority. The higher the hold priority, the LSP is less likely to give up its reservation (i.e. is less likely to be preempted by a higher priority LSP).

If there is not enough bandwidth to create a new tunnel, the source (head) router will compare the setup priority of the new tunnel to the hold priority of existing tunnels to decide if to preempt an existing tunnel.

To configure the tunnel priority:

**Command syntax: priority setup [setup] hold [hold]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- The value of hold-priority must be  setup-priority.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| setup     | priority used when signaling an LSP for this tunnel to determine which existing  | 0-7   | \-      |
|           | tunnels can be preempted                                                         |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+
| hold      | priority associated with an LSP for this tunnel to determine if it should be     | 0-7   | \-      |
|           | preempted by other LSPs that are being signaled                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# priority setup 3 hold 3

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL2
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# priority setup 5 hold 1


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no priority

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 9.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 10.0    | Added support for bypass tunnels (manual and auto) |
+---------+----------------------------------------------------+

---

### auto-mesh/auto-mesh.rst

protocols rsvp auto-mesh
------------------------

**Minimum user role:** operator

RSVP Auto Mesh helps to reduce the amount of configuration required for establishing traffic engineering (TE) tunnels. With auto-mesh, RSVP uses tunnel configuration templates to automatically create a mesh of TE LSPs among the LSR devices in the interior gateway protocol (IGP)-TE domain.

Whenever the IS-IS LSP database is updated (for example, when a new TE LSR is inserted into the IGP), the destination address is stored in the TE topology database of all routers in the IGP. At each update, the destination address contained in the database is compared to the access-list associated with all template interfaces. If a match is found, a mesh tunnel interface is established to the tunnel destination IP address.

Auto-mesh tunnels obtain their configuration information from the auto-mesh template. If no specific behavior is configured in the template, the configuration is taken from the global RSVP configuration. The tunnel's destination address is obtained from the TE topology database that matches a specific prefix-list.

All auto-mesh tunnels of a given template are applied with the same path constraints and tunnel parameters.

To activate auto-mesh:

1.	Enter the auto-mesh configuration hierarchy (see below).
2.	Create a new template (see "rsvp auto-mesh tunnel-template").
3.	Configure the template (see "rsvp auto-mesh tunnel-template destination-address").
4.	Configure the template's tunnel parameters. The entire tunnel configuration hierarchy is replicated under the template. See "rsvp tunnel" for tunnel configuration options.

Global RSVP tunnel configurations serve as the tunnel-template's defaults.

Tunnels that are created according to the tunnel-template destination prefix-list are assigned an auto-generated name, as follows:

Syntax: auto_tunnel_<local-hostname>_<destination-hostname/destination-ip>_<template-name>_<id>

Description of syntax:

- auto_tunnel: a prefix for all tunnels created by the auto-mesh feature

- local-hostname: the tunnel's source system name, as advertised in IS-IS

- destination-hostname/destination-ip: the tunnel's destination system name (IS-IS hostname TLV is in the TE database). If the destination node's hostname is unknown, the destination IP address is used instead. If a tunnel name is generated with a remote IP address (instead of hostname), or the destination router has updated its hostname, the user must run the clear rsvp tunnels [tunnel-name] command to update the tunnel's name. This is a hard clear which deletes the old tunnel and may disrupt traffic.

- template-name: The name of the template according to which the tunnel was created.

- id: an identifier provided to each tunnel. The ids are given sequentially to each tunnel that is generated, starting from 1.

Example: auto_tunnel_NCR-North_NCR-South_TMPLT-CORE_TUNNEL-1

The name of an auto-tunnel is limited to 225 characters. If the name of the automatically generated tunnel exceeds this limit, the tunnel is created in a down state.

To enter auto-mesh configuration mode:

**Command syntax: auto-mesh**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- Removing the auto-mesh configuration disables auto-mesh and removes all tunnels generated by the auto-mesh feature.

.. - default system behavior is auto-mesh disabled

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)


**Removing Configuration**

To revert all auto-mesh configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no auto-mesh

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/admin-state.rst

protocols rsvp auto-mesh tunnel-template admin-state
----------------------------------------------------

**Minimum user role:** operator

To enable/disable a tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel
- protocols rsvp tunnel bypass

**Parameter table**

+-------------+------------------+--------------+---------+
| Parameter   | Description      | Range        | Default |
+=============+==================+==============+=========+
| admin-state | Set tunnel state | | enabled    | enabled |
|             |                  | | disabled   |         |
+-------------+------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# admin-state disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# admin-state disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/adjust-interval.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-interval
-----------------------------------------------------------------------

**Minimum user role:** operator

The adjust interval is the time-frame in which the samples' calculated average-rates are compared. The highest calculated average-rate within the adjust-interval time-frame will be used in the adjustment threshold decision.
To configure the adjust-interval:

**Command syntax: adjust-interval [adjust-interval]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth

**Note**
.. -  must adjust-interval > sampling-interval

- Changing the interval configuration will reset the timer.

.. -  no command restores adjust-interval to its default value

**Parameter table**

+-----------------+--------------------------------------------------------------+---------+---------+
| Parameter       | Description                                                  | Range   | Default |
+=================+==============================================================+=========+=========+
| adjust-interval | time interval that traffic average-rate samples are gathered | 5-10080 | \-      |
+-----------------+--------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-interval 5


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no adjust-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/adjust-threshold/adjust-threshold.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold
------------------------------------------------------------------------

**Minimum user role:** operator

At the end of the adjust-interval (AI) window, the highest average rate within the AI window (maxAvgRate) is compared against the configured adjust-threshold. The adjust-threshold sets the required difference before requesting a change in bandwidth. If maxAvgRate is below or above the threshold, then an attempt is made to signal a new path for the tunnel with the calculated maxAvg bandwidth.
To configure the threshold:

**Command syntax: adjust-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the adjust-threshold configuration will take effect on the next sampling.

.. -  set bandwidth=0 or percent=0 to ignore one of the terms.

.. -  cannot set both bandwidth and percent to 0

.. -  when both bandwidth and percent are configured with a non-zero value, perform bandwidth adjustments when **both** terms are met.

.. -  Units can only be set with bandwidth

.. -  'adjust-threshold' , 'no adjust-threshold', 'no adjust-threshold bandwidth percent' - return bandwidth and percent to their default values

.. -  'no adjust-threshold bandwidth' - return bandwidth to its default value

.. -  'no adjust-threshold percent - return percent to its default value

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 100 mbps percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 0 percent 10
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 10 kbps percent 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 20 percent 0


**Removing Configuration**

dnRouter(cfg-protocols-rsvp-auto-bw)# no adjust-threshold bandwidth
::

    dnRouter(cfg-protocols-rsvp)# no adjust-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/adjust-threshold/bandwidth.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold bandwidth
----------------------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold
- protocols rsvp auto-bandwidth adjust-threshold
- protocols rsvp tunnel auto-bandwidth adjust-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | \-      |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/adjust-threshold/percent.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold percent
--------------------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold
- protocols rsvp auto-bandwidth adjust-threshold
- protocols rsvp tunnel auto-bandwidth adjust-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | \-      |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/admin-state.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth admin-state
-------------------------------------------------------------------

**Minimum user role:** operator

To enable auto-bandwidth globally:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth

**Parameter table**

+-------------+-----------------------+--------------+---------+
| Parameter   | Description           | Range        | Default |
+=============+=======================+==============+=========+
| admin-state | enable auto-bandwidth | | enabled    | \-      |
|             |                       | | disabled   |         |
+-------------+-----------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/auto-bandwidth.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth
-------------------------------------------------------

**Minimum user role:** operator

LSPs may become suboptimal in time as topology changes occur or the availability of network resources changes. During this time, new paths that are less congested, with lower metrics, or with fewer hops may become available. An LSP with a fixed path cannot take advantage of new network resources. The LSP will remain fixed until a recalculation triggering change in the topology occurs. By enabling auto-bandwidth, you can force the router to periodically recalculate paths for available tunnels and, if more optimal paths are found, make new decisions to reroute suboptimal LSPs through other paths. Optimization runs at fixed intervals or whenever an RSVP enabled interface becomes available.
Optimization is applicable to all tunnel types. Tunnels are optimized sequentially, from the lowest priority and highest bandwidth to highest priority and lowest bandwidth. The auto-bandwidth is aggressive: the tunnel will be optimized only if a new path has a better metric to the destination.
If auto-bandwidth fails, no additional auto-bandwidth is attempted until the next scheduled auto-bandwidth cycle or until a manual clear rsvp tunnels optimize is performed (see "clear rsvp tunnels").

To configure the auto-bandwidth options, enter the global RSVP auto-bandwidth configuration mode:

**Command syntax: auto-bandwidth**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp
- protocols rsvp tunnel

**Note**
.. -  disabling auto-bandwidth while auto-bandwidth is in process will stop current auto-bandwidth attempts

.. -  reconfiguring optimize-timer while timer is running, will reset optimize-timer to new interval value. if auto-bandwidth was underway, stop current auto-bandwidth process (even if auto-bandwidth is due to interface up or user clear triggers).

.. -  'no auto-bandwidth'- returns all auto-bandwidth configuration to their default value.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bandwidth)


**Removing Configuration**

To revert all auto-bandwidth configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no auto-bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/maximum-bandwidth.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth maximum-bandwidth
-------------------------------------------------------------------------

**Minimum user role:** operator

A new requested bandwidth reservation is always within the configured minimum and maximum limits. So if the sampled average rate is greater than the configured maximum, the requested bandwidth will be for the set maximum limit. Similarly, if the sampled average rate is lower than the configured minimum, the requested bandwidth will be for the configured minimum limit. A change to the maximum-bandwidth configuration will take effect on the next sampling. To configure the maximum limit:

**Command syntax: maximum-bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth

**Note**
-  The minimum-bandwidth value must be lower or equal to maximum-bandwidth

.. -  'no maximum-bandwidth' - return bandwidth to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------------+---------+
| Parameter | Description                                                                      | Range         | Default |
+===========+==================================================================================+===============+=========+
| bandwidth | tunnel bandwidth                                                                 | 0-42949672950 | \-      |
+-----------+----------------------------------------------------------------------------------+---------------+---------+
| units     | The units used for maximum-bandwidth. If you do not specify the unit, mpbs will  | | kbps        | kbps    |
|           | be used.                                                                         | | mbps        |         |
|           |                                                                                  | | gbps        |         |
+-----------+----------------------------------------------------------------------------------+---------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# maximum-bandwidth 10000000

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# maximum-bandwidth 1000 gbps


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no maximum-bandwidth

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 18.2.5  | Bandwidth range update |
+---------+------------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/minimum-bandwidth.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth minimum-bandwidth
-------------------------------------------------------------------------

**Minimum user role:** operator

A new requested bandwidth reservation is always within the configured minimum and maximum limits. So if the sampled average rate is greater than the configured maximum, the requested bandwidth will be for the set maximum limit. Similarly, if the sampled average rate is lower than the configured minimum, the requested bandwidth will be for the configured minimum limit. A change to the minimum-bandwidth configuration will take effect on the next sampling. To configure the minimum limit:

**Command syntax: minimum-bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth

**Note**
-  The minimum-bandwidth value must be lower or equal to maximum-bandwidth

.. -  'no minimum-bandwidth' - return bandwidth to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | tunnel bandwidth                                                                 | 0-4294967295 | \-      |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for minimum-bandwidth. If you do not specify the unit, mpbs will  | | kbps       | kbps    |
|           | be used.                                                                         | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# minimum-bandwidth 10

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# minimum-bandwidth 10000 kbps


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no minimum-bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/monitor-only.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth monitor-only
--------------------------------------------------------------------

**Minimum user role:** operator

This command instructs RSVP to do all the auto-bandwidth calculations according to the configuration and record them, but without actually performing any changes. The recorded information is available in show commands.
To enable/disable monitoring-only:

**Command syntax: monitor-only [monitor-only]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth

**Note**
.. -  'no monitor-only' - return to disabled state

-  No adjustments will be made even if you explicitly run the "run rsvp auto-bandwidth adjust" command.

**Parameter table**

+--------------+------------------------------------------------------------------------------+--------------+---------+
| Parameter    | Description                                                                  | Range        | Default |
+==============+==============================================================================+==============+=========+
| monitor-only | maximum sampled traffic rate is monitored but doesnt effect tunnel bandwidth | | enabled    | \-      |
|              |                                                                              | | disabled   |         |
+--------------+------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# monitor-only enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no monitor-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/overflow-threshold/bandwidth.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold bandwidth
------------------------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold
- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp tunnel auto-bandwidth overflow-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | \-      |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/overflow-threshold/limit.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold limit
--------------------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: limit [limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold
- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp tunnel auto-bandwidth overflow-threshold

**Note**
-  You may set a new limit while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no limit - return delay to its default value

**Parameter table**

+-----------+------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                            | Range | Default |
+===========+========================================================================+=======+=========+
| limit     | the amount of consecutive sampling-interval in which overflow happened | 1-10  | \-      |
+-----------+------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# limit 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/overflow-threshold/overflow-threshold.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold
--------------------------------------------------------------------------

**Minimum user role:** operator

The overflow thresholds allows the tunnel to react quickly to significant changes in traffic volume. It uses the same mechanism as the adjust-threshold, except it operates at every sample-interval. The traffic rate is measured at every sampling-interval. If the traffic rate exceeds the configured threshold, a new LSP with updated bandwidth is signaled immediately. To configure the overflow threshold:

**Command syntax: overflow-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the overflow-threshold configuration will take effect on the next sampling.

- A change to the limit takes effect on the current sampling.

- If you do not specify a parameter, the default value is assumed.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 100 percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 0 percent 10 limit 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 kbps percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 kbps limit 2


**Removing Configuration**

To revert all overflow-threshold configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no overflow-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/overflow-threshold/percent.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold percent
----------------------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold
- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp tunnel auto-bandwidth overflow-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | \-      |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/underflow-threshold/bandwidth.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold bandwidth
-------------------------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold
- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp tunnel auto-bandwidth underflow-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | \-      |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/underflow-threshold/limit.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold limit
---------------------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: limit [limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold
- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp tunnel auto-bandwidth underflow-threshold

**Note**
-  You may set a new limit while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no limit - return delay to its default value

**Parameter table**

+-----------+------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                            | Range | Default |
+===========+========================================================================+=======+=========+
| limit     | the amount of consecutive sampling-interval in which overflow happened | 1-10  | \-      |
+-----------+------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# limit 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/underflow-threshold/percent.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold percent
-----------------------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold
- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp tunnel auto-bandwidth underflow-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | \-      |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/auto-bandwidth/underflow-threshold/underflow-threshold.rst

protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold
---------------------------------------------------------------------------

**Minimum user role:** operator

The underflow thresholds allows the tunnel to react quickly to significant changes in traffic volume. It uses the same mechanism as the adjust-threshold, except it operates at every sample-interval. The traffic rate is measured at every sampling-interval. If the traffic rate drops below the configured threshold, a new LSP with updated bandwidth is signaled immediately. To configure the overflow threshold:

**Command syntax: underflow-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp tunnel auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the underflow-threshold configuration will take effect on the next sampling.

- A change to the limit takes effect on the current sampling.

- If you do not specify a parameter, the default value is assumed.

..-  must set either bandwidth or percent to enable threshold feature.
..
..-  when both bandwidth and percent are configured with a non-zero value, perform bandwidth adjustments when **both** terms are met.
..
..-  Units can only be set with bandwidth
..
..-  'underflow-threshold' , 'no underflow-threshold', 'no underflow-threshold bandwidth percent limit' - return bandwidth and percent to their default values
..
..-  'no underflow-threshold bandwidth' - return bandwidth to its default value
..
..-  'no underflow-threshold percent - return percent to its default value
..
..-  'no underflow-threshold limit - return limit to its default value

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 100 percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 0 percent 10 limit 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 10 percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 10 kbps percent 5 limit 1


**Removing Configuration**

To revert all underflow-threshold configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no underflow-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### auto-mesh/tunnel-template/bfd/admin-state.rst

protocols rsvp auto-mesh tunnel-template bfd admin-state
--------------------------------------------------------

**Minimum user role:** operator

Enables a BFD over MPLS session for tunnel LSP protection.

To enable/disable a tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp tunnel bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

.. -  no command returns admin-state to default value

.. -  configuring bfd parameter will trigger LSP make-before-break to comply with new BFD state

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/bfd/bfd.rst

protocols rsvp auto-mesh tunnel-template bfd
--------------------------------------------

**Minimum user role:** operator

An RSVP tunnel is a label-switched path (LSP) that can carry inside other RSVP LSPs in order to provide network end-to-end traffic engineering. Each tunnel LSP can have a unique BFD session. 

BFD is supported for all tunnel types (primary, manual bypass, auto bypass and auto mesh).

To establish the BFD session, LSP-Ping is used to sync the peers on session BFD discriminators.
Before activating an LSP, verify the data path by establishing BFD session over LSP and ensure that tunnel can carry data traffic. Only after the BFD session is up the LSP will be used for forwarding.

Install delay: before installing the new LSP as the active tunnel path in the data path, wait for "rsvp make-before-break install-delay" time to verify that LSP is stable as BFD session remain UP for install-delay time. 

After the time period, if the BFD is still up, install the tunnel in the data path.

Upon BFD failure:

- At head LER - Remove LSP, invoke Break Before Make and remove LSP from data path.
- At tail LER - Only Respond with BFD down
- BFD for RSVP isn't a trigger for bypass protection

In the case that RSVP FRR is enabled, BFD timers should be configured to at least 3 x 300 ms so that FRR mechanism can operate as expected and provide fast switchover to a bypass tunnel. it applies to any router acting as PLR, including the case where the head is the PLR of the tunnel.

BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations. Detection-time = negotiated-received-interval X received multiplier.

This is the maximum amount of time that can elapse without receipt of a BFD control packet before the session is declared down.

BFD neighbor can signal session state down, and upon receipt, local BFD session will immediately switch to DOWN state.

To enter BFD configuration level:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp auto-bypass
- protocols rsvp tunnel bypass
- protocols rsvp tunnel

**Note**
.. -  BFD is supported for all tunnel types (primary, manual bypass, auto bypass, auto-mesh)

.. -  no command returns all bfd configuration to their default settings

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)#


**Removing Configuration**

To revert all bfd configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/bfd/min-tx.rst

protocols rsvp auto-mesh tunnel-template bfd min-tx
---------------------------------------------------

**Minimum user role:** operator

To set minimum transmit interval for BFD session:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp tunnel bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

- Due to hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+---------+---------+
| Parameter | Description                                           | Range   | Default |
+===========+=======================================================+=========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 50-1700 | 300     |
+-----------+-------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# min-tx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# min-tx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# min-tx 350


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no min-tx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/bfd/mix-rx.rst

protocols rsvp auto-mesh tunnel-template bfd min-rx
---------------------------------------------------

**Minimum user role:** operator

To set desired minimum receive interval for BFD session:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

**Parameter table**

+-----------+------------------------------------------------------+---------+---------+
| Parameter | Description                                          | Range   | Default |
+===========+======================================================+=========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 50-1700 | 300     |
+-----------+------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# min-rx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# min-rx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# min-rx 350


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no min-rx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/bfd/multiplier.rst

protocols rsvp auto-mesh tunnel-template bfd multiplier
-------------------------------------------------------

**Minimum user role:** operator

The multiplier defines the number of min-rx intervals in which a BFD packet is not received before the session goes down. Using the example below, if min-rx is configured to 100 msec and the multiplier is 4, this means that if BFD packets stop arriving the session will go down after 400 msec.

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp tunnel bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# multiplier 4

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# multiplier 4

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# multiplier 4


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/description.rst

protocols rsvp auto-mesh tunnel-template description
----------------------------------------------------

**Minimum user role:** operator

To enter a description for the tunnel or bypass tunnel:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel
- protocols rsvp tunnel bypass

**Parameter table**

+-------------+----------------------------+------------------+---------+
| Parameter   | Description                | Range            | Default |
+=============+============================+==================+=========+
| description | description for the tunnel | | string         | \-      |
|             |                            | | length 1-255   |         |
+-------------+----------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# description MyDescription

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# description MyDescription


**Removing Configuration**

To remove the tunnel's description:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no description

**Command History**

+---------+----------------------------------------+
| Release | Modification                           |
+=========+========================================+
| 9.0     | Command introduced                     |
+---------+----------------------------------------+
| 10.0    | Added support for manual bypass tunnel |
+---------+----------------------------------------+

---

### auto-mesh/tunnel-template/destination-address.rst

protocols rsvp auto-mesh tunnel-template destination-address
------------------------------------------------------------

**Minimum user role:** operator

The tunnel-template destination-address differs from the regular tunnel destination-address command in that it takes a prefix-list rather than a single destination-address. The prefix-list indicates for which destinations the creation of auto-mesh tunnels is allowed. The prefix list is matched against the router-ids in the TE topology database. If a matching destination address is found in the database, a tunnel will be automatically created.

If the tunnel's destination address is unreachable, the tunnel will remain in a "down" state.

If the tunnel's destination address is not found in the database and the tunnel is in "down" state, the tunnel is deleted.

The template destination-address prefix-list is a mandatory configuration for the tunnel-template.If the prefix-list has a "deny" statement, this will prevent tunnel creation to that destination. If you update the prefix-list (e.g. change from "allow" to "deny", or remove a prefix from the list), the corresponding tunnels will be removed.

If you attach the same prefix-list to multiple auto-mesh templates, multiple different tunnels will be created to the same destination - one per template.

You can configure different auto-mesh templates that are configured with different prefix-lists that have overlapping prefixes.

To configure the destination-address (prefix-list) for the template:

**Command syntax: destination-address [destination-address-prefix-list]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template

**Note**
- It is not possible to remove the destination-address from the configuration. You can, however, run the command again with a different prefix-list-name, or you can remove the template and start over.

**Parameter table**

+---------------------------------+-------------------------+----------------+---------+
| Parameter                       | Description             | Range          | Default |
+=================================+=========================+================+=========+
| destination-address-prefix-list | rsvp tunnel destination | string         | \-      |
|                                 |                         | length 1..255  |         |
+---------------------------------+-------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# destination-address IPv4_PL_AutoMesh_1


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp-auto-mesh-temp)# no destination-address

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/igp-instance_isis.rst

protocols rsvp auto-mesh tunnel-template igp-instance isis
----------------------------------------------------------

**Minimum user role:** operator

To configure the IGP protocol to be used by CSPF in path calculation. In the event the protocol is ISIS, the instance name must be provided:

**Command syntax: igp-instance isis [instance-name]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel

**Parameter table**

+---------------+----------------------------+------------------+---------+
| Parameter     | Description                | Range            | Default |
+===============+============================+==================+=========+
| instance-name | igp protocol instnace name | | string         | \-      |
|               |                            | | length 1-255   |         |
+---------------+----------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-instance isis AREA_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL2
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-instance isis AREA_2


**Removing Configuration**

To revert to the system default behavior:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no igp-instance

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 10.0    | Command introduced                                      |
+---------+---------------------------------------------------------+
| 13.1    | Split command syntax - protocol changed to ISIS or OSPF |
+---------+---------------------------------------------------------+

---

### auto-mesh/tunnel-template/igp-instance_ospf.rst

protocols rsvp auto-mesh tunnel-template igp-instance ospf
----------------------------------------------------------

**Minimum user role:** operator

To configure the IGP protocol to be used by CSPF in path calculation. In the event the protocol is ISIS, the instance name must be provided:

**Command syntax: igp-instance ospf [instance-name]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel

**Parameter table**

+---------------+----------------------------+------------------+---------+
| Parameter     | Description                | Range            | Default |
+===============+============================+==================+=========+
| instance-name | igp protocol instnace name | | string         | \-      |
|               |                            | | length 1-255   |         |
+---------------+----------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL321
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-instance ospf OSPF_1


**Removing Configuration**

To revert to the system default behavior:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no igp-instance

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 10.0    | Command introduced                                      |
+---------+---------------------------------------------------------+
| 13.1    | Split command syntax - protocol changed to ISIS or OSPF |
+---------+---------------------------------------------------------+

---

### auto-mesh/tunnel-template/igp-shortcuts.rst

protocols rsvp auto-mesh tunnel-template igp-shortcuts
------------------------------------------------------

**Minimum user role:** operator

By default, BGP and static-route next-hops are resolved first by an LSP if the LSP destination matches the next-hop address.
When IGP-shortcuts is enabled, the BGP and static-route next-hop can be solved by the RSVP tunnel even if the tunnel destination doesnt match the next-hop address. An IGP path is found to the next-hop destination with the option of using LSPs as a connected route for the IGP topology.
An RSVP tunnel will always have preference over LDP for next-hop resolution.

To enable/disable the use of RSVP tunnels to resolve non-MPLS traffic:

**Command syntax: igp-shortcuts [igp-shortcuts]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel

**Note**
-  RSVP tunnel igp-shortcuts is not supported for bypass tunnels (auto and manual).

-  The RSVP tunnel IGP-shortcuts overrides the "mpls traffic-engineering igp-shortcuts" configuration for the tunnel:

**Parameter table**

+---------------+-----------------------------------------------------------------+--------------+---------+
| Parameter     | Description                                                     | Range        | Default |
+===============+=================================================================+==============+=========+
| igp-shortcuts | support the use of the rsvp tunnel to resolve non mpls traffic. | | enabled    | \-      |
|               |                                                                 | | disabled   |         |
+---------------+-----------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-shortcuts enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# igp-shortcuts disabled
    dnRouter(cfg-protocols-mpls-te)# exit
    dnRouter(cfg-protocols-mpls)# exit
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-shortcuts enabled


    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# igp-shortcuts enabled
    dnRouter(cfg-protocols-mpls-te)# exit
    dnRouter(cfg-protocols-mpls)# exit
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-shortcuts disabled


**Removing Configuration**

To return the igp-shortcuts to the default:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no igp-shortcuts

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/ldp-sync.rst

protocols rsvp auto-mesh tunnel-template ldp-sync
-------------------------------------------------

**Minimum user role:** operator

Enable ldp sync for all tunnels set with ldp-tunneling. When enabled, rsvp tunnel is excluded to be used for ldp tunneling, by either shortcut of forwarding-adjecency, if targeted LDP peer is missing.

**Command syntax: ldp-sync [ldp-sync]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel

**Parameter table**

+-----------+------------------------------------------+--------------+---------+
| Parameter | Description                              | Range        | Default |
+===========+==========================================+==============+=========+
| ldp-sync  | Set ldp sync for ldp tunneling over rsvp | | enabled    | \-      |
|           |                                          | | disabled   |         |
+-----------+------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# ldp-sync enabled


**Removing Configuration**

To return the ldp-sync to the default:
::

    dnRouter(cfg-protocols-rsvp)# no ldp-sync

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/ldp-tunneling.rst

protocols rsvp auto-mesh tunnel-template ldp-tunneling
------------------------------------------------------

**Minimum user role:** operator

You can enable an rsvp tunnel to be used for LDP tunneling over RSVP. When the tunnel is in Up state, a targeted LDP session will be open to a peer matching the rsvp tunnel destination
To enable/disable the LDP tunneling over RSVP:

**Command syntax: ldp-tunneling [ldp-tunneling]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel

**Note**
- RSVP tunnel ldp-shortcuts-sync is not supported for bypass tunnels (auto and manual).

**Parameter table**

+---------------+-----------------------------------------------------------+--------------+----------+
| Parameter     | Description                                               | Range        | Default  |
+===============+===========================================================+==============+==========+
| ldp-tunneling | Enable rsvp tunnel to be used for LDP tunneling over RSVP | | enabled    | disabled |
|               |                                                           | | disabled   |          |
+---------------+-----------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# ldp-tunneling enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# ldp-tunneling enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no ldp-tunneling

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/optimization.rst

protocols rsvp auto-mesh tunnel-template optimization
-----------------------------------------------------

**Minimum user role:** operator

LSPs may become suboptimal in time as topology changes occur or the availability of network resources changes. During this time, new paths that are less congested, with lower metrics, or with fewer hops may become available. An LSP with a fixed path cannot take advantage of new network resources. The LSP will remain fixed until a recalculation triggering change in the topology occurs. By enabling optimization, you can force the router to periodically recalculate paths for available tunnels and, if more optimal paths are found, make new decisions to reroute suboptimal LSPs through other paths. Optimization runs at fixed intervals or whenever an RSVP enabled interface becomes available.

To enable/disable optimization on the tunnel level:

**Command syntax: optimization [optimization]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel
- protocols rsvp tunnel bypass

**Note**
- Enabling optimization on a tunnel enables all types of optimization triggers, even if global optimization is disabled.

- Disabling the feature while optimization is running stops any current optimization attempts.

.. -  'no optimization [admin-state]' - return optimization admin-state to default value.

.. -  'no optimization' - return optimization admin-state to default value.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter    | Description                                                                      | Range        | Default |
+==============+==================================================================================+==============+=========+
| optimization | Run sequential path calculations for tunnels in UP state to find an optimized    | | enabled    | \-      |
|              | path                                                                             | | disabled   |         |
+--------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# optimization disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# optimization disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# tunnel
    dnRouter(cfg-rsvp-auto-bypass-tunnel)# optimization disabled


**Removing Configuration**

To revert all optimization configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no optimization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/pcep_delegation.rst

protocols rsvp auto-mesh tunnel-template pcep delegation
--------------------------------------------------------

**Minimum user role:** operator

PCEP delegation enables to configure the use of PCEP to delegate tunnel settings to a remote PCE. See additional information on PCE and PCEP in "mpls traffic-engineering pcep".
When PCEP delegation is enabled, you still have control over tunnel configuration.
When a new LSP is established for a tunnel, the path computation client (PCC) revokes the PCE's explicit route object (ERO) constraint. This may result in a new path with a different ERO for the tunnel. To prevent this behavior, use the sticky-ero attribute. With sticky-ero enabled, the following behavior is observed:

- The path computation client (PCC) keeps the last successfully established ERO received from the PCE for new established LSPs for the tunnel. All other LSP parameters (e.g. bandwidth, admin-groups, etc.) remain unchanged.

- When the user applies a new path configuration (ERO) to the tunnel, the tunnel will continue using the ERO provided by the PCE. The new path will be used when the tunnel is no longer delegated or RSVP has restarted.

To configure PCEP delegation for the tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: pcep delegation [admin-state]** sticky-ero [sticky-ero]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel
- protocols rsvp tunnel bypass

**Note**
- When PCEP delegation is enabled, you still have control over tunnel configuration.

- Tunnel delegation configuration takes precedence over global RSVP delegation configuration.

.. - 'delegation disable' - disable delegation. sticky-ero-admin-state configuration remain unchanged

.. - 'no pcep delegation', 'no pcep delegation [delegation-admin-state]' - return both delegation-admin-state and sticky-ero-admin-state to default values

**Parameter table**

+-------------+------------------------+--------------+---------+
| Parameter   | Description            | Range        | Default |
+=============+========================+==============+=========+
| admin-state | tunnel delegation mode | | enabled    | \-      |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+
| sticky-ero  | tunnel delegation mode | | enabled    | \-      |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled sticky-ero enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation enabled sticky-ero disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# pcep delegation enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# pcep delegation enabled


**Removing Configuration**

To revert to the default sticky-ero state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no pcep delegation enabled sticky-ero

To revert to the default delegation state and sticky-ero-admin-state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no pcep delegation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/admin-group_exclude-all.rst

protocols rsvp auto-mesh tunnel-template primary admin-group exclude-all
------------------------------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group exclude-all**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/admin-group_exclude.rst

protocols rsvp auto-mesh tunnel-template primary admin-group
------------------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group [exclude-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| exclude-type     | exclude options                    | | exclude-any      | \-      |
|                  |                                    | | exclude-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/admin-group_ignore.rst

protocols rsvp auto-mesh tunnel-template primary admin-group ignore
-------------------------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group ignore**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or ignore

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group ignore' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group ignore


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group ignore

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/admin-group_include.rst

protocols rsvp auto-mesh tunnel-template primary admin-group
------------------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. By default, admin-group constraints are ignored in path calculation.
To define global link include admin-group attributes for all tunnels:

**Command syntax: admin-group [include-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set include-all or include-any or include-strict admin-group list

.. -  cannot be set together with admin-group exclude

.. -  'no admin-group include-all [admin-group-name]', 'no admin-group include-strict [admin-group-name]' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group include-any', 'no admin-group include-strict' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| include-type     | rsvp global admin groups           | | include-all      | \-      |
|                  |                                    | | include-any      |         |
|                  |                                    | | include-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-all RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-strict BLUE


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-any RED

To remove all admin-groups from the admin group list:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/bandwidth.rst

protocols rsvp auto-mesh tunnel-template primary bandwidth
----------------------------------------------------------

**Minimum user role:** operator

This command reserves the bandwidth on the tunnel. When a bandwidth reservation is configured, reservation messages propagate the bandwidth value throughout the tunnel. Routers must reserve the bandwidth specified across the link for the particular LSP. The reservation is done independently of the traffic that runs through the tunnel. 

To configure the bandwidth requirements for the tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: bandwidth [bandwidth-value]** [bandwidth-units]

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Note**
- The total bandwidth cannot exceed the bandwidth ranges.

- Reconfiguring the tunnel's bandwidth will reset the tunnel, unless "soft preemption" is configured.

.. -  tunnel bandwidth 0 mbps will result in 0 BW reservation for a tunnel (best-effort traffic). Tunnels with 0 bandwidth setting can be allocated on every bandwidth pool (matching .. their class) even if the pool is with 0 bandwidth. This applies toalltunnel types
..
.. -  considering **bandwidth units,** total bandwidth amount cannot exceed 4294967295 kbps. i.e for mbps max range is 4194303, for gbps 4096
..
.. -  reconfiguring tunnel bandwidth will reset the tunnel, unless "soft preemption" is configured
..
.. -  'no bandwidth [bandwidth] kbps' - return to default units
..
.. -  'no bandwidth' - set tunnel to default 0 mbps bandwidth

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| bandwidth-value | tunnel bandwidth value                                                           | 0-4294967295 | 0       |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| bandwidth-units | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|                 |                                                                                  | | mbps       |         |
|                 |                                                                                  | | gbps       |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# bandwidth 10000 kbps

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# bandwidth 20000


**Removing Configuration**

To revert to the default tunnel bandwidth reservation (i.e. 0 mbps):
::

    dnRouter(cfg-rsvp-tunnel-primary)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/class-type.rst

protocols rsvp auto-mesh tunnel-template primary class-type
-----------------------------------------------------------

**Minimum user role:** operator

A class type is a set of traffic flows that have the same set of bandwidth constraints. Tunnels of the same class type allocate bandwidth from the same bandwidth pool and tunnels from different class-types will reserve bandwidth from different pools according to the resource allocation model.

The following table shows the class-type to bandwidth pool mapping:

+--------------------+----------------+
|                    |                |
| Bandwidth Pool     | Class-type     |
+====================+================+
| bc0                | 0              |
+--------------------+----------------+
| bc1                | 1              |
+--------------------+----------------+

If the combination of priority (both setup and hold) and class-type is not mapped to a te-class for a tunnel (see "mpls traffic-engineering diffserv-te te-class-map te-class"), the commit will fail.

To assign a tunnel, manual bypass tunnel, or auto-bypass tunnel to a class-type:

**Command syntax: class-type [class-type]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Note**
- Changing the tunnel's class-type for an existing tunnel will cause the tunnel to tear-down before reestablishing it.

- If a bypass tunnel does not satisfy the primary tunnel's constraint, it will not be used for protection.

.. -  if, for any tunnel, the combination priority (both setup and hold) & class-type isn't mapped to a te-class (according to traffic-engineering te-class) commit will fail with .. error message: "No defined TE-Class for tunnel <tunnel-name> with setup-priority <setup-priority> and class-type <class-type>, no bandwidth pool to match".
..
.. -  reconfiguring tunnel class-type for an existing tunnel will cause tunnel to tear-down before reestablishing it.
..
.. -  In case a bypass tunnel doesn't satisfy the primary tunnel constraint, it will not be used for protection
..
.. -  no command returns default class-type

.. -  default tunnel class-type is class-type 0.
..
.. -  class-type to bandwidth pool mapping:

**Parameter table**

+------------+-------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                 | Range | Default |
+============+=============================================================+=======+=========+
| class-type | Assign a tunnel to a class-type when diffserv-te is enabled | 0-1   | 0       |
+------------+-------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# class-type 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# class-type 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# class-type 1


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no class-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/cspf-calculation.rst

protocols rsvp auto-mesh tunnel-template primary cspf-calculation
-----------------------------------------------------------------

**Minimum user role:** operator

RSVP uses the Constrained Shortest Path First (CSPF) algorithm to calculate traffic paths subject to the administrative-groups, bandwidth requirements, and explicit route objects (EROs) constraints, maintained in the traffic engineering database. In determining which path to select, CSPF uses the Dijkstra algorithm.

When enabled, CSPF calculates the available bandwidth ratio along each valid candidate tunnel path (where a valid candidate tunnel path is an equal cost shortest path that satisfies the path constraints). The available bandwidth ratio is calculated as: available-bandwidth/max-reservable-bandwidth across all path links.

Use the equal-cost mode to define how the available bandwidth ratio is considered for path selection:

- Least-fill - the path with the highest available-bandwidth-ratio is selected

- Most-fill - the path with the lowest available-bandwidth-ratio is selected

- Random - randomly selects a path from all valid path candidates

To enable/disable the CSPF calculation:

**Command syntax: cspf-calculation [cspf-calculation]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary

**Note**
- max-reservable-bandwidth is the configured traffic-engineering class-type 0 bandwidth for the TE interface.

.. -  default values for primary tunnels - as global cspf-calculation value
..
.. -  default values for bypass tunnels - enabled with equal-cost "least-fill"
..
.. -  'no cspf-calculation enabled equal-cost' return equal-cost to default value
..
.. -  'no cspf-calculation' command returns cspf-calculation & equal-cost to default values

**Parameter table**

+------------------+------------------------------------------------------------------------------+--------------+---------+
| Parameter        | Description                                                                  | Range        | Default |
+==================+==============================================================================+==============+=========+
| cspf-calculation | set whether Constraint Shortest Path Forwarding is used for path calculation | | enabled    | \-      |
|                  |                                                                              | | disabled   |         |
+------------------+------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation enabled equal-cost most-fill

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation enabled equal-cost random

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# cspf-calculation disabled


**Removing Configuration**

To revert equal-cost to default mode:
::

    dnRouter(cfg-protocols-rsvp-tunnel-primary)# no cspf-calculation enabled equal-cost

To revert cspf-calculation and equal-cost mode to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel-primary)# no cspf-calculation

**Command History**

+---------+----------------------------------------------------------------------+
| Release | Modification                                                         |
+=========+======================================================================+
| 9.0     | Command introduced                                                   |
+---------+----------------------------------------------------------------------+
| 10.0    | Changed the default admin-state value to the global configuration.   |
|         | Added support for manual bypass tunnels.                             |
+---------+----------------------------------------------------------------------+
| 11.0    | Added support for equal-cost mode configuration                      |
+---------+----------------------------------------------------------------------+

---

### auto-mesh/tunnel-template/primary/equal-cost.rst

protocols rsvp auto-mesh tunnel-template primary equal-cost
-----------------------------------------------------------

**Minimum user role:** operator

RSVP uses the Constrained Shortest Path First (CSPF) algorithm to calculate traffic paths that are subject to the following constraints:

- LSP attributes - Administrative groups such as link coloring, bandwidth requirements, and EROs

- Link attributes - Colors on a particular link and available bandwidth

These constraints are maintained in the traffic engineering database. The database provides CSPF with up-to-date topology information, the current reservable bandwidth of links, and the link colors. You can configure whether or not CSPF is used for path calculation. When disabled, the tunnel path must be explicitly set in order for the tunnel to be established. When enabled, CSPF calculates the available bandwidth ratio along each valid candidate tunnel path (where a valid candidate tunnel path is an equal cost shortest path that satisfies the path constraints). The available bandwidth ratio is calculated as: available-bandwidth/max-reservable-bandwidth across all path links.  
Use the equal-cost mode to define how the available bandwidth ratio is considered for path selection:

- Least-fill - the path with the highest available-bandwidth-ratio is selected

- Most-fill - the path with the lowest available-bandwidth-ratio is selected

- Random - randomly selects a path from all valid path candidates

To enable/disable CSPF path calculation:

**Command syntax: equal-cost [equal-cost]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary

**Note**
-  max-reservable-bandwidth is the configured traffic-engineering class-type 0 bandwidth for the TE interface.

.. -  'no equal-cost enabled equal-cost' return equal-cost to default value

.. -  'no equal-cost' command returns equal-cost & equal-cost to default values

**Parameter table**

+------------+-----------------------------------------------------------------------+----------------+---------+
| Parameter  | Description                                                           | Range          | Default |
+============+=======================================================================+================+=========+
| equal-cost | choose how available-bandwidth-ratio is considered for path selection | | least-fill   | \-      |
|            |                                                                       | | most-fill    |         |
|            |                                                                       | | random       |         |
+------------+-----------------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# equal-cost disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# equal-cost enabled equal-cost random


**Removing Configuration**

To revert equal-cost to default mode:
::

    dnRouter(cfg-protocols-rsvp)# no equal-cost enabled equal-cost

To revert equal-cost and equal-cost mode to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no equal-cost

**Command History**

+---------+---------------------------------------------------------------+
| Release | Modification                                                  |
+=========+===============================================================+
| 10.0    | Command introduced                                            |
+---------+---------------------------------------------------------------+
| 11.0    | Added "most-fill" and "random" selection of equal cost paths. |
+---------+---------------------------------------------------------------+

---

### auto-mesh/tunnel-template/primary/hop-limit.rst

protocols rsvp auto-mesh tunnel-template primary hop-limit
----------------------------------------------------------

**Minimum user role:** operator

You can set the maximum number of nodes that the LSP can traverse, including head-end and tail-end nodes. Setting a hop-limit value will add a CSPF constraint that the tunnel path cannot exceed the set number of hops.

To configure the limitation on the number of hops that LSPs can traverse:

**Command syntax: hop-limit [hop-limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Parameter table**

+-----------+-----------------------------------------+-------+---------+
| Parameter | Description                             | Range | Default |
+===========+=========================================+=======+=========+
| hop-limit | the time-to-live value for the mpls lsp | 2-255 | 255     |
+-----------+-----------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# hop-limit 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# hop-limit 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# hop-limit 100


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no hop-limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/mpls-oam_profile.rst

protocols rsvp auto-mesh tunnel-template primary mpls-oam profile
-----------------------------------------------------------------

**Minimum user role:** operator

This command associates an MPLS-OAM profile ("services mpls-oam profile") defining a periodic LSP ping test with the specific tunnel. When a profile is associated with the tunnel, and the profile is enabled ("services mpls-oam profile admin-state"), MPLS echo request packets will be sent over the tunnel as part of the periodic probe. 

To associate a profile with a primary tunnel:

**Command syntax: mpls-oam profile [mpls-oam-profile]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Note**
.. -  Available for all tunnel types
..
.. -  Changing mpls-oam profile configuration, attaching a different profile or removing the currently atteched profile will immiditaly stop current running probe an act by the probe .. result.
..
.. -  'no mpls-oam profile' - remove all mpls-oam profile attached to the tunnel

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| mpls-oam-profile | The profile name of the mpls oam service - the profile is atteched for an mpls   | | string         | \-      |
|                  | protocol (e.g RSVP)                                                              | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# mpls-oam profile P_1


**Removing Configuration**

To remove the profile association:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no mpls-oam profile

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/path-options/path_dynamic.rst

protocols rsvp auto-mesh tunnel-template primary path-options path dynamic
--------------------------------------------------------------------------

**Minimum user role:** operator

You can instruct the tunnel to resolve the LSP dynamically or using a specific explicit path. These can be complementary such that the explicit path may have holes that are resolved dynamically, using CSPF.

You can configure up to 10 paths altogether (explicit and dynamic) under a tunnel.

To configure the path-options for the tunnel so that the LSP will follow the explicit path rules:

**Command syntax: path dynamic**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary path-options
- protocols rsvp tunnel primary path-options
- protocols rsvp tunnel secondary path-options
- protocols rsvp tunnel bypass primary path-options

**Note**
- When configuring path-options (see "rsvp tunnel primary path-options"), you must configure a path-options path.

- You can configure path dynamic only once per path-option.

.. - If you instruct the tunnel to use explicit tunnels only and all path options fail, the tunnel will not be established. If you configure explicit path for higher priority path-options than for path-dynamic, the explicit path will never be tested.

.. - If you set "path dynamic" with a higher "path-options priority" than "path explicit", then the explicit path will never be considered. "path dynamic" should therefore always be the last option.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary

    dnRouter(cfg-rsvp-tunnel-primary)# path-options 3
    dnRouter(cfg-tunnel-primary-path-options)# path dynamic


**Removing Configuration**

To revert to the default path behavior:
::

    dnRouter(cfg-tunnel-primary-path-options)# no path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/path-options/path_explicit.rst

protocols rsvp auto-mesh tunnel-template primary path-options path explicit
---------------------------------------------------------------------------

**Minimum user role:** operator

You can instruct the tunnel to resolve the LSP dynamically or using a specific explicit path. These can be complementary such that the explicit path may have holes that are resolved dynamically, using CSPF.

You can configure up to 10 paths altogether (explicit and dynamic) under a tunnel.

To configure the path-options for the tunnel so that the LSP will follow the explicit path rules:

**Command syntax: path explicit [explicit-path-name]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary path-options
- protocols rsvp tunnel primary path-options
- protocols rsvp tunnel secondary path-options
- protocols rsvp tunnel bypass primary path-options

**Note**
- When configuring path-options (see "rsvp tunnel primary path-options"), you must configure a path-options path.

- You can configure path dynamic only once per path-option.

.. - If you instruct the tunnel to use explicit tunnels only and all path options fail, the tunnel will not be established. If you configure explicit path for higher priority path-options than for path-dynamic, the explicit path will never be tested.

.. - If you set "path dynamic" with a higher "path-options priority" than "path explicit", then the explicit path will never be considered. "path dynamic" should therefore always be the last option.

**Parameter table**

+--------------------+---------------+------------------+---------+
| Parameter          | Description   | Range            | Default |
+====================+===============+==================+=========+
| explicit-path-name | ERO path name | | string         | \-      |
|                    |               | | length 1-255   |         |
+--------------------+---------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-options 1
    dnRouter(cfg-tunnel-primary-path-options)# path explicit PATH_1

    dnRouter(cfg-rsvp-tunnel-primary)# path-options 2
    dnRouter(cfg-tunnel-primary-path-options)# path explicit PATH_2


**Removing Configuration**

To revert to the default path behavior:
::

    dnRouter(cfg-tunnel-primary-path-options)# no path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/path-options/path-options.rst

protocols rsvp auto-mesh tunnel-template primary path-options
-------------------------------------------------------------

**Minimum user role:** operator

Path-options provides a set of constraints for establishing the tunnel. When it is not possible to establish the tunnel with one set of constraints, you can opt to establish it using the next set of constraints (according to priority). After the tunnel is established with a specific path-options, the LSP will use the constraints of the best path option that was successfully established.

By default, the system dynamically computes the tunnel's path using global tunnel attributes.

To configure the path-options and enter path-options configuration mode:

**Command syntax: path-options [path-option]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel secondary
- protocols rsvp tunnel bypass primary

**Note**
.. -  default system behavior is to dynamically compute tunnel path using global tunnel attributes
..
.. -  when configuring a better path-option then one currently in use, invoke MBB starting fromt the best path-option. top to bottom. If a worst Path-Option was configured - do .. nothing
..
.. -  the path priority determines which path is examined first, the path is set by the first path that was successfully build
..
.. -  'no path-options [priority]' - remove specific path-option enty
..
.. -  'no path-options' - remove all path-option , returning to system default path option behavior

**Parameter table**

+-------------+----------------------+-------+---------+
| Parameter   | Description          | Range | Default |
+=============+======================+=======+=========+
| path-option | path option priority | 1-10  | \-      |
+-------------+----------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-options 1
    dnRouter(cfg-tunnel-primary-path-options)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# path-options 5
    dnRouter(cfg-bypass-tunnel-primary-path-options)#


**Removing Configuration**

To remove a specific path-option:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no path-options 1

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 9.0     | Command introduced                      |
+---------+-----------------------------------------+
| 10.0    | Added support for manual bypass tunnels |
+---------+-----------------------------------------+
| 11.0    | Updated the priority range              |
+---------+-----------------------------------------+

---

### auto-mesh/tunnel-template/primary/path-selection.rst

protocols rsvp auto-mesh tunnel-template primary path-selection
---------------------------------------------------------------

**Minimum user role:** operator

Set which type of metric cspf should consider when finding an LSP path.

The metric-types are:

- te-metric - The interface traffic-engineering metric, signaled as part of the traffic-engineering information by the igp protocol.

- igp-metric - The interface igp-metric.

To configure the metric-type:

**Command syntax: path-selection [path-selection]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Parameter table**

+----------------+-------------------------------------------------------------+----------------+---------+
| Parameter      | Description                                                 | Range          | Default |
+================+=============================================================+================+=========+
| path-selection | Set which metric should cspf consider whan finding lsp path | | te-metric    | \-      |
|                |                                                             | | igp-metric   |         |
+----------------+-------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-selection te-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# path-selection igp-metric


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no path-selection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/primary/primary.rst

protocols rsvp auto-mesh tunnel-template primary
------------------------------------------------

**Minimum user role:** operator

To configure a primary tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: primary**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel
- protocols rsvp tunnel bypass
- protocols rsvp auto-bypass

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)#


**Removing Configuration**

To revert all primary LSP's configuration to default:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no primary

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 9.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 10.0    | Added support for bypass tunnels (manual and auto) |
+---------+----------------------------------------------------+

---

### auto-mesh/tunnel-template/primary/priority.rst

protocols rsvp auto-mesh tunnel-template primary priority setup hold
--------------------------------------------------------------------

**Minimum user role:** operator

Tunnel priority allows you to configure the reservation setup and hold priority:

- Setup priority: the priority used when signaling an LSP for this tunnel to determine which existing tunnels can be preempted. A lower value indicates a higher priority. An LSP -  preempt any LSP with a lower priority.

- Hold priority: the priority used to determine if the LSP can be preempted by other signaled LSPs. A lower value indicates a higher priority. The higher the hold priority, the LSP is less likely to give up its reservation (i.e. is less likely to be preempted by a higher priority LSP).

If there is not enough bandwidth to create a new tunnel, the source (head) router will compare the setup priority of the new tunnel to the hold priority of existing tunnels to decide if to preempt an existing tunnel.

To configure the tunnel priority:

**Command syntax: priority setup [setup] hold [hold]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Note**
- The value of hold-priority must be  setup-priority.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| setup     | priority used when signaling an LSP for this tunnel to determine which existing  | 0-7   | \-      |
|           | tunnels can be preempted                                                         |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+
| hold      | priority associated with an LSP for this tunnel to determine if it should be     | 0-7   | \-      |
|           | preempted by other LSPs that are being signaled                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# priority setup 3 hold 3

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL2
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# priority setup 5 hold 1


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no priority

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 9.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 10.0    | Added support for bypass tunnels (manual and auto) |
+---------+----------------------------------------------------+

---

### auto-mesh/tunnel-template/primary/protection.rst

protocols rsvp auto-mesh tunnel-template primary protection
-----------------------------------------------------------

**Minimum user role:** operator

Fast reroute protection enables to divert a tunnel passing through a failed interface by encapsulating it in a different tunnel carrying the traffic to a merge point behind the network failure.

There are two types of traffic protection for RSVP-signaled LSPs:

- Link protection - where a bypass tunnel encapsulates the traffic through an LSP skipping the potential damaged link and forwards it towards the protected tunnel's next-hop:
- - When Link protection is desired, and no bypass LSP available to provide the required link protection, no protection will be given.

- Node protection - where a bypass tunnel encapsulates the traffic through an LSP skipping the potential damaged node and forwards it towards the protected tunnel's next next-hop:
- - When Node protection is desired, and no bypass LSP available to provide the required node protection, a link protection will be used if available. 

The bypass-tunnel can have any length LSP (limited by the configured hop-limit).
When protection is needed and a bypass tunnel that can provide it (i.e. it has the required destination and matches the required protection type) is available, the bypass tunnel will be used regardless of any conflict with the Primary tunnel's attributes, such as admin-group.
When there are multiple possible bypass-tunnels available for protection, the bypass tunnel that will be used is the least used bypass-tunnel, i.e the tunnel that protects the least number of primary tunnels. 

The bypass tunnel protection type supported is facility-backup. A single bypass-tunnel provides protection to multiple primary tunnels. If several (2 or more) primary tunnels are protected by a single protection Bypass (of the same type) and a new protection bypass (of the same type) is created  the bypasses are reselected for protection of the primary tunnels to ensure equal usage of bypass tunnels among the primary tunnels.

You can configure up to 5 manual bypass-tunnels per interface. There is no limit to the number of auto bypass-tunnels established through an interface.
When checking the scale of tunnels in the system, bypass-tunnels (auto and manual) are regarded as any other tunnel and are counted in the system's total tunnel scale limit.
Protection by a bypass tunnel that serves node-protection is preferred over a bypass tunnel that serves link-protection (even if link protection is requested). If a primary tunnel is protected by a link-protection bypass tunnel and a new bypass tunnel is created that serves node-protection, the primary tunnel will switch to be protected by the new bypass tunnel.

If there are both manual and automatic bypass tunnels, they are all eligible for load-balancing of primary tunnels.

When enabled, all the nodes are informed that the LSP is protected against link and/or node failure. Bypass tunnels that match the protection request are set as protection tunnels. If there are no eligible bypass tunnels and auto-bypass is enabled (see "rsvp auto-bypass"), an auto-bypass tunnel will be created.

To enable/disable fast-reroute protection for a tunnel:

**Command syntax: protection [protection]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template primary
- protocols rsvp tunnel primary

**Parameter table**

+------------+----------------------------------------------------+---------------------+---------+
| Parameter  | Description                                        | Range               | Default |
+============+====================================================+=====================+=========+
| protection | global configuration for tunnel protection setting | | disabled          | \-      |
|            |                                                    | | link-protection   |         |
|            |                                                    | | node-protection   |         |
+------------+----------------------------------------------------+---------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# protection link

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL2
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# protection node

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL3
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# protection disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.1    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/rib-unicast-install.rst

protocols rsvp auto-mesh tunnel-template rib-unicast-install
------------------------------------------------------------

**Minimum user role:** operator

With the rib-unicast-install command, you can install RSVP tunnel destinations in the RIB IPv4-unicast table as directly reachable through the tunnel.
To enable/disable the ability to install the tunnel destinations in the RIB:

**Command syntax: rib-unicast-install [rib-unicast-install]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel

**Note**
- This configuration is applicable to all primary tunnel types (regular and auto-mesh), except bypass tunnels.

.. - RSVP administrative-distance is 100 by default

.. - 'no rib-unicast-install'- return rib-unicast-install to default state

**Parameter table**

+---------------------+-----------------------------------------------------------------------------+--------------+---------+
| Parameter           | Description                                                                 | Range        | Default |
+=====================+=============================================================================+==============+=========+
| rib-unicast-install | state if tunnel destination will be installed in the rib ipv4-unicast table | | enabled    | \-      |
|                     |                                                                             | | disabled   |         |
+---------------------+-----------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# rib-unicast-install disabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# rib-unicast-install enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install disabled


**Removing Configuration**

To return the rib-unicast-install to the default:
::

    dnRouter(cfg-protocols-rsvp)# no rib-unicast-install

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/source-address.rst

protocols rsvp auto-mesh tunnel-template source-address
-------------------------------------------------------

**Minimum user role:** operator

A tunnel's source-address is the tunnel's head-end router's address. By default, this would be the router's configured MPLS-TE router-id. You can, however use a different address.
To configure a source-address for the tunnel:

**Command syntax: source-address [source-address]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template
- protocols rsvp tunnel

**Note**
- This command does not apply to bypass tunnels (auto or manual). For auto-bypass and manual bypass tunnels, the RSVP egress interface source address is according to the egress interface.

**Parameter table**

+----------------+------------------------------------------------------+---------+---------+
| Parameter      | Description                                          | Range   | Default |
+================+======================================================+=========+=========+
| source-address | rsvp ip source address to be use in tunnel signaling | A.B.C.D | \-      |
+----------------+------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# source-address 2.2.2.2


**Removing Configuration**

To revert to the default source-address:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no source-address

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/tunnel-template.rst

protocols rsvp auto-mesh tunnel-template
----------------------------------------

**Minimum user role:** operator

To create a new auto-mesh tunnel template and enter the template's configuration mode:

**Command syntax: tunnel-template [tunnel-template]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh

**Note**
- Removing a tunnel-template will remove all tunnels that were created according to that template.

.. - default system behavior is auto-mesh disabled

**Parameter table**

+-----------------+---------------+------------------+---------+
| Parameter       | Description   | Range            | Default |
+=================+===============+==================+=========+
| tunnel-template | template name | | string         | \-      |
|                 |               | | length 1-255   |         |
+-----------------+---------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# description "auto tunnel test template"
    dnRouter(cfg-rsvp-auto-mesh-temp)# destination-address prefix-list IPv4_CORE
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# bandwidth 900 mbps
    dnRouter(cfg-auto-mesh-temp-primary)# admin-group include-any RED, GREEN
    dnRouter(cfg-auto-mesh-temp-primary)# priority setup 5 hold 5


**Removing Configuration**

To remove a specific template:
::

    dnRouter(cfg-protocols-rsvp-auto-mesh)# no tunnel-template TEMP_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### auto-mesh/tunnel-template/weight.rst

protocols rsvp auto-mesh tunnel-template weight
-----------------------------------------------

**Minimum user role:** operator

Set tunnel weight for unequal load-balancing when working with weighted-ecmp . 
For "tunnel-bw" weight will be per tunnel bw in kbps
To configure the weight for the rsvp tunnel:

**Command syntax: weight [weight]**

**Command mode:** config

**Hierarchies**

- protocols rsvp auto-mesh tunnel-template

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------------------------+-----------+
| Parameter | Description                                                                      | Range                     | Default   |
+===========+==================================================================================+===========================+===========+
| weight    | configure the tunnel weight to be used for unequal rsvp tunnels multi-path       | 1..4294967295 | tunnel-bw | tunnel-bw |
|           | load-balancing                                                                   |                           |           |
+-----------+----------------------------------------------------------------------------------+---------------------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# weight 1500

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# weight tunnel-bw


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no weight

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

### bfd/bfd.rst

protocols rsvp bfd
------------------

**Minimum user role:** operator

To enter BFD for RSVP configuration mode:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# bfd
    dnRouter(cfg-protocols-rsvp-bfd)


**Removing Configuration**

To revert all parameters to their default value:
::

    dnRouter(cfg-protocols-rsvp)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### bfd/tail/multiplier.rst

protocols rsvp bfd tail multiplier
----------------------------------

**Minimum user role:** operator

You can set a multiplier to determine the BFD detection timeout over the head end. The timeout calculation is:

Timeout = tail_multiplier x negotiated_tail_tx

To configure a BFD multiplier value for a tunnel tail end:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols rsvp bfd tail

**Note**
- The new configuration of the BFD multiplier affects only new LSPs established at the tail end.

- The timeout will be 5 times the negotiated tail transmission time.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# bfd
    dnRouter(cfg-protocols-rsvp-bfd)# tail
    dnRouter(cfg-protocols-rsvp-bfd-tail)# multiplier 5


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-bfd)# no tail multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### bfd/tail/tail.rst

protocols rsvp bfd tail
-----------------------

**Minimum user role:** operator

To enter BFD-Tail for RSVP configuration mode:

**Command syntax: tail**

**Command mode:** config

**Hierarchies**

- protocols rsvp bfd

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# bfd
    dnRouter(cfg-protocols-rsvp-bfd)# tail


**Removing Configuration**

To revert all tail configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-bfd)# no tail

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### class-of-service.rst

protocols rsvp class-of-service
-------------------------------

**Minimum user role:** operator

With class of service (CoS) you can classify traffic to provide different service levels to different traffic so that when congestion occurs, you can control which packets receive priority.
To configure a CoS for all outgoing RSVP packets:

**Command syntax: class-of-service [class-of-service-dscp]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Parameter table**

+-----------------------+------------------------------------------+-------+---------+
| Parameter             | Description                              | Range | Default |
+=======================+==========================================+=======+=========+
| class-of-service-dscp | set dscp value for outgoing RSVP packets | 0-56  | 48      |
+-----------------------+------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# class-of-service 48


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### cspf-calculation.rst

protocols rsvp cspf-calculation
-------------------------------

**Minimum user role:** operator

RSVP uses the Constrained Shortest Path First (CSPF) algorithm to calculate traffic paths that are subject to the following constraints:

- LSP attributes - Administrative groups such as link coloring, bandwidth requirements, and EROs

- Link attributes - Colors on a particular link and available bandwidth

These constraints are maintained in the traffic engineering database. The database provides CSPF with up-to-date topology information, the current reservable bandwidth of links, and the link colors. You can configure whether or not CSPF is used for path calculation. When disabled, the tunnel path must be explicitly set in order for the tunnel to be established. When enabled, CSPF calculates the available bandwidth ratio along each valid candidate tunnel path (where a valid candidate tunnel path is an equal cost shortest path that satisfies the path constraints). The available bandwidth ratio is calculated as: available-bandwidth/max-reservable-bandwidth across all path links.  
Use the equal-cost mode to define how the available bandwidth ratio is considered for path selection:

- Least-fill - the path with the highest available-bandwidth-ratio is selected

- Most-fill - the path with the lowest available-bandwidth-ratio is selected

- Random - randomly selects a path from all valid path candidates

To enable/disable CSPF path calculation:

**Command syntax: cspf-calculation [cspf-calculation]** equal-cost [equal-cost]

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
-  max-reservable-bandwidth is the configured traffic-engineering class-type 0 bandwidth for the TE interface.

.. -  'no cspf-calculation enabled equal-cost' return equal-cost to default value

.. -  'no cspf-calculation' command returns cspf-calculation & equal-cost to default values

**Parameter table**

+------------------+----------------------------------------------------------------------------------+----------------+------------+
| Parameter        | Description                                                                      | Range          | Default    |
+==================+==================================================================================+================+============+
| cspf-calculation | Globally set whether Constraint Shortest Path Forwarding is used for path        | | enabled      | enabled    |
|                  | calculation                                                                      | | disabled     |            |
+------------------+----------------------------------------------------------------------------------+----------------+------------+
| equal-cost       | choose how available-bandwidth-ratio is considered for path selection            | | least-fill   | least-fill |
|                  |                                                                                  | | most-fill    |            |
|                  |                                                                                  | | random       |            |
+------------------+----------------------------------------------------------------------------------+----------------+------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# cspf-calculation disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# cspf-calculation enabled equal-cost random


**Removing Configuration**

To revert equal-cost to default mode:
::

    dnRouter(cfg-protocols-rsvp)# no cspf-calculation enabled equal-cost

To revert cspf-calculation and equal-cost mode to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no cspf-calculation

**Command History**

+---------+---------------------------------------------------------------+
| Release | Modification                                                  |
+=========+===============================================================+
| 10.0    | Command introduced                                            |
+---------+---------------------------------------------------------------+
| 11.0    | Added "most-fill" and "random" selection of equal cost paths. |
+---------+---------------------------------------------------------------+

---

### explicit-null.rst

protocols rsvp explicit-null
----------------------------

**Minimum user role:** operator

This command sets explicit-null behavior for the LSP. When enabled, the last LSR in the LSP will advertise label 0 to indicate to the penultimate router to push label 0 instead of popping the last label.

When disabled, the egress LSR advertises an implicit null label (label 3) to indicate to the penultimate router to remove (pop) the tunnel's label. When the packet arrives to the egress LSR, the egress LSR only needs to perform IP lookup, saving it from doing a label lookup first.
Although implicit-null is more efficient, explicit-null is useful for maintaining class of service (CoS). When a packet or Ethernet frame is encapsulated in MPLS, you can you can set the EXP bits independently, so that the LSP CoS is different than the payload CoS. In this case, if you use implicit-null, the LSP CoS will be lost when the penultimate LSR pops the label and the packet will be queued on the outgoing interface according to the CoS behavior of the underlying payload. With explicit-null, however, the MPLS header is preserved until the packet reaches the egress, preserving the LSP CoS behavior across the entire LSP.
To enable/disable explicit-null behavior for the LSP:

**Command syntax: explicit-null [explicit-null]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. -  default system behavior is implicit-null were penultimate-hop router removes the tunnel label

-  Changing the explicit-null admin-state will only affect new tunnels.

.. -  no command returns explicit-null to default value

**Parameter table**

+---------------+----------------------------------------+--------------+----------+
| Parameter     | Description                            | Range        | Default  |
+===============+========================================+==============+==========+
| explicit-null | Set explicit-null behavior for the LSP | | enabled    | disabled |
|               |                                        | | disabled   |          |
+---------------+----------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# explicit-null enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp)# no explicit-null

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### explicit-path/explicit-path.rst

protocols rsvp explicit-path
----------------------------

**Minimum user role:** operator

Explicit paths limit LSP routing to a specified list of LSRs. By default, RSVP messages follow a path that is dynamically determined by the network IGP's shortest path (i.e. by IS-IS), unless an explicit path is configured.
To create an explicit path:

**Command syntax: explicit-path [explicit-path]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. - no commands remove the explicit-path

- You cannot remove an explicit path that is in use by a tunnel.

**Parameter table**

+---------------+--------------------+------------------+---------+
| Parameter     | Description        | Range            | Default |
+===============+====================+==================+=========+
| explicit-path | explicit path name | | string         | \-      |
|               |                    | | length 1-255   |         |
+---------------+--------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# explicit-path PATH_1
    dnRouter(cfg-protocols-rsvp-expl-path)#


**Removing Configuration**

To remove an explicit path:
::

    dnRouter(cfg-protocols-rsvp)# no explicit-path PATH_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### explicit-path/index_lsr-rule.rst

protocols rsvp explicit-path index ipv4-address
-----------------------------------------------

**Minimum user role:** operator

You can configure explicit paths with include-loose or include-strict:

- Include-strict: identifies an exact path through which the LSP must be routed. Strict-hop explicit paths specify the exact order of routers through which the RSVP messages are sent.

- Include-loose: identifies one or more transit LSRs through which the LSP must be routed. The network IGP (IS-IS) determines the exact route from the head-end router to the first loose hop, or from one loose hop to the next. The loose hop specifies only that a particular LSR be included in the LSP.

- Exclude: identifies one or more LSRs through which the LSP must not be routed.

If you configure explicit an path with include-loose and include-strict simultaneously, the IGP determines the route between loose hops, while the strict-hop configuration specifies the exact path for specific path segments. To configure the explicit path:

**Command syntax: index [explicit-path-index] ipv4-address [ipv4-address] [lsr-rule]**

**Command mode:** config

**Hierarchies**

- protocols rsvp explicit-path

**Note**
-  If you do not specify an include-strict, include-loose, or exclude, include-strict will be assumed for the specified IP address.

.. -  user can set loopback address as the ipv4-address, in which case

   -  cspf must be enabled in order to resolve the rechability for the loopback address

   -  having "include-strict" for a loopback address will be treated as a loose constraint with requirement of a single hop reachability. E.g if two consecutive address are loopbacks with include-strict, the path may variant between using different links connecting to two nodes.

.. -  no command removes the path entry

**Parameter table**

+---------------------+-------------------------------+--------------------+----------------+
| Parameter           | Description                   | Range              | Default        |
+=====================+===============================+====================+================+
| explicit-path-index | node index                    | 1-32               | \-             |
+---------------------+-------------------------------+--------------------+----------------+
| ipv4-address        | lsr-ip-address                | A.B.C.D            | \-             |
+---------------------+-------------------------------+--------------------+----------------+
| lsr-rule            | label switch router rule type | | include-loose    | include-strict |
|                     |                               | | include-strict   |                |
|                     |                               | | exclude          |                |
+---------------------+-------------------------------+--------------------+----------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)
    dnRouter(cfg-protocols-rsvp)# explicit-path PATH_1
    dnRouter(cfg-protocols-rsvp-expl-path)# index 1 ipv4-address 192.168.3.2 include-strict
    dnRouter(cfg-protocols-rsvp-expl-path)# index 2 ipv4-address 192.168.3.3 include-strict
    dnRouter(cfg-protocols-rsvp-expl-path)# index 3 ipv4-address 192.168.3.4 include-loose
    dnRouter(cfg-protocols-rsvp-expl-path)# index 4 ipv4-address 192.168.3.5 exclude


    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)
    dnRouter(cfg-protocols-rsvp)# explicit-path PATH_2
    dnRouter(cfg-protocols-rsvp-expl-path)# index 1 ipv4-address 12.122.94.57 exclude
    dnRouter(cfg-protocols-rsvp-expl-path)# index 2 ipv4-address 192.168.3.2 include-strict

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)
    dnRouter(cfg-protocols-rsvp)# explicit-path PATH_3
    dnRouter(cfg-protocols-rsvp-expl-path)# index 1 ipv4-address 192.168.3.2
    dnRouter(cfg-protocols-rsvp-expl-path)# index 2 ipv4-address 192.168.3.3


**Removing Configuration**

To remove a path entry from the explicit path:
::

    dnRouter(cfg-protocols-rsvp-expl-path)# no index 2

**Command History**

+---------+----------------------------------------+
| Release | Modification                           |
+=========+========================================+
| 9.0     | Command introduced                     |
+---------+----------------------------------------+
| 10.0    | Added exclude option to command syntax |
+---------+----------------------------------------+

---

### explicit-path/index.rst

protocols rsvp explicit-path index ipv4-address
-----------------------------------------------

**Minimum user role:** operator

You can configure explicit paths with include-loose or include-strict:

- Include-strict: identifies an exact path through which the LSP must be routed. Strict-hop explicit paths specify the exact order of routers through which the RSVP messages are sent.

- Include-loose: identifies one or more transit LSRs through which the LSP must be routed. The network IGP (IS-IS) determines the exact route from the head-end router to the first loose hop, or from one loose hop to the next. The loose hop specifies only that a particular LSR be included in the LSP.

- Exclude: identifies one or more LSRs through which the LSP must not be routed.

If you configure explicit an path with include-loose and include-strict simultaneously, the IGP determines the route between loose hops, while the strict-hop configuration specifies the exact path for specific path segments. To configure the explicit path:

**Command syntax: index [explicit-path-index] ipv4-address [ipv4-address]**

**Command mode:** config

**Hierarchies**

- protocols rsvp explicit-path

**Note**
-  If you do not specify an include-strict, include-loose, or exclude, include-strict will be assumed for the specified IP address.

.. -  user can set loopback address as the ipv4-address, in which case

   -  cspf must be enabled in order to resolve the rechability for the loopback address

   -  having "include-strict" for a loopback address will be treated as a loose constraint with requirement of a single hop reachability. E.g if two consecutive address are loopbacks with include-strict, the path may variant between using different links connecting to two nodes.

.. -  no command removes the path entry

**Parameter table**

+---------------------+----------------+---------+---------+
| Parameter           | Description    | Range   | Default |
+=====================+================+=========+=========+
| explicit-path-index | node index     | 1-32    | \-      |
+---------------------+----------------+---------+---------+
| ipv4-address        | lsr-ip-address | A.B.C.D | \-      |
+---------------------+----------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)
    dnRouter(cfg-protocols-rsvp)# explicit-path PATH_1
    dnRouter(cfg-protocols-rsvp-expl-path)# index 1 ipv4-address 192.168.3.2 include-strict
    dnRouter(cfg-protocols-rsvp-expl-path)# index 2 ipv4-address 192.168.3.3 include-strict
    dnRouter(cfg-protocols-rsvp-expl-path)# index 3 ipv4-address 192.168.3.4 include-loose
    dnRouter(cfg-protocols-rsvp-expl-path)# index 4 ipv4-address 192.168.3.5 exclude


    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)
    dnRouter(cfg-protocols-rsvp)# explicit-path PATH_2
    dnRouter(cfg-protocols-rsvp-expl-path)# index 1 ipv4-address 12.122.94.57 exclude
    dnRouter(cfg-protocols-rsvp-expl-path)# index 2 ipv4-address 192.168.3.2 include-strict

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)
    dnRouter(cfg-protocols-rsvp)# explicit-path PATH_3
    dnRouter(cfg-protocols-rsvp-expl-path)# index 1 ipv4-address 192.168.3.2
    dnRouter(cfg-protocols-rsvp-expl-path)# index 2 ipv4-address 192.168.3.3


**Removing Configuration**

To remove a path entry from the explicit path:
::

    dnRouter(cfg-protocols-rsvp-expl-path)# no index 2

**Command History**

+---------+----------------------------------------+
| Release | Modification                           |
+=========+========================================+
| 9.0     | Command introduced                     |
+---------+----------------------------------------+
| 10.0    | Added exclude option to command syntax |
+---------+----------------------------------------+

---

### interface/interface.rst

protocols rsvp interface
------------------------

**Minimum user role:** operator

RSVP signaling is automatically enabled for every MPLS Traffic Engineering enabled interface. In RSVP interface configuration mode, you can configure interface specific behaviors such as RSVP timer and protection.
When an MPLS-TE interface is configured, it is also automatically configured under the rsvp interface hierarchy. You may change the default configuration per interface within the rsvp interface hierarchy.
To enter RSVP interface configuration mode to support RSVP signaling:

**Command syntax: interface [interface]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. -  whenever a mpls traffic-engineering interface is configured, if it does not exist under "protocols rsvp interfaces" the interface will be automatically configured for "protocols rsvp interface".

- Removing an MPLS-TE interface does not result in the removal of the rsvp interface and vice versa.

.. -  no commands remove the interface from rsvp

**Parameter table**

+-----------+----------------+------------------+---------+
| Parameter | Description    | Range            | Default |
+===========+================+==================+=========+
| interface | interface name | | string         | \-      |
|           |                | | length 1-255   |         |
+-----------+----------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)#


**Removing Configuration**

To remove the interface specific configuration:
::

    dnRouter(cfg-protocols-rsvp)# no interface bundle-1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### interface/protection/auto-bypass.rst

protocols rsvp interface protection auto-bypass
-----------------------------------------------

**Minimum user role:** operator

Auto-bypass allows RSVP to automatically generate bypass-tunnels to protect tunnels passing through this interface. If there is a link failure for the interface, the bypass tunnel can us as an alternate path for the affected LSP passing through the failed interface. The auto-bypass tunnel is established when needed. See "rsvp auto-bypass" on page 2869 for information on the configurable parameters for automatically generated bypass tunnels.

If the primary tunnel requests node protection and there is no existing bypass to provide it, a new auto-bypass tunnel will be formed to provide node protection. If there is already a bypass tunnel that can provide link protection, that bypass will be used until node protection becomes available.
There is no limit to the number of auto-generated bypass tunnels that can provide protection per interface.
Auto-bypass can be enabled together with manual bypass-tunnel configuration.
To enable/disable automatic generation of bypass tunnels:

**Command syntax: auto-bypass [auto-bypass]**

**Command mode:** config

**Hierarchies**

- protocols rsvp interface protection

**Note**
- When disabling auto-bypass for an interface, all auto-generated bypass-tunnels will be removed.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| auto-bypass | enable auto generating bypass-tunnels in order to protect tunnel passing through | | enabled    | disabled |
|             | the interface                                                                    | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)# protection
    dnRouter(cfg-rsvp-if-protection)# auto-bypass enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-rsvp-if-protection)# no auto-bypass

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### interface/protection/bypass-tunnel.rst

protocols rsvp interface protection bypass-tunnel
-------------------------------------------------

**Minimum user role:** operator

Bypass tunnels can be created manually or automatically. If there is a link failure for the interface, the bypass tunnel can us as an alternate path for the affected LSP passing through the failed interface.
You can assign up to 32 manual bypass tunnels per interface. Only tunnels configured with the "bypass" flag can serve as bypass tunnels. A bypass tunnel can be assigned to one RSVP interface only.
To assign a manual bypass tunnel to protects the interface against link failure:

**Command syntax: bypass-tunnel [bypass-tunnel]** [, bypass-tunnel, bypass-tunnel]

**Command mode:** config

**Hierarchies**

- protocols rsvp interface protection

**Note**
- Removing a manual bypass tunnel from an interface will result in closing the bypass tunnel, even if it is currently carrying traffic.

..
	-  a bypass-tunnel can be assigned to one rsvp interface only

	-  removing a manual-bypass-tunnel from an interface will result in closing the bypass-tunnel, even if it currently carries traffic.

	-  'no bypass-tunnel [tunnel-name]' - remove the specified manual-bypass-tunnels

	-  'no bypass-tunnel' - remove all manual-bypass-tunnels that protect the interface

**Parameter table**

+---------------+----------------------------------------+------------------+---------+
| Parameter     | Description                            | Range            | Default |
+===============+========================================+==================+=========+
| bypass-tunnel | manual tunnel protecting the interface | | string         | \-      |
|               |                                        | | length 1-255   |         |
+---------------+----------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)# protection
    dnRouter(cfg-rsvp-if-protection)# bypass-tunnel BACKUP_1
    dnRouter(cfg-rsvp-if-protection)# bypass-tunnel BACKUP_7


    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-2
    dnRouter(cfg-protocols-rsvp-if)# protection
    dnRouter(cfg-rsvp-if-protection)# bypass-tunnel BACKUP_2,BACKUP_3,BACKUP_4,BACKUP_5,BACKUP_6


**Removing Configuration**

To remove a specific manual bypass-tunnel:
::

    dnRouter(cfg-rsvp-if-protection)# no bypass-tunnel BACKUP_2,BACKUP_3

To remove all manual bypass-tunnels from protecting the interface:
::

    dnRouter(cfg-rsvp-if-protection)# no bypass-tunnel

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### interface/protection/protection.rst

protocols rsvp interface protection
-----------------------------------

**Minimum user role:** operator

Fast reroute protection enables to divert a tunnel passing through a failed interface by encapsulating it in a different tunnel carrying the traffic to a merge point behind the network failure.
There are two types of traffic protection for RSVP-signaled LSPs:

- Link protection - where a bypass tunnel encapsulates the traffic through an LSP skipping the potential damaged link and forwards it towards the protected tunnel's next-hop.

- Node protection - where a bypass tunnel encapsulates the traffic through an LSP skipping the potential damaged node and forwards it towards the protected tunnel's next next-hop.

The bypass-tunnel can have any length LSP (limited by the configured hop-limit).

When protection is needed and a bypass tunnel that can provide it (i.e. it has the required destination and matches the required protection type) is available, the bypass tunnel will be used regardless of any conflict with the Primary tunnel's attributes, such as admin-group.
When there are multiple possible bypass-tunnels available for protection, the bypass tunnel that will be used is the least used bypass-tunnel, i.e the tunnel that protects the least number of primary tunnels. 

The bypass tunnel protection type supported is facility-backup. A single bypass-tunnel provides protection to multiple primary tunnels. If several (2 or more) primary tunnels are protected by a single protection Bypass (of the same type) and a new protection bypass (of the same type) is created  the bypasses are reselected for protection of the primary tunnels to ensure equal usage of bypass tunnels among the primary tunnels.
You can configure up to 5 manual bypass-tunnels per interface. There is no limit to the number of auto bypass-tunnels established through an interface.
When checking the scale of tunnels in the system, bypass-tunnels (auto and manual) are regarded as any other tunnel and are counted in the system's total tunnel scale limit.
To enter interface fast-reroute tunnel protection configuration:

**Command syntax: protection**

**Command mode:** config

**Hierarchies**

- protocols rsvp interface

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)# protection
    dnRouter(cfg-rsvp-if-protection)#


**Removing Configuration**

To revert the protection settings to their default value:
::

    dnRouter(cfg-protocols-rsvp-if)# no protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### interface/refresh-reduction/aggregate.rst

protocols rsvp interface refresh-reduction aggregate
----------------------------------------------------

**Minimum user role:** operator

Use the aggregate attribute to bundle standard RSVP messages (i.e.. Path, PathErr, Resv, ResvTear, ResvErr, ResvConf, ACK) into a single RSVP message. Doing so improves message processing overhead.
To enable or disable message aggregation for the interface:

**Command syntax: aggregate [aggregate]**

**Command mode:** config

**Hierarchies**

- protocols rsvp interface refresh-reduction

**Parameter table**

+-----------+-----------------------------------------------+--------------+---------+
| Parameter | Description                                   | Range        | Default |
+===========+===============================================+==============+=========+
| aggregate | Set RSVP message bundling and summary refresh | | enabled    | \-      |
|           |                                               | | disabled   |         |
+-----------+-----------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)# refresh-reduction
    dnRouter(cfg-rsvp-if-rr)# aggregate disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-rsvp-if-rr)# no aggregate

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### interface/refresh-reduction/refresh-reduction.rst

protocols rsvp interface refresh-reduction
------------------------------------------

**Minimum user role:** operator

In RSVP, states are maintained through the generation of RSVP refresh messages. These messages have two usages:

- To synchronize the state between RSVP neighbors

- To recover from lost RSVP messages

The following problems arise from relying on periodic refresh messages:

- Scalability - the periodic transmission and processing overhead of refresh messages for every RSVP session presents a scaling problem that increases as the number of sessions increases.

- Reliability and latency - the time to recover from the loss of RSVP messages is dependent on the refresh interval. A long refresh interval improves the transmission overhead, but at the cost of latency in state synchronization. A short refresh interval improves state synchronization (reliability), but at the cost of increased refresh message rate.

The RSVP refresh reduction option has the following capabilities that address these problems:

- RSVP message bundling - See "rsvp refresh-reduction aggregate".

- RSVP message ID - reduces message processing overhead - See "rsvp refresh-reduction reliable".

- Summary refresh - reduces the amount of information transmitted every refresh interval - enable both refresh-reduction aggregate and refresh-reduction reliable .

You can selectively enable or disable these capabilities on the Network Cloud. The RSVP full tunnel scale can only be reached if refresh-reduction is enabled.
The maximum MTU for a summary message and for an ACK message is the interface's L3 MTU.

Ack hold-time is 1 second.

To configure refresh-reduction on the interface:

**Command syntax: refresh-reduction**

**Command mode:** config

**Hierarchies**

- protocols rsvp interface

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)# refresh-reduction
    dnRouter(cfg-rsvp-if-rr)#


**Removing Configuration**

To revert the refresh-reduction settings to their default value:
::

    dnRouter(cfg-protocols-rsvp-if)# no refresh-reduction

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### interface/refresh-reduction/reliable.rst

protocols rsvp interface refresh-reduction reliable
---------------------------------------------------

**Minimum user role:** operator

Use the reliable attribute to use the message ID and summary refresh for RSVP messages. Doing so reduces the amount of information transmitted every refresh interval.
To enable or disable reliable message delivery for the interface:

**Command syntax: reliable [reliable]**

**Command mode:** config

**Hierarchies**

- protocols rsvp interface refresh-reduction

**Parameter table**

+-----------+-----------------------------------------------+--------------+---------+
| Parameter | Description                                   | Range        | Default |
+===========+===============================================+==============+=========+
| reliable  | Set RSVP message bundling and summary refresh | | enabled    | \-      |
|           |                                               | | disabled   |         |
+-----------+-----------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)# refresh-reduction
    dnRouter(cfg-rsvp-if-rr)# reliable disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-rsvp-if-rr)# no reliable

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### interface/timers/refresh-interval.rst

protocols rsvp interface timers refresh-interval
------------------------------------------------

**Minimum user role:** operator

An established path remains open as long as the RSVP session is active. The session is maintained by the periodic transmission of messages reporting the state of the session. If the system does not receive the state messages for the configured amount of time, it terminates the RSVP session and reroutes the LSP through another active router.
The amount of time that the system waits for a state message before terminating the RSVP session = the configured refresh-interval x the configured refresh multiplier.To configure the refresh-interval for the interface:

Say the refresh-interval is set to 60 seconds and the refresh-multiplier is set to 3. The router will expect a state message every 60 seconds. If after 60 seconds from receiving a state message it does not receive another state message, the refresh-multiplier timer enters to action. The router will allow the loss of a state message only 3 times. If after 180 seconds from receiving the last state message it does not receive another state message (i.e. 60 sec x 3), it will terminate the session.
To change the refresh-interval:

**Command syntax: refresh-interval [refresh-interval]**

**Command mode:** config

**Hierarchies**

- protocols rsvp interface timers

**Note**
-  When configuring a new refresh-interval value, the new interval will take effect on the tunnel after the old refresh-interval window has expired. For example, say the tunnel is running with a refresh-interval value of 30 seconds and after 15 seconds from the interval start you change the value to 10 seconds. In this case, the tunnel will wait 15 more seconds for the interval to expire before change its refresh rate to 10 seconds.

.. -  no command returns refresh-interval to its default value

**Parameter table**

+------------------+------------------------------------------------------------------+---------+---------+
| Parameter        | Description                                                      | Range   | Default |
+==================+==================================================================+=========+=========+
| refresh-interval | refresh time interval for RSVP interface status refresh messages | 1-65535 | \-      |
+------------------+------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)# timers refresh-interval 100


**Removing Configuration**

To revert to the refresh-interval to its default value:
::

    dnRouter(cfg-protocols-rsvp-if)# no timers refresh-interval

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 10.0    | Command introduced in rsvp interface configuration mode |
+---------+---------------------------------------------------------+

---

### interface/timers/refresh-multiplier.rst

protocols rsvp interface timers refresh-multiplier
--------------------------------------------------

**Minimum user role:** operator

The refresh-multiplier determines the number of messages that are allowed to be missed before a specific state is declared stale and the RSVP session is terminated. This command works together with the refresh-interval command. The specific state is declared stale if a state message is not received refresh-interval x refresh-multiplier.
To configure the refresh-multiplier for the interface:

**Command syntax: refresh-multiplier [refresh-multiplier]**

**Command mode:** config

**Hierarchies**

- protocols rsvp interface timers

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| refresh-multiplier | the number of messages that can be lost before a particular state is declared    | 1-255 | \-      |
|                    | stale                                                                            |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# interface bundle-1
    dnRouter(cfg-protocols-rsvp-if)# timers refresh-multiplier 100


**Removing Configuration**

To revert to the refresh-multiplier to its default value:
::

    dnRouter(cfg-protocols-rsvp-if)# no timers refresh-multiplier

**Command History**

+---------+----------------------------------------------------------+
| Release | Modification                                             |
+=========+==========================================================+
| 10.0    | Command introduced in rsvp interface configuration mode  |
+---------+----------------------------------------------------------+

---

### interface/timers/timers.rst

protocols rsvp interface timers
-------------------------------

**Minimum user role:** operator

You can set timers to:

- Terminate the RSVP session if refresh messages are not received (determined by "rsvp timers refresh-interval" and "rsvp timers refresh-multiplier")

- Reset the tunnel when the router is unable to establish a tunnel (determined by "rsvp timers retry")

To configure RSVP timers, enter timers configuration mode:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols rsvp interface

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)#


**Removing Configuration**

To revert all timers to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### ldp-sync.rst

protocols rsvp ldp-sync
-----------------------

**Minimum user role:** operator

Enable ldp sync for all tunnels set with ldp-tunneling. When enabled, rsvp tunnel is excluded to be used for ldp tunneling, by either shortcut of forwarding-adjecency, if targeted LDP peer is missing.

**Command syntax: ldp-sync [ldp-sync]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Parameter table**

+-----------+-----------------------+--------------+----------+
| Parameter | Description           | Range        | Default  |
+===========+=======================+==============+==========+
| ldp-sync  | Set shortcut ldp sync | | enabled    | disabled |
|           |                       | | disabled   |          |
+-----------+-----------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# ldp-sync enabled


**Removing Configuration**

To return the ldp-sync to the default:
::

    dnRouter(cfg-protocols-rsvp)# no ldp-sync

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### make-before-break/holddown-delay.rst

protocols rsvp make-before-break holddown-delay
-----------------------------------------------

**Minimum user role:** operator

You can set a timer for controlling the amount of time following a switchover to a new path in which the old path will be removed. This timer is activated only after the install-delay timer has expired and the tunnel has started forwarding traffic over the new path.
To configure the holddown delay timer:

**Command syntax: holddown-delay [holddown-delay]**

**Command mode:** config

**Hierarchies**

- protocols rsvp make-before-break

**Note**
IPP is set accordingly. i.e DSCP 48 is mapped to 6.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter      | Description                                                                      | Range   | Default |
+================+==================================================================================+=========+=========+
| holddown-delay | delay the time to remove the old paths following a switchover to the optimized   | 0-65535 | 10      |
|                | path                                                                             |         |         |
+----------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# make-before-break
    dnRouter(cfg-protocols-rsvp-mbb)# holddown-delay 10


**Removing Configuration**

To revert to the default holddown-delay:
::

    dnRouter(cfg-protocols-rsvp-mbb)# no holddown-delay

**Command History**

+---------+--------------------------------------------+
| Release | Modification                               |
+=========+============================================+
| 9.0     | Command introduced                         |
+---------+--------------------------------------------+
| 10.0    | Changed default value from 20 to 5 seconds |
+---------+--------------------------------------------+
| 17.1    | Changed default value from 5 to 10 seconds |
+---------+--------------------------------------------+

---

### make-before-break/install-delay.rst

protocols rsvp make-before-break install-delay
----------------------------------------------

**Minimum user role:** operator

After the LSP is up and ready to be installed, you can delay the installation of the new path (LSP) in the FIB. During this time, the system will not switch to the new path.
To delay the path installation in the FIB:

**Command syntax: install-delay [install-delay]**

**Command mode:** config

**Hierarchies**

- protocols rsvp make-before-break

**Parameter table**

+---------------+-------------------------------------------------------------+---------+---------+
| Parameter     | Description                                                 | Range   | Default |
+===============+=============================================================+=========+=========+
| install-delay | set the time to delay the switchover to the new tunnel path | 0-65535 | 5       |
+---------------+-------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# make-before-break
    dnRouter(cfg-protocols-rsvp-mbb)# install-delay 50


**Removing Configuration**

To revert to the default delay interval:
::

    dnRouter(cfg-protocols-rsvp-mbb)# no install-delay

**Command History**

+---------+--------------------------------------------+
| Release | Modification                               |
+=========+============================================+
| 9.0     | Command introduced                         |
+---------+--------------------------------------------+
| 10.0    | Changed default value from 20 to 5 seconds |
+---------+--------------------------------------------+

---

### make-before-break/make-before-break.rst

protocols rsvp make-before-break
--------------------------------

**Minimum user role:** operator

The system operates in make-before-break mode by default. It will never tear down a path before an alternative path is established. When a tunnel is created, the tunnel may perform optimization actions to find a better path. In this case, the old path will remain active until the new path becomes active. You can configure timers to control the time-frames in which the two paths coexist. The following attribute change will cause creating a new LSP in a make-before-break fashion:

- priority

- bandwidth

- exclude-srlg

- admin-group

- path

- igp instance

- cspf-calculation

- explicit-null

To configure the make-before-break timers, enter make-before-break configuration mode:

**Command syntax: make-before-break**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# make-before-break
    dnRouter(cfg-protocols-rsvp-mmb)#


**Removing Configuration**

To revert all make-before-break configuration to the default values:
::

    dnRouter(cfg-protocols-rsvp)# no make-before-break

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### maximum-head-tunnels.rst

protocols rsvp maximum-head-tunnels
-----------------------------------

**Minimum user role:** operator

You can control the size of the RIB by setting thresholds to generate system event notifications. When a threshold is crossed, a system-event notification is generated allowing you to take action, if necessary. To set thresholds on RSVP-TE head tunnels:

**Command syntax: maximum-head-tunnels [maximum]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. -  there is no limitation for how many rsvp head tunnels user can configure, or how many rsvp head tunnel can be created

- The thresholds are for generating system-events only. They do not affect in any way the number of installed tunnels.

- The thresholds apply to all tunnel types (primary, bypass, auto-bypass, auto-mesh).

**Parameter table**

+-----------+----------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                | Range   | Default |
+===========+============================================================================+=========+=========+
| maximum   | maximum rsvp-te head tunnel limit, exceeding the limit will invoke warning | 1-29999 | 500     |
+-----------+----------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# maximum-head-tunnels 150


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-protocols-rsvp)# no maximum-head-tunnels

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 11.2    | Command introduced                |
+---------+-----------------------------------+
| 15.0    | Updated max-tunnels default value |
+---------+-----------------------------------+

---

### maximum-tunnels.rst

protocols rsvp maximum-tunnels threshold
----------------------------------------

**Minimum user role:** operator

You can control the size of the RIB by setting thresholds to generate system event notifications. When a threshold is crossed, a system-event notification is generated allowing you to take action, if necessary. To set thresholds on RSVP-TE tunnels:

In the above example, the maximum number of RSVP-TE tunnels in the RIB is set to 6,000 and the threshold is set to 70%. This means that when the number of tunnels in the RIB reaches 4,200, a system-event notification will be generated that the 70% threshold has been crossed. If you do nothing, you will not receive another notification until the number of routes reaches 6,000.

**Command syntax: maximum-tunnels [maximum] threshold [threshold]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- The thresholds are for generating system-events only. They do not affect in any way the number of installed tunnels.

- The thresholds apply to all tunnel types (primary, bypass, auto-bypass, auto-mesh) and for all tunnel roles (head, transit, tail) combined.

- When the number of tunnels drops below a threshold, a system-event notification is generated.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| maximum   | maximum rsvp-te tunnel limit, exceeding the limit will invoke a periodic warning | 1-29999 | 7000    |
+-----------+----------------------------------------------------------------------------------+---------+---------+
| threshold | maximum rsvp-te tunnel threshold, exceeding the threshold will invoke a warning  | 1-100   | 75      |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# maximum-tunnels 6000 threshold 70


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-protocols-rsvp)# no maximum-tunnels

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 11.0    | Command introduced                |
+---------+-----------------------------------+
| 15.0    | Updated max-tunnels default value |
+---------+-----------------------------------+

---

### optimization/admin-state.rst

protocols rsvp optimization admin-state
---------------------------------------

**Minimum user role:** operator

You can enable or disable tunnel optimization globally for all tunnel types, or per tunnel. To enable/disable tunnel optimization per tunnel, see "rsvp tunnel optimization".
To enable/disable tunnel optimization globally:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp optimization

**Note**
- Disabling the optimization while optimization is running will stop all running optimization attempts.

.. -  'no admin-state' - return admin-state to default value

**Parameter table**

+-------------+-------------------------------+--------------+----------+
| Parameter   | Description                   | Range        | Default  |
+=============+===============================+==============+==========+
| admin-state | rsvp optimization admin state | | enabled    | disabled |
|             |                               | | disabled   |          |
+-------------+-------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### optimization/interval.rst

protocols rsvp optimization interval
------------------------------------

**Minimum user role:** operator

Tunnel optimization runs at fixed intervals (by default every 60 minutes). You may want to change the frequency to more frequent for a better optimized network, or less frequent to save on system resources. To change the optimization frequency:

Say the interval was set to 60 minutes and there are 35 minutes left till the next run when you changed the interval to 100 minutes. The timer will reset to 0 and the next optimization will run after 100 minutes. In this example, the interval between the two periodic runs is 125 minutes because of the timer configuration change.

**Command syntax: interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols rsvp optimization

**Note**
- While you can enable optimization per tunnel, the interval is configured globally for all tunnels.

.. -  reconfiguring optimize-timer while timer is running, will reset optimize-timer to new interval value. if optimization was underway, stop current optimization process (even if optimization is due to interface up or user clear triggers).

.. -  Interval 0 will disable periodic optimization.

.. -  'no interval' - return interval to its default value

**Parameter table**

+-----------+------------------------------------------------------+---------+---------+
| Parameter | Description                                          | Range   | Default |
+===========+======================================================+=========+=========+
| interval  | sets how often to run optimization CSPF calculations | 0-65535 | 60      |
+-----------+------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# interval 30
    dnRouter(cfg-protocols-rsvp-optimization)# interval 0


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### optimization/optimization.rst

protocols rsvp optimization
---------------------------

**Minimum user role:** operator

LSPs may become suboptimal in time as topology changes occur or the availability of network resources changes. During this time, new paths that are less congested, with lower metrics, or with fewer hops may become available. An LSP with a fixed path cannot take advantage of new network resources. The LSP will remain fixed until a recalculation triggering change in the topology occurs. By enabling optimization, you can force the router to periodically recalculate paths for available tunnels and, if more optimal paths are found, make new decisions to reroute suboptimal LSPs through other paths. Optimization runs at fixed intervals or whenever an RSVP enabled interface becomes available.
Optimization is applicable to all tunnel types. Tunnels are optimized sequentially, from the lowest priority and highest bandwidth to highest priority and lowest bandwidth. The optimization is aggressive: the tunnel will be optimized only if a new path has a better metric to the destination.
If optimization fails, no additional optimization is attempted until the next scheduled optimization cycle or until a manual clear rsvp tunnels optimize is performed (see "clear rsvp tunnels").

To configure the optimization options, enter the global RSVP optimization configuration mode:

**Command syntax: optimization**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. -  disabling optimization while optimization is in process will stop current optimization attempts

.. -  reconfiguring optimize-timer while timer is running, will reset optimize-timer to new interval value. if optimization was underway, stop current optimization process (even if optimization is due to interface up or user clear triggers).

.. -  'no optimization'- returns all optimization configuration to their default value.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)


**Removing Configuration**

To revert all optimization configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no optimization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### optimization/queue-delay.rst

protocols rsvp optimization queue-delay
---------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: queue-delay [queue-delay]**

**Command mode:** config

**Hierarchies**

- protocols rsvp optimization

**Note**
-  You may set a new queue-delay while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no queue-delay - return delay to its default value

**Parameter table**

+-------------+--------------------------------------------------------+-------+---------+
| Parameter   | Description                                            | Range | Default |
+=============+========================================================+=======+=========+
| queue-delay | sets delay between consecutive tunnels being optimized | 0-59  | 3       |
+-------------+--------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# queue-delay 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no queue-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### path-selection.rst

protocols rsvp path-selection
-----------------------------

**Minimum user role:** operator

This command sets the type of metric cspf should consider when finding an LSP path. The metric types are:

	te-metric - The interface traffic-engineering metric, signaled as part of the traffic-engineering information by the igp protocol

	igp-metric - The interface igp-metric.

To configure the metric-type:

**Command syntax: path-selection [path-selection]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Parameter table**

+----------------+-------------------------------------------------------------+----------------+-----------+
| Parameter      | Description                                                 | Range          | Default   |
+================+=============================================================+================+===========+
| path-selection | Set which metric should cspf consider whan finding lsp path | | te-metric    | te-metric |
|                |                                                             | | igp-metric   |           |
+----------------+-------------------------------------------------------------+----------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# path-selection igp-metric


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp)# no path-selection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### pcep_delegation.rst

protocols rsvp pcep delegation
------------------------------

**Minimum user role:** operator

PCEP delegation enables to configure the use of PCEP to delegate tunnel settings to a remote PCE. See additional information on PCE and PCEP in "mpls traffic-engineering pcep.
When a new LSP is established for a tunnel, the path computation client (PCC) revokes the PCE's explicit route object (ERO) constraint. This may result in a new path with a different ERO for the tunnel. To prevent this behavior, use the sticky-ero attribute. With sticky-ero enabled, the following behavior is observed:

- The path computation client (PCC) keeps the last successfully established ERO received from the PCE for new established LSPs for the tunnel. All other LSP parameters (e.g. bandwidth, admin-groups, etc.) remain unchanged.

- When the user applies a new path configuration (ERO) to the tunnel, the tunnel will continue using the ERO provided by the PCE. The new path will be used when the tunnel is no longer delegated or RSVP has restarted.

To configure PCEP delegation globally:

**Command syntax: pcep delegation [admin-state]** sticky-ero [sticky-ero]

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. -  'delegation disable' - disable delegation. sticky-ero-admin-state configuration remain unchanged

.. -  'no pcep delegation [delegation-admin-state] sticky-ero', 'no pcep delegation [delegation-admin-state] sticky-ero [sticky-ero-admin-state]' - return sticky-ero-admin-state to default settings

.. -  'no pcep delegation', 'no pcep delegation [delegation-admin-state]' - return both delegation-admin-state and sticky-ero-admin-state to default values

- When PCEP delegation is enabled, you still have control over tunnel configuration.

**Parameter table**

+-------------+-------------------------+--------------+----------+
| Parameter   | Description             | Range        | Default  |
+=============+=========================+==============+==========+
| admin-state | default delegation mode | | enabled    | disabled |
|             |                         | | disabled   |          |
+-------------+-------------------------+--------------+----------+
| sticky-ero  | default delegation mode | | enabled    | enabled  |
|             |                         | | disabled   |          |
+-------------+-------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled sticky-ero enabled


**Removing Configuration**

To revert to the default sticky-ero state:
::

    dnRouter(cfg-protocols-rsvp)# no pcep delegation enabled sticky-ero

To revert to the default delegation state and sticky-ero-admin-state:
::

    dnRouter(cfg-protocols-rsvp)# no pcep delegation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### preemption_hard.rst

protocols rsvp preemption hard
------------------------------

**Minimum user role:** operator

When bandwidth is insufficient to handle all RSVP tunnels (for example when a new tunnel with bandwidth reservation needs to be installed, or one of the members of a bundle interface fails), you can control the preemption of one or more existing RSVP bandwidth reservations to accommodate a higher priority reservation. The preemption will occur in make-before-break fashion, such that the lower priority tunnel is maintained until the alternative higher priority tunnel is successfully established.
You can choose between two preemption types:

- Hard: the device tears down a preempted LSP first, signals a new path, and then reestablishes the LSP over the new path. In the interval between the time that the LSP is taken down and the new LSP is established, any traffic attempting to use the LSP is lost.

- Soft: the device first attempts to find a new path for the preempted LSP before tearing down the old path to prevent traffic loss. During soft preemption, the two LSPs with their corresponding bandwidth requirements are used until the original path is torn down. 

When enabled, tunnel changes will be applied only if the new tunnel is created successfully. When preemption is required, the least number of tunnels will be preempted in order to satisfy the new bandwidth requirement.

To configure preemption:

**Command syntax: preemption hard**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. -timeout - can only be set for type 'soft'

.. -'no preemption soft timeout' - return timeout to default value

.. -'no preemption' - return to default preemption settings (soft) with default timeout value

- Preemption affects transit routers.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# preemption soft timeout 40

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# preemption hard


**Removing Configuration**

To revert to the default timeout value:
::

    dnRouter(cfg-protocols-rsvp-mmb)# no preemption soft timeout

To revert to the default preemption type (and reverts the timeout to default):
::

    dnRouter(cfg-protocols-rsvp-mmb)# no preemption

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### preemption_soft.rst

protocols rsvp preemption soft
------------------------------

**Minimum user role:** operator

When bandwidth is insufficient to handle all RSVP tunnels (for example when a new tunnel with bandwidth reservation needs to be installed, or one of the members of a bundle interface fails), you can control the preemption of one or more existing RSVP bandwidth reservations to accommodate a higher priority reservation. The preemption will occur in make-before-break fashion, such that the lower priority tunnel is maintained until the alternative higher priority tunnel is successfully established.
You can choose between two preemption types:

- Hard: the device tears down a preempted LSP first, signals a new path, and then reestablishes the LSP over the new path. In the interval between the time that the LSP is taken down and the new LSP is established, any traffic attempting to use the LSP is lost.

- Soft: the device first attempts to find a new path for the preempted LSP before tearing down the old path to prevent traffic loss. During soft preemption, the two LSPs with their corresponding bandwidth requirements are used until the original path is torn down. 

When enabled, tunnel changes will be applied only if the new tunnel is created successfully. When preemption is required, the least number of tunnels will be preempted in order to satisfy the new bandwidth requirement.

To configure preemption:

**Command syntax: preemption soft** timeout [timeout]

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. -timeout - can only be set for type 'soft'

.. -'no preemption soft timeout' - return timeout to default value

.. -'no preemption' - return to default preemption settings (soft) with default timeout value

- Preemption affects transit routers.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------+---------+
| Parameter | Description                                                                      | Range  | Default |
+===========+==================================================================================+========+=========+
| timeout   | maximum time for trying to establish alternate tunnel before primary tunnel is   | 30-300 | 30      |
|           | preempted                                                                        |        |         |
+-----------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# preemption soft timeout 40

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# preemption hard


**Removing Configuration**

To revert to the default timeout value:
::

    dnRouter(cfg-protocols-rsvp-mmb)# no preemption soft timeout

To revert to the default preemption type (and reverts the timeout to default):
::

    dnRouter(cfg-protocols-rsvp-mmb)# no preemption

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### priority.rst

protocols rsvp priority setup hold
----------------------------------

**Minimum user role:** operator

Preemption of an existing LSP is used when there is insufficient bandwidth. Priority determines whether an LSP can be preempted or can preempt another LSP using the following properties:

- Setup priority - determines which tunnels can be preempted. For preemption to occur, the setup priority of the new tunnel must be higher than the setup priority of the existing tunnel.

- Hold priority - determines which LSP should be preempted by other LSPs. A high hold priority means that the LSP is less likely to be preempted (that is, it is less likely to give up its reservation).

To prevent preemption loops (i.e. when two LSPs are allowed to preempt each other), the hold priority must be greater than or equal to the setup priority.
By default, an LSP has a setup priority of 7 (meaning it cannot preempt any other LSP) and a hold priority of 0 (meaning it cannot be preempted by other LSPs), so that preemption does not happen.
To globally configure the tunnels' reservation priority:

**Command syntax: priority setup [setup] hold [hold]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- Hold-priority must be  setup priority to prevent preemption loops.

.. -  must comply [hold-priority] <= [setup-priority]

.. -  no command returns to default priority settings.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| setup     | priority used when signaling an LSP for this tunnel to determine which existing  | 0-7   | 7       |
|           | tunnels can be preempted                                                         |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+
| hold      | priority associated with an LSP for this tunnel to determine if it should be     | 0-7   | 0       |
|           | preempted by other LSPs that are being signaled                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# priority setup 3 hold 3


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-protocols-rsvp)# no priority

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### protection.rst

protocols rsvp protection
-------------------------

**Minimum user role:** operator

Fast reroute protection enables to divert a tunnel passing through a failed interface by encapsulating it in a different tunnel carrying the traffic to a merge point behind the network failure.
There are two types of traffic protection for RSVP-signaled LSPs:

- Link protection - where a bypass tunnel encapsulates the traffic through an LSP skipping the potential damaged link and forwards it towards the protected tunnel's next-hop.

- Node protection - where a bypass tunnel encapsulates the traffic through an LSP skipping the potential damaged node and forwards it towards the protected tunnel's next next-hop.

The bypass-tunnel can have any length LSP (limited by the configured hop-limit).

When protection is needed and a bypass tunnel that can provide it (i.e. it has the required destination and matches the required protection type) is available, the bypass tunnel will be used regardless of any conflict with the Primary tunnel's attributes, such as admin-group.
When there are multiple possible bypass-tunnels available for protection, the bypass tunnel that will be used is the least used bypass-tunnel, i.e the tunnel that protects the least number of primary tunnels. 

The bypass tunnel protection type supported is facility-backup. A single bypass-tunnel provides protection to multiple primary tunnels. If several (2 or more) primary tunnels are protected by a single protection Bypass (of the same type) and a new protection bypass (of the same type) is created  the bypasses are reselected for protection of the primary tunnels to ensure equal usage of bypass tunnels among the primary tunnels.
You can configure up to 5 manual bypass-tunnels per interface. There is no limit to the number of auto bypass-tunnels established through an interface.
When checking the scale of tunnels in the system, bypass-tunnels (auto and manual) are regarded as any other tunnel and are counted in the system's total tunnel scale limit.

When enabled, all the nodes are informed that the LSP is protected against link and/or node failure. Bypass tunnels that match the protection request are set as protection tunnels. If there are no eligible bypass tunnels and auto-bypass is enabled, an auto-bypass tunnel will be created.

To globally enable/disable fast-reroute tunnel protection:

**Command syntax: protection [protection]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Parameter table**

+------------+----------------------------------------------------+---------------------+----------+
| Parameter  | Description                                        | Range               | Default  |
+============+====================================================+=====================+==========+
| protection | global configuration for tunnel protection setting | | disabled          | disabled |
|            |                                                    | | link-protection   |          |
|            |                                                    | | node-protection   |          |
+------------+----------------------------------------------------+---------------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# protection link-protection

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# protection node-protection

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# protection disabled


**Removing Configuration**

To revert protection to the default state:
::

    dnRouter(cfg-protocols-rsvp)# no protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### refresh-reduction/aggregate.rst

protocols rsvp refresh-reduction aggregate
------------------------------------------

**Minimum user role:** operator

Use the aggregate attribute to bundle standard RSVP messages (i.e.. Path, PathErr, Resv, ResvTear, ResvErr, ResvConf, ACK) into a single RSVP message. Doing so improves message processing overhead.
To enable or disable message aggregation:

**Command syntax: aggregate [aggregate]**

**Command mode:** config

**Hierarchies**

- protocols rsvp refresh-reduction

**Parameter table**

+-----------+-----------------------------------------------+--------------+---------+
| Parameter | Description                                   | Range        | Default |
+===========+===============================================+==============+=========+
| aggregate | Set RSVP message bundling and summary refresh | | enabled    | enabled |
|           |                                               | | disabled   |         |
+-----------+-----------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# refresh-reduction
    dnRouter(cfg-protocols-rsvp-rr)# aggregate disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-rr)# no aggregate

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### refresh-reduction/refresh-reduction.rst

protocols rsvp refresh-reduction
--------------------------------

**Minimum user role:** operator

In RSVP, states are maintained through the generation of RSVP refresh messages. These messages have two usages:

- To synchronize the state between RSVP neighbors

- To recover from lost RSVP messages

The following problems arise from relying on periodic refresh messages:

- Scalability - the periodic transmission and processing overhead of refresh messages for every RSVP session presents a scaling problem that increases as the number of sessions increases.

- Reliability and latency - the time to recover from the loss of RSVP messages is dependent on the refresh interval. A long refresh interval improves the transmission overhead, but at the cost of latency in state synchronization. A short refresh interval improves state synchronization (reliability), but at the cost of increased refresh message rate.

The RSVP refresh reduction option has the following capabilities that address these problems:

- RSVP message bundling - See "rsvp refresh-reduction aggregate".

- RSVP message ID - reduces message processing overhead - See "rsvp refresh-reduction reliable".

- Summary refresh - reduces the amount of information transmitted every refresh interval - enable both refresh-reduction aggregate and refresh-reduction reliable.

You can selectively enable or disable these capabilities on the Network Cloud. The RSVP full tunnel scale can only be reached if refresh-reduction is enabled.
The maximum MTU for a summary message and for an ACK message is the interface's L3 MTU.
Ack hold-time is 1 second.

To configure refresh-reduction:

1.	Enter RSVP refresh-reduction configuration mode:

2.	Proceed to configure the refresh-reduction options: "rsvp refresh-reduction aggregate" and "rsvp refresh-reduction reliable".

**Command syntax: refresh-reduction**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. - RSVP full tunnel scale can only be reached if refresh-reduction is enabled

.. - no command returns refresh-reduction settings to their default value

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# refresh-reduction
    dnRouter(cfg-protocols-rsvp-rr)#


**Removing Configuration**

To revert the refresh-reduction settings to their default value:
::

    dnRouter(cfg-protocols-rsvp)# no refresh-reduction

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### refresh-reduction/reliable.rst

protocols rsvp refresh-reduction reliable
-----------------------------------------

**Minimum user role:** operator

Use the reliable attribute to use the message ID and summary refresh for RSVP messages. Doing so reduces the amount of information transmitted every refresh interval.
To enable or disable reliable message delivery:

**Command syntax: reliable [reliable]**

**Command mode:** config

**Hierarchies**

- protocols rsvp refresh-reduction

**Parameter table**

+-----------+-----------------------------------------------+--------------+---------+
| Parameter | Description                                   | Range        | Default |
+===========+===============================================+==============+=========+
| reliable  | Set RSVP message bundling and summary refresh | | enabled    | enabled |
|           |                                               | | disabled   |         |
+-----------+-----------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# refresh-reduction
    dnRouter(cfg-protocols-rsvp-rr)# reliable disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-rr)# no reliable

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### rib-unicast-install.rst

protocols rsvp rib-unicast-install
----------------------------------

**Minimum user role:** operator

With the rib-unicast-install command, you can install RSVP tunnel destinations in the RIB IPv4-unicast table as directly reachable through the tunnel.
To enable/disable the ability to install the tunnel destinations in the RIB:

**Command syntax: rib-unicast-install [rib-unicast-install]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- This configuration is applicable to all primary tunnel types (regular and auto-mesh), except bypass tunnels.

.. - RSVP administrative-distance is 100 by default

.. - 'no rib-unicast-install'- return rib-unicast-install to default state

**Parameter table**

+---------------------+-----------------------------------------------------------------------------+--------------+----------+
| Parameter           | Description                                                                 | Range        | Default  |
+=====================+=============================================================================+==============+==========+
| rib-unicast-install | state if tunnel destination will be installed in the rib ipv4-unicast table | | enabled    | disabled |
|                     |                                                                             | | disabled   |          |
+---------------------+-----------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# rib-unicast-install disabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# rib-unicast-install enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install disabled


**Removing Configuration**

To return the rib-unicast-install to the default:
::

    dnRouter(cfg-protocols-rsvp)# no rib-unicast-install

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### rsvp.rst

protocols rsvp
--------------

**Minimum user role:** operator

Enters the RSVP configuration hierarchy level.

**Command syntax: rsvp**

**Command mode:** config

**Hierarchies**

- protocols

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)#


**Removing Configuration**

To remove all RSVP configuration:
::

    dnRouter(cfg-protocols)# no rsvp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### source-address.rst

protocols rsvp source-address
-----------------------------

**Minimum user role:** operator

To configure the RSVP IP source address to be used in tunnel signaling:

**Command syntax: source-address [source-address]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Parameter table**

+----------------+------------------------------------------------------+---------+---------+
| Parameter      | Description                                          | Range   | Default |
+================+======================================================+=========+=========+
| source-address | rsvp ip source address to be use in tunnel signaling | A.B.C.D | \-      |
+----------------+------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# source-address 10.10.10.10


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp)# no source-address

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### timers/lsp-establishment.rst

protocols rsvp timers lsp-establishment resv
--------------------------------------------

**Minimum user role:** operator

You can define how long a tunnel head will wait when a new LSP is signaled, before declaring signaling failure and continuing to establish a new LSP.
To configure the LSP establishment timer:

**Command syntax: lsp-establishment resv [resv-timeout]**

**Command mode:** config

**Hierarchies**

- protocols rsvp timers

**Parameter table**

+--------------+-----------------------------------------------+---------+---------+
| Parameter    | Description                                   | Range   | Default |
+==============+===============================================+=========+=========+
| resv-timeout | define the resv timeout for lsp establishment | 1-65535 | 135     |
+--------------+-----------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)# lsp-establishment resv 15


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp-timers)# lsp-establishment resv

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### timers/protection-distribution.rst

protocols rsvp timers protection-distribution
---------------------------------------------

**Minimum user role:** operator

Sets the periodic protection-distribution timer. With protection-distribution, bypass tunnels that are protecting the same interface and the same destination will need to balance which primary lsps they protect, in order to balance the aggregated protected-bw between bypasses,
When set to 0, no protection-distribution is performed.
To configure the protection distribution:

**Command syntax: protection-distribution [protection-distribution]**

**Command mode:** config

**Hierarchies**

- protocols rsvp timers

**Note**
- If the interval is reconfigured while the timer is running, the timer will be reset to the new interval value. if balancing is underway, current balancing process should be stopped.

.. -  Interval 0 will disable periodic optimization.

**Parameter table**

+-------------------------+------------------------------------------------+----------+---------+
| Parameter               | Description                                    | Range    | Default |
+=========================+================================================+==========+=========+
| protection-distribution | Set the periodic protection-distribution timer | 0, 5-180 | 0       |
+-------------------------+------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)# protection-distribution 10


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp-timers)# no protection-distribution

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 13.2    | Command introduced |
+---------+--------------------+

---

### timers/refresh-interval.rst

protocols rsvp timers refresh-interval
--------------------------------------

**Minimum user role:** operator

An established path remains open as long as the RSVP session is active. The session is maintained by the periodic transmission of messages reporting the state of the session. If the system does not receive the state messages for the configured amount of time, it terminates the RSVP session and reroutes the LSP through another active router.

The amount of time that the system waits for a state message before terminating the RSVP session = the configured refresh-interval x the configured refresh multiplier (see "rsvp timers refresh-multiplier")

When configuring a new refresh-interval value, the new interval will take effect on the tunnel after the old refresh-interval window has expired. For example, say the tunnel is running with a refresh-interval value of 30 seconds and after 15 seconds from the interval start you change the value to 10 seconds. In this case, the tunnel will wait 15 more seconds for the interval to expire before change its refresh rate to 10 seconds.

To configure the refresh-interval:

**Command syntax: refresh-interval [refresh-interval]**

**Command mode:** config

**Hierarchies**

- protocols rsvp timers

**Note**
- If the interval is reconfigured while the timer is running, the timer will be reset to the new interval value. if balancing is underway, current balancing process should be stopped.

..  -  when setting a new refresh-interval value, the new interval will take effect on the tunnel once the old refresh-interval window has expired. e.g if tunnel is running with refresh-interval of 30seconds and while there are 15 seconds left to next refresh, user configured an interval of 10seconds. only after the 15 seconds window will expire, will the tunnel change its refresh rate to every 10 seconds

**Parameter table**

+------------------+----------------------------------------------------------------------+---------+---------+
| Parameter        | Description                                                          | Range   | Default |
+==================+======================================================================+=========+=========+
| refresh-interval | set refresh time interval for RSVP interface status refresh messages | 1-65535 | 45      |
+------------------+----------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)# refresh-interval 100


**Removing Configuration**

To revert to the refresh-interval to its default value:
::

    dnRouter(cfg-protocols-rsvp-timers)# no refresh-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### timers/refresh-multiplier.rst

protocols rsvp timers refresh-multiplier
----------------------------------------

**Minimum user role:** operator

The refresh-multiplier determines the number of messages that are allowed to be missed before a specific state is declared stale and the RSVP session is terminated. This command works together with the refresh-interval command (see  "rsvp timers refresh-interval".

The specific state is declared stale if a state message is not received refresh-interval x refresh-multiplier.

To configure the refresh-multiplier:

**Command syntax: refresh-multiplier [refresh-multiplier]**

**Command mode:** config

**Hierarchies**

- protocols rsvp timers

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| refresh-multiplier | set the number of messages that can be lost before a particular state is         | 1-255 | 3       |
|                    | declared                                                                         |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)# refresh-multiplier 100


**Removing Configuration**

To revert to the refresh-multiplier to its default value:
::

    dnRouter(cfg-protocols-rsvp-timers)# no refresh-multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### timers/remove-unused-bypass.rst

protocols rsvp timers remove-unused-bypass
------------------------------------------

**Minimum user role:** operator

You can configure the amount of time that an auto-generated bypass tunnel (i.e. protection tunnel) is kept after there are no more subscriptions for it. That is, no primary tunnels are requiring its protection.

To configure the remove-unused-bypass timer:

**Command syntax: remove-unused-bypass [remove-unused-bypass]**

**Command mode:** config

**Hierarchies**

- protocols rsvp timers

**Note**
IPP is set accordingly. i.e DSCP 48 is mapped to 6.

**Parameter table**

+----------------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter            | Description                                                                      | Range   | Default |
+======================+==================================================================================+=========+=========+
| remove-unused-bypass | the amount of time an auto-generated bypass tunnel (protection tunnel) is kept   | 0-10080 | 1       |
|                      | after there are no more 'subscriptions' for it                                   |         |         |
+----------------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)# remove-unused-bypass 5


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp-timers)# no remove-unused-bypass

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 10.0    | Command introduced                                 |
+---------+----------------------------------------------------+
| 11.0    | Range and default changed from seconds to minutes. |
+---------+----------------------------------------------------+

---

### timers/retry.rst

protocols rsvp timers retry
---------------------------

**Minimum user role:** operator

Once path is set, the device will attempt to establish an LSP tunnel. If it fails to establish the LSP tunnel (for example if there is no CSPF solution or the path signaling fails), the system will try again after the interval timer expires. It will continue retrying a number of times set by the limit parameter and then it will stop. When this happens, you must manually clear the tunnels (see "clear rsvp tunnels") or apply a configuration change to the tunnel. The system will attempt to establish a new LSP tunnel.

If there are multiple path-options, "retry interval" and "limit" refer to the full set of path-options. If a path option fails, the following path option is immediately processed. If all path options fail, the retry interval timer starts and attempts counter advances. The next retry starts from the first path-option. When the attempts counter reaches the limit system will seize to establish the tunnel.

To configure the timer:

**Command syntax: retry {interval [interval], limit [limit]}**

**Command mode:** config

**Hierarchies**

- protocols rsvp timers

**Note**
-  0 means that there is no limit. The system will attempt to establish an LSP tunnel until it is successful.

-  At least one parameter is mandatory (either interval or limit)

.. -  no retry interval - return interval to default value

.. -  no retry limit - return limit to default value

.. -  no retry interval limit - return both interval and limit to default value

.. -  no retry - return both interval and limit to default value

**Parameter table**

+-----------+-------------+-------+---------+
| Parameter | Description | Range | Default |
+===========+=============+=======+=========+
| interval  | interval    | 1-600 | 45      |
+-----------+-------------+-------+---------+
| limit     | limit       | 0-650 | 0       |
+-----------+-------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)# retry interval 60

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)# retry-interval 30 limit 20


**Removing Configuration**

To revert to the default interval value:
::

    dnRouter(cfg-protocols-rsvp-timers)# no retry interval

To revert to the default limit value:
::

    dnRouter(cfg-protocols-rsvp-timers)# no retry limit

To revert both parameters to their default value:
::

    dnRouter(cfg-protocols-rsvp-timers)# no retry

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### timers/timers.rst

protocols rsvp timers
---------------------

**Minimum user role:** operator

You can set timers to:

- Terminate the RSVP session if refresh messages are not received (determined by "rsvp timers refresh-interval" and "rsvp timers refresh-multiplier")

- Reset the tunnel when the router is unable to establish a tunnel (determined by "rsvp timers retry")

To configure RSVP timers, enter timers configuration mode:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# timers
    dnRouter(cfg-protocols-rsvp-timers)#


**Removing Configuration**

To revert all timers to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/admin-state.rst

protocols rsvp tunnel bypass admin-state
----------------------------------------

**Minimum user role:** operator

To enable/disable a tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass
- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Parameter table**

+-------------+------------------+--------------+---------+
| Parameter   | Description      | Range        | Default |
+=============+==================+==============+=========+
| admin-state | Set tunnel state | | enabled    | enabled |
|             |                  | | disabled   |         |
+-------------+------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# admin-state disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# admin-state disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/bfd/admin-state.rst

protocols rsvp tunnel bypass bfd admin-state
--------------------------------------------

**Minimum user role:** operator

Enables a BFD over MPLS session for tunnel LSP protection.

To enable/disable a tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

.. -  no command returns admin-state to default value

.. -  configuring bfd parameter will trigger LSP make-before-break to comply with new BFD state

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/bfd/bfd.rst

protocols rsvp tunnel bypass bfd
--------------------------------

**Minimum user role:** operator

An RSVP tunnel is a label-switched path (LSP) that can carry inside other RSVP LSPs in order to provide network end-to-end traffic engineering. Each tunnel LSP can have a unique BFD session. 

BFD is supported for all tunnel types (primary, manual bypass, auto bypass and auto mesh).

To establish the BFD session, LSP-Ping is used to sync the peers on session BFD discriminators.
Before activating an LSP, verify the data path by establishing BFD session over LSP and ensure that tunnel can carry data traffic. Only after the BFD session is up the LSP will be used for forwarding.

Install delay: before installing the new LSP as the active tunnel path in the data path, wait for "rsvp make-before-break install-delay" time to verify that LSP is stable as BFD session remain UP for install-delay time. 

After the time period, if the BFD is still up, install the tunnel in the data path.

Upon BFD failure:

- At head LER - Remove LSP, invoke Break Before Make and remove LSP from data path.
- At tail LER - Only Respond with BFD down
- BFD for RSVP isn't a trigger for bypass protection

In the case that RSVP FRR is enabled, BFD timers should be configured to at least 3 x 300 ms so that FRR mechanism can operate as expected and provide fast switchover to a bypass tunnel. it applies to any router acting as PLR, including the case where the head is the PLR of the tunnel.

BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations. Detection-time = negotiated-received-interval X received multiplier.

This is the maximum amount of time that can elapse without receipt of a BFD control packet before the session is declared down.

BFD neighbor can signal session state down, and upon receipt, local BFD session will immediately switch to DOWN state.

To enter BFD configuration level:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass
- protocols rsvp auto-bypass
- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
.. -  BFD is supported for all tunnel types (primary, manual bypass, auto bypass, auto-mesh)

.. -  no command returns all bfd configuration to their default settings

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)#


**Removing Configuration**

To revert all bfd configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/bfd/min-tx.rst

protocols rsvp tunnel bypass bfd min-tx
---------------------------------------

**Minimum user role:** operator

To set minimum transmit interval for BFD session:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

- Due to hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+---------+---------+
| Parameter | Description                                           | Range   | Default |
+===========+=======================================================+=========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 50-1700 | 300     |
+-----------+-------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# min-tx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# min-tx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# min-tx 350


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no min-tx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/bfd/multiplier.rst

protocols rsvp tunnel bypass bfd multiplier
-------------------------------------------

**Minimum user role:** operator

The multiplier defines the number of min-rx intervals in which a BFD packet is not received before the session goes down. Using the example below, if min-rx is configured to 100 msec and the multiplier is 4, this means that if BFD packets stop arriving the session will go down after 400 msec.

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# multiplier 4

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# multiplier 4

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# multiplier 4


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/description.rst

protocols rsvp tunnel bypass description
----------------------------------------

**Minimum user role:** operator

To enter a description for the tunnel or bypass tunnel:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass
- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Parameter table**

+-------------+----------------------------+------------------+---------+
| Parameter   | Description                | Range            | Default |
+=============+============================+==================+=========+
| description | description for the tunnel | | string         | \-      |
|             |                            | | length 1-255   |         |
+-------------+----------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# description MyDescription

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# description MyDescription


**Removing Configuration**

To remove the tunnel's description:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no description

**Command History**

+---------+----------------------------------------+
| Release | Modification                           |
+=========+========================================+
| 9.0     | Command introduced                     |
+---------+----------------------------------------+
| 10.0    | Added support for manual bypass tunnel |
+---------+----------------------------------------+

---

### tunnel-bypass/destination-address.rst

protocols rsvp tunnel bypass destination-address
------------------------------------------------

**Minimum user role:** operator

A tunnel's destination-address is the tunnel's tail-end router's address.
To configure the tunnel's destination-address for a tunnel or bypass-tunnel:

**Command syntax: destination-address [destination-address]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass

**Note**
- This command is mandatory for tunnel creation.

- This command does not apply to auto-bypass tunnels, whose destination is set according to the protected primary tunnel.

**Parameter table**

+---------------------+-------------------------+---------+---------+
| Parameter           | Description             | Range   | Default |
+=====================+=========================+=========+=========+
| destination-address | rsvp tunnel destination | A.B.C.D | \-      |
+---------------------+-------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# destination-address 1.1.1.1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# destination-address 1.1.1.1


**Removing Configuration**

To remove the tunnel's destination-address, run the command with a new destination address:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# destination-address 5.5.5.5

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 9.0     | Command introduced                      |
+---------+-----------------------------------------+
| 10.0    | Added support for manual bypass tunnels |
+---------+-----------------------------------------+

---

### tunnel-bypass/optimization.rst

protocols rsvp tunnel bypass optimization
-----------------------------------------

**Minimum user role:** operator

LSPs may become suboptimal in time as topology changes occur or the availability of network resources changes. During this time, new paths that are less congested, with lower metrics, or with fewer hops may become available. An LSP with a fixed path cannot take advantage of new network resources. The LSP will remain fixed until a recalculation triggering change in the topology occurs. By enabling optimization, you can force the router to periodically recalculate paths for available tunnels and, if more optimal paths are found, make new decisions to reroute suboptimal LSPs through other paths. Optimization runs at fixed intervals or whenever an RSVP enabled interface becomes available.

To enable/disable optimization on the tunnel level:

**Command syntax: optimization [optimization]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass
- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
- Enabling optimization on a tunnel enables all types of optimization triggers, even if global optimization is disabled.

- Disabling the feature while optimization is running stops any current optimization attempts.

.. -  'no optimization [admin-state]' - return optimization admin-state to default value.

.. -  'no optimization' - return optimization admin-state to default value.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter    | Description                                                                      | Range        | Default |
+==============+==================================================================================+==============+=========+
| optimization | Run sequential path calculations for tunnels in UP state to find an optimized    | | enabled    | \-      |
|              | path                                                                             | | disabled   |         |
+--------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# optimization disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# optimization disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# tunnel
    dnRouter(cfg-rsvp-auto-bypass-tunnel)# optimization disabled


**Removing Configuration**

To revert all optimization configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no optimization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/pcep_delegation.rst

protocols rsvp tunnel bypass pcep delegation
--------------------------------------------

**Minimum user role:** operator

PCEP delegation enables to configure the use of PCEP to delegate tunnel settings to a remote PCE. See additional information on PCE and PCEP in "mpls traffic-engineering pcep".
When PCEP delegation is enabled, you still have control over tunnel configuration.
When a new LSP is established for a tunnel, the path computation client (PCC) revokes the PCE's explicit route object (ERO) constraint. This may result in a new path with a different ERO for the tunnel. To prevent this behavior, use the sticky-ero attribute. With sticky-ero enabled, the following behavior is observed:

- The path computation client (PCC) keeps the last successfully established ERO received from the PCE for new established LSPs for the tunnel. All other LSP parameters (e.g. bandwidth, admin-groups, etc.) remain unchanged.

- When the user applies a new path configuration (ERO) to the tunnel, the tunnel will continue using the ERO provided by the PCE. The new path will be used when the tunnel is no longer delegated or RSVP has restarted.

To configure PCEP delegation for the tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: pcep delegation [admin-state]** sticky-ero [sticky-ero]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass
- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
- When PCEP delegation is enabled, you still have control over tunnel configuration.

- Tunnel delegation configuration takes precedence over global RSVP delegation configuration.

.. - 'delegation disable' - disable delegation. sticky-ero-admin-state configuration remain unchanged

.. - 'no pcep delegation', 'no pcep delegation [delegation-admin-state]' - return both delegation-admin-state and sticky-ero-admin-state to default values

**Parameter table**

+-------------+------------------------+--------------+---------+
| Parameter   | Description            | Range        | Default |
+=============+========================+==============+=========+
| admin-state | tunnel delegation mode | | enabled    | \-      |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+
| sticky-ero  | tunnel delegation mode | | enabled    | \-      |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled sticky-ero enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation enabled sticky-ero disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# pcep delegation enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# pcep delegation enabled


**Removing Configuration**

To revert to the default sticky-ero state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no pcep delegation enabled sticky-ero

To revert to the default delegation state and sticky-ero-admin-state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no pcep delegation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/admin-group_exclude-all.rst

protocols rsvp tunnel bypass primary admin-group exclude-all
------------------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group exclude-all**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/admin-group_exclude.rst

protocols rsvp tunnel bypass primary admin-group
------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group [exclude-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| exclude-type     | exclude options                    | | exclude-any      | \-      |
|                  |                                    | | exclude-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/admin-group_ignore.rst

protocols rsvp tunnel bypass primary admin-group ignore
-------------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group ignore**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or ignore

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group ignore' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group ignore


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group ignore

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/admin-group_include.rst

protocols rsvp tunnel bypass primary admin-group
------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. By default, admin-group constraints are ignored in path calculation.
To define global link include admin-group attributes for all tunnels:

**Command syntax: admin-group [include-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set include-all or include-any or include-strict admin-group list

.. -  cannot be set together with admin-group exclude

.. -  'no admin-group include-all [admin-group-name]', 'no admin-group include-strict [admin-group-name]' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group include-any', 'no admin-group include-strict' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| include-type     | rsvp global admin groups           | | include-all      | \-      |
|                  |                                    | | include-any      |         |
|                  |                                    | | include-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-all RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-strict BLUE


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-any RED

To remove all admin-groups from the admin group list:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/bandwidth.rst

protocols rsvp tunnel bypass primary bandwidth
----------------------------------------------

**Minimum user role:** operator

This command reserves the bandwidth on the tunnel. When a bandwidth reservation is configured, reservation messages propagate the bandwidth value throughout the tunnel. Routers must reserve the bandwidth specified across the link for the particular LSP. The reservation is done independently of the traffic that runs through the tunnel. 

To configure the bandwidth requirements for the tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: bandwidth [bandwidth-value]** [bandwidth-units]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- The total bandwidth cannot exceed the bandwidth ranges.

- Reconfiguring the tunnel's bandwidth will reset the tunnel, unless "soft preemption" is configured.

.. -  tunnel bandwidth 0 mbps will result in 0 BW reservation for a tunnel (best-effort traffic). Tunnels with 0 bandwidth setting can be allocated on every bandwidth pool (matching .. their class) even if the pool is with 0 bandwidth. This applies toalltunnel types
..
.. -  considering **bandwidth units,** total bandwidth amount cannot exceed 4294967295 kbps. i.e for mbps max range is 4194303, for gbps 4096
..
.. -  reconfiguring tunnel bandwidth will reset the tunnel, unless "soft preemption" is configured
..
.. -  'no bandwidth [bandwidth] kbps' - return to default units
..
.. -  'no bandwidth' - set tunnel to default 0 mbps bandwidth

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| bandwidth-value | tunnel bandwidth value                                                           | 0-4294967295 | 0       |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| bandwidth-units | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|                 |                                                                                  | | mbps       |         |
|                 |                                                                                  | | gbps       |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# bandwidth 10000 kbps

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# bandwidth 20000


**Removing Configuration**

To revert to the default tunnel bandwidth reservation (i.e. 0 mbps):
::

    dnRouter(cfg-rsvp-tunnel-primary)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/class-type.rst

protocols rsvp tunnel bypass primary class-type
-----------------------------------------------

**Minimum user role:** operator

A class type is a set of traffic flows that have the same set of bandwidth constraints. Tunnels of the same class type allocate bandwidth from the same bandwidth pool and tunnels from different class-types will reserve bandwidth from different pools according to the resource allocation model.

The following table shows the class-type to bandwidth pool mapping:

+--------------------+----------------+
|                    |                |
| Bandwidth Pool     | Class-type     |
+====================+================+
| bc0                | 0              |
+--------------------+----------------+
| bc1                | 1              |
+--------------------+----------------+

If the combination of priority (both setup and hold) and class-type is not mapped to a te-class for a tunnel (see "mpls traffic-engineering diffserv-te te-class-map te-class"), the commit will fail.

To assign a tunnel, manual bypass tunnel, or auto-bypass tunnel to a class-type:

**Command syntax: class-type [class-type]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- Changing the tunnel's class-type for an existing tunnel will cause the tunnel to tear-down before reestablishing it.

- If a bypass tunnel does not satisfy the primary tunnel's constraint, it will not be used for protection.

.. -  if, for any tunnel, the combination priority (both setup and hold) & class-type isn't mapped to a te-class (according to traffic-engineering te-class) commit will fail with .. error message: "No defined TE-Class for tunnel <tunnel-name> with setup-priority <setup-priority> and class-type <class-type>, no bandwidth pool to match".
..
.. -  reconfiguring tunnel class-type for an existing tunnel will cause tunnel to tear-down before reestablishing it.
..
.. -  In case a bypass tunnel doesn't satisfy the primary tunnel constraint, it will not be used for protection
..
.. -  no command returns default class-type

.. -  default tunnel class-type is class-type 0.
..
.. -  class-type to bandwidth pool mapping:

**Parameter table**

+------------+-------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                 | Range | Default |
+============+=============================================================+=======+=========+
| class-type | Assign a tunnel to a class-type when diffserv-te is enabled | 0-1   | 0       |
+------------+-------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# class-type 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# class-type 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# class-type 1


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no class-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/cspf-calculation.rst

protocols rsvp tunnel bypass primary cspf-calculation
-----------------------------------------------------

**Minimum user role:** operator

RSVP uses the Constrained Shortest Path First (CSPF) algorithm to calculate traffic paths subject to the administrative-groups, bandwidth requirements, and explicit route objects (EROs) constraints, maintained in the traffic engineering database. In determining which path to select, CSPF uses the Dijkstra algorithm.

When enabled, CSPF calculates the available bandwidth ratio along each valid candidate tunnel path (where a valid candidate tunnel path is an equal cost shortest path that satisfies the path constraints). The available bandwidth ratio is calculated as: available-bandwidth/max-reservable-bandwidth across all path links.

Use the equal-cost mode to define how the available bandwidth ratio is considered for path selection:

- Least-fill - the path with the highest available-bandwidth-ratio is selected

- Most-fill - the path with the lowest available-bandwidth-ratio is selected

- Random - randomly selects a path from all valid path candidates

To enable/disable the CSPF calculation:

**Command syntax: cspf-calculation [cspf-calculation]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- max-reservable-bandwidth is the configured traffic-engineering class-type 0 bandwidth for the TE interface.

.. -  default values for primary tunnels - as global cspf-calculation value
..
.. -  default values for bypass tunnels - enabled with equal-cost "least-fill"
..
.. -  'no cspf-calculation enabled equal-cost' return equal-cost to default value
..
.. -  'no cspf-calculation' command returns cspf-calculation & equal-cost to default values

**Parameter table**

+------------------+------------------------------------------------------------------------------+--------------+---------+
| Parameter        | Description                                                                  | Range        | Default |
+==================+==============================================================================+==============+=========+
| cspf-calculation | set whether Constraint Shortest Path Forwarding is used for path calculation | | enabled    | \-      |
|                  |                                                                              | | disabled   |         |
+------------------+------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation enabled equal-cost most-fill

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation enabled equal-cost random

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# cspf-calculation disabled


**Removing Configuration**

To revert equal-cost to default mode:
::

    dnRouter(cfg-protocols-rsvp-tunnel-primary)# no cspf-calculation enabled equal-cost

To revert cspf-calculation and equal-cost mode to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel-primary)# no cspf-calculation

**Command History**

+---------+----------------------------------------------------------------------+
| Release | Modification                                                         |
+=========+======================================================================+
| 9.0     | Command introduced                                                   |
+---------+----------------------------------------------------------------------+
| 10.0    | Changed the default admin-state value to the global configuration.   |
|         | Added support for manual bypass tunnels.                             |
+---------+----------------------------------------------------------------------+
| 11.0    | Added support for equal-cost mode configuration                      |
+---------+----------------------------------------------------------------------+

---

### tunnel-bypass/primary/equal-cost.rst

protocols rsvp tunnel bypass primary equal-cost
-----------------------------------------------

**Minimum user role:** operator

RSVP uses the Constrained Shortest Path First (CSPF) algorithm to calculate traffic paths that are subject to the following constraints:

- LSP attributes - Administrative groups such as link coloring, bandwidth requirements, and EROs

- Link attributes - Colors on a particular link and available bandwidth

These constraints are maintained in the traffic engineering database. The database provides CSPF with up-to-date topology information, the current reservable bandwidth of links, and the link colors. You can configure whether or not CSPF is used for path calculation. When disabled, the tunnel path must be explicitly set in order for the tunnel to be established. When enabled, CSPF calculates the available bandwidth ratio along each valid candidate tunnel path (where a valid candidate tunnel path is an equal cost shortest path that satisfies the path constraints). The available bandwidth ratio is calculated as: available-bandwidth/max-reservable-bandwidth across all path links.  
Use the equal-cost mode to define how the available bandwidth ratio is considered for path selection:

- Least-fill - the path with the highest available-bandwidth-ratio is selected

- Most-fill - the path with the lowest available-bandwidth-ratio is selected

- Random - randomly selects a path from all valid path candidates

To enable/disable CSPF path calculation:

**Command syntax: equal-cost [equal-cost]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
-  max-reservable-bandwidth is the configured traffic-engineering class-type 0 bandwidth for the TE interface.

.. -  'no equal-cost enabled equal-cost' return equal-cost to default value

.. -  'no equal-cost' command returns equal-cost & equal-cost to default values

**Parameter table**

+------------+-----------------------------------------------------------------------+----------------+---------+
| Parameter  | Description                                                           | Range          | Default |
+============+=======================================================================+================+=========+
| equal-cost | choose how available-bandwidth-ratio is considered for path selection | | least-fill   | \-      |
|            |                                                                       | | most-fill    |         |
|            |                                                                       | | random       |         |
+------------+-----------------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# equal-cost disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# equal-cost enabled equal-cost random


**Removing Configuration**

To revert equal-cost to default mode:
::

    dnRouter(cfg-protocols-rsvp)# no equal-cost enabled equal-cost

To revert equal-cost and equal-cost mode to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no equal-cost

**Command History**

+---------+---------------------------------------------------------------+
| Release | Modification                                                  |
+=========+===============================================================+
| 10.0    | Command introduced                                            |
+---------+---------------------------------------------------------------+
| 11.0    | Added "most-fill" and "random" selection of equal cost paths. |
+---------+---------------------------------------------------------------+

---

### tunnel-bypass/primary/exclude-srlg.rst

protocols rsvp tunnel bypass primary exclude-srlg
-------------------------------------------------

**Minimum user role:** operator

You can configure a bypass-tunnel to avoid interfaces that have the same SRLG-ID as the main path (see "mpls traffic-engineering interface srlg-group").
There are 3 exclusion modes, each has a slightly different effect:

- Strict - a path will not be accepted if it traverses in a link with the same SRLG-ID

- Avoid - the path with the least number of links that have SRLG conflict will be selected

- Ignore - SRLG will be ignored for CSPF path calculation

To set this behavior:

**Command syntax: exclude-srlg [exclude-srlg]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary

**Parameter table**

+--------------+-------------------+------------+---------+
| Parameter    | Description       | Range      | Default |
+==============+===================+============+=========+
| exclude-srlg | exclude srlg mode | | strict   | avoid   |
|              |                   | | avoid    |         |
|              |                   | | ignore   |         |
+--------------+-------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# exclude-srlg ignore

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# exclude-srlg ignore


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-auto-bypass-primary)# no exclude-srlg

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/hop-limit.rst

protocols rsvp tunnel bypass primary hop-limit
----------------------------------------------

**Minimum user role:** operator

You can set the maximum number of nodes that the LSP can traverse, including head-end and tail-end nodes. Setting a hop-limit value will add a CSPF constraint that the tunnel path cannot exceed the set number of hops.

To configure the limitation on the number of hops that LSPs can traverse:

**Command syntax: hop-limit [hop-limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Parameter table**

+-----------+-----------------------------------------+-------+---------+
| Parameter | Description                             | Range | Default |
+===========+=========================================+=======+=========+
| hop-limit | the time-to-live value for the mpls lsp | 2-255 | 255     |
+-----------+-----------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# hop-limit 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# hop-limit 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# hop-limit 100


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no hop-limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/mpls-oam_profile.rst

protocols rsvp tunnel bypass primary mpls-oam profile
-----------------------------------------------------

**Minimum user role:** operator

This command associates an MPLS-OAM profile ("services mpls-oam profile") defining a periodic LSP ping test with the specific tunnel. When a profile is associated with the tunnel, and the profile is enabled ("services mpls-oam profile admin-state"), MPLS echo request packets will be sent over the tunnel as part of the periodic probe. 

To associate a profile with a primary tunnel:

**Command syntax: mpls-oam profile [mpls-oam-profile]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
.. -  Available for all tunnel types
..
.. -  Changing mpls-oam profile configuration, attaching a different profile or removing the currently atteched profile will immiditaly stop current running probe an act by the probe .. result.
..
.. -  'no mpls-oam profile' - remove all mpls-oam profile attached to the tunnel

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| mpls-oam-profile | The profile name of the mpls oam service - the profile is atteched for an mpls   | | string         | \-      |
|                  | protocol (e.g RSVP)                                                              | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# mpls-oam profile P_1


**Removing Configuration**

To remove the profile association:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no mpls-oam profile

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/path-options/path_dynamic.rst

protocols rsvp tunnel bypass primary path-options path dynamic
--------------------------------------------------------------

**Minimum user role:** operator

You can instruct the tunnel to resolve the LSP dynamically or using a specific explicit path. These can be complementary such that the explicit path may have holes that are resolved dynamically, using CSPF.

You can configure up to 10 paths altogether (explicit and dynamic) under a tunnel.

To configure the path-options for the tunnel so that the LSP will follow the explicit path rules:

**Command syntax: path dynamic**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary path-options
- protocols rsvp tunnel primary path-options
- protocols rsvp tunnel secondary path-options
- protocols rsvp auto-mesh tunnel-template primary path-options

**Note**
- When configuring path-options (see "rsvp tunnel primary path-options"), you must configure a path-options path.

- You can configure path dynamic only once per path-option.

.. - If you instruct the tunnel to use explicit tunnels only and all path options fail, the tunnel will not be established. If you configure explicit path for higher priority path-options than for path-dynamic, the explicit path will never be tested.

.. - If you set "path dynamic" with a higher "path-options priority" than "path explicit", then the explicit path will never be considered. "path dynamic" should therefore always be the last option.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary

    dnRouter(cfg-rsvp-tunnel-primary)# path-options 3
    dnRouter(cfg-tunnel-primary-path-options)# path dynamic


**Removing Configuration**

To revert to the default path behavior:
::

    dnRouter(cfg-tunnel-primary-path-options)# no path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/path-options/path_explicit.rst

protocols rsvp tunnel bypass primary path-options path explicit
---------------------------------------------------------------

**Minimum user role:** operator

You can instruct the tunnel to resolve the LSP dynamically or using a specific explicit path. These can be complementary such that the explicit path may have holes that are resolved dynamically, using CSPF.

You can configure up to 10 paths altogether (explicit and dynamic) under a tunnel.

To configure the path-options for the tunnel so that the LSP will follow the explicit path rules:

**Command syntax: path explicit [explicit-path-name]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary path-options
- protocols rsvp tunnel primary path-options
- protocols rsvp tunnel secondary path-options
- protocols rsvp auto-mesh tunnel-template primary path-options

**Note**
- When configuring path-options (see "rsvp tunnel primary path-options"), you must configure a path-options path.

- You can configure path dynamic only once per path-option.

.. - If you instruct the tunnel to use explicit tunnels only and all path options fail, the tunnel will not be established. If you configure explicit path for higher priority path-options than for path-dynamic, the explicit path will never be tested.

.. - If you set "path dynamic" with a higher "path-options priority" than "path explicit", then the explicit path will never be considered. "path dynamic" should therefore always be the last option.

**Parameter table**

+--------------------+---------------+------------------+---------+
| Parameter          | Description   | Range            | Default |
+====================+===============+==================+=========+
| explicit-path-name | ERO path name | | string         | \-      |
|                    |               | | length 1-255   |         |
+--------------------+---------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-options 1
    dnRouter(cfg-tunnel-primary-path-options)# path explicit PATH_1

    dnRouter(cfg-rsvp-tunnel-primary)# path-options 2
    dnRouter(cfg-tunnel-primary-path-options)# path explicit PATH_2


**Removing Configuration**

To revert to the default path behavior:
::

    dnRouter(cfg-tunnel-primary-path-options)# no path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/path-options/path-options.rst

protocols rsvp tunnel bypass primary path-options
-------------------------------------------------

**Minimum user role:** operator

Path-options provides a set of constraints for establishing the tunnel. When it is not possible to establish the tunnel with one set of constraints, you can opt to establish it using the next set of constraints (according to priority). After the tunnel is established with a specific path-options, the LSP will use the constraints of the best path option that was successfully established.

By default, the system dynamically computes the tunnel's path using global tunnel attributes.

To configure the path-options and enter path-options configuration mode:

**Command syntax: path-options [path-option]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp tunnel secondary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
.. -  default system behavior is to dynamically compute tunnel path using global tunnel attributes
..
.. -  when configuring a better path-option then one currently in use, invoke MBB starting fromt the best path-option. top to bottom. If a worst Path-Option was configured - do .. nothing
..
.. -  the path priority determines which path is examined first, the path is set by the first path that was successfully build
..
.. -  'no path-options [priority]' - remove specific path-option enty
..
.. -  'no path-options' - remove all path-option , returning to system default path option behavior

**Parameter table**

+-------------+----------------------+-------+---------+
| Parameter   | Description          | Range | Default |
+=============+======================+=======+=========+
| path-option | path option priority | 1-10  | \-      |
+-------------+----------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-options 1
    dnRouter(cfg-tunnel-primary-path-options)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# path-options 5
    dnRouter(cfg-bypass-tunnel-primary-path-options)#


**Removing Configuration**

To remove a specific path-option:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no path-options 1

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 9.0     | Command introduced                      |
+---------+-----------------------------------------+
| 10.0    | Added support for manual bypass tunnels |
+---------+-----------------------------------------+
| 11.0    | Updated the priority range              |
+---------+-----------------------------------------+

---

### tunnel-bypass/primary/path-selection.rst

protocols rsvp tunnel bypass primary path-selection
---------------------------------------------------

**Minimum user role:** operator

Set which type of metric cspf should consider when finding an LSP path.

The metric-types are:

- te-metric - The interface traffic-engineering metric, signaled as part of the traffic-engineering information by the igp protocol.

- igp-metric - The interface igp-metric.

To configure the metric-type:

**Command syntax: path-selection [path-selection]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Parameter table**

+----------------+-------------------------------------------------------------+----------------+---------+
| Parameter      | Description                                                 | Range          | Default |
+================+=============================================================+================+=========+
| path-selection | Set which metric should cspf consider whan finding lsp path | | te-metric    | \-      |
|                |                                                             | | igp-metric   |         |
+----------------+-------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-selection te-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# path-selection igp-metric


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no path-selection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### tunnel-bypass/primary/primary.rst

protocols rsvp tunnel bypass primary
------------------------------------

**Minimum user role:** operator

To configure a primary tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: primary**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass
- protocols rsvp tunnel
- protocols rsvp auto-bypass
- protocols rsvp auto-mesh tunnel-template

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)#


**Removing Configuration**

To revert all primary LSP's configuration to default:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no primary

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 9.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 10.0    | Added support for bypass tunnels (manual and auto) |
+---------+----------------------------------------------------+

---

### tunnel-bypass/primary/priority.rst

protocols rsvp tunnel bypass primary priority setup hold
--------------------------------------------------------

**Minimum user role:** operator

Tunnel priority allows you to configure the reservation setup and hold priority:

- Setup priority: the priority used when signaling an LSP for this tunnel to determine which existing tunnels can be preempted. A lower value indicates a higher priority. An LSP -  preempt any LSP with a lower priority.

- Hold priority: the priority used to determine if the LSP can be preempted by other signaled LSPs. A lower value indicates a higher priority. The higher the hold priority, the LSP is less likely to give up its reservation (i.e. is less likely to be preempted by a higher priority LSP).

If there is not enough bandwidth to create a new tunnel, the source (head) router will compare the setup priority of the new tunnel to the hold priority of existing tunnels to decide if to preempt an existing tunnel.

To configure the tunnel priority:

**Command syntax: priority setup [setup] hold [hold]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bypass primary
- protocols rsvp tunnel primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- The value of hold-priority must be  setup-priority.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| setup     | priority used when signaling an LSP for this tunnel to determine which existing  | 0-7   | \-      |
|           | tunnels can be preempted                                                         |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+
| hold      | priority associated with an LSP for this tunnel to determine if it should be     | 0-7   | \-      |
|           | preempted by other LSPs that are being signaled                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# priority setup 3 hold 3

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL2
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# priority setup 5 hold 1


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no priority

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 9.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 10.0    | Added support for bypass tunnels (manual and auto) |
+---------+----------------------------------------------------+

---

### tunnel-bypass/tunnel-bypass.rst

protocols rsvp tunnel bypass
----------------------------

**Minimum user role:** operator

A manual bypass tunnel is a backup LSP used for fast reroute protection. The tunnel is created the moment it is attached to an RSVP interface. The following are the properties of a manually configured bypass tunnel:

- It inherently includes a constraint to avoid the interface it bypasses.
- Its source address is the IPv4 address of the interface it protects (non-configurable). This address must differ from the source-address of the primary LSP it protects.
- Its destination address is configurable (see "rsvp tunnel destination-address" on page 2723
- The default parameter values for a manual bypass tunnel are:

- bandwidth = 0 mbps
- exclude-srlg = avoid
- admin-group = ignore
- class-type = 0
- igp-instance - the IGP instance of the interface configured in IGP (e.g. IS-IS)
- cspf-calculation = enabled, equal cost = least-fill
- primary hop-limit = 255

To manually create a bypass tunnel and enter its configuration mode:

**Command syntax: tunnel [tunnel-bypass] bypass**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
- You cannot remove a manual bypass tunnel if it is attached to an RSVP interface.

-  A tunnel name cannot start with "auto\_tunnel\_" or "tunnel\_bypass\_".

.. -  a tunnel name cannot start with tunnel\_bypass\_

.. -  A tunnel is unique by its name, for all bypass and regular tunnels

.. -  a tunnel name cannot include spaces

.. -  no commands remove the manual-bypass RSVP tunnel.

.. -  cannot remove a manual-bypass RSVP tunnel while it's attached to a RSVP interface.

**Parameter table**

+---------------+-------------+------------------+---------+
| Parameter     | Description | Range            | Default |
+===============+=============+==================+=========+
| tunnel-bypass | tunnel name | | string         | \-      |
|               |             | | length 1-255   |         |
+---------------+-------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)#


**Removing Configuration**

To remove a manual bypass tunnel:
::

    dnRouter(cfg-protocols-rsvp)# no tunnel MAN_BACKUP_1

**Command History**

+---------+------------------------------------------------------------------------------------+
| Release | Modification                                                                       |
+=========+====================================================================================+
| 10.0    | Command introduced                                                                 |
+---------+------------------------------------------------------------------------------------+
| 11.0    | Added restrictions on tunnel names to not start with auto_tunnel or tunnel_bypass. |
+---------+------------------------------------------------------------------------------------+

---

### tunnel/admin-state.rst

protocols rsvp tunnel admin-state
---------------------------------

**Minimum user role:** operator

To enable/disable a tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp tunnel bypass
- protocols rsvp auto-mesh tunnel-template

**Parameter table**

+-------------+------------------+--------------+---------+
| Parameter   | Description      | Range        | Default |
+=============+==================+==============+=========+
| admin-state | Set tunnel state | | enabled    | enabled |
|             |                  | | disabled   |         |
+-------------+------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# admin-state disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# admin-state disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/adjust-interval.rst

protocols rsvp tunnel auto-bandwidth adjust-interval
----------------------------------------------------

**Minimum user role:** operator

The adjust interval is the time-frame in which the samples' calculated average-rates are compared. The highest calculated average-rate within the adjust-interval time-frame will be used in the adjustment threshold decision.
To configure the adjust-interval:

**Command syntax: adjust-interval [adjust-interval]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
.. -  must adjust-interval > sampling-interval

- Changing the interval configuration will reset the timer.

.. -  no command restores adjust-interval to its default value

**Parameter table**

+-----------------+--------------------------------------------------------------+---------+---------+
| Parameter       | Description                                                  | Range   | Default |
+=================+==============================================================+=========+=========+
| adjust-interval | time interval that traffic average-rate samples are gathered | 5-10080 | \-      |
+-----------------+--------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-interval 5


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no adjust-interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/adjust-threshold/adjust-threshold.rst

protocols rsvp tunnel auto-bandwidth adjust-threshold
-----------------------------------------------------

**Minimum user role:** operator

At the end of the adjust-interval (AI) window, the highest average rate within the AI window (maxAvgRate) is compared against the configured adjust-threshold. The adjust-threshold sets the required difference before requesting a change in bandwidth. If maxAvgRate is below or above the threshold, then an attempt is made to signal a new path for the tunnel with the calculated maxAvg bandwidth.
To configure the threshold:

**Command syntax: adjust-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the adjust-threshold configuration will take effect on the next sampling.

.. -  set bandwidth=0 or percent=0 to ignore one of the terms.

.. -  cannot set both bandwidth and percent to 0

.. -  when both bandwidth and percent are configured with a non-zero value, perform bandwidth adjustments when **both** terms are met.

.. -  Units can only be set with bandwidth

.. -  'adjust-threshold' , 'no adjust-threshold', 'no adjust-threshold bandwidth percent' - return bandwidth and percent to their default values

.. -  'no adjust-threshold bandwidth' - return bandwidth to its default value

.. -  'no adjust-threshold percent - return percent to its default value

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 100 mbps percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 0 percent 10
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 10 kbps percent 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# adjust-threshold bandwidth 20 percent 0


**Removing Configuration**

dnRouter(cfg-protocols-rsvp-auto-bw)# no adjust-threshold bandwidth
::

    dnRouter(cfg-protocols-rsvp)# no adjust-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### tunnel/auto-bandwidth/adjust-threshold/bandwidth.rst

protocols rsvp tunnel auto-bandwidth adjust-threshold bandwidth
---------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth adjust-threshold
- protocols rsvp auto-bandwidth adjust-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | \-      |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/adjust-threshold/percent.rst

protocols rsvp tunnel auto-bandwidth adjust-threshold percent
-------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth adjust-threshold
- protocols rsvp auto-bandwidth adjust-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth adjust-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | \-      |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/admin-state.rst

protocols rsvp tunnel auto-bandwidth admin-state
------------------------------------------------

**Minimum user role:** operator

To enable auto-bandwidth globally:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Parameter table**

+-------------+-----------------------+--------------+---------+
| Parameter   | Description           | Range        | Default |
+=============+=======================+==============+=========+
| admin-state | enable auto-bandwidth | | enabled    | \-      |
|             |                       | | disabled   |         |
+-------------+-----------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# admin-state disabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/auto-bandwidth.rst

protocols rsvp tunnel auto-bandwidth
------------------------------------

**Minimum user role:** operator

Tunnels reserve a fixed bandwidth based on the bandwidth setting (see "rsvp tunnel primary bandwidth"), regardless of utilization. Auto-bandwidth allocation enables to dynamically adjust the bandwidth allocation based on the volume of traffic running through the tunnel. This allows the tunnel to reserve a minimum bandwidth and adjust the bandwidth as necessary, according to actual traffic patterns. The bandwidth adjustments do not interrupt traffic flow through the tunnel.

A tunnel with auto-bandwidth enabled is configured with a sampling interval. The traffic running through the tunnel is measured at each sampling interval and the average rate is calculated. At the end of the adjust-interval (AI) window, the highest average rate within the AI window (maxAvgRate) is compared against the configured adjust-threshold. The adjust-threshold sets the required difference before requesting a change in bandwidth. If maxAvgRate is below or above the threshold, the an attempt is made to signal a new path for the tunnel with the calculated maxAvg bandwidth.

The wider the AI window, the longer it takes to adjust to changes in traffic. Overflow and underflow thresholds allow the tunnel to react quickly to significant changes in traffic volume. These thresholds use the same mechanism as the adjust-threshold, except they operate at every sample-interval.

A new requested bandwidth reservation is always within the configured minimum and maximum limits. So if the sampled average rate is greater than the configured maximum, the requested bandwidth will be for the set maximum limit. Similarly, if the sampled average rate is lower than the configured minimum, the requested bandwidth will be for the configured minimum limit.

Once a new request for bandwidth is made, if the new path is successfully established, the old path is removed and the tunnel will switch over to the new path. Otherwise, the tunnel will continue using the existing path until the next sampling interval, when another attempt will be made to signal a new path.

To configure auto-bandwidth for a specific tunnel:

1.	Enable auto-bandwidth on the specific tunnel - "rsvp tunnel auto-bandwidth admin-state".
2.	Configure the sampling interval (globally) - "rsvp auto-bandwidth sampling-interval".
3.	Configure adjust-interval and threshold - "rsvp tunnel auto-bandwidth adjust-interval" and "rsvp tunnel auto-bandwidth adjust-threshold".
4.	Configure overflow and underflow thresholds - "rsvp tunnel auto-bandwidth overflow-threshold" and "rsvp tunnel auto-bandwidth underflow-threshold".
5.	Configure minimum and maximum bandwidth - "rsvp tunnel auto-bandwidth minimum-bandwidth" and "rsvp tunnel auto-bandwidth maximum-bandwidth".
6.	Optional. Set the auto-bandwidth feature to monitor only - "rsvp tunnel auto-bandwidth monitor-only".

To configure auto-bandwidth for a specific tunnel, enter the tunnel's auto-bandwidth configuration mode:

**Command syntax: auto-bandwidth**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp
- protocols rsvp auto-mesh tunnel-template

**Note**
-  Auto-bandwidth parameters apply to primary headend tunnels (manual or auto-mesh) only. They do not apply to bypass tunnels (neither manual nor auto-bypass).

-  no auto-bandwidth restores all auto-bandwidth configuration to their default status and disables auto-bandwidth

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# auto-bandwidth
    dnRouter(cfg-rsvp-tunnel-auto-bw)#


**Removing Configuration**

To revert all auto-bandwidth configurations for this tunnel to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no auto-bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/maximum-bandwidth.rst

protocols rsvp tunnel auto-bandwidth maximum-bandwidth
------------------------------------------------------

**Minimum user role:** operator

A new requested bandwidth reservation is always within the configured minimum and maximum limits. So if the sampled average rate is greater than the configured maximum, the requested bandwidth will be for the set maximum limit. Similarly, if the sampled average rate is lower than the configured minimum, the requested bandwidth will be for the configured minimum limit. A change to the maximum-bandwidth configuration will take effect on the next sampling. To configure the maximum limit:

**Command syntax: maximum-bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
-  The minimum-bandwidth value must be lower or equal to maximum-bandwidth

.. -  'no maximum-bandwidth' - return bandwidth to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------------+---------+
| Parameter | Description                                                                      | Range         | Default |
+===========+==================================================================================+===============+=========+
| bandwidth | tunnel bandwidth                                                                 | 0-42949672950 | \-      |
+-----------+----------------------------------------------------------------------------------+---------------+---------+
| units     | The units used for maximum-bandwidth. If you do not specify the unit, mpbs will  | | kbps        | kbps    |
|           | be used.                                                                         | | mbps        |         |
|           |                                                                                  | | gbps        |         |
+-----------+----------------------------------------------------------------------------------+---------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# maximum-bandwidth 10000000

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# maximum-bandwidth 1000 gbps


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no maximum-bandwidth

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 18.2.5  | Bandwidth range update |
+---------+------------------------+

---

### tunnel/auto-bandwidth/minimum-bandwidth.rst

protocols rsvp tunnel auto-bandwidth minimum-bandwidth
------------------------------------------------------

**Minimum user role:** operator

A new requested bandwidth reservation is always within the configured minimum and maximum limits. So if the sampled average rate is greater than the configured maximum, the requested bandwidth will be for the set maximum limit. Similarly, if the sampled average rate is lower than the configured minimum, the requested bandwidth will be for the configured minimum limit. A change to the minimum-bandwidth configuration will take effect on the next sampling. To configure the minimum limit:

**Command syntax: minimum-bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
-  The minimum-bandwidth value must be lower or equal to maximum-bandwidth

.. -  'no minimum-bandwidth' - return bandwidth to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | tunnel bandwidth                                                                 | 0-4294967295 | \-      |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for minimum-bandwidth. If you do not specify the unit, mpbs will  | | kbps       | kbps    |
|           | be used.                                                                         | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# minimum-bandwidth 10

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# minimum-bandwidth 10000 kbps


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no minimum-bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/monitor-only.rst

protocols rsvp tunnel auto-bandwidth monitor-only
-------------------------------------------------

**Minimum user role:** operator

This command instructs RSVP to do all the auto-bandwidth calculations according to the configuration and record them, but without actually performing any changes. The recorded information is available in show commands.
To enable/disable monitoring-only:

**Command syntax: monitor-only [monitor-only]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
.. -  'no monitor-only' - return to disabled state

-  No adjustments will be made even if you explicitly run the "run rsvp auto-bandwidth adjust" command.

**Parameter table**

+--------------+------------------------------------------------------------------------------+--------------+---------+
| Parameter    | Description                                                                  | Range        | Default |
+==============+==============================================================================+==============+=========+
| monitor-only | maximum sampled traffic rate is monitored but doesnt effect tunnel bandwidth | | enabled    | \-      |
|              |                                                                              | | disabled   |         |
+--------------+------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# monitor-only enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no monitor-only

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/overflow-threshold/bandwidth.rst

protocols rsvp tunnel auto-bandwidth overflow-threshold bandwidth
-----------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth overflow-threshold
- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | \-      |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/overflow-threshold/limit.rst

protocols rsvp tunnel auto-bandwidth overflow-threshold limit
-------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: limit [limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth overflow-threshold
- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold

**Note**
-  You may set a new limit while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no limit - return delay to its default value

**Parameter table**

+-----------+------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                            | Range | Default |
+===========+========================================================================+=======+=========+
| limit     | the amount of consecutive sampling-interval in which overflow happened | 1-10  | \-      |
+-----------+------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# limit 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/overflow-threshold/overflow-threshold.rst

protocols rsvp tunnel auto-bandwidth overflow-threshold
-------------------------------------------------------

**Minimum user role:** operator

The overflow thresholds allows the tunnel to react quickly to significant changes in traffic volume. It uses the same mechanism as the adjust-threshold, except it operates at every sample-interval. The traffic rate is measured at every sampling-interval. If the traffic rate exceeds the configured threshold, a new LSP with updated bandwidth is signaled immediately. To configure the overflow threshold:

**Command syntax: overflow-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the overflow-threshold configuration will take effect on the next sampling.

- A change to the limit takes effect on the current sampling.

- If you do not specify a parameter, the default value is assumed.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 100 percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 0 percent 10 limit 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 kbps percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# overflow-threshold bandwidth 10 kbps limit 2


**Removing Configuration**

To revert all overflow-threshold configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no overflow-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### tunnel/auto-bandwidth/overflow-threshold/percent.rst

protocols rsvp tunnel auto-bandwidth overflow-threshold percent
---------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth overflow-threshold
- protocols rsvp auto-bandwidth overflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth overflow-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | \-      |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/underflow-threshold/bandwidth.rst

protocols rsvp tunnel auto-bandwidth underflow-threshold bandwidth
------------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: bandwidth [bandwidth]** [units]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth underflow-threshold
- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold

**Note**
-  You may set a new bandwidth while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no bandwidth - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                                      | Range        | Default |
+===========+==================================================================================+==============+=========+
| bandwidth | perform bandwidth adjustments if traffic rate is more/less than current          | 0-4294967295 | \-      |
|           | bandwidth allocation                                                             |              |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+
| units     | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|           |                                                                                  | | mbps       |         |
|           |                                                                                  | | gbps       |         |
+-----------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# bandwidth 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/underflow-threshold/limit.rst

protocols rsvp tunnel auto-bandwidth underflow-threshold limit
--------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: limit [limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth underflow-threshold
- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold

**Note**
-  You may set a new limit while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no limit - return delay to its default value

**Parameter table**

+-----------+------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                            | Range | Default |
+===========+========================================================================+=======+=========+
| limit     | the amount of consecutive sampling-interval in which overflow happened | 1-10  | \-      |
+-----------+------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# limit 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/underflow-threshold/percent.rst

protocols rsvp tunnel auto-bandwidth underflow-threshold percent
----------------------------------------------------------------

**Minimum user role:** operator

After establishing a tunnel LSP, we recommend to delay the next tunnel optimization in order to allow the network to stabilize and for the IGP-TE to converge.
To configure a delay between optimization attempts of sequential tunnels in the optimization queue:

**Command syntax: percent [percent]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth underflow-threshold
- protocols rsvp auto-bandwidth underflow-threshold
- protocols rsvp auto-mesh tunnel-template auto-bandwidth underflow-threshold

**Note**
-  You may set a new percent while optimization is running. The new delay will take effect at the next tunnel optimization.

.. -  no percent - return delay to its default value

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| percent   | perform bandwidth adjustments if traffic rate is more/less than current          | 0-100 | \-      |
|           | bandwidth allocation by percent%                                                 |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# optimization
    dnRouter(cfg-protocols-rsvp-optimization)# percent 1


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-optimization)# no percent

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/auto-bandwidth/underflow-threshold/underflow-threshold.rst

protocols rsvp tunnel auto-bandwidth underflow-threshold
--------------------------------------------------------

**Minimum user role:** operator

The underflow thresholds allows the tunnel to react quickly to significant changes in traffic volume. It uses the same mechanism as the adjust-threshold, except it operates at every sample-interval. The traffic rate is measured at every sampling-interval. If the traffic rate drops below the configured threshold, a new LSP with updated bandwidth is signaled immediately. To configure the overflow threshold:

**Command syntax: underflow-threshold**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel auto-bandwidth
- protocols rsvp auto-bandwidth
- protocols rsvp auto-mesh tunnel-template auto-bandwidth

**Note**
- You can disable either thresholds (bandwidth or percent), but not both. When both thresholds are enabled, both thresholds must be crossed to adjust the bandwidth.

- A change to the underflow-threshold configuration will take effect on the next sampling.

- A change to the limit takes effect on the current sampling.

- If you do not specify a parameter, the default value is assumed.

..-  must set either bandwidth or percent to enable threshold feature.
..
..-  when both bandwidth and percent are configured with a non-zero value, perform bandwidth adjustments when **both** terms are met.
..
..-  Units can only be set with bandwidth
..
..-  'underflow-threshold' , 'no underflow-threshold', 'no underflow-threshold bandwidth percent limit' - return bandwidth and percent to their default values
..
..-  'no underflow-threshold bandwidth' - return bandwidth to its default value
..
..-  'no underflow-threshold percent - return percent to its default value
..
..-  'no underflow-threshold limit - return limit to its default value

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bandwidth
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 100 percent 0
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 0 percent 10 limit 5
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 10 percent 5 limit 1
    dnRouter(cfg-protocols-rsvp-auto-bw)# underflow-threshold bandwidth 10 kbps percent 5 limit 1


**Removing Configuration**

To revert all underflow-threshold configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-auto-bw)# no underflow-threshold

**Command History**

+---------+------------------------+
| Release | Modification           |
+=========+========================+
| 11.0    | Command introduced     |
+---------+------------------------+
| 13.2    | Updated command syntax |
+---------+------------------------+

---

### tunnel/bfd/admin-state.rst

protocols rsvp tunnel bfd admin-state
-------------------------------------

**Minimum user role:** operator

Enables a BFD over MPLS session for tunnel LSP protection.

To enable/disable a tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

.. -  no command returns admin-state to default value

.. -  configuring bfd parameter will trigger LSP make-before-break to comply with new BFD state

**Parameter table**

+-------------+--------------------------------------+--------------+----------+
| Parameter   | Description                          | Range        | Default  |
+=============+======================================+==============+==========+
| admin-state | set whether bfd protection is in use | | enabled    | disabled |
|             |                                      | | disabled   |          |
+-------------+--------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# admin-state enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel/bfd/bfd.rst

protocols rsvp tunnel bfd
-------------------------

**Minimum user role:** operator

An RSVP tunnel is a label-switched path (LSP) that can carry inside other RSVP LSPs in order to provide network end-to-end traffic engineering. Each tunnel LSP can have a unique BFD session. 

BFD is supported for all tunnel types (primary, manual bypass, auto bypass and auto mesh).

To establish the BFD session, LSP-Ping is used to sync the peers on session BFD discriminators.
Before activating an LSP, verify the data path by establishing BFD session over LSP and ensure that tunnel can carry data traffic. Only after the BFD session is up the LSP will be used for forwarding.

Install delay: before installing the new LSP as the active tunnel path in the data path, wait for "rsvp make-before-break install-delay" time to verify that LSP is stable as BFD session remain UP for install-delay time. 

After the time period, if the BFD is still up, install the tunnel in the data path.

Upon BFD failure:

- At head LER - Remove LSP, invoke Break Before Make and remove LSP from data path.
- At tail LER - Only Respond with BFD down
- BFD for RSVP isn't a trigger for bypass protection

In the case that RSVP FRR is enabled, BFD timers should be configured to at least 3 x 300 ms so that FRR mechanism can operate as expected and provide fast switchover to a bypass tunnel. it applies to any router acting as PLR, including the case where the head is the PLR of the tunnel.

BFD failure detection time is computed out of the negotiated received interval and the remote multiplier configurations. Detection-time = negotiated-received-interval X received multiplier.

This is the maximum amount of time that can elapse without receipt of a BFD control packet before the session is declared down.

BFD neighbor can signal session state down, and upon receipt, local BFD session will immediately switch to DOWN state.

To enter BFD configuration level:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp auto-bypass
- protocols rsvp tunnel bypass
- protocols rsvp auto-mesh tunnel-template

**Note**
.. -  BFD is supported for all tunnel types (primary, manual bypass, auto bypass, auto-mesh)

.. -  no command returns all bfd configuration to their default settings

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)#


**Removing Configuration**

To revert all bfd configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel/bfd/min-tx.rst

protocols rsvp tunnel bfd min-tx
--------------------------------

**Minimum user role:** operator

To set minimum transmit interval for BFD session:

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

- Due to hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+---------+---------+
| Parameter | Description                                           | Range   | Default |
+===========+=======================================================+=========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 50-1700 | 300     |
+-----------+-------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# min-tx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# min-tx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# min-tx 350


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no min-tx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel/bfd/mix-rx.rst

protocols rsvp tunnel bfd min-rx
--------------------------------

**Minimum user role:** operator

To set desired minimum receive interval for BFD session:

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

**Parameter table**

+-----------+------------------------------------------------------+---------+---------+
| Parameter | Description                                          | Range   | Default |
+===========+======================================================+=========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 50-1700 | 300     |
+-----------+------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# min-rx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# min-rx 350

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# min-rx 350


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no min-rx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel/bfd/multiplier.rst

protocols rsvp tunnel bfd multiplier
------------------------------------

**Minimum user role:** operator

The multiplier defines the number of min-rx intervals in which a BFD packet is not received before the session goes down. Using the example below, if min-rx is configured to 100 msec and the multiplier is 4, this means that if BFD packets stop arriving the session will go down after 400 msec.

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel bfd
- protocols rsvp auto-bypass bfd
- protocols rsvp tunnel bypass bfd
- protocols rsvp auto-mesh tunnel-template bfd

**Note**
- Configuring the BFD parameter will trigger LSP make-before-break to comply with new BFD state.

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# bfd
    dnRouter(cfg-rsvp-tunnel-bfd)# multiplier 4

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# bfd
    dnRouter(cfg-rsvp-bypass-tunnel-bfd)# multiplier 4

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# bfd
    dnRouter(cfg-rsvp-auto-bypass-bfd)# multiplier 4


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.4    | Command introduced |
+---------+--------------------+

---

### tunnel/description.rst

protocols rsvp tunnel description
---------------------------------

**Minimum user role:** operator

To enter a description for the tunnel or bypass tunnel:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp tunnel bypass
- protocols rsvp auto-mesh tunnel-template

**Parameter table**

+-------------+----------------------------+------------------+---------+
| Parameter   | Description                | Range            | Default |
+=============+============================+==================+=========+
| description | description for the tunnel | | string         | \-      |
|             |                            | | length 1-255   |         |
+-------------+----------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# description MyDescription

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# description MyDescription


**Removing Configuration**

To remove the tunnel's description:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no description

**Command History**

+---------+----------------------------------------+
| Release | Modification                           |
+=========+========================================+
| 9.0     | Command introduced                     |
+---------+----------------------------------------+
| 10.0    | Added support for manual bypass tunnel |
+---------+----------------------------------------+

---

### tunnel/destination-address.rst

protocols rsvp tunnel destination-address
-----------------------------------------

**Minimum user role:** operator

A tunnel's destination-address is the tunnel's tail-end router's address.
To configure the tunnel's destination-address for a tunnel or bypass-tunnel:

**Command syntax: destination-address [destination-address]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel

**Note**
- This command is mandatory for tunnel creation.

- This command does not apply to auto-bypass tunnels, whose destination is set according to the protected primary tunnel.

**Parameter table**

+---------------------+-------------------------+---------+---------+
| Parameter           | Description             | Range   | Default |
+=====================+=========================+=========+=========+
| destination-address | rsvp tunnel destination | A.B.C.D | \-      |
+---------------------+-------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# destination-address 1.1.1.1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# destination-address 1.1.1.1


**Removing Configuration**

To remove the tunnel's destination-address, run the command with a new destination address:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# destination-address 5.5.5.5

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 9.0     | Command introduced                      |
+---------+-----------------------------------------+
| 10.0    | Added support for manual bypass tunnels |
+---------+-----------------------------------------+

---

### tunnel/igp-instance_isis.rst

protocols rsvp tunnel igp-instance isis
---------------------------------------

**Minimum user role:** operator

To configure the IGP protocol to be used by CSPF in path calculation. In the event the protocol is ISIS, the instance name must be provided:

**Command syntax: igp-instance isis [instance-name]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Parameter table**

+---------------+----------------------------+------------------+---------+
| Parameter     | Description                | Range            | Default |
+===============+============================+==================+=========+
| instance-name | igp protocol instnace name | | string         | \-      |
|               |                            | | length 1-255   |         |
+---------------+----------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-instance isis AREA_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL2
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-instance isis AREA_2


**Removing Configuration**

To revert to the system default behavior:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no igp-instance

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 10.0    | Command introduced                                      |
+---------+---------------------------------------------------------+
| 13.1    | Split command syntax - protocol changed to ISIS or OSPF |
+---------+---------------------------------------------------------+

---

### tunnel/igp-instance_ospf.rst

protocols rsvp tunnel igp-instance ospf
---------------------------------------

**Minimum user role:** operator

To configure the IGP protocol to be used by CSPF in path calculation. In the event the protocol is ISIS, the instance name must be provided:

**Command syntax: igp-instance ospf [instance-name]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Parameter table**

+---------------+----------------------------+------------------+---------+
| Parameter     | Description                | Range            | Default |
+===============+============================+==================+=========+
| instance-name | igp protocol instnace name | | string         | \-      |
|               |                            | | length 1-255   |         |
+---------------+----------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL321
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-instance ospf OSPF_1


**Removing Configuration**

To revert to the system default behavior:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no igp-instance

**Command History**

+---------+---------------------------------------------------------+
| Release | Modification                                            |
+=========+=========================================================+
| 10.0    | Command introduced                                      |
+---------+---------------------------------------------------------+
| 13.1    | Split command syntax - protocol changed to ISIS or OSPF |
+---------+---------------------------------------------------------+

---

### tunnel/igp-shortcuts.rst

protocols rsvp tunnel igp-shortcuts
-----------------------------------

**Minimum user role:** operator

By default, BGP and static-route next-hops are resolved first by an LSP if the LSP destination matches the next-hop address.
When IGP-shortcuts is enabled, the BGP and static-route next-hop can be solved by the RSVP tunnel even if the tunnel destination doesnt match the next-hop address. An IGP path is found to the next-hop destination with the option of using LSPs as a connected route for the IGP topology.
An RSVP tunnel will always have preference over LDP for next-hop resolution.

To enable/disable the use of RSVP tunnels to resolve non-MPLS traffic:

**Command syntax: igp-shortcuts [igp-shortcuts]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
-  RSVP tunnel igp-shortcuts is not supported for bypass tunnels (auto and manual).

-  The RSVP tunnel IGP-shortcuts overrides the "mpls traffic-engineering igp-shortcuts" configuration for the tunnel:

**Parameter table**

+---------------+-----------------------------------------------------------------+--------------+---------+
| Parameter     | Description                                                     | Range        | Default |
+===============+=================================================================+==============+=========+
| igp-shortcuts | support the use of the rsvp tunnel to resolve non mpls traffic. | | enabled    | \-      |
|               |                                                                 | | disabled   |         |
+---------------+-----------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-shortcuts enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# igp-shortcuts disabled
    dnRouter(cfg-protocols-mpls-te)# exit
    dnRouter(cfg-protocols-mpls)# exit
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-shortcuts enabled


    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# mpls
    dnRouter(cfg-protocols-mpls)# traffic-engineering
    dnRouter(cfg-protocols-mpls-te)# igp-shortcuts enabled
    dnRouter(cfg-protocols-mpls-te)# exit
    dnRouter(cfg-protocols-mpls)# exit
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# igp-shortcuts disabled


**Removing Configuration**

To return the igp-shortcuts to the default:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no igp-shortcuts

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/ldp-sync.rst

protocols rsvp tunnel ldp-sync
------------------------------

**Minimum user role:** operator

Enable ldp sync for all tunnels set with ldp-tunneling. When enabled, rsvp tunnel is excluded to be used for ldp tunneling, by either shortcut of forwarding-adjecency, if targeted LDP peer is missing.

**Command syntax: ldp-sync [ldp-sync]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Parameter table**

+-----------+------------------------------------------+--------------+---------+
| Parameter | Description                              | Range        | Default |
+===========+==========================================+==============+=========+
| ldp-sync  | Set ldp sync for ldp tunneling over rsvp | | enabled    | \-      |
|           |                                          | | disabled   |         |
+-----------+------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# ldp-sync enabled


**Removing Configuration**

To return the ldp-sync to the default:
::

    dnRouter(cfg-protocols-rsvp)# no ldp-sync

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.2    | Command introduced |
+---------+--------------------+

---

### tunnel/ldp-tunneling.rst

protocols rsvp tunnel ldp-tunneling
-----------------------------------

**Minimum user role:** operator

You can enable an rsvp tunnel to be used for LDP tunneling over RSVP. When the tunnel is in Up state, a targeted LDP session will be open to a peer matching the rsvp tunnel destination
To enable/disable the LDP tunneling over RSVP:

**Command syntax: ldp-tunneling [ldp-tunneling]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
- RSVP tunnel ldp-shortcuts-sync is not supported for bypass tunnels (auto and manual).

**Parameter table**

+---------------+-----------------------------------------------------------+--------------+----------+
| Parameter     | Description                                               | Range        | Default  |
+===============+===========================================================+==============+==========+
| ldp-tunneling | Enable rsvp tunnel to be used for LDP tunneling over RSVP | | enabled    | disabled |
|               |                                                           | | disabled   |          |
+---------------+-----------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# ldp-tunneling enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# ldp-tunneling enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no ldp-tunneling

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### tunnel/optimization.rst

protocols rsvp tunnel optimization
----------------------------------

**Minimum user role:** operator

LSPs may become suboptimal in time as topology changes occur or the availability of network resources changes. During this time, new paths that are less congested, with lower metrics, or with fewer hops may become available. An LSP with a fixed path cannot take advantage of new network resources. The LSP will remain fixed until a recalculation triggering change in the topology occurs. By enabling optimization, you can force the router to periodically recalculate paths for available tunnels and, if more optimal paths are found, make new decisions to reroute suboptimal LSPs through other paths. Optimization runs at fixed intervals or whenever an RSVP enabled interface becomes available.

To enable/disable optimization on the tunnel level:

**Command syntax: optimization [optimization]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp tunnel bypass
- protocols rsvp auto-mesh tunnel-template

**Note**
- Enabling optimization on a tunnel enables all types of optimization triggers, even if global optimization is disabled.

- Disabling the feature while optimization is running stops any current optimization attempts.

.. -  'no optimization [admin-state]' - return optimization admin-state to default value.

.. -  'no optimization' - return optimization admin-state to default value.

**Parameter table**

+--------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter    | Description                                                                      | Range        | Default |
+==============+==================================================================================+==============+=========+
| optimization | Run sequential path calculations for tunnels in UP state to find an optimized    | | enabled    | \-      |
|              | path                                                                             | | disabled   |         |
+--------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# optimization disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# optimization disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# tunnel
    dnRouter(cfg-rsvp-auto-bypass-tunnel)# optimization disabled


**Removing Configuration**

To revert all optimization configurations to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no optimization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/pcep_delegation.rst

protocols rsvp tunnel pcep delegation
-------------------------------------

**Minimum user role:** operator

PCEP delegation enables to configure the use of PCEP to delegate tunnel settings to a remote PCE. See additional information on PCE and PCEP in "mpls traffic-engineering pcep".
When PCEP delegation is enabled, you still have control over tunnel configuration.
When a new LSP is established for a tunnel, the path computation client (PCC) revokes the PCE's explicit route object (ERO) constraint. This may result in a new path with a different ERO for the tunnel. To prevent this behavior, use the sticky-ero attribute. With sticky-ero enabled, the following behavior is observed:

- The path computation client (PCC) keeps the last successfully established ERO received from the PCE for new established LSPs for the tunnel. All other LSP parameters (e.g. bandwidth, admin-groups, etc.) remain unchanged.

- When the user applies a new path configuration (ERO) to the tunnel, the tunnel will continue using the ERO provided by the PCE. The new path will be used when the tunnel is no longer delegated or RSVP has restarted.

To configure PCEP delegation for the tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: pcep delegation [admin-state]** sticky-ero [sticky-ero]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp tunnel bypass
- protocols rsvp auto-mesh tunnel-template

**Note**
- When PCEP delegation is enabled, you still have control over tunnel configuration.

- Tunnel delegation configuration takes precedence over global RSVP delegation configuration.

.. - 'delegation disable' - disable delegation. sticky-ero-admin-state configuration remain unchanged

.. - 'no pcep delegation', 'no pcep delegation [delegation-admin-state]' - return both delegation-admin-state and sticky-ero-admin-state to default values

**Parameter table**

+-------------+------------------------+--------------+---------+
| Parameter   | Description            | Range        | Default |
+=============+========================+==============+=========+
| admin-state | tunnel delegation mode | | enabled    | \-      |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+
| sticky-ero  | tunnel delegation mode | | enabled    | \-      |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# pcep delegation enabled sticky-ero enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# pcep delegation enabled sticky-ero disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# pcep delegation enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# pcep delegation enabled


**Removing Configuration**

To revert to the default sticky-ero state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no pcep delegation enabled sticky-ero

To revert to the default delegation state and sticky-ero-admin-state:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no pcep delegation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/admin-group_exclude-all.rst

protocols rsvp tunnel primary admin-group exclude-all
-----------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group exclude-all**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/admin-group_exclude.rst

protocols rsvp tunnel primary admin-group
-----------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group [exclude-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or exclude-all

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group exclude-all' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| exclude-type     | exclude options                    | | exclude-any      | \-      |
|                  |                                    | | exclude-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-all


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/admin-group_ignore.rst

protocols rsvp tunnel primary admin-group ignore
------------------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. To define global link exclude admin-group attributes for all tunnels:

**Command syntax: admin-group ignore**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

- The tunnel admin-group exclude configuration overrides the global setting.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set exclude or ignore

.. -  cannot be set together with admin-group include

.. -  'no admin-group exclude [admin-group-name]'' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group exclude', 'no admin-group ignore' - remove all admin-groups from the admin-groups list

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group exclude-any RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group ignore


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group exclude RED

To remove all admin-groups from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group ignore

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/admin-group_include.rst

protocols rsvp tunnel primary admin-group
-----------------------------------------

**Minimum user role:** operator

After configuring the administrative group, you can either exclude, include, or ignore links of that color in the traffic engineering database:

- If you exclude a specific color, all segments with an administrative group of that color are excluded from CSPF path selection.

- If you include a specific color, only those segments with the appropriate color are selected.

- If you neither exclude nor include the color, the metrics associated with the administrative groups and applied on the specific segments determine the path cost for that segment.

The LSP with the lowest total path cost is selected into the traffic engineering database. By default, admin-group constraints are ignored in path calculation.
To define global link include admin-group attributes for all tunnels:

**Command syntax: admin-group [include-type] [admin-group-name]** [, admin-group-name, admin-group-name]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- You cannot set the same admin-group-name in both an exclude and include constraint.

.. -  default system behavior is to ignore admin-groups constraints in path calculation

.. -  can either set include-all or include-any or include-strict admin-group list

.. -  cannot be set together with admin-group exclude

.. -  'no admin-group include-all [admin-group-name]', 'no admin-group include-strict [admin-group-name]' - remove the specified admin-group from the admin-groups list

.. -  'no admin-group include-any', 'no admin-group include-strict' - remove all admin-groups from the admin-groups list

**Parameter table**

+------------------+------------------------------------+--------------------+---------+
| Parameter        | Description                        | Range              | Default |
+==================+====================================+====================+=========+
| include-type     | rsvp global admin groups           | | include-all      | \-      |
|                  |                                    | | include-any      |         |
|                  |                                    | | include-strict   |         |
+------------------+------------------------------------+--------------------+---------+
| admin-group-name | Admin groups (separated by commas) | | string           | \-      |
|                  |                                    | | length 1-255     |         |
+------------------+------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-all RED, GREEN

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# admin-group include-strict BLUE


**Removing Configuration**

To remove a specific admin-group-name from the constraint:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-any RED

To remove all admin-groups from the admin group list:
::

    dnRouter(cfg-protocols-rsvp)# no admin-group include-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/bandwidth.rst

protocols rsvp tunnel primary bandwidth
---------------------------------------

**Minimum user role:** operator

This command reserves the bandwidth on the tunnel. When a bandwidth reservation is configured, reservation messages propagate the bandwidth value throughout the tunnel. Routers must reserve the bandwidth specified across the link for the particular LSP. The reservation is done independently of the traffic that runs through the tunnel. 

To configure the bandwidth requirements for the tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: bandwidth [bandwidth-value]** [bandwidth-units]

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- The total bandwidth cannot exceed the bandwidth ranges.

- Reconfiguring the tunnel's bandwidth will reset the tunnel, unless "soft preemption" is configured.

.. -  tunnel bandwidth 0 mbps will result in 0 BW reservation for a tunnel (best-effort traffic). Tunnels with 0 bandwidth setting can be allocated on every bandwidth pool (matching .. their class) even if the pool is with 0 bandwidth. This applies toalltunnel types
..
.. -  considering **bandwidth units,** total bandwidth amount cannot exceed 4294967295 kbps. i.e for mbps max range is 4194303, for gbps 4096
..
.. -  reconfiguring tunnel bandwidth will reset the tunnel, unless "soft preemption" is configured
..
.. -  'no bandwidth [bandwidth] kbps' - return to default units
..
.. -  'no bandwidth' - set tunnel to default 0 mbps bandwidth

**Parameter table**

+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter       | Description                                                                      | Range        | Default |
+=================+==================================================================================+==============+=========+
| bandwidth-value | tunnel bandwidth value                                                           | 0-4294967295 | 0       |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+
| bandwidth-units | The units used for bandwidth. If you do not specify the unit, mpbs will be used. | | kbps       | kbps    |
|                 |                                                                                  | | mbps       |         |
|                 |                                                                                  | | gbps       |         |
+-----------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# bandwidth 10000 kbps

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# bandwidth 20000


**Removing Configuration**

To revert to the default tunnel bandwidth reservation (i.e. 0 mbps):
::

    dnRouter(cfg-rsvp-tunnel-primary)# no bandwidth

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel/primary/class-type.rst

protocols rsvp tunnel primary class-type
----------------------------------------

**Minimum user role:** operator

A class type is a set of traffic flows that have the same set of bandwidth constraints. Tunnels of the same class type allocate bandwidth from the same bandwidth pool and tunnels from different class-types will reserve bandwidth from different pools according to the resource allocation model.

The following table shows the class-type to bandwidth pool mapping:

+--------------------+----------------+
|                    |                |
| Bandwidth Pool     | Class-type     |
+====================+================+
| bc0                | 0              |
+--------------------+----------------+
| bc1                | 1              |
+--------------------+----------------+

If the combination of priority (both setup and hold) and class-type is not mapped to a te-class for a tunnel (see "mpls traffic-engineering diffserv-te te-class-map te-class"), the commit will fail.

To assign a tunnel, manual bypass tunnel, or auto-bypass tunnel to a class-type:

**Command syntax: class-type [class-type]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- Changing the tunnel's class-type for an existing tunnel will cause the tunnel to tear-down before reestablishing it.

- If a bypass tunnel does not satisfy the primary tunnel's constraint, it will not be used for protection.

.. -  if, for any tunnel, the combination priority (both setup and hold) & class-type isn't mapped to a te-class (according to traffic-engineering te-class) commit will fail with .. error message: "No defined TE-Class for tunnel <tunnel-name> with setup-priority <setup-priority> and class-type <class-type>, no bandwidth pool to match".
..
.. -  reconfiguring tunnel class-type for an existing tunnel will cause tunnel to tear-down before reestablishing it.
..
.. -  In case a bypass tunnel doesn't satisfy the primary tunnel constraint, it will not be used for protection
..
.. -  no command returns default class-type

.. -  default tunnel class-type is class-type 0.
..
.. -  class-type to bandwidth pool mapping:

**Parameter table**

+------------+-------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                 | Range | Default |
+============+=============================================================+=======+=========+
| class-type | Assign a tunnel to a class-type when diffserv-te is enabled | 0-1   | 0       |
+------------+-------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# class-type 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# class-type 1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# class-type 1


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no class-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.0    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/cspf-calculation.rst

protocols rsvp tunnel primary cspf-calculation
----------------------------------------------

**Minimum user role:** operator

RSVP uses the Constrained Shortest Path First (CSPF) algorithm to calculate traffic paths subject to the administrative-groups, bandwidth requirements, and explicit route objects (EROs) constraints, maintained in the traffic engineering database. In determining which path to select, CSPF uses the Dijkstra algorithm.

When enabled, CSPF calculates the available bandwidth ratio along each valid candidate tunnel path (where a valid candidate tunnel path is an equal cost shortest path that satisfies the path constraints). The available bandwidth ratio is calculated as: available-bandwidth/max-reservable-bandwidth across all path links.

Use the equal-cost mode to define how the available bandwidth ratio is considered for path selection:

- Least-fill - the path with the highest available-bandwidth-ratio is selected

- Most-fill - the path with the lowest available-bandwidth-ratio is selected

- Random - randomly selects a path from all valid path candidates

To enable/disable the CSPF calculation:

**Command syntax: cspf-calculation [cspf-calculation]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- max-reservable-bandwidth is the configured traffic-engineering class-type 0 bandwidth for the TE interface.

.. -  default values for primary tunnels - as global cspf-calculation value
..
.. -  default values for bypass tunnels - enabled with equal-cost "least-fill"
..
.. -  'no cspf-calculation enabled equal-cost' return equal-cost to default value
..
.. -  'no cspf-calculation' command returns cspf-calculation & equal-cost to default values

**Parameter table**

+------------------+------------------------------------------------------------------------------+--------------+---------+
| Parameter        | Description                                                                  | Range        | Default |
+==================+==============================================================================+==============+=========+
| cspf-calculation | set whether Constraint Shortest Path Forwarding is used for path calculation | | enabled    | \-      |
|                  |                                                                              | | disabled   |         |
+------------------+------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation enabled equal-cost most-fill

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# cspf-calculation enabled equal-cost random

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# cspf-calculation disabled


**Removing Configuration**

To revert equal-cost to default mode:
::

    dnRouter(cfg-protocols-rsvp-tunnel-primary)# no cspf-calculation enabled equal-cost

To revert cspf-calculation and equal-cost mode to their default values:
::

    dnRouter(cfg-protocols-rsvp-tunnel-primary)# no cspf-calculation

**Command History**

+---------+----------------------------------------------------------------------+
| Release | Modification                                                         |
+=========+======================================================================+
| 9.0     | Command introduced                                                   |
+---------+----------------------------------------------------------------------+
| 10.0    | Changed the default admin-state value to the global configuration.   |
|         | Added support for manual bypass tunnels.                             |
+---------+----------------------------------------------------------------------+
| 11.0    | Added support for equal-cost mode configuration                      |
+---------+----------------------------------------------------------------------+

---

### tunnel/primary/equal-cost.rst

protocols rsvp tunnel primary equal-cost
----------------------------------------

**Minimum user role:** operator

RSVP uses the Constrained Shortest Path First (CSPF) algorithm to calculate traffic paths that are subject to the following constraints:

- LSP attributes - Administrative groups such as link coloring, bandwidth requirements, and EROs

- Link attributes - Colors on a particular link and available bandwidth

These constraints are maintained in the traffic engineering database. The database provides CSPF with up-to-date topology information, the current reservable bandwidth of links, and the link colors. You can configure whether or not CSPF is used for path calculation. When disabled, the tunnel path must be explicitly set in order for the tunnel to be established. When enabled, CSPF calculates the available bandwidth ratio along each valid candidate tunnel path (where a valid candidate tunnel path is an equal cost shortest path that satisfies the path constraints). The available bandwidth ratio is calculated as: available-bandwidth/max-reservable-bandwidth across all path links.  
Use the equal-cost mode to define how the available bandwidth ratio is considered for path selection:

- Least-fill - the path with the highest available-bandwidth-ratio is selected

- Most-fill - the path with the lowest available-bandwidth-ratio is selected

- Random - randomly selects a path from all valid path candidates

To enable/disable CSPF path calculation:

**Command syntax: equal-cost [equal-cost]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
-  max-reservable-bandwidth is the configured traffic-engineering class-type 0 bandwidth for the TE interface.

.. -  'no equal-cost enabled equal-cost' return equal-cost to default value

.. -  'no equal-cost' command returns equal-cost & equal-cost to default values

**Parameter table**

+------------+-----------------------------------------------------------------------+----------------+---------+
| Parameter  | Description                                                           | Range          | Default |
+============+=======================================================================+================+=========+
| equal-cost | choose how available-bandwidth-ratio is considered for path selection | | least-fill   | \-      |
|            |                                                                       | | most-fill    |         |
|            |                                                                       | | random       |         |
+------------+-----------------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# equal-cost disabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# equal-cost enabled equal-cost random


**Removing Configuration**

To revert equal-cost to default mode:
::

    dnRouter(cfg-protocols-rsvp)# no equal-cost enabled equal-cost

To revert equal-cost and equal-cost mode to their default values:
::

    dnRouter(cfg-protocols-rsvp)# no equal-cost

**Command History**

+---------+---------------------------------------------------------------+
| Release | Modification                                                  |
+=========+===============================================================+
| 10.0    | Command introduced                                            |
+---------+---------------------------------------------------------------+
| 11.0    | Added "most-fill" and "random" selection of equal cost paths. |
+---------+---------------------------------------------------------------+

---

### tunnel/primary/hop-limit.rst

protocols rsvp tunnel primary hop-limit
---------------------------------------

**Minimum user role:** operator

You can set the maximum number of nodes that the LSP can traverse, including head-end and tail-end nodes. Setting a hop-limit value will add a CSPF constraint that the tunnel path cannot exceed the set number of hops.

To configure the limitation on the number of hops that LSPs can traverse:

**Command syntax: hop-limit [hop-limit]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Parameter table**

+-----------+-----------------------------------------+-------+---------+
| Parameter | Description                             | Range | Default |
+===========+=========================================+=======+=========+
| hop-limit | the time-to-live value for the mpls lsp | 2-255 | 255     |
+-----------+-----------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# hop-limit 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# hop-limit 100

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# hop-limit 100


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no hop-limit

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/mpls-oam_profile.rst

protocols rsvp tunnel primary mpls-oam profile
----------------------------------------------

**Minimum user role:** operator

This command associates an MPLS-OAM profile ("services mpls-oam profile") defining a periodic LSP ping test with the specific tunnel. When a profile is associated with the tunnel, and the profile is enabled ("services mpls-oam profile admin-state"), MPLS echo request packets will be sent over the tunnel as part of the periodic probe. 

To associate a profile with a primary tunnel:

**Command syntax: mpls-oam profile [mpls-oam-profile]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
.. -  Available for all tunnel types
..
.. -  Changing mpls-oam profile configuration, attaching a different profile or removing the currently atteched profile will immiditaly stop current running probe an act by the probe .. result.
..
.. -  'no mpls-oam profile' - remove all mpls-oam profile attached to the tunnel

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| mpls-oam-profile | The profile name of the mpls oam service - the profile is atteched for an mpls   | | string         | \-      |
|                  | protocol (e.g RSVP)                                                              | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# mpls-oam profile P_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# mpls-oam profile P_1


**Removing Configuration**

To remove the profile association:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no mpls-oam profile

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/path-options/path_dynamic.rst

protocols rsvp tunnel primary path-options path dynamic
-------------------------------------------------------

**Minimum user role:** operator

You can instruct the tunnel to resolve the LSP dynamically or using a specific explicit path. These can be complementary such that the explicit path may have holes that are resolved dynamically, using CSPF.

You can configure up to 10 paths altogether (explicit and dynamic) under a tunnel.

To configure the path-options for the tunnel so that the LSP will follow the explicit path rules:

**Command syntax: path dynamic**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary path-options
- protocols rsvp tunnel secondary path-options
- protocols rsvp tunnel bypass primary path-options
- protocols rsvp auto-mesh tunnel-template primary path-options

**Note**
- When configuring path-options (see "rsvp tunnel primary path-options"), you must configure a path-options path.

- You can configure path dynamic only once per path-option.

.. - If you instruct the tunnel to use explicit tunnels only and all path options fail, the tunnel will not be established. If you configure explicit path for higher priority path-options than for path-dynamic, the explicit path will never be tested.

.. - If you set "path dynamic" with a higher "path-options priority" than "path explicit", then the explicit path will never be considered. "path dynamic" should therefore always be the last option.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary

    dnRouter(cfg-rsvp-tunnel-primary)# path-options 3
    dnRouter(cfg-tunnel-primary-path-options)# path dynamic


**Removing Configuration**

To revert to the default path behavior:
::

    dnRouter(cfg-tunnel-primary-path-options)# no path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel/primary/path-options/path_explicit.rst

protocols rsvp tunnel primary path-options path explicit
--------------------------------------------------------

**Minimum user role:** operator

You can instruct the tunnel to resolve the LSP dynamically or using a specific explicit path. These can be complementary such that the explicit path may have holes that are resolved dynamically, using CSPF.

You can configure up to 10 paths altogether (explicit and dynamic) under a tunnel.

To configure the path-options for the tunnel so that the LSP will follow the explicit path rules:

**Command syntax: path explicit [explicit-path-name]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary path-options
- protocols rsvp tunnel secondary path-options
- protocols rsvp tunnel bypass primary path-options
- protocols rsvp auto-mesh tunnel-template primary path-options

**Note**
- When configuring path-options (see "rsvp tunnel primary path-options"), you must configure a path-options path.

- You can configure path dynamic only once per path-option.

.. - If you instruct the tunnel to use explicit tunnels only and all path options fail, the tunnel will not be established. If you configure explicit path for higher priority path-options than for path-dynamic, the explicit path will never be tested.

.. - If you set "path dynamic" with a higher "path-options priority" than "path explicit", then the explicit path will never be considered. "path dynamic" should therefore always be the last option.

**Parameter table**

+--------------------+---------------+------------------+---------+
| Parameter          | Description   | Range            | Default |
+====================+===============+==================+=========+
| explicit-path-name | ERO path name | | string         | \-      |
|                    |               | | length 1-255   |         |
+--------------------+---------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-options 1
    dnRouter(cfg-tunnel-primary-path-options)# path explicit PATH_1

    dnRouter(cfg-rsvp-tunnel-primary)# path-options 2
    dnRouter(cfg-tunnel-primary-path-options)# path explicit PATH_2


**Removing Configuration**

To revert to the default path behavior:
::

    dnRouter(cfg-tunnel-primary-path-options)# no path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel/primary/path-options/path-options.rst

protocols rsvp tunnel primary path-options
------------------------------------------

**Minimum user role:** operator

Path-options provides a set of constraints for establishing the tunnel. When it is not possible to establish the tunnel with one set of constraints, you can opt to establish it using the next set of constraints (according to priority). After the tunnel is established with a specific path-options, the LSP will use the constraints of the best path option that was successfully established.

By default, the system dynamically computes the tunnel's path using global tunnel attributes.

To configure the path-options and enter path-options configuration mode:

**Command syntax: path-options [path-option]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel secondary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
.. -  default system behavior is to dynamically compute tunnel path using global tunnel attributes
..
.. -  when configuring a better path-option then one currently in use, invoke MBB starting fromt the best path-option. top to bottom. If a worst Path-Option was configured - do .. nothing
..
.. -  the path priority determines which path is examined first, the path is set by the first path that was successfully build
..
.. -  'no path-options [priority]' - remove specific path-option enty
..
.. -  'no path-options' - remove all path-option , returning to system default path option behavior

**Parameter table**

+-------------+----------------------+-------+---------+
| Parameter   | Description          | Range | Default |
+=============+======================+=======+=========+
| path-option | path option priority | 1-10  | \-      |
+-------------+----------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-options 1
    dnRouter(cfg-tunnel-primary-path-options)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# path-options 5
    dnRouter(cfg-bypass-tunnel-primary-path-options)#


**Removing Configuration**

To remove a specific path-option:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no path-options 1

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 9.0     | Command introduced                      |
+---------+-----------------------------------------+
| 10.0    | Added support for manual bypass tunnels |
+---------+-----------------------------------------+
| 11.0    | Updated the priority range              |
+---------+-----------------------------------------+

---

### tunnel/primary/path-selection.rst

protocols rsvp tunnel primary path-selection
--------------------------------------------

**Minimum user role:** operator

Set which type of metric cspf should consider when finding an LSP path.

The metric-types are:

- te-metric - The interface traffic-engineering metric, signaled as part of the traffic-engineering information by the igp protocol.

- igp-metric - The interface igp-metric.

To configure the metric-type:

**Command syntax: path-selection [path-selection]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Parameter table**

+----------------+-------------------------------------------------------------+----------------+---------+
| Parameter      | Description                                                 | Range          | Default |
+================+=============================================================+================+=========+
| path-selection | Set which metric should cspf consider whan finding lsp path | | te-metric    | \-      |
|                |                                                             | | igp-metric   |         |
+----------------+-------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-selection te-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# primary
    dnRouter(cfg-auto-mesh-temp-primary)# path-selection igp-metric

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)# path-selection igp-metric


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no path-selection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.1    | Command introduced |
+---------+--------------------+

---

### tunnel/primary/primary.rst

protocols rsvp tunnel primary
-----------------------------

**Minimum user role:** operator

To configure a primary tunnel, manual bypass tunnel, or auto-bypass tunnel:

**Command syntax: primary**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp tunnel bypass
- protocols rsvp auto-bypass
- protocols rsvp auto-mesh tunnel-template

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-bypass
    dnRouter(cfg-protocols-rsvp-auto-bypass)# primary
    dnRouter(cfg-rsvp-auto-bypass-primary)#


**Removing Configuration**

To revert all primary LSP's configuration to default:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no primary

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 9.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 10.0    | Added support for bypass tunnels (manual and auto) |
+---------+----------------------------------------------------+

---

### tunnel/primary/priority.rst

protocols rsvp tunnel primary priority setup hold
-------------------------------------------------

**Minimum user role:** operator

Tunnel priority allows you to configure the reservation setup and hold priority:

- Setup priority: the priority used when signaling an LSP for this tunnel to determine which existing tunnels can be preempted. A lower value indicates a higher priority. An LSP -  preempt any LSP with a lower priority.

- Hold priority: the priority used to determine if the LSP can be preempted by other signaled LSPs. A lower value indicates a higher priority. The higher the hold priority, the LSP is less likely to give up its reservation (i.e. is less likely to be preempted by a higher priority LSP).

If there is not enough bandwidth to create a new tunnel, the source (head) router will compare the setup priority of the new tunnel to the hold priority of existing tunnels to decide if to preempt an existing tunnel.

To configure the tunnel priority:

**Command syntax: priority setup [setup] hold [hold]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
- The value of hold-priority must be  setup-priority.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| setup     | priority used when signaling an LSP for this tunnel to determine which existing  | 0-7   | \-      |
|           | tunnels can be preempted                                                         |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+
| hold      | priority associated with an LSP for this tunnel to determine if it should be     | 0-7   | \-      |
|           | preempted by other LSPs that are being signaled                                  |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# priority setup 3 hold 3

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL2
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# priority setup 5 hold 1


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no priority

**Command History**

+---------+----------------------------------------------------+
| Release | Modification                                       |
+=========+====================================================+
| 9.0     | Command introduced                                 |
+---------+----------------------------------------------------+
| 10.0    | Added support for bypass tunnels (manual and auto) |
+---------+----------------------------------------------------+

---

### tunnel/primary/protection.rst

protocols rsvp tunnel primary protection
----------------------------------------

**Minimum user role:** operator

Fast reroute protection enables to divert a tunnel passing through a failed interface by encapsulating it in a different tunnel carrying the traffic to a merge point behind the network failure.

There are two types of traffic protection for RSVP-signaled LSPs:

- Link protection - where a bypass tunnel encapsulates the traffic through an LSP skipping the potential damaged link and forwards it towards the protected tunnel's next-hop:
- - When Link protection is desired, and no bypass LSP available to provide the required link protection, no protection will be given.

- Node protection - where a bypass tunnel encapsulates the traffic through an LSP skipping the potential damaged node and forwards it towards the protected tunnel's next next-hop:
- - When Node protection is desired, and no bypass LSP available to provide the required node protection, a link protection will be used if available. 

The bypass-tunnel can have any length LSP (limited by the configured hop-limit).
When protection is needed and a bypass tunnel that can provide it (i.e. it has the required destination and matches the required protection type) is available, the bypass tunnel will be used regardless of any conflict with the Primary tunnel's attributes, such as admin-group.
When there are multiple possible bypass-tunnels available for protection, the bypass tunnel that will be used is the least used bypass-tunnel, i.e the tunnel that protects the least number of primary tunnels. 

The bypass tunnel protection type supported is facility-backup. A single bypass-tunnel provides protection to multiple primary tunnels. If several (2 or more) primary tunnels are protected by a single protection Bypass (of the same type) and a new protection bypass (of the same type) is created  the bypasses are reselected for protection of the primary tunnels to ensure equal usage of bypass tunnels among the primary tunnels.

You can configure up to 5 manual bypass-tunnels per interface. There is no limit to the number of auto bypass-tunnels established through an interface.
When checking the scale of tunnels in the system, bypass-tunnels (auto and manual) are regarded as any other tunnel and are counted in the system's total tunnel scale limit.
Protection by a bypass tunnel that serves node-protection is preferred over a bypass tunnel that serves link-protection (even if link protection is requested). If a primary tunnel is protected by a link-protection bypass tunnel and a new bypass tunnel is created that serves node-protection, the primary tunnel will switch to be protected by the new bypass tunnel.

If there are both manual and automatic bypass tunnels, they are all eligible for load-balancing of primary tunnels.

When enabled, all the nodes are informed that the LSP is protected against link and/or node failure. Bypass tunnels that match the protection request are set as protection tunnels. If there are no eligible bypass tunnels and auto-bypass is enabled (see "rsvp auto-bypass"), an auto-bypass tunnel will be created.

To enable/disable fast-reroute protection for a tunnel:

**Command syntax: protection [protection]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel primary
- protocols rsvp auto-mesh tunnel-template primary

**Parameter table**

+------------+----------------------------------------------------+---------------------+---------+
| Parameter  | Description                                        | Range               | Default |
+============+====================================================+=====================+=========+
| protection | global configuration for tunnel protection setting | | disabled          | \-      |
|            |                                                    | | link-protection   |         |
|            |                                                    | | node-protection   |         |
+------------+----------------------------------------------------+---------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# protection link

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL2
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# protection node

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL3
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# protection disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 10.1    | Command introduced |
+---------+--------------------+

---

### tunnel/rib-unicast-install.rst

protocols rsvp tunnel rib-unicast-install
-----------------------------------------

**Minimum user role:** operator

With the rib-unicast-install command, you can install RSVP tunnel destinations in the RIB IPv4-unicast table as directly reachable through the tunnel.
To enable/disable the ability to install the tunnel destinations in the RIB:

**Command syntax: rib-unicast-install [rib-unicast-install]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
- This configuration is applicable to all primary tunnel types (regular and auto-mesh), except bypass tunnels.

.. - RSVP administrative-distance is 100 by default

.. - 'no rib-unicast-install'- return rib-unicast-install to default state

**Parameter table**

+---------------------+-----------------------------------------------------------------------------+--------------+---------+
| Parameter           | Description                                                                 | Range        | Default |
+=====================+=============================================================================+==============+=========+
| rib-unicast-install | state if tunnel destination will be installed in the rib ipv4-unicast table | | enabled    | \-      |
|                     |                                                                             | | disabled   |         |
+---------------------+-----------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# auto-mesh
    dnRouter(cfg-protocols-rsvp-auto-mesh)# tunnel-template TEMP_1
    dnRouter(cfg-rsvp-auto-mesh-temp)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# rib-unicast-install disabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install enabled

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# rib-unicast-install enabled
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# rib-unicast-install disabled


**Removing Configuration**

To return the rib-unicast-install to the default:
::

    dnRouter(cfg-protocols-rsvp)# no rib-unicast-install

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.5    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/admin-state.rst

protocols rsvp tunnel secondary admin-state
-------------------------------------------

**Minimum user role:** operator

With the secondary path, primary lsp of tunnel will be end to end protected. Upon a primary path failure, the traffic will switch to use the pre-installed secondary path.
The tunnel secondary lsp has a disjoin path with primary lsp
To enable usage of the tunnel secondary lsp:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary

**Note**
- Secondary LSP is not supported for bypass tunnels.

**Parameter table**

+-------------+----------------------------+--------------+----------+
| Parameter   | Description                | Range        | Default  |
+=============+============================+==============+==========+
| admin-state | Set tunnel secondary state | | enabled    | disabled |
|             |                            | | disabled   |          |
+-------------+----------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)# admin-state enabled


**Removing Configuration**

To revert to the default state:
::

    dnRouter(cfg-rsvp-tunnel-secondary)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/bfd/bfd.rst

protocols rsvp tunnel secondary bfd
-----------------------------------

**Minimum user role:** operator

Define BFD behavior for protecting the RSVP-TE tunnel secondary LSP.
When BFD is enabled for the RSVP-TE tunnel, and the tunnel is set with end-to-end protection using secondary LSP, the BFD session will be established for secondary LSP as well.
The secondary LSP is dependent on BFD session and will be installed only if the BFD session is in Up state.
The operator can control the BFD timers desired for Secondary LSP protecting session.
To enter the RSVP-TE tunnel secondary lsp bfd configuration level:


**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary

**Note**

- The BFD settings apply to the LSP installed as the tunnel end-to-end protection alternate path.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)# bfd
    dnRouter(cfg-tunnel-secondary-bfd)#


**Removing Configuration**

To revert all bfd configuration to default:
::

    dnRouter(cfg-rsvp-tunnel-secondary)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/bfd/min-rx.rst

protocols rsvp tunnel secondary bfd min-rx
------------------------------------------

**Minimum user role:** operator

The desired minimum received interval is the time-frame in which a BFD packet is expected to arrive. If a BFD packet is not received within the configured interval, the BFD session will go down.
The min-rx together with the multiplier, defines the detection time.
The Local Detection timeout = negotiated Rx interval * remote_multiplier (the multiplier value received on the BFD packet).
The Remote Detection timeout = negotiated Tx interval * local_multiplier (the multiplier value configured locally for the session).
Set the desired minimum receive interval for the BFD session:


**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary bfd

**Note**

- Due to a hardware limitation, the maximum supported transmit rate is 1700 msec, and a negotiated transmit interval that is higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+---------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                         | Range   | Default |
+===========+=====================================================================+=========+=========+
| min-rx    | The interval (in msec) in which a BFD packet is expected to arrive. | 50-1700 | 1000    |
+-----------+---------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)# bfd
    dnRouter(cfg-tunnel-secondary-bfd)# min-rx 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-tunnel-secondary-bfd)# no min-rx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/bfd/min-tx.rst

protocols rsvp tunnel secondary bfd min-tx
------------------------------------------

**Minimum user role:** operator

The minimum transmission interval is the time between consecutive transmissions of BFD packets. To configure the transmission rate of BFD packets:


**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary bfd

**Note**

- Due to a hardware limitation, the maximum supported transmit rate is 1700msec, and a negotiated transmit interval that is higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+--------------------------------------------------------------+---------+---------+
| Parameter | Description                                                  | Range   | Default |
+===========+==============================================================+=========+=========+
| min-tx    | The interval (in msec) between transmissions of BFD packets. | 50-1700 | 1000    |
+-----------+--------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)# bfd
    dnRouter(cfg-tunnel-secondary-bfd)# min-tx 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-tunnel-secondary-bfd)# no min-tx

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/bfd/multiplier.rst

protocols rsvp tunnel secondary bfd multiplier
----------------------------------------------

**Minimum user role:** operator

The multiplier defines the number of min-rx intervals in which a BFD packet is not received before the BFD session goes down.

To configure a local BFD multiplier:


**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary bfd

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| multiplier | The number of min-rx intervals in which no BFD packet is received as expected    | 2-16  | 3       |
|            | (or the number of missing BFD packets) before the BFD session goes down.         |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)# bfd
    dnRouter(cfg-tunnel-secondary-bfd)# multiplier 5


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-tunnel-secondary-bfd)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/disjoint-preference.rst

protocols rsvp tunnel secondary disjoint-preference
---------------------------------------------------

**Minimum user role:** operator

Sets a disjoint constraint preference for establishing a Secondary LSP.
By default, requires a strictly disjoint path excluding any link and node used in Primary LSP path. If no path is found, no Secondary LSP is provided.
When avoid is set, the Secondary LSP avoids utilizing links and nodes used in the primary path as much as possible, but if no other alternative secondary path can pass through them. This increases finding a path for secondary.
To set a disjoint constraint preference:

**Command syntax: disjoint-preference [preference]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary

**Parameter table**

+------------+----------------------------------------------------------------------------------+------------+---------+
| Parameter  | Description                                                                      | Range      | Default |
+============+==================================================================================+============+=========+
| preference | set desired disjoint constraint for Secondary LSP in compare to Primary LSP path | | strict   | strict  |
|            |                                                                                  | | avoid    |         |
+------------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)# disjoint-preference avoid


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-secondary)# no disjoint-preference

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/exclude-srlg.rst

protocols rsvp tunnel secondary exclude-srlg
--------------------------------------------

**Minimum user role:** operator

You can configure a Secondary LSP to avoid interfaces that have the same SRLG as the Primary LSP path.
To set exclude-srlg behavior:

**Command syntax: exclude-srlg [exclude-srlg]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary

**Parameter table**

+--------------+-------------------+------------+---------+
| Parameter    | Description       | Range      | Default |
+==============+===================+============+=========+
| exclude-srlg | exclude srlg mode | | strict   | strict  |
|              |                   | | avoid    |         |
|              |                   | | ignore   |         |
+--------------+-------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)# exclude-srlg ignore


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-secondary)# no exclude-srlg

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/path-options/path_dynamic.rst

protocols rsvp tunnel secondary path-options path dynamic
---------------------------------------------------------

**Minimum user role:** operator

You can instruct the tunnel to resolve the LSP dynamically or using a specific explicit path. These can be complementary such that the explicit path may have holes that are resolved dynamically, using CSPF.

You can configure up to 10 paths altogether (explicit and dynamic) under a tunnel.

To configure the path-options for the tunnel so that the LSP will follow the explicit path rules:

**Command syntax: path dynamic**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary path-options
- protocols rsvp tunnel primary path-options
- protocols rsvp tunnel bypass primary path-options
- protocols rsvp auto-mesh tunnel-template primary path-options

**Note**
- When configuring path-options (see "rsvp tunnel primary path-options"), you must configure a path-options path.

- You can configure path dynamic only once per path-option.

.. - If you instruct the tunnel to use explicit tunnels only and all path options fail, the tunnel will not be established. If you configure explicit path for higher priority path-options than for path-dynamic, the explicit path will never be tested.

.. - If you set "path dynamic" with a higher "path-options priority" than "path explicit", then the explicit path will never be considered. "path dynamic" should therefore always be the last option.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary

    dnRouter(cfg-rsvp-tunnel-primary)# path-options 3
    dnRouter(cfg-tunnel-primary-path-options)# path dynamic


**Removing Configuration**

To revert to the default path behavior:
::

    dnRouter(cfg-tunnel-primary-path-options)# no path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/path-options/path_explicit.rst

protocols rsvp tunnel secondary path-options path explicit
----------------------------------------------------------

**Minimum user role:** operator

You can instruct the tunnel to resolve the LSP dynamically or using a specific explicit path. These can be complementary such that the explicit path may have holes that are resolved dynamically, using CSPF.

You can configure up to 10 paths altogether (explicit and dynamic) under a tunnel.

To configure the path-options for the tunnel so that the LSP will follow the explicit path rules:

**Command syntax: path explicit [explicit-path-name]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary path-options
- protocols rsvp tunnel primary path-options
- protocols rsvp tunnel bypass primary path-options
- protocols rsvp auto-mesh tunnel-template primary path-options

**Note**
- When configuring path-options (see "rsvp tunnel primary path-options"), you must configure a path-options path.

- You can configure path dynamic only once per path-option.

.. - If you instruct the tunnel to use explicit tunnels only and all path options fail, the tunnel will not be established. If you configure explicit path for higher priority path-options than for path-dynamic, the explicit path will never be tested.

.. - If you set "path dynamic" with a higher "path-options priority" than "path explicit", then the explicit path will never be considered. "path dynamic" should therefore always be the last option.

**Parameter table**

+--------------------+---------------+------------------+---------+
| Parameter          | Description   | Range            | Default |
+====================+===============+==================+=========+
| explicit-path-name | ERO path name | | string         | \-      |
|                    |               | | length 1-255   |         |
+--------------------+---------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-options 1
    dnRouter(cfg-tunnel-primary-path-options)# path explicit PATH_1

    dnRouter(cfg-rsvp-tunnel-primary)# path-options 2
    dnRouter(cfg-tunnel-primary-path-options)# path explicit PATH_2


**Removing Configuration**

To revert to the default path behavior:
::

    dnRouter(cfg-tunnel-primary-path-options)# no path

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/path-options/path-options.rst

protocols rsvp tunnel secondary path-options
--------------------------------------------

**Minimum user role:** operator

Path-options provides a set of constraints for establishing the tunnel. When it is not possible to establish the tunnel with one set of constraints, you can opt to establish it using the next set of constraints (according to priority). After the tunnel is established with a specific path-options, the LSP will use the constraints of the best path option that was successfully established.

By default, the system dynamically computes the tunnel's path using global tunnel attributes.

To configure the path-options and enter path-options configuration mode:

**Command syntax: path-options [path-option]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary
- protocols rsvp tunnel primary
- protocols rsvp tunnel bypass primary
- protocols rsvp auto-mesh tunnel-template primary

**Note**
.. -  default system behavior is to dynamically compute tunnel path using global tunnel attributes
..
.. -  when configuring a better path-option then one currently in use, invoke MBB starting fromt the best path-option. top to bottom. If a worst Path-Option was configured - do .. nothing
..
.. -  the path priority determines which path is examined first, the path is set by the first path that was successfully build
..
.. -  'no path-options [priority]' - remove specific path-option enty
..
.. -  'no path-options' - remove all path-option , returning to system default path option behavior

**Parameter table**

+-------------+----------------------+-------+---------+
| Parameter   | Description          | Range | Default |
+=============+======================+=======+=========+
| path-option | path option priority | 1-10  | \-      |
+-------------+----------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# primary
    dnRouter(cfg-rsvp-tunnel-primary)# path-options 1
    dnRouter(cfg-tunnel-primary-path-options)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel MAN_BACKUP_1 bypass
    dnRouter(cfg-protocols-rsvp-bypass-tunnel)# primary
    dnRouter(cfg-rsvp-bypass-tunnel-primary)# path-options 5
    dnRouter(cfg-bypass-tunnel-primary-path-options)#


**Removing Configuration**

To remove a specific path-option:
::

    dnRouter(cfg-rsvp-tunnel-primary)# no path-options 1

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 9.0     | Command introduced                      |
+---------+-----------------------------------------+
| 10.0    | Added support for manual bypass tunnels |
+---------+-----------------------------------------+
| 11.0    | Updated the priority range              |
+---------+-----------------------------------------+

---

### tunnel/secondary/revertive.rst

protocols rsvp tunnel secondary revertive
-----------------------------------------

**Minimum user role:** operator

The tunnel revertive logic only applies for tunnels set with end-to-end protection, i.e usage of Primary & Secondary LSP.
Upon a Primary LSP failure (or an explicit request by the user), it is expected that traffic will shift from a Primary LSP to a Secondary LSP. 
The tunnel remains in an Up state and the Secondary LSP is the one declared as in-use while passing traffic.
The revertive logic dictates if & when traffic should switch back to a Primary LSP assuming such was restored, established and is in an Up state.

To set a desire revertive behavior:

**Command syntax: revertive [revertive]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel secondary

**Parameter table**

+-----------+----------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                          | Range | Default |
+===========+======================================================================+=======+=========+
| revertive | Define when it is expected for traffic to switch back to primary lsp | \-    | 0       |
+-----------+----------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)# revertive 600


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-rsvp-tunnel-secondary)# no revertive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### tunnel/secondary/secondary.rst

protocols rsvp tunnel secondary
-------------------------------

**Minimum user role:** operator

To configure a tunnel secondary lsp:

**Command syntax: secondary**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel

**Note**
- Secondary LSP is not supported for bypass tunnels.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# secondary
    dnRouter(cfg-rsvp-tunnel-secondary)#


**Removing Configuration**

To revert all secondary LSP's configuration to default:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no secondary

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### tunnel/source-address.rst

protocols rsvp tunnel source-address
------------------------------------

**Minimum user role:** operator

A tunnel's source-address is the tunnel's head-end router's address. By default, this would be the router's configured MPLS-TE router-id. You can, however use a different address.
To configure a source-address for the tunnel:

**Command syntax: source-address [source-address]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel
- protocols rsvp auto-mesh tunnel-template

**Note**
- This command does not apply to bypass tunnels (auto or manual). For auto-bypass and manual bypass tunnels, the RSVP egress interface source address is according to the egress interface.

**Parameter table**

+----------------+------------------------------------------------------+---------+---------+
| Parameter      | Description                                          | Range   | Default |
+================+======================================================+=========+=========+
| source-address | rsvp ip source address to be use in tunnel signaling | A.B.C.D | \-      |
+----------------+------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# source-address 2.2.2.2


**Removing Configuration**

To revert to the default source-address:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no source-address

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 9.0     | Command introduced |
+---------+--------------------+

---

### tunnel/tunnel.rst

protocols rsvp tunnel
---------------------

**Minimum user role:** operator

An RSVP tunnel is a label-switched path (LSP) that can carry inside other RSVP LSPs in order to provide network end-to-end traffic engineering. There are several types of RSVP tunnels, each with its own set of possible configuration and default configuration values. These are:

- RSVP tunnel - a primary LSP that is created immediately upon configuration. See "rsvp tunnel primary".

- Manual bypass tunnel - a backup LSP used for fast reroute protection. The tunnel is created the moment it is attached to an RSVP interface. See "rsvp tunnel bypass".

- Auto-bypass tunnel - an automatically generated LSP profile. The tunnel is created the moment that a protection request arrives from a primary RSVP tunnel. See "rsvp auto-bypass".

- Auto-mesh tunnel - a primary LSP whose configuration and attributes are taken from a tunnel template. The tunnel is created when a new router is discovered in the TE topology database.

The following global RSVP default configurations do not apply for manual and auto-bypass tunnels:

- source-address
- cspf-calculation
- priority
- admin-group

Follow these general steps to create a new tunnel:

1.	Create a new tunnel and give it a name (see below)

2.	Optional. Enter a description for the tunnel (see "rsvp tunnel description").

3.	Enter a destination address for the tunnel (see "rsvp tunnel destination-address").

4.	Optional. Enter the source address of the tunnel (see "rsvp tunnel source-address").

5.	Configure primary tunnel parameters (see "rsvp tunnel primary").

To create a tunnel and enter its configuration mode:

**Command syntax: tunnel [tunnel]**

**Command mode:** config

**Hierarchies**

- protocols rsvp

**Note**
.. -  a tunnel name cannot start with "auto\_tunnel'_"

.. -  a tunnel name cannot start with "tunnel\_bypass\_"

.. -  a tunnel name cannot include spaces

.. -  A tunnel is unique by its name, for all bypass and regular tunnels

**Parameter table**

+-----------+-------------+------------------+---------+
| Parameter | Description | Range            | Default |
+===========+=============+==================+=========+
| tunnel    | tunnel name | | string         | \-      |
|           |             | | length 1-255   |         |
+-----------+-------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)#


**Removing Configuration**

To delete the tunnel:
::

    dnRouter(cfg-protocols-rsvp)# no tunnel TUNNEL1

**Command History**

+---------+--------------------------------------------------------+
| Release | Modification                                           |
+=========+========================================================+
| 9.0     | Command introduced                                     |
+---------+--------------------------------------------------------+
| 11.0    | Added restrictions on names                            |
+---------+--------------------------------------------------------+
| 15.0    | Added support for ldp-tunneling and ldp-shortcuts-sync |
+---------+--------------------------------------------------------+
| 15.1    | Added support for primary path-selection               |
+---------+--------------------------------------------------------+

---

### tunnel/weight.rst

protocols rsvp tunnel weight
----------------------------

**Minimum user role:** operator

Set tunnel weight for unequal load-balancing when working with weighted-ecmp . 
For "tunnel-bw" weight will be per tunnel bw in kbps
To configure the weight for the rsvp tunnel:

**Command syntax: weight [weight]**

**Command mode:** config

**Hierarchies**

- protocols rsvp tunnel

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------------------------+-----------+
| Parameter | Description                                                                      | Range                     | Default   |
+===========+==================================================================================+===========================+===========+
| weight    | configure the tunnel weight to be used for unequal rsvp tunnels multi-path       | 1..4294967295 | tunnel-bw | tunnel-bw |
|           | load-balancing                                                                   |                           |           |
+-----------+----------------------------------------------------------------------------------+---------------------------+-----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# weight 1500

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# rsvp
    dnRouter(cfg-protocols-rsvp)# tunnel TUNNEL1
    dnRouter(cfg-protocols-rsvp-tunnel)# weight tunnel-bw


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols-rsvp-tunnel)# no weight

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---


## SECTION 2.O: SEGMENT-ROUTING

Files in this section: 147

### mpls/auto-policy/auto-policy.rst

protocols segment-routing mpls auto-policy
------------------------------------------

**Minimum user role:** operator

Segment Routing auto policies allow a service head-end router to dynamically create an SR-TE policy for a route resolved over BGP next-hop when required (on-demand).
The head-end router automatically follows the actions defined in the template upon arrival of BGP global or VPN routes with a BGP color extended community that matches the color value specified in the template.

Key benefits include:

* SLA-aware BGP service  provides per-destination steering behaviors where a prefix, a set of prefixes, or all prefixes from a service can be associated with a desired underlay SLA. The functionality applies equally to single-domain and multi-domain networks.

* Simplicity  no prior SR Policy configuration needs to be configured and maintained. Instead, operator simply configures a small set of common intent-based optimization templates throughout the network.

* Scalability  device resources at the head-end router are used only when required, based on service or SLA connectivity needs.


To enter segment-routing auto policy configuration hierarchy:

**Command syntax: auto-policy**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)#


**Removing Configuration**

To remove all configured auto-policy templates and revert global configuration to default:
::

    dnRouter(cfg-protocols-sr-mpls)# no auto-policy

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/maximum-auto-policies.rst

protocols segment-routing mpls auto-policy maximum-auto-policies
----------------------------------------------------------------

**Minimum user role:** operator

Maximum auto policies sets the values for the generation of system events when crossed.

To configure the SR-TE auto policies limit:

**Command syntax: maximum-auto-policies [maximum]** threshold [percent]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy

**Parameter table**

+-----------+----------------------------------------------------------------+--------------+---------+
| Parameter | Description                                                    | Range        | Default |
+===========+================================================================+==============+=========+
| maximum   | The maximum limit of auto-policies in the system               | 1-4294967295 | 500     |
+-----------+----------------------------------------------------------------+--------------+---------+
| percent   | Percentage of the maximum limit of auto-policies in the system | 1-100        | 75      |
+-----------+----------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# maximum-auto-policies 1000

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# maximum-auto-policies 1200 threshold 80


**Removing Configuration**

To revert maximum limit and threshold to their default values:
::

    dnRouter(cfg-sr-mpls-auto-policy)# no maximum-auto-policies

To revert threshold to its default value:
::

    dnRouter(cfg-sr-mpls-auto-policy)# no maximum-auto-policies 1200 threshold

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template-name.rst

protocols segment-routing mpls auto-policy template-name
--------------------------------------------------------

**Minimum user role:** operator

To overwrite the default prefix for the name of auto-policies created with auto-policy templates:

**Command syntax: template-name [template-name]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy

**Note**
- The default name format for policies created by the auto-policy template: Auto_c_colorValue_dest_DestIp.

- Changing the tempalte-name will not affect running auto-policies created by existing templates.

**Parameter table**

+---------------+-----------------------------------------------------------------------------+-----------------+---------+
| Parameter     | Description                                                                 | Range           | Default |
+===============+=============================================================================+=================+=========+
| template-name | The prefix for the name of auto-policies created with auto-policy templates | | string        | Auto    |
|               |                                                                             | | length 1-64   |         |
+---------------+-----------------------------------------------------------------------------+-----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template-name auto-policy


**Removing Configuration**

To revert the SR-TE auto policy template-name to its default value:
::

    dnRouter(cfg-sr-mpls-auto-policy)# no template-name

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/admin-state.rst

protocols segment-routing mpls auto-policy template color admin-state
---------------------------------------------------------------------

**Minimum user role:** operator

When disabled, a policy created by this auto-policy template will not be used for traffic forwarding.

To enable/disable policies created by a specific SR-TE auto policy template:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Parameter table**

+-------------+-----------------------+--------------+---------+
| Parameter   | Description           | Range        | Default |
+=============+=======================+==============+=========+
| admin-state | SR policy admin state | | enabled    | enabled |
|             |                       | | disabled   |         |
+-------------+-----------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# admin-state enabled


**Removing Configuration**

To return the admin-state to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/administrative-distance.rst

protocols segment-routing mpls auto-policy template color administrative-distance
---------------------------------------------------------------------------------

**Minimum user role:** operator

Administrative distance is an arbitrary numerical value that is assigned to routes to allow the router to decide which routing protocol to select for installation in the FIB and for route resolution for protocol next-hop when multiple protocols provide route information for the same destination. The assigned value denotes the preference of the route compared to other routes, such that a lower value denotes a more preferred route.

To configure the segment-routing traffic-engineering administrative distance for policies created by a specific SR-TE auto policy template:

**Command syntax: administrative-distance [administrative-distance]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Note**
- An administrative distance of 255 will cause the router to remove the route from the routing table and not use it.

- Reconfiguration of the administrative-distance will take immediate effect.

- If no value is set explicitly by the user, then it will be inherited from traffic-engineering administrative-distance configuration.

**Parameter table**

+-------------------------+-------------------------------------------------------------------------+-------+---------+
| Parameter               | Description                                                             | Range | Default |
+=========================+=========================================================================+=======+=========+
| administrative-distance | Sets the Segment-Routing administrative-distance used for SR-TE policy. | 1-255 | \-      |
+-------------------------+-------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# administrative-distance 90


**Removing Configuration**

To return to the default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no administrative-distance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/backup-path-install.rst

protocols segment-routing mpls auto-policy template color backup-path-install
-----------------------------------------------------------------------------

**Minimum user role:** operator

When the backup-install-path is set for a given policy, DNOS picks the next (lower) preference valid candidate path as the backup for the active candidate path.
The backup path is installed to the FIB to provide sub 50 msec failover upon active path failure.

To enable end to end protecition and support backup path installation:


**Command syntax: backup-path-install [backup-path-install]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Note**
- For policy to have a backup path , at least two paths needs to be configured for policy (no commit validation required)
- Each path , both active and backup is fully defined by its path settings. There is no implicit disjoint constraint between them.


**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter           | Description                                                                      | Range        | Default |
+=====================+==================================================================================+==============+=========+
| backup-path-install | Utilize lower preference candidate path as policy end to end back path installed | | enabled    | \-      |
|                     | to RIB and FIB                                                                   | | disabled   |         |
+---------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# backup-path-install enabled


**Removing Configuration**

To return the backup-path-install setting to its default value:
::

    dnRouter(cfg-protocols-igp-mpls)# no backup-path-install

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/description.rst

protocols segment-routing mpls auto-policy template color description
---------------------------------------------------------------------

**Minimum user role:** operator

It is good practice to provide a meaningful description of the template and policies.

To configure a description for the SR-TE auto policy template that shall also be used for policies created with the template:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Parameter table**

+-------------+--------------------+------------------+---------+
| Parameter   | Description        | Range            | Default |
+=============+====================+==================+=========+
| description | policy description | | string         | \-      |
|             |                    | | length 1-255   |         |
+-------------+--------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# description "this is my auto-policy"


**Removing Configuration**

To remove the configured description:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/igp-instance_isis.rst

protocols segment-routing mpls auto-policy template color igp-instance isis
---------------------------------------------------------------------------

**Minimum user role:** operator

By default, the SR-TE policies created with auto policy templates are created with the the lowest administrative-distance IGP instance.

To configure that SR-TE policies created with a specific SR-TE auto policy template are first attempted to be created in a specific IS-IS instance:

**Command syntax: igp-instance isis [isis-instance-name]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Note**
- ISIS is by default preferred over OSPF as a required IGP instance.

**Parameter table**

+--------------------+---------------------+-------+---------+
| Parameter          | Description         | Range | Default |
+====================+=====================+=======+=========+
| isis-instance-name | IS-IS instance name | \-    | \-      |
+--------------------+---------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# igp-instance isis instance_1


**Removing Configuration**

To revert the igp-instance to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no igp-instance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/igp-instance_ospf.rst

protocols segment-routing mpls auto-policy template color igp-instance ospf
---------------------------------------------------------------------------

**Minimum user role:** operator

By default, the SR-TE policies created with auto policy templates are created with the lowest administrative-distance IGP instance.

To configure that SR-TE policies created with a specific SR-TE auto policy template are first attempted to be created in a specific OSPF instance:

**Command syntax: igp-instance ospf [ospf-instance-name]** area [area]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Note**
- ISIS is by default preferred over OSPF as a required IGP instance.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ospf-instance-name | OSPFv2 instance name                                                             | \-    | \-      |
+--------------------+----------------------------------------------------------------------------------+-------+---------+
| area               | The desired OSPF area for the desired OSPF instance in which SR-TE policy should | \-    | \-      |
|                    | be constructed                                                                   |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# igp-instance ospf instance_1
    dnRouter(cfg-mpls-auto-policy-color-3)# igp-instance ospf instance_1 area 0


**Removing Configuration**

To revert the igp-instance to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no igp-instance

To remove the OSPF igp-instance:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no igp-instance ospf instance_1

To revert the desired OSPF area to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no igp-instance ospf instance_1 area 0

**Command History**

+---------+--------------------------------------+
| Release | Modification                         |
+=========+======================================+
| 18.2    | Command introduced                   |
+---------+--------------------------------------+
| 19.2    | Add optional ospf area configuration |
+---------+--------------------------------------+

---

### mpls/auto-policy/template/no-fallback-dis.rst

protocols segment-routing mpls auto-policy template color no-fallback disabled
------------------------------------------------------------------------------

**Minimum user role:** operator

Once no-fallback is enabled for an auto-policy template, if all the policy paths associated with the policies created by the template are found to be invalid, leaving the SR-TE with no policy solution to install. Then SR-TE will install a policy to null0 (drop) to the RIB.
As a result there will be no fallback in the RIB for resolving traffic on a different route, if the policy is the best match for both destination and color.

To enable no-fallback:

**Command syntax: no-fallback disabled**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Note**
- While creating an auto policy, even with the no-fallback option set, in the interim period until such policy is created, DNOS will attempt to resolve over mpls-nh algo0.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# no-fallback disabled


**Removing Configuration**

To revert the no-fallback to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no no-fallback

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 18.2    | Command introduced            |
+---------+-------------------------------+
| TDB     | disqualify-color-routes added |
+---------+-------------------------------+

---

### mpls/auto-policy/template/no-fallback-ena.rst

protocols segment-routing mpls auto-policy template color no-fallback enabled
-----------------------------------------------------------------------------

**Minimum user role:** operator

Once no-fallback is enabled for an auto-policy template, if all the policy paths associated with the policies created by the template are found to be invalid, leaving the SR-TE with no policy solution to install. Then SR-TE will install a policy to null0 (drop) to the RIB.
As a result there will be no fallback in the RIB for resolving traffic on a different route, if the policy is the best match for both destination and color.
Once disqualify-color-routes is set, the no-fallback route in color-mpls-nh or color-mpls-nh-ipv6 table will be considered unreachable.
As result, colored bgp routes resolved over matching color nexthop will be considered unreachable and will not be accepted

To enable no-fallback:

**Command syntax: no-fallback enabled** disqualify-color-routes

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Note**
- While creating an auto policy, even with the no-fallback option set, in the interim period until such policy is created, DNOS will attempt to resolve over mpls-nh algo0.

**Parameter table**

+-------------+-----------------------------------------------------------------------+-------+---------+
| Parameter   | Description                                                           | Range | Default |
+=============+=======================================================================+=======+=========+
| admin-state | Set policy to disqualify color routes matching this no-fallback route | \-    | \-      |
+-------------+-----------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# no-fallback
    dnRouter(cfg-mpls-auto-policy-color-3)# no-fallback enabled disqualify-color-routes


**Removing Configuration**

To revert the no-fallback to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no no-fallback

To revert the disqualify-color-routes to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no no-fallback enabled disqualify-color-routes

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 18.2    | Command introduced            |
+---------+-------------------------------+
| TDB     | disqualify-color-routes added |
+---------+-------------------------------+

---

### mpls/auto-policy/template/no-fallback.rst

protocols segment-routing mpls auto-policy template color no-fallback
---------------------------------------------------------------------

**Minimum user role:** operator

Once no-fallback is enabled for an auto-policy template, if all the policy paths associated with the policies created by the template are found to be invalid, leaving the SR-TE with no policy solution to install. Then SR-TE will install a policy to null0 (drop) to the RIB.
As a result there will be no fallback in the RIB for resolving traffic on a different route, if the policy is the best match for both destination and color.
Once disqualify-color-routes is set, the no-fallback route in color-mpls-nh or color-mpls-nh-ipv6 table will be considered unreachable.
As result, colored bgp routes resolved over matching color nexthop will be considered unreachable and will not be accepted

To enable no-fallback:

**Command syntax: no-fallback [admin-state]** disqualify-color-routes

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Note**
- While creating an auto policy, even with the no-fallback option set, in the interim period until such policy is created, DNOS will attempt to resolve over mpls-nh algo0.

**Parameter table**

+-------------+-----------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                           | Range        | Default  |
+=============+=======================================================================+==============+==========+
| admin-state | Set policy to drop traffic in no valid path is found                  | | enabled    | disabled |
|             |                                                                       | | disabled   |          |
+-------------+-----------------------------------------------------------------------+--------------+----------+
| admin-state | Set policy to disqualify color routes matching this no-fallback route | \-           | \-       |
+-------------+-----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# no-fallback enabled
    dnRouter(cfg-mpls-auto-policy-color-3)# no-fallback enabled disqualify-color-routes


**Removing Configuration**

To revert the no-fallback to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no no-fallback

To revert the disqualify-color-routes to its default value:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no no-fallback NO-FALLBACK disqualify-color-routes

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 18.2    | Command introduced            |
+---------+-------------------------------+
| TDB     | disqualify-color-routes added |
+---------+-------------------------------+

---

### mpls/auto-policy/template/path/lock.rst

protocols segment-routing mpls auto-policy template color path lock
-------------------------------------------------------------------

**Minimum user role:** operator

Set the lock timer (in seconds) over a given candidate path to prevent path replacement in when a better candidate path is found valid.
The operator may use lock logic to prevent frequent policy path changes.
- The value '0' (default behavior) result is that the candidate path is replaced from installed as an active path as soon as a better candidate path is found valid.
- The values '1..65535' results are that the candidate path is replaced from installed as active, only once it was in used for the duration of the lock timer or once found to be invalid.
- The value 'until-invalid' result is that the candidate path is replaced only once found to be invalid.


To configure the lock timer for the SR-TE path:


**Command syntax: lock [lock]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color path

**Note**

- The lock does not prevent a backup path from becoming active if the active path fails.

- The lock timer starts upon the path installed as active. The path update does not reset the lock timer.

- Reconfig of the lock timer only applies to the next time the lock is set.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| lock      | Set a lock over a given candidate path to prevent path replacement in case a     | \-    | 0       |
|           | better candidate path found valid to use                                         |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# path PATH_1 priority 5
    dnRouter(cfg-auto-policy-color-3-path)#lock 30

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# path PATH_1 priority 5
    dnRouter(cfg-auto-policy-color-3-path)# lock until-invalid


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-sr-mpls-policy)# no lock

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/path/path.rst

protocols segment-routing mpls auto-policy template color path
--------------------------------------------------------------

**Minimum user role:** operator

To configure a path:

**Command syntax: path [path]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Note**
- A path is not a mandatory configuration for auto-policies. If no paths are configured, then algo0 SPF algorithm will be used to resolve the destination.

**Parameter table**

+-----------+---------------------------+------------------+---------+
| Parameter | Description               | Range            | Default |
+===========+===========================+==================+=========+
| path      | segment-routing path name | | string         | \-      |
|           |                           | | length 1-255   |         |
+-----------+---------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# path PATH_1
    dnRouter(cfg-auto-policy-color-3-path)#


**Removing Configuration**

To remove a path:
::

    dnRouter(cfg-mpls-auto-policy-color-3)# no path PATH_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/path/priority.rst

protocols segment-routing mpls auto-policy template color path priority
-----------------------------------------------------------------------

**Minimum user role:** operator

To configure a path priority:

**Command syntax: priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color path

**Parameter table**

+-----------+----------------------------+-------+---------+
| Parameter | Description                | Range | Default |
+===========+============================+=======+=========+
| priority  | SR-TE policy path priority | 1-255 | \-      |
+-----------+----------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# path PATH_1
    dnRouter(cfg-auto-policy-color-3-path)# priority 5
    dnRouter(cfg-auto-policy-color-3-path)#


**Removing Configuration**

To remove a priority:
::

    dnRouter(cfg-auto-policy-color-3-path)# no priority

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/seamless-bfd/admin-state.rst

protocols segment-routing mpls auto-policy template color seamless-bfd admin-state
----------------------------------------------------------------------------------

**Minimum user role:** operator

When disabled, the S-BFD session(s) will not be initiated on for auto-policies created with this template.

To enable/disable the S-BFD session(s):

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color seamless-bfd

**Parameter table**

+-------------+------------------------------+--------------+----------+
| Parameter   | Description                  | Range        | Default  |
+=============+==============================+==============+==========+
| admin-state | S-BFD Session(s) admin state | | enabled    | disabled |
|             |                              | | disabled   |          |
+-------------+------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# seamless-bfd
    dnRouter(cfg-auto-policy-color-3-sbfd)# admin-state enabled


**Removing Configuration**

To return the admin-state to its default value:
::

    dnRouter(cfg-auto-policy-color-3-sbfd) no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/seamless-bfd/failure-action.rst

protocols segment-routing mpls auto-policy template color seamless-bfd failure-action
-------------------------------------------------------------------------------------

**Minimum user role:** operator

Configure the failure-action to be performed when the S-BFD session fails. If 'down' - then the state of all auto-policies created with this template will be set to down if the S-BFD session fails. If it is 'none' then the SR-TE state of all auto-policies created with this template will not be affected by the S-BFD state.

**Command syntax: failure-action [failure-action]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color seamless-bfd

**Parameter table**

+----------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter      | Description                                                                      | Range    | Default |
+================+==================================================================================+==========+=========+
| failure-action | Define whether failure of the S-BFD session will bring the SR-TE state 'down' or | | down   | down    |
|                | not affect it                                                                    | | none   |         |
+----------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# seamless-bfd
    dnRouter(cfg-auto-policy-color-3-sbfd)# failure-action none


**Removing Configuration**

To return the failure-action to its default value:
::

    dnRouter(cfg-auto-policy-color-3-sbfd) no failure-action

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/seamless-bfd/interval.rst

protocols segment-routing mpls auto-policy template color seamless-bfd interval
-------------------------------------------------------------------------------

**Minimum user role:** operator

Configure the interval value for the S-BFD session.

**Command syntax: interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color seamless-bfd

**Parameter table**

+-----------+---------------------------------------------------+--------+---------+
| Parameter | Description                                       | Range  | Default |
+===========+===================================================+========+=========+
| interval  | set desired interval (msec) for the S-BFD session | 5-1700 | 300     |
+-----------+---------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# seamless-bfd
    dnRouter(cfg-auto-policy-color-3-sbfd)# interval 6


**Removing Configuration**

To remove the interval and return to its default value:
::

    dnRouter(cfg-auto-policy-color-3-sbfd) no interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/seamless-bfd/multiplier.rst

protocols segment-routing mpls auto-policy template color seamless-bfd multiplier
---------------------------------------------------------------------------------

**Minimum user role:** operator

Configure a Multiplier value which will be used for the S-BFD session.

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color seamless-bfd

**Parameter table**

+------------+----------------------------+-------+---------+
| Parameter  | Description                | Range | Default |
+============+============================+=======+=========+
| multiplier | set local S-BFD multiplier | 2-16  | 3       |
+------------+----------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)# seamless-bfd
    dnRouter(cfg-auto-policy-color-3-sbfd)# multiplier 5


**Removing Configuration**

To remove the multiplier value:
::

    dnRouter(cfg-auto-policy-color-3-sbfd) no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/seamless-bfd/seamless-bfd.rst

protocols segment-routing mpls auto-policy template color seamless-bfd
----------------------------------------------------------------------

**Minimum user role:** operator

To configure the seamless-bfd session that will be applied on the path(s) of the policy

**Command syntax: seamless-bfd**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy template color

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)#


**Removing Configuration**

To remove the seamless-bfd sessions on the SR policy:
::

    dnRouter(cfg-sr-mpls-policy)# no seamless-bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.0    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/template/template.rst

protocols segment-routing mpls auto-policy template color
---------------------------------------------------------

**Minimum user role:** operator

To create SR-TE auto policy templates for Segment-Routing policies that will be created automatically upon requests matching the color:

**Command syntax: template color [color]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy

**Note**
- Two policies from the same head to the same tail with the same color cannot exist, regardless of their origin.
- Deletion of the auto-policy templates will delete the associated policies created by these templates.
- For each SR-TE policy created by auto-policy template and BGP on-demand logic, policy will have a dynamic Binding-SID label, which is allocated from the system dynamic label range

**Parameter table**

+-----------+----------------------+--------------+---------+
| Parameter | Description          | Range        | Default |
+===========+======================+==============+=========+
| color     | SR auto-policy color | 0-4294967295 | \-      |
+-----------+----------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# template color 3
    dnRouter(cfg-mpls-auto-policy-color-3)#


**Removing Configuration**

To remove a specific auto policy template:
::

    dnRouter(cfg-sr-mpls-auto-policy)# no template color 3

To remove all configured auto policy templates:
::

    dnRouter(cfg-sr-mpls-auto-policy)# no template

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/timers/delete-delay.rst

protocols segment-routing mpls auto-policy timers delete-delay
--------------------------------------------------------------

**Minimum user role:** operator

The global delete delay timer serves as a retention mechanism to minimize flapping and free resources for policies created with SR-TE auto policy templates.
Once the last route associated with a given [NH, color] is withdrawn from BGP, then the delay-timer will start. Upon its expiration when there are no more applicable routes, the auto policy will be deleted automatically.

To configure the global SR-TE auto policy delete delay timer:


**Command syntax: delete-delay [delete-delay]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy timers

**Note**
- Once the delay timer starts and until it expires, the auto policy state is managed per the SR-TE policy state machine as any other policy.

**Parameter table**

+--------------+---------------------------------------------------+---------+---------+
| Parameter    | Description                                       | Range   | Default |
+==============+===================================================+=========+=========+
| delete-delay | Global timer to trigger deletion of auto-policies | 0-86400 | 120     |
+--------------+---------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# timers
    dnRouter(cfg-mpls-auto-policy-timers)# delete-delay 300


**Removing Configuration**

To revert the SR-TE auto policy global delete delay timer to its default value:
::

    dnRouter(cfg-mpls-auto-policy-timers)# no delete-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/auto-policy/timers/timers.rst

protocols segment-routing mpls auto-policy timers
-------------------------------------------------

**Minimum user role:** operator

To enter the SR-TE auto policy global timers configuration hierarchy:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls auto-policy

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# auto-policy
    dnRouter(cfg-sr-mpls-auto-policy)# timers
    dnRouter(cfg-mpls-auto-policy-timers)#


**Removing Configuration**

To remove all configured auto-policy global timers configuration to default:
::

    dnRouter(cfg-sr-mpls-auto-policy)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/backup-path-install.rst

protocols segment-routing mpls backup-path-install
--------------------------------------------------

**Minimum user role:** operator

When a backup-install-path is set for a given policy, DNOS picks the next (lower) preference valid candidate path as the backup for the active candidate path.
The backup path is installed to a FIB to provide a sub 50 msec failover upon active path failure.

To enable end to end protecition and support backup path installation:


**Command syntax: backup-path-install [backup-path-install]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Note**
- For policy to have a backup path , at least two paths needs to be configured for policy (no commit validation required)
- Each path , both active and backup is fully defined by its path settings. There is no implicit disjoint constraint between them.


**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter           | Description                                                                      | Range        | Default  |
+=====================+==================================================================================+==============+==========+
| backup-path-install | Utilize lower preference candidate path as policy end to end back path installed | | enabled    | disabled |
|                     | to RIB and FIB                                                                   | | disabled   |          |
+---------------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# backup-path-install enabled


**Removing Configuration**

To return the backup-path-install setting to its default value:
::

    dnRouter(cfg-protocols-igp-mpls)# no backup-path-install

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/flex-algo/advertise-definition/admin-group_exclude.rst

protocols segment-routing mpls flex-algo advertise-definition admin-group exclude
---------------------------------------------------------------------------------

**Minimum user role:** operator

A link is pruned from the Flex-Algo topology if the link has any admin-group value that matches the admin-group-exclude values.
To configure an admin-group exclude constraint:

**Command syntax: admin-group exclude [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls flex-algo advertise-definition

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from flex-algo topology if link has any admin-group value that      | | string         | \-      |
|                  | match the admin-group-exclude values                                             | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# flex-algo
    dnRouter(cfg-sr-mpls-flex-algo)# advertise-definition MIN_DELAY_130
    dnRouter(cfg-mpls-flex-algo-fad)# admin-group exclude RED,GREEN


**Removing Configuration**

To remove a specific admin-group exclude configuration:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no admin-group exclude RED

To remove all admin-group exclude configuration:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no admin-group exclude

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### mpls/flex-algo/advertise-definition/admin-group_include-all.rst

protocols segment-routing mpls flex-algo advertise-definition admin-group include-all
-------------------------------------------------------------------------------------

**Minimum user role:** operator

A link is pruned from the Flex-Algo topology if the link doesn't match all admin-group values that are in the admin-group-include-all values.
To configure an admin-group include-all constraint:

**Command syntax: admin-group include-all [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls flex-algo advertise-definition

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from flex-algo topology if link don't match all admin-group values  | | string         | \-      |
|                  | that are in the admin-group-include-all values                                   | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# flex-algo
    dnRouter(cfg-sr-mpls-flex-algo)# advertise-definition MIN_DELAY_130
    dnRouter(cfg-mpls-flex-algo-fad)# admin-group include-all RED,GREEN


**Removing Configuration**

To remove a specific admin-group include-all configuration:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no admin-group include-all RED

To remove all admin-group include-all configuration:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no admin-group include-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### mpls/flex-algo/advertise-definition/admin-group_include-any.rst

protocols segment-routing mpls flex-algo advertise-definition admin-group include-any
-------------------------------------------------------------------------------------

**Minimum user role:** operator

A link is pruned from the Flex-Algo topology if the link doesn't match any admin-group values that are in the admin-group-include-any values.
To configure an admin-group include-any constraint:

**Command syntax: admin-group include-any [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls flex-algo advertise-definition

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from flex-algo topology if link don't match any admin-group value   | | string         | \-      |
|                  | that is in the admin-group-include-any values                                    | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# flex-algo
    dnRouter(cfg-sr-mpls-flex-algo)# advertise-definition MIN_DELAY_130
    dnRouter(cfg-mpls-flex-algo-fad)# admin-group include-any RED,GREEN


**Removing Configuration**

To remove a specific admin-group include-any configuration:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no admin-group include-any RED

To remove all admin-group include-any configuration:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no admin-group include-any

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### mpls/flex-algo/advertise-definition/advertise-definition.rst

protocols segment-routing mpls flex-algo advertise-definition
-------------------------------------------------------------

**Minimum user role:** operator

To guarantee the loop-free forwarding for paths computed for a particular flex-algorithm, all the routers that are configured to participate in a particular flex-algorithm, must agree on the definition of the flex-algorithm.
The flex-algorithm definition is a set of contstraints from which the IGP topology is derived and how the path calculation is expected.
Different routers in the Flex-Algo domain can advertise a flex-algorithm definition, according to tie-breaking logic definition of a specific router that is selected to be used 
among all participating routers.
To configure a Flex-Algo definition profile with constraint set and enter its configuration mode:

**Command syntax: advertise-definition [Flex-Algo Definition Name]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls flex-algo

**Parameter table**

+---------------------------+----------------------------------------+------------------+---------+
| Parameter                 | Description                            | Range            | Default |
+===========================+========================================+==================+=========+
| Flex-Algo Definition Name | flex algorithm definition profile name | | string         | \-      |
|                           |                                        | | length 1-255   |         |
+---------------------------+----------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# flex-algo
    dnRouter(cfg-sr-mpls-flex-algo)# advertise-definition MIN_DELAY_130
    dnRouter(cfg-mpls-flex-algo-fad)#


**Removing Configuration**

To remove the advertise-definition configuration:
::

    dnRouter(cfg-sr-mpls-flex-algo)# no advertise-definition MIN_DELAY_130

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### mpls/flex-algo/advertise-definition/exclude-srlg.rst

protocols segment-routing mpls flex-algo advertise-definition exclude-srlg
--------------------------------------------------------------------------

**Minimum user role:** operator

A link is pruned if the link has any srlg value that matches the exclude-srlg values. The srlg value is per RFC5307.
To configure an exclude-srlg constraint:

**Command syntax: exclude-srlg [srlg-value]** [, srlg-value, srlg-value]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls flex-algo advertise-definition

**Parameter table**

+------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter  | Description                                                                      | Range        | Default |
+============+==================================================================================+==============+=========+
| srlg-value | link is prun if link has any srlg value that match the exclude-srlg values. srlg | 1-4294967295 | \-      |
|            | value per RFC5307                                                                |              |         |
+------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# flex-algo
    dnRouter(cfg-sr-mpls-flex-algo)# advertise-definition MIN_DELAY_130
    dnRouter(cfg-mpls-flex-algo-fad)# exclude-srlg 2,50


**Removing Configuration**

To remove a specific exclude-srlg configuration:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no exclude-srlg 50

To remove all exclude-srlg configuration:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no exclude-srlg

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### mpls/flex-algo/advertise-definition/metric-type.rst

protocols segment-routing mpls flex-algo advertise-definition metric-type
-------------------------------------------------------------------------

**Minimum user role:** operator


Metric-type indicates which is the corresponding metric to be used for this algorithm in path calculations.
igp - IGP metric is used during the calculation. IGP is a default metric-type.
link-delay - Min Unidirectional Link Delay as defined in [RFC7810] is used during the calculation.
te - TE default metric as defined in [RFC5305] is used during the calculation.
To configure metric-type behavior:

**Command syntax: metric-type [metric-type]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls flex-algo advertise-definition

**Parameter table**

+-------------+----------------------------------------------------------------------------------+----------------+---------+
| Parameter   | Description                                                                      | Range          | Default |
+=============+==================================================================================+================+=========+
| metric-type | Indicates which is the corresponding metric type for this algorithm, default is  | | igp          | igp     |
|             | IGP                                                                              | | link-delay   |         |
|             |                                                                                  | | te           |         |
+-------------+----------------------------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# flex-algo
    dnRouter(cfg-sr-mpls-flex-algo)# advertise-definition MIN_DELAY_130
    dnRouter(cfg-mpls-flex-algo-fad)# metric-type te


**Removing Configuration**

To revert metric-type to default behavior:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no metric-type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### mpls/flex-algo/advertise-definition/prefix-metric.rst

protocols segment-routing mpls flex-algo advertise-definition prefix-metric
---------------------------------------------------------------------------

**Minimum user role:** operator

Set prefix metric flag in flex algorithm definition. When set, specific prefix and ASBR metric must be used for inter-area end external prefix calculation. If specific metric is not provided (Flexible Algorithm Prefix Metric Sub-TLV type 3) inter-area/external prefix will be rejected from flex-algo topology
For ISIS inter-area prefix are propagated prefixes from Level-2 to Level-1
For OSPF inter-area prefix are summary prefixes advertised by ABR
For ISIS & OSPF, external prefixes are redistributed prefixes

**Command syntax: prefix-metric [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls flex-algo advertise-definition

**Note**

- the FAD's prefix metric option is a shared feature between OSPF and ISIS; When configuring the prefix metric it will be set for both OSPF and ISIS, and while this is not yet implemented in ISIS, ISIS will ignore this option with no side-effects.

**Parameter table**

+-------------+--------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                              | Range        | Default  |
+=============+==========================================================================+==============+==========+
| admin-state | Set prefix metric flag in flex algorithm definition, default is disabled | | enabled    | disabled |
|             |                                                                          | | disabled   |          |
+-------------+--------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# flex-algo
    dnRouter(cfg-sr-mpls-flex-algo)# advertise-definition MIN_DELAY_130
    dnRouter(cfg-mpls-flex-algo-fad)# prefix-metric enabled


**Removing Configuration**

To revert prefix-metric to default behavior:
::

    dnRouter(cfg-mpls-flex-algo-fad)# no prefix-metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/flex-algo/flex-algo.rst

protocols segment-routing mpls flex-algo
----------------------------------------

**Minimum user role:** operator

Flex-Algo allows IGP constraint-based computation and creates separate IGP algorithms according to the defined set of constraints and metric types.
It compliments the SR-TE solution by adding new prefix segments with specific optimization objectives and constraints. 
- Metric types: Minimize IGP-metric, te-metric, or delay. 
- Exclude certain SRLGs, include/exclude link admin groups. 

Flex-Algo allows calculating constrained-based network paths, with no SR policies, and no TE tunnels.
- Outgoing packets arent comprised of multiple transport labels as in SR policies  the label stack is minimal, while a constraint path is used. Each PE in a certain Flex-Algo topology can send traffic to each PE using a single transport label.
- No need for SR Policy per destination  each node participating in the required Flex-Algo is a destination potential PE, and is applicable to be reached by all other PEs of that specific Flex-Algo.
- Simplicity, automation  automated steering, ODN steering according to color, TI-LFA per Flex-Algo, etc.

By default, an IGP uses the Algorithm 0 - Shortest Path First (SPF). 

To configure the flexible algorithm, enter the Flex-Algo configuration mode:

**Command syntax: flex-algo**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Note**

- Enabling participant in flex-algorithm topology is under ISIS/OSPF protocol configuration

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# flex-algo
    dnRouter(cfg-sr-mpls-flex-algo)#


**Removing Configuration**

To revert all flex-algo configurations to default:
::

    dnRouter(cfg-protocols-sr-mpls)# no flex-algo

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+

---

### mpls/igp-shortcuts.rst

protocols segment-routing mpls igp-shortcuts
--------------------------------------------

**Minimum user role:** operator

IGP shortcuts (IGP-SC) allow the IGP to install routes to indirect destination in the MPLS-NH table in addition to the destination. IGP takes all the destinations in its internal routing table and treats them as if they were directly connected to the local router, thus recreating its topology.
When enabled, an IGP configured with SR extensions will use the SR-TE policy information to calculate a new IGP-MPLS topology, where the SR-TE policies are considered as next-hop for resolution of IGP routes. This makes the SIDs "behind" the SR-TE policy destination reachable using the segment-routing policy.
IGP-Shortcuts results in installing both FTN route and ILM routes using SR-TE policies as next-hops:

	For FEC-To-NHLFE (FTN) routes, a route is the prefix for which a shortcut was calculated.
	For Incoming Label Map (ILM) routes, in-label is the matching route SPF prefix-sid, and the next-hop is via SR-TE policy. 

Only policies enabled with a destination-rib that is "mpls-forwarding" or "both" are valid for use as next-hops in shortcuts for ILM routes. If no valid policy next-hop is found, no route will be installed.

To enable or disable the use of a segment-routing policy as shortcuts in calculating segment-routing paths:


**Command syntax: igp-shortcuts [sr-shortcuts]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Note**
- This command may be also be invoked inside mesh-group peer or inside default-peer configuration hierarchy.

- The hold-time timer must be greater than the igp-shortcuts timer. The user is warned in case the igp-shortcuts timer is greater or equal to hold-time.


**Parameter table**

+--------------+-------------------------------------------------------------------+--------------+----------+
| Parameter    | Description                                                       | Range        | Default  |
+==============+===================================================================+==============+==========+
| sr-shortcuts | Configure usage of SR policy as shortcuts in calculating SR paths | | enabled    | disabled |
|              |                                                                   | | disabled   |          |
+--------------+-------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# igp-shortcuts enabled


**Removing Configuration**

To return the igp-shortcuts setting to its default value:
::

    dnRouter(cfg-protocols-igp-mpls)# no igp-shortcuts

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/mapping-server/mapping-server.rst

protocols segment-routing mpls mapping-server
---------------------------------------------

**Minimum user role:** operator

When the router is enabled as a mapping server, it maintains a mapping of prefixes and their SIDs. This is useful for allocating SIDs for Prefixes outside the segment-routing domain, for example prefixes of nodes in the IS-IS domain running only LDP and not segment-routing.

To enter the segment-routing mapping-server configuration hierarchy:

**Command syntax: mapping-server**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# mapping-server
    dnRouter(cfg-sr-mpls-mapping)#


**Removing Configuration**

To remove all mapping configuration:
::

    dnRouter(cfg-protocols-sr-mpls)# no mapping-server

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/mapping-server/prefix-sid-map.rst

protocols segment-routing mpls mapping-server prefix-sid-map
------------------------------------------------------------

**Minimum user role:** operator

To configure a prefix to SID mapping. This mapping is advertised as a binding-SID when the router acts as a mapping server.

To configure a prefix to SID mapping:

**Command syntax: prefix-sid-map [prefix-sid-mapping] [start-sid]** range [range] s-flag [s-flag]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls mapping-server

**Note**
- Require commit validation that all prefix-sid are in the SRGB range

- Require commit validation that mapping policy doesn't include overlapping prefixes that assigned different labels. e.g

  - 20.1.1.0/24 16000 range 10

  - 20.1.2.0/24 16005 range 1

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+----------------+----------+
| Parameter          | Description                                                                      | Range          | Default  |
+====================+==================================================================================+================+==========+
| prefix-sid-mapping | ip prefix                                                                        | | A.B.C.D/x    | \-       |
|                    |                                                                                  | | X:X::X:X/x   |          |
+--------------------+----------------------------------------------------------------------------------+----------------+----------+
| start-sid          | SID index value associated with prefix. The value must be interpreted in the     | 0-999999       | \-       |
|                    | context of value-type.                                                           |                |          |
+--------------------+----------------------------------------------------------------------------------+----------------+----------+
| range              | Describes how many SIDs could be allocated.                                      | 1-65535        | 1        |
+--------------------+----------------------------------------------------------------------------------+----------------+----------+
| s-flag             | control if s-flag is enabled (set) or disabled (unset) for the binding-sid tlv.  | | enabled      | disabled |
|                    | Enable s-flag to allow routers in the network to propagate binding-sids between  | | disabled     |          |
|                    | ISIS levels.                                                                     |                |          |
+--------------------+----------------------------------------------------------------------------------+----------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protcols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# mapping-server
    dnRouter(cfg-sr-mpls-mapping)# prefix-sid-map 101.0.0.1/32 1000 range 100
    dnRouter(cfg-sr-mpls-mapping)# prefix-sid-map 101.0.2.1/32 10250 range 5
    dnRouter(cfg-sr-mpls-mapping)# prefix-sid-map 101.0.3.1/32 10300
    dnRouter(cfg-sr-mpls-mapping)# prefix-sid-map 101.0.4.1/32 10400 s-flag enabled

    dnRouter# configure
    dnRouter(cfg)# protcols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# mapping-server
    dnRouter(cfg-sr-mpls-mapping)# prefix-sid-map 101::1/128 1000 range 100
    dnRouter(cfg-sr-mpls-mapping)# prefix-sid-map 101::2:1/128 10250 range 5
    dnRouter(cfg-sr-mpls-mapping)# prefix-sid-map 101::3:1/128 10300
    dnRouter(cfg-sr-mpls-mapping)# prefix-sid-map 101::4:1/128 10400 s-flag enabled


**Removing Configuration**

To remove prefix-mapping:
::

    dnRouter(cfg-sr-mpls-mapping)# no prefix-sid-map 101.0.0.1/32

**Command History**

+---------+-------------------------+
| Release | Modification            |
+=========+=========================+
| 15.0    | Command introduced      |
+---------+-------------------------+
| 18.3    | Add ipv6 prefix support |
+---------+-------------------------+

---

### mpls/mpls.rst

protocols segment-routing mpls
------------------------------

**Minimum user role:** operator

Segment routing is a mechanism for source-based packet forwarding, where the source router pre-selects a path to the destination and encodes it in the packet header as an ordered list of segments. A segment is an instruction consisting of a flat unsigned 20-bit identifier (the segment ID  SID) and is encoded as an MPLS label. The interior gateway protocol (IGP) distributes two types of segments: prefix SIDs and adjace ncy SIDs. The segment routing configuration level allows you to configure the segment routing global block (SRGB) and local block (SRLB) that will be used by the router. Every node in the domain will receive a node SID from the global block, and every adjacency formed by each router receives a SID from the router's local block.

In the following example, the global-block is from 16000 to 23999, and so all nodes within the domain receive a node SID within this range. Each node is configured with an SRLB range, and so every adjacency formed by that node receives an adjacency SID from within the configured local block.


**Command syntax: mpls**

**Command mode:** config

**Hierarchies**

- protocols segment-routing

**Note**
- The SRGB and SRLB ranges affect the label pools assigned to other MPLS protocols such as RSVP, BGP, and LDP label pools.


**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)#


**Removing Configuration**

To remove the mpls segment-routing configuration:
::

    dnRouter(cfg-protocols-sr)# no mpls

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/adj-sid-protection.rst

protocols segment-routing mpls path dynamic constraints adj-sid-protection
--------------------------------------------------------------------------

**Minimum user role:** operator

When a dynamic calculated path require to use adjacency-sid over the label stack for a given link hop, there may be multiple possible adj-sid possbile differs by protection entitlement.
To configure adjacency sid protection preference:

**Command syntax: adj-sid-protection [srlg-value]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Note**

- By default prefer adjacency-sids that are eligable for protection

**Parameter table**

+------------+--------------------------------------------+---------------------------+---------+
| Parameter  | Description                                | Range                     | Default |
+============+============================================+===========================+=========+
| srlg-value | adjacency sid protection preference config | | desired                 | desired |
|            |                                            | | mandatory               |         |
|            |                                            | | unprotected-desired     |         |
|            |                                            | | unprotected-mandatory   |         |
+------------+--------------------------------------------+---------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# adj-sid-protection mandatory


**Removing Configuration**

To revert adj-sid-protection to default value:
::

     dnRouter(cfg-path-dynamic-constraints)# no adj-sid-protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/admin-group_exclude.rst

protocols segment-routing mpls path dynamic constraints admin-group exclude
---------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in dynamic path if the link has any admin-group value that matches the admin-group-exclude values.
To configure a admin-group exclude constraint:

**Command syntax: admin-group exclude [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from dynamic-path if link has any admin-group value that match the  | | string         | \-      |
|                  | admin-group-exclude values                                                       | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# admin-group exclude RED,GREEN


**Removing Configuration**

To remove a specific admin-group exclude configuration:
::

    dnRouter(cfg-path-dynamic-constraints)# no admin-group exclude RED

To remove all admin-group exclude configuration:
::

    dnRouter(cfg-path-dynamic-constraints)# no admin-group exclude

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/admin-group_include-all.rst

protocols segment-routing mpls path dynamic constraints admin-group include-all
-------------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in dynamic path if the link doesn't match all admin-group values that are in the admin-group-include-all values.
To configure a admin-group include-all constraint:

**Command syntax: admin-group include-all [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from dynamic-path if link don't match all admin-group values that   | | string         | \-      |
|                  | are in the admin-group-include-all values                                        | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# admin-group include-all RED,GREEN


**Removing Configuration**

To remove a specific admin-group include-all configuration:
::

    dnRouter(cfg-path-dynamic-constraints)# no admin-group include-all RED

To remove all admin-group include-all configuration:
::

    dnRouter(cfg-path-dynamic-constraints)# no admin-group include-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/admin-group_include-any.rst

protocols segment-routing mpls path dynamic constraints admin-group include-any
-------------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in dynamic path if the link doesn't match any admin-group values that are in the admin-group-include-any values.
To configure a admin-group include-any constraint:

**Command syntax: admin-group include-any [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from dynamic-path if link don't match any admin-group value that is | | string         | \-      |
|                  | in the admin-group-include-any values                                            | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# admin-group include-any RED,GREEN


**Removing Configuration**

To remove a specific admin-group include-any configuration:
::

    dnRouter(cfg-path-dynamic-constraints)# no admin-group include-any RED

To remove all admin-group include-any configuration:
::

    dnRouter(cfg-path-dynamic-constraints)# no admin-group include-any

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/algorithm.rst

protocols segment-routing mpls path dynamic constraints algorithm
-----------------------------------------------------------------

**Minimum user role:** operator

A dynamic path is calculated over a given topology. Operator can control over which flex-algo algorithm topology path will be calculated.
When path is calculated over a non algo 0 topology, SID usage for path label stack will match SIDs valid in that topology only, with exception of adjacency-sid usage.
To set desired algorithm:

**Command syntax: algorithm [srlg-value]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Note**

- Default algorithm to use is per policy configured destination sid algorithm

- When algorithm is configured for dynamic path, the Segement-Routing destination algorithm is ignored in path construction and only destination address is taken in to account

**Parameter table**

+------------+--------------------------------------------------------------+--------------+---------+
| Parameter  | Description                                                  | Range        | Default |
+============+==============================================================+==============+=========+
| srlg-value | topology algorithm overwhich dynamic path will be calculated | 0-1, 128-255 | \-      |
+------------+--------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# algorithm 128


**Removing Configuration**

To remove a algorithm configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no algorithm

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/constraints.rst

protocols segment-routing mpls path dynamic constraints
-------------------------------------------------------

**Minimum user role:** operator

To configure path constraints:

**Command syntax: constraints**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)#


**Removing Configuration**

To revert all dynamic path constraints configurations to default:
::

    dnRouter(cfg-mpls-path-dynamic)# no constraints

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/exclude-prefix-ipv4.rst

protocols segment-routing mpls path dynamic constraints exclude-prefix-ipv4
---------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid to be used in dynamic path if the link has any prefix value that matches the IPv4 exclude-prefix values.
A node is not valid to be used in dynamic path if the node has a prefix-sid in any algo that matches the excluded prefixes.
The exclusion of prefixes affects policies regardless of what algo the prefix
Excluded IPv4 prefixes will only affect IPv4 Policies.
To configure a IPv4 exclude-prefix constraint:

**Command syntax: exclude-prefix-ipv4 [prefix-value]** [, prefix-value, prefix-value]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Note**

- If the active IGP is OSPF, this constraint will have no effect on the resulting path.

**Parameter table**

+--------------+------------------------------------------------------------------------------+---------+---------+
| Parameter    | Description                                                                  | Range   | Default |
+==============+==============================================================================+=========+=========+
| prefix-value | link is pruned if nexthop node has address that match the IPv4 prefix values | A.B.C.D | \-      |
+--------------+------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# exclude-ipv4 1.1.1.1, 2.2.2.2


**Removing Configuration**

To remove a specific exclude-prefix-ipv4 configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no exclude-prefix-ipv4 1.1.1.1

To remove all exclude-prefix-ipv4 configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no exclude-prefix-ipv4

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/exclude-prefix-ipv6.rst

protocols segment-routing mpls path dynamic constraints exclude-prefix-ipv6
---------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid to be used in dynamic path if the link has any prefix value that matches the IPv6 exclude-prefix values.
A node is not valid to be used in dynamic path if the node has a prefix-sid in any algo that matches the excluded prefixes.
The exclusion of prefixes affects policies regardless of what algo the prefix
Excluded IPv6 prefixes will only affect IPv6 Policies.
To configure a IPv6 exclude-prefix constraint:

**Command syntax: exclude-prefix-ipv6 [prefix-value]** [, prefix-value, prefix-value]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Note**
If the active IGP is OSPF, this constraint will have no effect on the resulting path.

**Parameter table**

+--------------+------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                  | Range    | Default |
+==============+==============================================================================+==========+=========+
| prefix-value | link is pruned if nexthop node has address that match the IPv6 prefix values | X:X::X:X | \-      |
+--------------+------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# exclude-ipv6 1::1, 1::2


**Removing Configuration**

To remove a specific exclude-prefix-ipv6 configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no exclude-prefix-ipv6 1::1

To remove all exclude-prefix-ipv6 configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no exclude-prefix-ipv6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/exclude-prefix.rst

protocols segment-routing mpls path dynamic constraints exclude-prefix-ipv4
---------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in dynamic path if the link has any prefix value that matches the IPv4 exclude-prefix values. The prefix value is per RFC5307.
To configure a IPv4 exclude-prefix constraint:

**Command syntax: exclude-prefix-ipv4 [prefix-value]** [, prefix-value, prefix-value]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Parameter table**

+--------------+------------------------------------------------------------------------------+---------+---------+
| Parameter    | Description                                                                  | Range   | Default |
+==============+==============================================================================+=========+=========+
| prefix-value | link is prunes if nexthop node has address that match the IPv4 prefix values | A.B.C.D | \-      |
+--------------+------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# exclude-ipv4 1.1.1.1/32, 2.2.2.2/32
    dnRouter(cfg-path-dynamic-constraints)# exclude-ipv6 1::1/128, 1::2/128


**Removing Configuration**

To remove a specific exclude-prefix-ipv4 configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no exclude-prefix-ipv4 1.1.1.1/32

To remove all exclude-prefix-ipv4 configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no exclude-prefix-ipv4

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.1    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/exclude-srlg.rst

protocols segment-routing mpls path dynamic constraints exclude-srlg
--------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in dynamic path if the link has any srlg value that matches the exclude-srlg values. The srlg value is per RFC5307.
To configure a exclude-srlg constraint:

**Command syntax: exclude-srlg [srlg-value]** [, srlg-value, srlg-value]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Parameter table**

+------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter  | Description                                                                      | Range        | Default |
+============+==================================================================================+==============+=========+
| srlg-value | link is prun if link has any srlg value that match the exclude-srlg values. srlg | 1-4294967295 | \-      |
|            | value per RFC5307                                                                |              |         |
+------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# exclude-srlg 2,50


**Removing Configuration**

To remove a specific exclude-srlg configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no exclude-srlg 50

To remove all exclude-srlg configuration:
::

     dnRouter(cfg-path-dynamic-constraints)# no exclude-srlg

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/metric/limit/limit.rst

protocols segment-routing mpls path dynamic constraints metric limit
--------------------------------------------------------------------

**Minimum user role:** operator

To define an upper bound limit for a given metric type, which a dynamic calculated path must honor:

**Command syntax: limit [metric type]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints metric

**Parameter table**

+-------------+-------------------------------------------+----------------+---------+
| Parameter   | Description                               | Range          | Default |
+=============+===========================================+================+=========+
| metric type | metric type over which limits are imposed | | igp          | \-      |
|             |                                           | | link-delay   |         |
|             |                                           | | te           |         |
+-------------+-------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# metric
    dnRouter(cfg-dynamic-constraints-metric)# limit igp
    dnRouter(cfg-constraints-metric-limit)#


**Removing Configuration**

To remove the limit for a given metric type:
::

    dnRouter(cfg-dynamic-constraints-metric)# no limit igp

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/metric/limit/value.rst

protocols segment-routing mpls path dynamic constraints metric limit value
--------------------------------------------------------------------------

**Minimum user role:** operator


To set metric limit value:

**Command syntax: value [value]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints metric limit

**Parameter table**

+-----------+-----------------------------------+--------------+---------+
| Parameter | Description                       | Range        | Default |
+===========+===================================+==============+=========+
| value     | metric upper bound absolute value | 1-4294967295 | \-      |
+-----------+-----------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# metric
    dnRouter(cfg-dynamic-constraints-metric)# limit igp
    dnRouter(cfg-constraints-metric-limit)# value 200010


**Removing Configuration**

To remove value:
::

    dnRouter(cfg-constraints-metric-limit)# no value

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/metric/margin/absolute.rst

protocols segment-routing mpls path dynamic constraints metric margin absolute
------------------------------------------------------------------------------

**Minimum user role:** operator


To set absolute metric margin:

**Command syntax: absolute [absolute]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints metric margin

**Parameter table**

+-----------+-------------------------------------------------+--------------+---------+
| Parameter | Description                                     | Range        | Default |
+===========+=================================================+==============+=========+
| absolute  | margin by absolute value, per metric type units | 1-2147483647 | \-      |
+-----------+-------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# metric
    dnRouter(cfg-dynamic-constraints-metric)# margin
    dnRouter(cfg-constraints-metric-margin)# absolute 200


**Removing Configuration**

To remove absolute metric margin:
::

    dnRouter(cfg-constraints-metric-margin)# no absolute

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/metric/margin/margin.rst

protocols segment-routing mpls path dynamic constraints metric margin
---------------------------------------------------------------------

**Minimum user role:** operator


To support multiple paths of unequal cost, set allowed margin from overall best path (lowest cost):

**Command syntax: margin**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints metric

**Note**

- The allowed margin will be consumed first by hops that are closer to the source node Resulting that DNOS ECMP finding using margin will might be sub optimal and not find all possible paths that meet metric+margin constraint.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# metric
    dnRouter(cfg-dynamic-constraints-metric)# margin
    dnRouter(cfg-constraints-metric-margin)#


**Removing Configuration**

To revert all margin configurations to default:
::

    dnRouter(cfg-dynamic-constraints-metric)# no margin

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/metric/margin/relative.rst

protocols segment-routing mpls path dynamic constraints metric margin relative
------------------------------------------------------------------------------

**Minimum user role:** operator


To set metric margin as relative value from best path accumulated metric:

**Command syntax: relative [relative]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints metric margin

**Parameter table**

+-----------+-----------------------------------------------------+-------+---------+
| Parameter | Description                                         | Range | Default |
+===========+=====================================================+=======+=========+
| relative  | margin by relative percent above shortest path cost | 1-100 | \-      |
+-----------+-----------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# metric
    dnRouter(cfg-dynamic-constraints-metric)# margin
    dnRouter(cfg-constraints-metric-margin)# relative 10


**Removing Configuration**

To remove relative metric margin:
::

    dnRouter(cfg-constraints-metric-margin)# no relative

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/metric/metric.rst

protocols segment-routing mpls path dynamic constraints metric
--------------------------------------------------------------

**Minimum user role:** operator


To enter metric configuration level of dynamic path constraints and set metric related constraints:

**Command syntax: metric**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# metric
    dnRouter(cfg-dynamic-constraints-metric)#


**Removing Configuration**

To revert all dynamic path metric constraints configurations to default:
::

    dnRouter(cfg-path-dynamic-constraints)# metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/constraints/metric/type.rst

protocols segment-routing mpls path dynamic constraints metric type
-------------------------------------------------------------------

**Minimum user role:** operator


Metric-type indicates which is the corresponding metric to be used for shortest path calculation.
igp - IGP metric is used during the calculation.
link-delay - Min Unidirectional Link Delay as defined in [RFC7810] is used during the calculation.
te - TE default metric as defined in [RFC5305] is used during the calculation.
By default, DNOS will calculate best path according to metric type defined by used algorithm
To configure metric-type behavior:

**Command syntax: type [metric-type]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic constraints metric

**Parameter table**

+-------------+-------------------------------------------------------------------------+----------------+---------+
| Parameter   | Description                                                             | Range          | Default |
+=============+=========================================================================+================+=========+
| metric-type | Indicates which metric type to be used in lowest cost path calculations | | igp          | \-      |
|             |                                                                         | | link-delay   |         |
|             |                                                                         | | te           |         |
+-------------+-------------------------------------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# constraints
    dnRouter(cfg-path-dynamic-constraints)# metric
    dnRouter(cfg-dynamic-constraints-metric)# type te


**Removing Configuration**

To revert metric type to default behavior:
::

    dnRouter(cfg-dynamic-constraints-metric)# no type

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/dynamic.rst

protocols segment-routing mpls path dynamic
-------------------------------------------

**Minimum user role:** operator

With a dynamic path, DNOS will calculate an SR-TE path that matches the set of constraints desired by the user.
A dynmaic path is calculated towards the SR-TE policy destination and may include multiple segment-lists.
The dynamic path may be a fully strict hop by hop adjacency list, or a minimized SID list leveraging LSR node-sid forwarding.
To enter a dynamic path configuration level:


**Command syntax: dynamic**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)#


**Removing Configuration**

To revert all dynamic path configurations to default:
::

    dnRouter(cfg-sr-mpls-path)# no dynamic

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/maximum-segment-lists.rst

protocols segment-routing mpls path dynamic maximum-segment-lists
-----------------------------------------------------------------

**Minimum user role:** operator

Multiple different equal cost paths can be found, as a result of dynamic path calculations.
To choose how many paths to install for forwarding:


**Command syntax: maximum-segment-lists [maximum-segment-lists]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic

**Note**

- Multiple paths are defined by path differences of label-stack and/or nexthop.

- When stack compression is used, downstream forwarding ECMP may be achieved by transit LSR leveraging Node/Anycast-SID forwarding.

- All paths found that match the desired constraints and optimization requirement (such as min delay) will be considered equal cost for an ECMP selection (even when margin is used). As such, there is no preference in the RIB path selection if more paths are found in comparison with the allowed maximum-path.

**Parameter table**

+-----------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter             | Description                                                                      | Range | Default |
+=======================+==================================================================================+=======+=========+
| maximum-segment-lists | Number of Policy path segment-list ECMP to be installed to rib as result of      | 1-8   | 8       |
|                       | dynamic path calculations                                                        |       |         |
+-----------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# maximum-segment-lists 1


**Removing Configuration**

To return maximum-segment-lists to default value:
::

    dnRouter(cfg-mpls-path-dynamic)# no maximum-segment-lists

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/dynamic/no-stack-compression.rst

protocols segment-routing mpls path dynamic no-stack-compression
----------------------------------------------------------------

**Minimum user role:** operator

By default, the calculated dynamic path will utilize node-sid or anycast-sids to leverage transit LSR multi-path forwarding.
Usage of node-sid or anycast-sids is limited to cases where the LSR forwarding per given SID topology matches the required dynamic path constraints.
With no-stack-compression, the operator has the option to enforce the calculated dynamic path representation as a fully strict hop by hop adjacency-sid list.
To enable no-stack-compression:


**Command syntax: no-stack-compression [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path dynamic

**Note**

- If the dynamic path has no configured constraint or only has the algorithm constraint, the provided path is expected to be a single SID matching the policy destination pre required algorithm (i.e the spf / strict-spf / flex-algo route).

- The provided path SID solution will also include any uloop, lfa or ti-lfa solution that exists for the spf / strict-spf / flex-algo route.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | do not compress calculated path to use node/anycast-sids and provide paths as    | | enabled    | disabled |
|             | multiple full strict adj-sid label stacks                                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# dynamic
    dnRouter(cfg-mpls-path-dynamic)# no-stack-compression enabled


**Removing Configuration**

To return no-stack-compression to default behavior:
::

    dnRouter(cfg-mpls-path-dynamic)# no no-stack-compression

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/path.rst

protocols segment-routing mpls path
-----------------------------------

**Minimum user role:** operator

A segment-routing path can contain up to 8 segment-lists. Each segment-list defines a path according to the different segments (SIDs) specified for it. Multiple segment-lists within the same path can be used to apply weighted ECMP of traffic forwarding between the different segment-lists.

The path must be valid for a policy to be able to use it.

A path is valid if at least one segment-list with in it is valid. A segment-list is invalid if:

	The segment-list is empty
	The head-end is unable to perform path resolution for the first SID into one or more outgoing interface(s) and next-hop(s)
	The head-end is unable to perform SID resolution for any prefix-SID other than the first into an MPLS label.
	The SID is known with an R-flag (i.e., is propagated from a different level)
	The SID appears more than once on the path (loop)
	Consecutive SIDs belong to the same node.

An empty path, i.e., a path with no segment-list, is also invalid for policy usage.

To configure the segment-routing path and enter its configuration hierarchy:


**Command syntax: path [path]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Note**
Required validations:

- cannot remove a path which is configured for a given sr policy

- path must have at least one segment-list configure.


**Parameter table**

+-----------+---------------------------+------------------+---------+
| Parameter | Description               | Range            | Default |
+===========+===========================+==================+=========+
| path      | segment-routing path name | | string         | \-      |
|           |                           | | length 1-255   |         |
+-----------+---------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)#


**Removing Configuration**

To remove a path or all paths:
::

    dnRouter(cfg-protocols-sr-mpls)# no path PATH_1

**Command History**

+---------+-----------------------------------------------------------------------------------+
| Release | Modification                                                                      |
+=========+===================================================================================+
| 15.0    | Command introduced                                                                |
+---------+-----------------------------------------------------------------------------------+
| TBD     | Update path behavior. Path is valid if at least one segment-list with it is valid |
+---------+-----------------------------------------------------------------------------------+

---

### mpls/path/pcep-delegation/pcep-delegation.rst

protocols segment-routing mpls path pcep-delegation
---------------------------------------------------

**Minimum user role:** operator

A path defined with 'pcep delegation' will hold no local ERO definition and is expected to be controlled by PCE. 
Only when there is a valid PCE ERO, can the path be used to forward traffic
To define the path to be delegated and controlled by PCE in active stateful mode:


**Command syntax: pcep-delegation**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# pcep-delegation
    dnRouter(cfg-mpls-path-pcep)#


**Removing Configuration**

To remove path definition of delegated path:
::

    dnRouter(cfg-sr-mpls-path)# no pcep-delegation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/constraints/adj-sid-protection.rst

protocols segment-routing mpls path segment-list constraints adj-sid-protection
-------------------------------------------------------------------------------

**Minimum user role:** operator

When a configured path require to use adjacency-sid over the label stack for a given link hop, there may be multiple possible adj-sid differs by protection entitlement.
To configure adjacency sid protection preference:

**Command syntax: adj-sid-protection [adj-sid-protection]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list constraints

**Note**

- By default prefer adjacency-sids that are eligible for protection

**Parameter table**

+--------------------+--------------------------------------------+---------------------------+---------+
| Parameter          | Description                                | Range                     | Default |
+====================+============================================+===========================+=========+
| adj-sid-protection | adjacency sid protection preference config | | desired                 | desired |
|                    |                                            | | mandatory               |         |
|                    |                                            | | unprotected-desired     |         |
|                    |                                            | | unprotected-mandatory   |         |
+--------------------+--------------------------------------------+---------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list SEGMENT_LIST_1
    dnRouter(cfg-mpls-path-sl)# constraints
    dnRouter(cfg-path-sl-constraints)# adj-sid-protection mandatory


**Removing Configuration**

To revert adj-sid-protection to default value:
::

     dnRouter(cfg-path-sl-constraints)# no adj-sid-protection

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/constraints/admin-group_exclude.rst

protocols segment-routing mpls path segment-list constraints admin-group exclude
--------------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in a static path if the link has any admin-group value that matches the admin-group-exclude values.
To configure a admin-group exclude constraint:

**Command syntax: admin-group exclude [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list constraints

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from dynamic-path if link has any admin-group value that match the  | | string         | \-      |
|                  | admin-group-exclude values                                                       | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list SEGMENT_LIST_1
    dnRouter(cfg-mpls-path-sl)# constraints
    dnRouter(cfg-path-sl-constraints)# admin-group exclude RED,GREEN


**Removing Configuration**

To remove a specific admin-group exclude configuration:
::

    dnRouter(cfg-path-sl-constraints)# no admin-group exclude RED

To remove all admin-group exclude configuration:
::

    dnRouter(cfg-path-sl-constraints)# no admin-group exclude

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/constraints/admin-group_include-all.rst

protocols segment-routing mpls path segment-list constraints admin-group include-all
------------------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in a static path if the link doesn't match all admin-group values that are in the admin-group-include-all values.
To configure a admin-group include-all constraint:

**Command syntax: admin-group include-all [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list constraints

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from dynamic-path if link don't match all admin-group values that   | | string         | \-      |
|                  | are in the admin-group-include-all values                                        | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list SEGMENT_LIST_1
    dnRouter(cfg-mpls-path-sl)# constraints
    dnRouter(cfg-path-sl-constraints)# admin-group include-all RED,GREEN


**Removing Configuration**

To remove a specific admin-group include-all configuration:
::

    dnRouter(cfg-path-sl-constraints)# no admin-group include-all RED

To remove all admin-group include-all configuration:
::

    dnRouter(cfg-path-sl-constraints)# no admin-group include-all

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/constraints/admin-group_include-any.rst

protocols segment-routing mpls path segment-list constraints admin-group include-any
------------------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in a static path if the link doesn't match any admin-group values that are in the admin-group-include-any values.
To configure a admin-group include-any constraint:

**Command syntax: admin-group include-any [admin-group name]** [, admin-group name, admin-group name]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list constraints

**Parameter table**

+------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter        | Description                                                                      | Range            | Default |
+==================+==================================================================================+==================+=========+
| admin-group name | link is prun from dynamic-path if link don't match any admin-group value that is | | string         | \-      |
|                  | in the admin-group-include-any values                                            | | length 1-255   |         |
+------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list SEGMENT_LIST_1
    dnRouter(cfg-mpls-path-sl)# constraints
    dnRouter(cfg-path-sl-constraints)# admin-group include-any RED,GREEN


**Removing Configuration**

To remove a specific admin-group include-any configuration:
::

    dnRouter(cfg-path-sl-constraints)# no admin-group include-any RED

To remove all admin-group include-any configuration:
::

    dnRouter(cfg-path-sl-constraints)# no admin-group include-any

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/constraints/constraints.rst

protocols segment-routing mpls path segment-list constraints
------------------------------------------------------------

**Minimum user role:** operator

User may add constraints to a statically configured path segment-list. 
When constraint is added the provided user path is validated throughout all known hops, making sure that every link and node confirm with the required constraint.
If constraint can't be met, the segment-list is decided as invalid.
To enter static path segment-list constraint configuration level:

**Command syntax: constraints**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list

**Note**

- usage of anycast-sids with constraints is not supported
- segment-list is validated up to the last hop sid which can be resolved to a link/node in the segment-routing topology.
  For example, if sr-te policy binding-sid is used a mid segment-list hop, constraint validation will not apply for path starting from that hop. The resulting segment-list may pass validation will in fact violate constraints in last segments.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list SEGMENT_LIST_1
    dnRouter(cfg-mpls-path-sl)# constraints
    dnRouter(cfg-path-sl-constraints)#


**Removing Configuration**

To revert all static path constraints configurations to default:
::

    dnRouter(cfg-mpls-path-sl)# no constraints

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/constraints/exclude-prefix-ipv4.rst

protocols segment-routing mpls path segment-list constraints exclude-prefix-ipv4
--------------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid to be used in a static path if the link has any prefix value that matches the IPv4 exclude-prefix values.
A node is not valid to be used in a static path if the node has a prefix-sid in any algo that matches the excluded prefixes.
The exclusion of prefixes affects policies regardless of what algo the prefix
Excluded IPv4 prefixes will only affect IPv4 Policies.
To configure an IPv4 exclude-prefix constraint:

**Command syntax: exclude-prefix-ipv4 [prefix-value]** [, prefix-value, prefix-value]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list constraints

**Parameter table**

+--------------+------------------------------------------------------------------------------+---------+---------+
| Parameter    | Description                                                                  | Range   | Default |
+==============+==============================================================================+=========+=========+
| prefix-value | link is pruned if nexthop node has address that match the IPv4 prefix values | A.B.C.D | \-      |
+--------------+------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list SEGMENT_LIST_1
    dnRouter(cfg-mpls-path-sl)# constraints
    dnRouter(cfg-path-sl-constraints)# exclude-ipv4 1.1.1.1, 2.2.2.2


**Removing Configuration**

To remove a specific exclude-prefix-ipv4 configuration:
::

     dnRouter(cfg-path-sl-constraints)# no exclude-prefix-ipv4 1.1.1.1

To remove all exclude-prefix-ipv4 configuration:
::

     dnRouter(cfg-path-sl-constraints)# no exclude-prefix-ipv4

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/constraints/exclude-prefix-ipv6.rst

protocols segment-routing mpls path segment-list constraints exclude-prefix-ipv6
--------------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid to be used in a static path if the link has any prefix value that matches the IPv6 exclude-prefix values.
A node is not valid to be used in a static path if the node has a prefix-sid in any algo that matches the excluded prefixes.
The exclusion of prefixes affects policies regardless of what algo the prefix
Excluded IPv6 prefixes will only affect IPv6 Policies.
To configure an IPv6 exclude-prefix constraint:

**Command syntax: exclude-prefix-ipv6 [prefix-value]** [, prefix-value, prefix-value]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list constraints

**Parameter table**

+--------------+------------------------------------------------------------------------------+----------+---------+
| Parameter    | Description                                                                  | Range    | Default |
+==============+==============================================================================+==========+=========+
| prefix-value | link is pruned if nexthop node has address that match the IPv6 prefix values | X:X::X:X | \-      |
+--------------+------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list SEGMENT_LIST_1
    dnRouter(cfg-mpls-path-sl)# constraints
    dnRouter(cfg-path-sl-constraints)# exclude-ipv6 1::1, 1::2


**Removing Configuration**

To remove a specific exclude-prefix-ipv6 configuration:
::

     dnRouter(cfg-path-sl-constraints)# no exclude-prefix-ipv6 1::1

To remove all exclude-prefix-ipv6 configuration:
::

     dnRouter(cfg-path-sl-constraints)# no exclude-prefix-ipv6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/constraints/exclude-srlg.rst

protocols segment-routing mpls path segment-list constraints exclude-srlg
-------------------------------------------------------------------------

**Minimum user role:** operator

A link is not valid for to be used in a static path if the link has any srlg value that matches the exclude-srlg values. The srlg value is per RFC5307.
To configure a exclude-srlg constraint:

**Command syntax: exclude-srlg [srlg-value]** [, srlg-value, srlg-value]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list constraints

**Parameter table**

+------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter  | Description                                                                      | Range        | Default |
+============+==================================================================================+==============+=========+
| srlg-value | link is prun if link has any srlg value that match the exclude-srlg values. srlg | 1-4294967295 | \-      |
|            | value per RFC5307                                                                |              |         |
+------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list SEGMENT_LIST_1
    dnRouter(cfg-mpls-path-sl)# constraints
    dnRouter(cfg-path-sl-constraints)# exclude-srlg 2,50


**Removing Configuration**

To remove a specific exclude-srlg configuration:
::

     dnRouter(cfg-path-sl-constraints)# no exclude-srlg 50

To remove all exclude-srlg configuration:
::

     dnRouter(cfg-path-sl-constraints)# no exclude-srlg

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/hop_algorithm.rst

protocols segment-routing mpls path segment-list hop include prefix-sid ipv4-address
------------------------------------------------------------------------------------

**Minimum user role:** operator

The segment-list hop represents a single segment within the path. Each hop is associated with a specific label, a prefix-SID index, or a prefix-SID IPv4-address. You can configure up to 5 segments per segment-list.

To configure a segment-list hop:

**Command syntax: hop [hop] include prefix-sid ipv4-address [include-ipv4-address] [algorithm]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list

**Note**
Required validations:

- ipv4-address must be a legal unicast ipv4 address, i.e not multicast of broadcast address.

**Parameter table**

+----------------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter            | Description                                                                      | Range   | Default |
+======================+==================================================================================+=========+=========+
| hop                  | Hop identifier. The segment list path is defined according to the hop order.     | 1-9     | \-      |
|                      | Lowest value will be the first hop                                               |         |         |
+----------------------+----------------------------------------------------------------------------------+---------+---------+
| include-ipv4-address | Configure a given address. DNOS will resolve the given address to the matching   | A.B.C.D | \-      |
|                      | SID according to SR DB                                                           |         |         |
+----------------------+----------------------------------------------------------------------------------+---------+---------+
| algorithm            | algorithm associated with the prefix to match the SID                            | \-      | \-      |
+----------------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list 1
    dnRouter(cfg-mpls-path-sl)# hop 1 include prefix-sid ipv4-address 1.2.3.4 spf


**Removing Configuration**

To remove a specific hop from the segment-list:
::

    dnRouter(cfg-mpls-path-sl)# no hop 1

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 15.0    | Command introduced                |
+---------+-----------------------------------+
| 18.1    | Extend support to 9 hops          |
+---------+-----------------------------------+
| 18.1    | Add algorithm flex-algo id option |
+---------+-----------------------------------+

---

### mpls/path/segment-list/hop_include_adjacency-sid.rst

protocols segment-routing mpls path segment-list hop include adjacency-sid
--------------------------------------------------------------------------

**Minimum user role:** operator

The segment-list hop represents a single segment within the path. Each hop is associated with a specific label, a prefix-SID index, or a prefix-SID IPv4-address. You can configure up to 5 segments per segment-list.

To configure a segment-list hop:


**Command syntax: hop [hop] include adjacency-sid [include-adjacency-sid]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list

**Note**

- This command may also be invoked inside the mesh-group peer or inside the default-peer configuration hierarchy.

- The hold-time timer must be greater than the hop timer. The user is warned in case the hop timer is greater or equal to the hold-time.

**Parameter table**

+-----------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter             | Description                                                                      | Range        | Default |
+=======================+==================================================================================+==============+=========+
| hop                   | Hop identifier. The segment list path is defined according to the hop order.     | 1-9          | \-      |
|                       | Lowest value will be the first hop                                               |              |         |
+-----------------------+----------------------------------------------------------------------------------+--------------+---------+
| include-adjacency-sid | Add adjacency SID to policy path according to the matching interface local ipv4  | | A.B.C.D    | \-      |
|                       | address                                                                          | | X:X::X:X   |         |
+-----------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list 1
    dnRouter(cfg-mpls-path-sl)# hop 2 include adjacency-sid 1.1.1.1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list 1
    dnRouter(cfg-mpls-path-sl)# hop 2 include adjacency-sid 2001:77:44::1


**Removing Configuration**

To remove a specific hop from the segment-list:
::

    dnRouter(cfg-mpls-path-sl)# no hop 2

**Command History**

+---------+------------------------------------------------------------+
| Release | Modification                                               |
+=========+============================================================+
| 15.0    | Command introduced                                         |
+---------+------------------------------------------------------------+
| 17.0    | Add adjacency-sid hop option                               |
+---------+------------------------------------------------------------+
| 17.2    | Extend support to 9 hops. Added support for ipv6 adjacency |
+---------+------------------------------------------------------------+

---

### mpls/path/segment-list/hop_include_index.rst

protocols segment-routing mpls path segment-list hop include prefix-sid index
-----------------------------------------------------------------------------

**Minimum user role:** operator

The segment-list hop represents a single segment within the path. Each hop is associated with a specific label, a prefix-SID index, or a prefix-SID IPv4-address. You can configure up to 5 segments per segment-list.

To configure a segment-list hop:


**Command syntax: hop [hop] include prefix-sid index [include-index]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list

**Note**
Required validations:

- The index must be within the configured SRGB range.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter     | Description                                                                      | Range    | Default |
+===============+==================================================================================+==========+=========+
| hop           | Hop identifier. The segment list path is defined according to the hop order.     | 1-9      | \-      |
|               | Lowest value will be the first hop                                               |          |         |
+---------------+----------------------------------------------------------------------------------+----------+---------+
| include-index | Configure the SID index for the associated hop                                   | 0-999999 | \-      |
+---------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list 1
    dnRouter(cfg-mpls-path-sl)# hop 2 prefix-sid include index 2


**Removing Configuration**

To remove a specific hop from the segment-list:
::

    dnRouter(cfg-mpls-path-sl)# no hop 2

**Command History**

+---------+----------------------------+
| Release | Modification               |
+=========+============================+
| 15.0    | Command introduced         |
+---------+----------------------------+
| 17.2    | Extended support to 9 hops |
+---------+----------------------------+

---

### mpls/path/segment-list/hop_label.rst

protocols segment-routing mpls path segment-list hop label
----------------------------------------------------------

**Minimum user role:** operator

The segment-list hop represents a single segment within the path. Each hop is associated with a specific label, a prefix-SID index, or a prefix-SID IPv4-address. You can configure up to 5 segments per segment-list.

To configure a segment-list hop:


**Command syntax: hop [hop] label [label]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list

**Note**
Required validations:

- The label must be within the configured SRGB.


**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------------+---------+
| Parameter | Description                                                                      | Range       | Default |
+===========+==================================================================================+=============+=========+
| hop       | Hop identifier. The segment list path is defined according to the hop order.     | 1-9         | \-      |
|           | Lowest value will be the first hop                                               |             |         |
+-----------+----------------------------------------------------------------------------------+-------------+---------+
| label     | Absolute label value to assign on the policy label stack                         | 256-1048575 | \-      |
+-----------+----------------------------------------------------------------------------------+-------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list 1
    dnRouter(cfg-mpls-path-sl)# hop 1 label 10000


**Removing Configuration**

To remove a specific hop from the segment-list:
::

    dnRouter(cfg-mpls-path-sl)# no hop 1

**Command History**

+---------+----------------------------+
| Release | Modification               |
+=========+============================+
| 15.0    | Command introduced         |
+---------+----------------------------+
| 17.2    | Extended support to 9 hops |
+---------+----------------------------+

---

### mpls/path/segment-list/hop_prefix_sid_ipv4_algorithm.rst

protocols segment-routing mpls path segment-list hop include prefix-sid ipv4-address
------------------------------------------------------------------------------------

**Minimum user role:** operator

The segment-list hop represents a single segment within the path. Each hop is associated with a specific label, a prefix-SID index, or a prefix-SID IPv4-address. You can configure up to 5 segments per segment-list.

To configure a segment-list hop:


**Command syntax: hop [hop] include prefix-sid ipv4-address [include-ipv4-address] [algorithm]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list

**Note**
Required validations:

- The ipv4-address must be a legal unicast ipv4 address, i.e not a multicast of broadcast address.


**Parameter table**

+----------------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter            | Description                                                                      | Range   | Default |
+======================+==================================================================================+=========+=========+
| hop                  | Hop identifier. The segment list path is defined according to the hop order.     | 1-9     | \-      |
|                      | Lowest value will be the first hop                                               |         |         |
+----------------------+----------------------------------------------------------------------------------+---------+---------+
| include-ipv4-address | Configure a given address. DNOS will resolve the given address to the matching   | A.B.C.D | \-      |
|                      | SID according to SR DB                                                           |         |         |
+----------------------+----------------------------------------------------------------------------------+---------+---------+
| algorithm            | algorithm associated with the prefix to match the SID                            | \-      | \-      |
+----------------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list 1
    dnRouter(cfg-mpls-path-sl)# hop 1 include prefix-sid ipv4-address 1.2.3.4 spf


**Removing Configuration**

To remove a specific hop from the segment-list:
::

    dnRouter(cfg-mpls-path-sl)# no hop 1

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 15.0    | Command introduced                |
+---------+-----------------------------------+
| 17.2    | Extended support to 9 hops        |
+---------+-----------------------------------+
| 18.0    | Add algorithm flex-algo id option |
+---------+-----------------------------------+

---

### mpls/path/segment-list/hop_prefix_sid_ipv6_algorithm.rst

protocols segment-routing mpls path segment-list hop include prefix-sid ipv6-address
------------------------------------------------------------------------------------

**Minimum user role:** operator

The segment-list hop represents a single segment within the path. Each hop is associated with a specific label, a prefix-SID index, or a prefix-SID IPv6-address. You can configure up to 5 segments per segment-list.

To configure a segment-list hop:


**Command syntax: hop [hop] include prefix-sid ipv6-address [include-ipv6-address] [algorithm-ipv6]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path segment-list

**Note**
Required validations:

- The ipv6-address must be a legal unicast ipv6 address, i.e not a multicast of a broadcast address.


**Parameter table**

+----------------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter            | Description                                                                      | Range    | Default |
+======================+==================================================================================+==========+=========+
| hop                  | Hop identifier. The segment list path is defined according to the hop order.     | 1-9      | \-      |
|                      | Lowest value will be the first hop                                               |          |         |
+----------------------+----------------------------------------------------------------------------------+----------+---------+
| include-ipv6-address | Configure a given address. DNOS will resolve the given address to the matching   | X:X::X:X | \-      |
|                      | SID according to SR DB                                                           |          |         |
+----------------------+----------------------------------------------------------------------------------+----------+---------+
| algorithm-ipv6       | algorithm associated with the prefix to match the SID                            | \-       | \-      |
+----------------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list 1
    dnRouter(cfg-mpls-path-sl)# hop 1 include prefix-sid ipv6-address 1:1::1::1 spf


**Removing Configuration**

To remove a specific hop from the segment-list:
::

    dnRouter(cfg-mpls-path-sl)# no hop 1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/path/segment-list/segment-list.rst

protocols segment-routing mpls path segment-list
------------------------------------------------

**Minimum user role:** operator

A segment-list defines a path according to the different segments (SIDs) specified for it. Multiple segment-lists within the same path can be used to apply weighted ECMP of traffic forwarding between the different segment-lists.

The path must be valid for a policy to be able to use it. A path is valid if at least one segment-list with in it is valid. A segment-list is invalid if:

	The segment-list is empty.
	The head-end is unable to perform a path resolution for the first SID into one or more outgoing interface(s) and next-hop(s).
	The head-end is unable to perform a SID resolution for any prefix-SID other than the first into an MPLS label.
	The SID is known with an R-flag (i.e., is propagated from a different level).
	The SID appears more than once on the path (loop).
	Consecutive SIDs belong to the same node.

To configure a segment-list for a path and enter its configuration hierarchy:


**Command syntax: segment-list [segment-list]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls path

**Note**
Required validations:

- At least one hop is configured.


**Parameter table**

+--------------+-----------------------------------------------------+-------+---------+
| Parameter    | Description                                         | Range | Default |
+==============+=====================================================+=======+=========+
| segment-list | unique identifier of segment-list within an SR path | 1-8   | \-      |
+--------------+-----------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# path PATH_1
    dnRouter(cfg-sr-mpls-path)# segment-list 1
    dnRouter(cfg-mpls-path-sl)# hop 1 label 30000

    dnRouter(cfg-sr-mpls-path)# segment-list 2


**Removing Configuration**

To remove a specific segment-list given path:
::

    dnRouter(cfg-sr-mpls-path)# no segment-list 1

**Command History**

+---------+-----------------------------------------------------------------------------------+
| Release | Modification                                                                      |
+=========+===================================================================================+
| 15.0    | Command introduced                                                                |
+---------+-----------------------------------------------------------------------------------+
| TBD     | Update path behavior. Path is valid if at least one segment-list with it is valid |
+---------+-----------------------------------------------------------------------------------+

---

### mpls/policy-reoptimization.rst

protocols segment-routing mpls policy-reoptimization
----------------------------------------------------

**Minimum user role:** operator

Paths may become invalid in time due to topology changes. When a policy has multiple path options and a better priority path becomes invalid, the system will use the next preferred priority path. The policy will continue using the worse priority path even if the better priority path is available again. To fix this, you can globally set a policy reoptimization interval that will cause the system to instruct all segment-routing policies that are not on the best path to attempt to use a better priority path.

To configure the policy reoptimization interval:

**Command syntax: policy-reoptimization [policy-reoptimization]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Note**
-  Interval 0 will disable periodic optimization.

**Parameter table**

+-----------------------+----------------------------------------------------------------------------------+---------+---------+
| Parameter             | Description                                                                      | Range   | Default |
+=======================+==================================================================================+=========+=========+
| policy-reoptimization | Configure the period of time after which global policy optimization will be      | 0-65535 | 60      |
|                       | attempted                                                                        |         |         |
+-----------------------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy-reoptimization 5


**Removing Configuration**

To return the interval to its default value:
::

    dnRouter(cfg-protocols-sr-mpls)# no policy-reoptimization

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/admin-state.rst

protocols segment-routing mpls policy admin-state
-------------------------------------------------

**Minimum user role:** operator

When disabled, a configured policy will not be used for traffic forwarding.

To enable/disable a segment-routing policy:


**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+-------------+-----------------------+--------------+---------+
| Parameter   | Description           | Range        | Default |
+=============+=======================+==============+=========+
| admin-state | SR policy admin state | | enabled    | enabled |
|             |                       | | disabled   |         |
+-------------+-----------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# admin-state disabled


**Removing Configuration**

To return the admin-state to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/administrative-distance.rst

protocols segment-routing mpls policy administrative-distance
-------------------------------------------------------------

**Minimum user role:** operator

Administrative distance is an arbitrary numerical value that is assigned to routes to allow the router to decide which routing protocol to select for installation in the FIB and for route resolution for protocol next-hop when multiple protocols provide route information for the same destination. The assigned value denotes the preference of the route compared to other routes, such that a lower value denotes a more preferred route.

To configure the segment-routing traffic-engineering administrative distance for the specific policy:


**Command syntax: administrative-distance [administrative-distance]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Note**
-  An administrative distance of 255 will cause the router to remove the route from the routing table and not use it.

-  Reconfiguration of administrative-distance will take immediate effect.


**Parameter table**

+-------------------------+-------------------------------------------------------------------------+-------+---------+
| Parameter               | Description                                                             | Range | Default |
+=========================+=========================================================================+=======+=========+
| administrative-distance | Sets the Segment-Routing administrative-distance used for SR-TE policy. | 1-255 | \-      |
+-------------------------+-------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy POL_1
    dnRouter(cfg-sr-mpls-policy)# administrative-distance 90


**Removing Configuration**

To return to the default value:
::

    dnRouter(cfg-sr-mpls-policy)# no administrative-distance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/backup-path-install.rst

protocols segment-routing mpls policy backup-path-install
---------------------------------------------------------

**Minimum user role:** operator

When a backup-install-path is set for a given policy, DNOS picks the next (lower) preference valid candidate path as the backup for the active candidate path.
The backup path is installed to the FIB to provide sub 50 msec failover upon an active path failure.

To enable end to end protecition and support the backup path installation:


**Command syntax: backup-path-install [backup-path-install]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Note**
- For the policy to have a backup path, at least two paths need to be configured for the policy (no commit validation required).
- Each path, both active and backup, are fully defined by their path settings. There is no implicit disjoint constraint between them.


**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter           | Description                                                                      | Range        | Default |
+=====================+==================================================================================+==============+=========+
| backup-path-install | Utilize lower preference candidate path as policy end to end back path installed | | enabled    | \-      |
|                     | to RIB and FIB                                                                   | | disabled   |         |
+---------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy POL_1
    dnRouter(cfg-sr-mpls-policy)# backup-path-install enabled


**Removing Configuration**

To return the backup-path-install setting to its default value:
::

    dnRouter(cfg-protocols-igp-mpls)# no backup-path-install

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/policy/binding-sid.rst

protocols segment-routing mpls policy binding-sid
-------------------------------------------------

**Minimum user role:** operator

Set a statically configured binding-SID to be assigned for a given SR-TE policy.
When configured with a value, the binding-SID label value must match an available label within the configured SRLB.
When set to dynamic (default behavior), the system automatically allocates a binding-SID label for the SR-TE policy from the dynamic label range.
When the policy is in the Up state, and the mpls ILM entry is installed in the FIB with an ingress label matching the requested binding-SID label, and the egress operation of the pop and push policy label stack.
To configure the policy binding-SID:

**Command syntax: binding-sid [binding-sid]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Note**
- The system default behavior is to select a policy binding-SID from the dynamic label range.
- The user may configure the binding-SID value, required to do a commit validation that the configured value matches the configured SRLB.
- The commit validation that the configured binding-SID label value does not conflict with any other configured binding-SID or adjacency-SID.
- The configured binding-SID by value is persistent for the given policy throughout the policy lifetime,and expected to be preserved after the system reboot.
- Reconfiguration of the binding-SID, regardless of changing the value or adding/removing a config does not change the policy state.

**Parameter table**

+-------------+--------------------------------------------+-------+---------+
| Parameter   | Description                                | Range | Default |
+=============+============================================+=======+=========+
| binding-sid | Configure binding-sid value for the policy | \-    | dynamic |
+-------------+--------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# binding-sid 8003


**Removing Configuration**

To return to default binding-sid allocation:
::

    dnRouter(cfg-igp-mpls-policy)# no binding-sid

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/policy/color.rst

protocols segment-routing mpls policy color
-------------------------------------------

**Minimum user role:** operator

Color distinguishes between different policies with the same source and destination address.

To configure color value for sr-te policy:


**Command syntax: color [color]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Note**

- Color is a mandatory configuration for sr-te policy.

- The user cannot configure more than one policy with the same destination and color.

**Parameter table**

+-----------+------------------------------+--------------+---------+
| Parameter | Description                  | Range        | Default |
+===========+==============================+==============+=========+
| color     | segment-routing policy color | 0-4294967295 | \-      |
+-----------+------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# color 5


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-sr-mpls-policy)# no color

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/description.rst

protocols segment-routing mpls policy description
-------------------------------------------------

**Minimum user role:** operator

It is good practice to provide a meaningful description of the policy.

To configure a description of the policy:


**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+-------------+--------------------+------------------+---------+
| Parameter   | Description        | Range            | Default |
+=============+====================+==================+=========+
| description | policy description | | string         | \-      |
|             |                    | | length 1-255   |         |
+-------------+--------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy POL_1
    dnRouter(cfg-sr-mpls-policy)# description "this is my segment-routing policy"


**Removing Configuration**

To remove the configured description:
::

    dnRouter(cfg-sr-mpls-policy)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/destination_algorithm.rst

protocols segment-routing mpls policy destination
-------------------------------------------------

**Minimum user role:** operator

The destination is the last hop (tail-end) of the segment-routing policy and is a mandatory configuration.
The configuration is much like the hop configuration (see "segment-routing mpls path segment-list hop"), except that it marks the last hop.

To configure the policy's destination:


**Command syntax: destination [destination ip-address] [destination-algorithm]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Note**
- There's no remove option for the destination as it is a mandatory config for the policy. The user can change the assigned destination.


**Parameter table**

+------------------------+----------------------------------------------+----------------+---------+
| Parameter              | Description                                  | Range          | Default |
+========================+==============================================+================+=========+
| destination ip-address | segment-routing policy destination           | | A.B.C.D      | \-      |
|                        |                                              | | X:X::X:X     |         |
+------------------------+----------------------------------------------+----------------+---------+
| destination-algorithm  | segment-routing policy destination algorithm | | spf          | \-      |
|                        |                                              | | strict-spf   |         |
+------------------------+----------------------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protcols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# destination 1.1.1.1 strict-spf

    dnRouter# configure
    dnRouter(cfg)# protcols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_v6_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# destination 1717:1717::1 strict-spf


**Removing Configuration**

To remove a destination:
::

    The destination is mandatory. You can only change it, not remove it.

**Command History**

+---------+----------------------------------+
| Release | Modification                     |
+=========+==================================+
| 15.0    | Command introduced               |
+---------+----------------------------------+
| 18.2    | Add support for ipv6 destination |
+---------+----------------------------------+

---

### mpls/policy/destination_external.rst

protocols segment-routing mpls policy destination external
----------------------------------------------------------

**Minimum user role:** operator

The destination is the last hop (tail-end) of the segment-routing policy and is a mandatory configuration.
Configure the policy destination as an external SID to the SR-TE policy label stack. The policy label stack will fully be defined by the provided path.
To configure the policy's destination as external:


**Command syntax: destination [destination ip-address] external**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+------------------------+------------------------------------+--------------+---------+
| Parameter              | Description                        | Range        | Default |
+========================+====================================+==============+=========+
| destination ip-address | segment-routing policy destination | | A.B.C.D    | \-      |
|                        |                                    | | X:X::X:X   |         |
+------------------------+------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# destination 1.1.1.1 external

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-_v6_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# destination 1717:1717::1 external


**Removing Configuration**

To remove destination configuration:
::

    dnRouter(cfg-sr-mpls-policy)# no destination

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.2    | Command introduced |
+---------+--------------------+

---

### mpls/policy/destination_flex-algo.rst

protocols segment-routing mpls policy destination flex-algo
-----------------------------------------------------------

**Minimum user role:** operator

The destination is the last hop (tail-end) of the segment-routing policy and is a mandatory configuration. 
The configuration is much like the hop configuration (see "segment-routing mpls path segment-list hop"), except that it marks the last hop.
Flex-algo defines in which Flex-Algo topology the requested destination SID should be matched.

To configure the policy's destination for the Flex-Algo SID:


**Command syntax: destination [destination ip-address] flex-algo [flex-algo id]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+------------------------+--------------------------------------------------------------+--------------+---------+
| Parameter              | Description                                                  | Range        | Default |
+========================+==============================================================+==============+=========+
| destination ip-address | segment-routing policy destination                           | | A.B.C.D    | \-      |
|                        |                                                              | | X:X::X:X   |         |
+------------------------+--------------------------------------------------------------+--------------+---------+
| flex-algo id           | segment-routing policy destination flex-algorithm identifier | 128-255      | \-      |
+------------------------+--------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# destination 1.1.1.1 flex-algo 130

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-_v6_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# destination 1717:1717::1 flex-algo 130


**Removing Configuration**

To remove destination configuration:
::

    dnRouter(cfg-sr-mpls-policy)# no destination

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.0    | Command introduced |
+---------+--------------------+
| 18.2    | Add ipv6 support   |
+---------+--------------------+

---

### mpls/policy/igp-instance_isis.rst

protocols segment-routing mpls policy igp-instance isis
-------------------------------------------------------

**Minimum user role:** operator

By default, the SR-TE policy is created in the lowest administrative-distance IGP instance.
To configure that SR-TE policy is created in a specific IS-IS instance:


**Command syntax: igp-instance isis [isis-instance-name]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Note**

- ISIS is by default preferred over OSPF as a required IGP instance.

**Parameter table**

+--------------------+---------------------+-------+---------+
| Parameter          | Description         | Range | Default |
+====================+=====================+=======+=========+
| isis-instance-name | IS-IS instance name | \-    | \-      |
+--------------------+---------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# igp-instance isis instance_1


**Removing Configuration**

To revert the igp-instance to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no igp-instance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.1    | Command introduced |
+---------+--------------------+

---

### mpls/policy/igp-instance_ospf.rst

protocols segment-routing mpls policy igp-instance ospf
-------------------------------------------------------

**Minimum user role:** operator

By default, the SR-TE policy is created in the lowest administrative-distance IGP instance.
To configure that SR-TE policy is created in a specific OSPF instance:


**Command syntax: igp-instance ospf [ospf-instance-name]** area [area]

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Note**
- ISIS is by default preferred over OSPF as a required IGP instance
- Support for inter-area SR-TE policy follows the following guidelines:
* Policy destination address and algorithm, required to be resolved to SID value. which will define the last SID on stack. Destination may be inter-area route, leading to construct a policy towards ABR advertising the SID
* Explicit path first hop must be a resolvable address / index / label to decide on egress nexthop.
** First hop can be inter-area sid. address expected to be resolved to match SR route. index/label expected to be resolve per local srgb matching the equivalent ILM route result
** For any hop after an inter-area address hop, support only as SID index or absolute label
- If address is given, path will be declared as invalid
- If index is given, the label value will match ABR SRGB base
- For the first inter-area route on the segment-list hops, , require to verify that given index is within the ABR SRGB, otherwise segment-list is invalid
- In case there are ABR ECMP advertising same inter-area SID , only one ABR will be checked to define the absolute label value (per its SRGB base) and the index validity check
- If absolute label is given, the provided label is be imposed , no validation required, no srgb translation

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ospf-instance-name | OSPFv2 instance name                                                             | \-    | \-      |
+--------------------+----------------------------------------------------------------------------------+-------+---------+
| area               | The desired OSPF area for the desired OSPF instance in which SR-TE policy should | \-    | \-      |
|                    | be constructed                                                                   |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# igp-instance ospf instance_1

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# igp-instance ospf instance_1 area 0


**Removing Configuration**

To revert the igp-instance to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no igp-instance

To remove the OSPF igp-instance:
::

    dnRouter(cfg-sr-mpls-policy)# no igp-instance ospf instance_1

To revert the desired OSPF area to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no igp-instance ospf instance_1 area 0

**Command History**

+---------+--------------------------+
| Release | Modification             |
+=========+==========================+
| 17.1    | Command introduced       |
+---------+--------------------------+
| 18.1    | Added ospf instance-name |
+---------+--------------------------+

---

### mpls/policy/igp-shortcuts.rst

protocols segment-routing mpls policy igp-shortcuts
---------------------------------------------------

**Minimum user role:** operator

IGP shortcuts (IGP-SC) allow the IGP to install routes to indirect destination in the MPLS-NH table in addition to the destination. IGP takes all the destinations in its internal routing table and treats them as if they were directly connected to the local router, thus recreating its topology.
When enabled, an IGP configured with SR extensions will use the SR-TE policy information to calculate a new IGP-MPLS topology, where the SR-TE policies are considered as next-hop for resolution of IGP routes. This makes the SIDs "behind" the SR-TE policy destination reachable using the segment-routing policy.
IGP-Shortcuts results in installing both FTN route and ILM routes using SR-TE policies as next-hops:

	For FEC-To-NHLFE (FTN) routes, a route is the prefix for which a shortcut was calculated.
	For Incoming Label Map (ILM) routes, in-label is the matching route SPF prefix-sid, and the next-hop is via SR-TE policy. Only policies enabled with a destination-rib that is "mpls-forwarding" or "both" are valid for use as next-hops in shortcuts for ILM routes. If no valid policy next-hop is found, no route will be installed.

To enable or disable the use of a segment-routing policy as shortcuts in calculating segment-routing paths:


**Command syntax: igp-shortcuts [sr-shortcuts]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Note**
- This command may be also be invoked inside mesh-group peer or inside default-peer configuration hierarchy.

- The hold-time timer must be greater than the igp-shortcuts timer. The user is warned in case the igp-shortcuts timer is greater or equal to hold-time.


**Parameter table**

+--------------+-------------------------------------------------------------------+--------------+---------+
| Parameter    | Description                                                       | Range        | Default |
+==============+===================================================================+==============+=========+
| sr-shortcuts | Configure usage of SR policy as shortcuts in calculating SR paths | | enabled    | \-      |
|              |                                                                   | | disabled   |         |
+--------------+-------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# igp-shortcuts enabled


**Removing Configuration**

To return the igp-shortcut to its default value:
::

    dnRouter(cfg-igp-mpls-policy)# no igp-shortcuts

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/ldp-sync.rst

protocols segment-routing mpls policy ldp-sync
----------------------------------------------

**Minimum user role:** operator

When enabled, the SR-TE policy is excluded from the IGP shortcut calculations if an LDP peer of policy tail-end node is missing.


**Command syntax: ldp-sync [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Set ldp sync. If there is no ldp session to neighbor at policy tail-end, policy  | | enabled    | disabled |
|             | will be excluded from IGP                                                        | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# ldp-sync enabeld


**Removing Configuration**

To revert the ldp-sync to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no ldp-sync

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/ldp-tunneling.rst

protocols segment-routing mpls policy ldp-tunneling
---------------------------------------------------

**Minimum user role:** operator

Enables the SR-TE policy to be used for ldp over SR-TE tunneling.
Once enabled, a targeted hello will be initiated to the policy destination to establish a remote ldp session.
An LDP binding will be possible when removing the neighbor with an mpls path that is resolved via the SR-TE policy


**Command syntax: ldp-tunneling [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Configure usage of SR policy for LDP over SR-TE forwarding resolution (LDP       | | enabled    | disabled |
|             | tunneling)                                                                       | | disabled   |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# ldp-tunneling enabeld


**Removing Configuration**

To revert the ldp-tunneling to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no ldp-tunneling

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/no-fallback-dis.rst

protocols segment-routing mpls policy no-fallback disabled
----------------------------------------------------------

**Minimum user role:** operator

Once no-fallback is enabled for a given policy, if all the policy paths are found to be invalid (including PCE path) leaving the SR-TE with no policy solution to install. The SR-TE will install a policy to null0 (drop) to the RIB. 
As a result there will be no fallback in RIB for resolving traffic on a different route, if the policy is the best match for both destination and color.

To enable no-fallback:


**Command syntax: no-fallback disabled**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# no-fallback disabled


**Removing Configuration**

To revert the no-fallback to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no no-fallback

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 18.0    | Command introduced            |
+---------+-------------------------------+
| TBD     | disqualify-color-routes added |
+---------+-------------------------------+

---

### mpls/policy/no-fallback-ena.rst

protocols segment-routing mpls policy no-fallback enabled
---------------------------------------------------------

**Minimum user role:** operator

Once no-fallback is enabled for a given policy, if all the policy paths are found to be invalid (including PCE path) leaving the SR-TE with no policy solution to install. The SR-TE will install a policy to null0 (drop) to the RIB. 
As a result there will be no fallback in RIB for resolving traffic on a different route, if the policy is the best match for both destination and color.
Once disqualify-color-routes is set, the no-fallback route in color-mpls-nh or color-mpls-nh-ipv6 table will be considered unreachable.
As result, colored bgp routes resolved over matching color nexthop will be considered unreachable and will not be accepted

To enable no-fallback:


**Command syntax: no-fallback enabled** disqualify-color-routes

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+-------------+-----------------------------------------------------------------------+-------+---------+
| Parameter   | Description                                                           | Range | Default |
+=============+=======================================================================+=======+=========+
| admin-state | Set policy to disqualify color routes matching this no-fallback route | \-    | \-      |
+-------------+-----------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# no-fallback enabled
    dnRouter(cfg-sr-mpls-policy)# no-fallback enabled disqualify-color-routes


**Removing Configuration**

To revert the no-fallback to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no no-fallback

To revert the disqualify-color-routes to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no no-fallback enabled disqualify-color-routes

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 18.0    | Command introduced            |
+---------+-------------------------------+
| TBD     | disqualify-color-routes added |
+---------+-------------------------------+

---

### mpls/policy/no-fallback.rst

protocols segment-routing mpls policy no-fallback
-------------------------------------------------

**Minimum user role:** operator

Once no-fallback is enabled for a given policy, if all the policy paths are found to be invalid (including PCE path) leaving the SR-TE with no policy solution to install. The SR-TE will install a policy to null0 (drop) to the RIB. 
As a result there will be no fallback in RIB for resolving traffic on a different route, if the policy is the best match for both destination and color.
Once disqualify-color-routes is set, the no-fallback route in color-mpls-nh or color-mpls-nh-ipv6 table will be considered unreachable.
As result, colored bgp routes resolved over matching color nexthop will be considered unreachable and will not be accepted

To enable no-fallback:


**Command syntax: no-fallback [admin-state]** disqualify-color-routes

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+-------------------------+-----------------------------------------------------------------------+--------------+----------+
| Parameter               | Description                                                           | Range        | Default  |
+=========================+=======================================================================+==============+==========+
| admin-state             | Set policy to drop traffic in no valid path is found                  | | enabled    | disabled |
|                         |                                                                       | | disabled   |          |
+-------------------------+-----------------------------------------------------------------------+--------------+----------+
| disqualify-color-routes | Set policy to disqualify color routes matching this no-fallback route | boolean      | \-       |
+-------------------------+-----------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR-POLICY_1
    dnRouter(cfg-sr-mpls-policy)# no-fallback enabled
    dnRouter(cfg-sr-mpls-policy)# no-fallback enabled disqualify-color-routes


**Removing Configuration**

To revert the no-fallback to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no no-fallback

To revert the disqualify-color-routes to its default value:
::

    dnRouter(cfg-sr-mpls-policy)# no no-fallback NO-FALLBACK disqualify-color-routes

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 18.0    | Command introduced            |
+---------+-------------------------------+
| TBD     | disqualify-color-routes added |
+---------+-------------------------------+

---

### mpls/policy/path/lock.rst

protocols segment-routing mpls policy path lock
-----------------------------------------------

**Minimum user role:** operator

Set the lock timer (in seconds) over a given candidate path to prevent path replacement in when a better candidate path is found valid.
The operator may use lock logic to prevent frequent policy path changes.
- The value '0' (default behavior) result is that the candidate path is replaced from installed as active path as soon as a better candidate path is found valid.
- The values '1..65535' results are that the candidate path is replaced from installed as active, only once it was used for the duration of the lock timer or once found to be invalid.
- The value 'until-invalid' result is that the candidate path is replaced only once found to be invalid.


To configure the lock timer for sr-te path:


**Command syntax: lock [lock]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy path

**Note**

- The lock does not prevent a backup path from becoming active if the active path fails.

- The lock timer starts upon path installed as active. The path update does not reset the lock timer.

- Reconfig of the lock timer only applies to the next time the lock is set.

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| lock      | Set a lock over a given candidate path to prevent path replacement in case a     | \-    | 0       |
|           | better candidate path found valid to use                                         |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# path PATH_1 priority 5
    dnRouter(cfg-mpls-policy-path)# lock 30

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# path PATH_1 priority 5
    dnRouter(cfg-mpls-policy-path)# lock until-invalid


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-sr-mpls-policy)# no lock

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/policy/path/path.rst

protocols segment-routing mpls policy path
------------------------------------------

**Minimum user role:** operator

Configure path


**Command syntax: path [path]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Parameter table**

+-----------+---------------------------+------------------+---------+
| Parameter | Description               | Range            | Default |
+===========+===========================+==================+=========+
| path      | segment-routing path name | | string         | \-      |
|           |                           | | length 1-255   |         |
+-----------+---------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# path PATH_1
    dnRouter(cfg-mpls-policy-path)#


**Removing Configuration**

To remove the path setting:
::

    dnRouter(cfg-sr-mpls-policy)# no path PATH_1

**Command History**

+---------+-------------------------------+
| Release | Modification                  |
+=========+===============================+
| 17.0    | Command introduced            |
+---------+-------------------------------+
| 18.3    | Moved priority to new command |
+---------+-------------------------------+

---

### mpls/policy/path/priority.rst

protocols segment-routing mpls policy path priority
---------------------------------------------------

**Minimum user role:** operator

Configure path priority


**Command syntax: priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy path

**Parameter table**

+-----------+----------------------------+-------+---------+
| Parameter | Description                | Range | Default |
+===========+============================+=======+=========+
| priority  | SR-TE policy path priority | 1-255 | \-      |
+-----------+----------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# path PATH_1
    dnRouter(cfg-mpls-policy-path)# priority 5
    dnRouter(cfg-mpls-policy-path)#


**Removing Configuration**

To remove the priority setting:
::

    dnRouter(cfg-mpls-policy-path)# no priority

**Command History**

+---------+-----------------------------------------+
| Release | Modification                            |
+=========+=========================================+
| 17.0    | Command introduced                      |
+---------+-----------------------------------------+
| 18.3    | Command detached from base path command |
+---------+-----------------------------------------+

---

### mpls/policy/policy.rst

protocols segment-routing mpls policy
-------------------------------------

**Minimum user role:** operator

Use a segment-routing policy to forward traffic along a specific path defined as head-end according the list of segments policy uses. When a packet is forwarded according to an SR policy, the SID list (MPLS labels) is pushed on the packet MPLS stack at the policy head-end. The downstream nodes forward the packet according to actions associated with the SID.

A policy may have one of the following states:

	Up: the policy has at least one valid path and can be used to forward traffic. Only a policy in this state is installed into the forwarding table.
	Down: the policy has been correctly configured, but it does not contain any valid paths (either path or destination is invalid). In this case, the policy is removed from the forwarding table.
	Admin-down: the policy has been disabled via the configuration / or by external means of a signaling protocol. The policy is removed from the forwarding table.

The following restrictions apply to policies:

	You must configure a policy destination.
	You cannot configure two policies with the same head and destination.

To configure the segment-routing policy:


**Command syntax: policy [policy]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Note**
Required validations:

- policy destination must be configured

- policy color must be configured

- 2 policies from the same head to the same tail with the same color cannot exist


**Parameter table**

+-----------+-----------------------------+------------------+---------+
| Parameter | Description                 | Range            | Default |
+===========+=============================+==================+=========+
| policy    | segment-routing policy name | | string         | \-      |
|           |                             | | length 1-255   |         |
+-----------+-----------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)#


**Removing Configuration**

To remove a specific or all configured policies:
::

    dnRouter(cfg-protocols-sr-mpls)# no policy SR_POLICY_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### mpls/policy/seamless-bfd/admin-state.rst

protocols segment-routing mpls policy seamless-bfd admin-state
--------------------------------------------------------------

**Minimum user role:** operator

When disabled, the S-BFD session(s) is not initiated on the paths of the Segment Routing Policy.

To enable/disable the S-BFD session(s):

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy seamless-bfd

**Parameter table**

+-------------+------------------------------+--------------+----------+
| Parameter   | Description                  | Range        | Default  |
+=============+==============================+==============+==========+
| admin-state | S-BFD Session(s) admin state | | enabled    | disabled |
|             |                              | | disabled   |          |
+-------------+------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)# admin-state enabled
    dnRouter(cfg-mpls-policy-sbfd)#


**Removing Configuration**

To return the admin-state to its default value:
::

    dnRouter(cfg-mpls-policy-sbfd) no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/policy/seamless-bfd/failure-action.rst

protocols segment-routing mpls policy seamless-bfd failure-action
-----------------------------------------------------------------

**Minimum user role:** operator

Configure the failure-action to be performed when the S-BFD session fails. If 'down' - then the SR-TE policy state is set to down if the S-BFD session fails. If it is 'none' then the SR-TE state is not affected by the S-BFD state.

**Command syntax: failure-action [failure-action]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy seamless-bfd

**Parameter table**

+----------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter      | Description                                                                      | Range    | Default |
+================+==================================================================================+==========+=========+
| failure-action | Define whether failure of the S-BFD session will bring the SR-TE state 'down' or | | down   | down    |
|                | not affect it                                                                    | | none   |         |
+----------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)# failure-action none
    dnRouter(cfg-mpls-policy-sbfd)#


**Removing Configuration**

To return the failure-action to its default value:
::

    dnRouter(cfg-mpls-policy-sbfd) no failure-action

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/policy/seamless-bfd/interval.rst

protocols segment-routing mpls policy seamless-bfd interval
-----------------------------------------------------------

**Minimum user role:** operator

Configure the interval value for the S-BFD session.

**Command syntax: interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy seamless-bfd

**Parameter table**

+-----------+---------------------------------------------------+--------+---------+
| Parameter | Description                                       | Range  | Default |
+===========+===================================================+========+=========+
| interval  | set desired interval (msec) for the S-BFD session | 5-1700 | 300     |
+-----------+---------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)# interval 6
    dnRouter(cfg-mpls-policy-sbfd)#


**Removing Configuration**

To remove the interval and return to its default value:
::

    dnRouter(cfg-mpls-policy-sbfd) no interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/policy/seamless-bfd/multiplier.rst

protocols segment-routing mpls policy seamless-bfd multiplier
-------------------------------------------------------------

**Minimum user role:** operator

Configure a multiplier value which will be used for the S-BFD session.

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy seamless-bfd

**Parameter table**

+------------+----------------------------+-------+---------+
| Parameter  | Description                | Range | Default |
+============+============================+=======+=========+
| multiplier | set local S-BFD multiplier | 2-16  | 3       |
+------------+----------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)# multiplier 5
    dnRouter(cfg-mpls-policy-sbfd)#


**Removing Configuration**

To remove the multiplier value:
::

    dnRouter(cfg-mpls-policy-sbfd) no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/policy/seamless-bfd/remote-reflector-discriminator.rst

protocols segment-routing mpls policy seamless-bfd remote-reflector-discriminator
---------------------------------------------------------------------------------

**Minimum user role:** operator

Configure the discriminator value of the SR-TE path endpoint.

**Command syntax: remote-reflector-discriminator [remote-reflector-discriminator]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy seamless-bfd

**Parameter table**

+--------------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter                      | Description                                                                      | Range            | Default |
+================================+==================================================================================+==================+=========+
| remote-reflector-discriminator | User can optionally supply the remote discriminator value that will be used by   | | 1-4294967295   | \-      |
|                                | the S-BFD                                                                        | | A.B.C.D        |         |
+--------------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)# remote-reflector-discriminator 14267
    dnRouter(cfg-mpls-policy-sbfd)#


    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)# remote-reflector-discriminator 187.23.45.9
    dnRouter(cfg-mpls-policy-sbfd)#


**Removing Configuration**

To remove the remote-reflector-discriminator value:
::

    dnRouter(cfg-mpls-policy-sbfd) no remote-reflector-discriminator

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/policy/seamless-bfd/reverse-path-label.rst

protocols segment-routing mpls policy seamless-bfd reverse-path-label
---------------------------------------------------------------------

**Minimum user role:** operator

An Operator may add additional labels on the S-BFD packets sent over SR-TE policy. Label is used to indicate a return path from policy tail-end to policy head-end. 
For example, usage of binding-sid label value matching a policy at tail-end node ending at head-end node.
As a result the S-BFD packets will undergo mpls forwarding by policy tail-end instead of tail-end reflector logic processing, looping S-BFD packets back to head-end
To set S-BFD reverse-path-label:

**Command syntax: reverse-path-label [reverse-path-label]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy seamless-bfd

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------------+---------+
| Parameter          | Description                                                                      | Range       | Default |
+====================+==================================================================================+=============+=========+
| reverse-path-label | Configure reverse-path label to be set on BoS for Seamless BFD initiated         | 256-1048575 | \-      |
|                    | packets. When configured, Seamless BFD works in looped mode                      |             |         |
+--------------------+----------------------------------------------------------------------------------+-------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)# reverse-path-label 144267


**Removing Configuration**

To remove the reverse-path-label:
::

    dnRouter(cfg-mpls-policy-sbfd) no reverse-path-label

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### mpls/policy/seamless-bfd/seamless-bfd.rst

protocols segment-routing mpls policy seamless-bfd
--------------------------------------------------

**Minimum user role:** operator

To configure the seamless-BFD session that will be applied on the path(s) of the policy.

**Command syntax: seamless-bfd**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls policy

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# policy SR_POLICY_1
    dnRouter(cfg-sr-mpls-policy)# seamless-bfd
    dnRouter(cfg-mpls-policy-sbfd)#


**Removing Configuration**

To remove the seamless-bfd sessions on the SR policy:
::

    dnRouter(cfg-sr-mpls-policy)# no seamless-bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.3    | Command introduced |
+---------+--------------------+

---

### mpls/traffic-engineering.rst

protocols segment-routing mpls traffic-engineering administrative-distance
--------------------------------------------------------------------------

**Minimum user role:** operator

Administrative distance is an arbitrary numerical value that is assigned to routes to allow the router to decide which routing protocol to select for installation in the FIB and for route resolution for protocol next-hop when multiple protocols provide route information for the same destination. The assigned value denotes the preference of the route compared to other routes, such that a lower value denotes a more preferred route.

By setting the administrative distance for SR-TE, you can control the SR-TE policy's preference over other protocols (ISIS-SR, LDP, RSVP) in the RIB tables.

To configure the administrative distance used for SR-TE:

**Command syntax: traffic-engineering administrative-distance [administrative-distance]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing mpls

**Note**
-  An administrative distance of 255 will cause the router to remove the route from the routing table and not use it

-  Reconfiguration of administrative-distance will take immediate effect

**Parameter table**

+-------------------------+------------------------------------------------------------------+-------+---------+
| Parameter               | Description                                                      | Range | Default |
+=========================+==================================================================+=======+=========+
| administrative-distance | Sets the Segment-Routing administrative-distance used for SR-TE. | 1-255 | 103     |
+-------------------------+------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# mpls
    dnRouter(cfg-protocols-sr-mpls)# traffic-engineering administrative-distance 90


**Removing Configuration**

To return the admin-distance to its default value:
::

    dnRouter(cfg-protocols-msdp-peer-timers)# no administrative-distance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### pcep/admin-state.rst

protocols segment-routing pcep admin-state
------------------------------------------

**Minimum user role:** operator

To enable or disable the PCEP protocol:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Parameter table**

+-------------+----------------------+--------------+----------+
| Parameter   | Description          | Range        | Default  |
+=============+======================+==============+==========+
| admin-state | enable pcep protocol | | enabled    | disabled |
|             |                      | | disabled   |          |
+-------------+----------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# admin-state enabled


**Removing Configuration**

To revert the admin-state to its default value:
::

    dnRouter(cfg-protocols-sr-pcep)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/authentication.rst

protocols segment-routing pcep authentication password
------------------------------------------------------

**Minimum user role:** operator

To protect PCEP TCP sessions between the PCE and PCC using an MD5 authentication algorithm:

**Command syntax: authentication [admin-state] password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Parameter table**

+--------------+---------------------------------------------------------+--------------+----------+
| Parameter    | Description                                             | Range        | Default  |
+==============+=========================================================+==============+==========+
| admin-state  | set whether authentication is enabled                   | | enabled    | disabled |
|              |                                                         | | disabled   |          |
+--------------+---------------------------------------------------------+--------------+----------+
| enc-password | pcep authentication password. saved Encypeted in the DB | \-           | \-       |
+--------------+---------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# authentication enabled password
    Enter password
    Enter password for verifications
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# authentication enabled password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==


**Removing Configuration**

To remove authentication usage:
::

    dnRouter(cfg-protocols-sr-pcep)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/class-of-service.rst

protocols segment-routing pcep class-of-service
-----------------------------------------------

**Minimum user role:** operator

With class-of-service (CoS) you can classify traffic to provide different service levels to different traffic so that when congestion occurs, you can control which packets receive priority.

To configure CoS for outgoing PCEP packets:

**Command syntax: class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Parameter table**

+------------------+------------------------------------------+-------+---------+
| Parameter        | Description                              | Range | Default |
+==================+==========================================+=======+=========+
| class-of-service | set dscp value for outgoing PCEP packets | 0-56  | 48      |
+------------------+------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# class-of-service 48


**Removing Configuration**

To revert class-of-service to its default value:
::

    dnRouter(cfg-protocols-sr-pcep)# no class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/admin-state.rst

protocols segment-routing pcep pce-initiated admin-state
--------------------------------------------------------

**Minimum user role:** operator

To enable support for PCE initiated SR-TE policies:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated

**Parameter table**

+-------------+------------------------------------------------+--------------+----------+
| Parameter   | Description                                    | Range        | Default  |
+=============+================================================+==============+==========+
| admin-state | enable support for PCE initiated SR-TE polices | | enabled    | disabled |
|             |                                                | | disabled   |          |
+-------------+------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# admin-state enabled


**Removing Configuration**

To revert admin-state to default value:
::

    dnRouter(cfg-sr-pcep-init)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/igp-instance_isis.rst

protocols segment-routing pcep pce-initiated igp-instance isis
--------------------------------------------------------------

**Minimum user role:** operator

By default, the SR-TE policy is created in the lowest administrative-distance IGP instance.
To configure that SR-TE policy is created in a specific IS-IS instance:


**Command syntax: igp-instance isis [isis-instance-name]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated

**Note**

- ISIS is by default preferred over OSPF as a required IGP instance.

**Parameter table**

+--------------------+---------------------+-------+---------+
| Parameter          | Description         | Range | Default |
+====================+=====================+=======+=========+
| isis-instance-name | IS-IS instance name | \-    | \-      |
+--------------------+---------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-protocols-sr-pcep)# igp-instance isis instance_1


**Removing Configuration**

To revert the igp-instance to its default value:
::

    dnRouter(cfg-sr-pcep-init)# no igp-instance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/igp-instance_ospf.rst

protocols segment-routing pcep pce-initiated igp-instance ospf
--------------------------------------------------------------

**Minimum user role:** operator

By default, the SR-TE policy is created in the lowest administrative-distance IGP instance.
To configure that SR-TE policy is created in a specific OSPF instance:


**Command syntax: igp-instance ospf [ospf-instance-name]** area [area]

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated

**Note**
- ISIS is by default preferred over OSPF as a required IGP instance
- Support for inter-area SR-TE policy follows the following guidelines:
* Policy destination address and algorithm, required to be resolved to SID value. which will define the last SID on stack. Destination may be inter-area route, leading to construct a policy towards ABR advertising the SID
* Explicit path first hop must be a resolvable address / index / label to decide on egress nexthop.
** First hop can be inter-area sid. address expected to be resolved to match SR route. index/label expected to be resolve per local srgb matching the equivalent ILM route result
** For any hop after an inter-area address hop, support only as SID index or absolute label
- If address is given, path will be declared as invalid
- If index is given, the label value will match ABR SRGB base
- For the first inter-area route on the segment-list hops, , require to verify that given index is within the ABR SRGB, otherwise segment-list is invalid
- In case there are ABR ECMP advertising same inter-area SID , only one ABR will be checked to define the absolute label value (per its SRGB base) and the index validity check
- If absolute label is given, the provided label is be imposed , no validation required, no srgb translation

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ospf-instance-name | OSPFv2 instance name                                                             | \-    | \-      |
+--------------------+----------------------------------------------------------------------------------+-------+---------+
| area               | The desired OSPF area for the desired OSPF instance in which SR-TE policy should | \-    | \-      |
|                    | be constructed                                                                   |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-protocols-sr-pcep)# igp-instance ospf instance_1
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-protocols-sr-pcep)# igp-instance ospf instance_1 area 0


**Removing Configuration**

To revert the igp-instance to its default value:
::

    dnRouter(cfg-protocols-sr-pcep)# no igp-instance ospf instance_1 area 0
    dnRouter(cfg-protocols-sr-pcep)# no igp-instance ospf instance_1
    dnRouter(cfg-protocols-sr-pcep)# no igp-instance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/backup-path-install.rst

protocols segment-routing pcep pce-initiated impose-behavior backup-path-install
--------------------------------------------------------------------------------

**Minimum user role:** operator

When a backup-install-path is set for a given policy, DNOS picks the next (lower) preference valid candidate path as the backup for the active candidate path.
The backup path is installed to the FIB to provide sub 50 msec failover upon an active path failure.

To enable end to end protecition and support the backup path installation:


**Command syntax: backup-path-install [backup-path-install]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior

**Note**
- For the policy to have a backup path, at least two paths need to be configured for the policy (no commit validation required).
- Each path, both active and backup, are fully defined by their path settings. There is no implicit disjoint constraint between them.


**Parameter table**

+---------------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter           | Description                                                                      | Range        | Default |
+=====================+==================================================================================+==============+=========+
| backup-path-install | Utilize lower preference candidate path as policy end to end back path installed | | enabled    | \-      |
|                     | to RIB and FIB                                                                   | | disabled   |         |
+---------------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-sr-pcep-init)# backup-path-install enabled


**Removing Configuration**

To return the backup-path-install setting to its default value:
::

    dnRouter(cfg-sr-pcep-init)# no backup-path-install

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/igp-instance_isis.rst

protocols segment-routing pcep pce-initiated impose-behavior igp-instance isis
------------------------------------------------------------------------------

**Minimum user role:** operator

By default, the SR-TE policy is created in the lowest administrative-distance IGP instance.
To configure that the SR-TE policy is created in a specific IS-IS instance:


**Command syntax: igp-instance isis [isis-instance-name]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior

**Note**

- ISIS is by default preferred over OSPF as a required IGP instance.

**Parameter table**

+--------------------+---------------------+-------+---------+
| Parameter          | Description         | Range | Default |
+====================+=====================+=======+=========+
| isis-instance-name | IS-IS instance name | \-    | \-      |
+--------------------+---------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# igp-instance isis instance_1


**Removing Configuration**

To revert the igp-instance to its default value:
::

    dnRouter(cfg-sr-pcep-init)# no igp-instance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/igp-instance_ospf.rst

protocols segment-routing pcep pce-initiated impose-behavior igp-instance ospf
------------------------------------------------------------------------------

**Minimum user role:** operator

By default, the SR-TE policy is created in the lowest administrative-distance IGP instance.
To configure that SR-TE policy is created in a specific OSPF instance:


**Command syntax: igp-instance ospf [ospf-instance-name]** area [area]

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior

**Note**
- ISIS is by default preferred over OSPF as a required IGP instance
- Support for inter-area SR-TE policy follows the following guidelines:
* Policy destination address and algorithm, required to be resolved to SID value. which will define the last SID on stack. Destination may be inter-area route, leading to construct a policy towards ABR advertising the SID
* Explicit path first hop must be a resolvable address / index / label to decide on egress nexthop.
** First hop can be inter-area sid. address expected to be resolved to match SR route. index/label expected to be resolve per local srgb matching the equivalent ILM route result
** For any hop after an inter-area address hop, support only as SID index or absolute label
- If an address is given, the path will be declared as invalid
- If an index is given, the label value will match ABR SRGB base
- For the first inter-area route on the segment-list hops, require to verify that given index is within the ABR SRGB, otherwise segment-list is invalid
- In case there are ABR ECMP advertising same inter-area SID , only one ABR will be checked to define the absolute label value (per its SRGB base) and the index validity check
- If absolute label is given, the provided label is be imposed, no validation required and no srgb translation.

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter          | Description                                                                      | Range | Default |
+====================+==================================================================================+=======+=========+
| ospf-instance-name | OSPFv2 instance name                                                             | \-    | \-      |
+--------------------+----------------------------------------------------------------------------------+-------+---------+
| area               | The desired OSPF area for the desired OSPF instance in which SR-TE policy should | \-    | \-      |
|                    | be constructed                                                                   |       |         |
+--------------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# igp-instance ospf instance_1
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# igp-instance ospf instance_1 area 0


**Removing Configuration**

To revert the igp-instance to its default value:
::

    dnRouter(cfg-sr-pcep-init)# no igp-instance ospf instance_1 area 0
    dnRouter(cfg-sr-pcep-init)# no igp-instance ospf instance_1
    dnRouter(cfg-sr-pcep-init)# no igp-instance

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/igp-shortcuts.rst

protocols segment-routing pcep pce-initiated impose-behavior igp-shortcuts
--------------------------------------------------------------------------

**Minimum user role:** operator

To enable usage of PCE initiated policies in IGP-Shortcuts calculations:

**Command syntax: igp-shortcuts [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior

**Parameter table**

+-------------+------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                            | Range        | Default |
+=============+========================================================================+==============+=========+
| admin-state | Configure usage of SR policy as shortcuts in IGP shortcut calculations | | enabled    | \-      |
|             |                                                                        | | disabled   |         |
+-------------+------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# igp-shortcuts enabled


**Removing Configuration**

To revert admin-state to default value:
::

    dnRouter(cfg-pcep-init-impose)# no igp-shortcuts

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/impose-behavior.rst

protocols segment-routing pcep pce-initiated impose-behavior
------------------------------------------------------------

**Minimum user role:** operator

Configure PCC local behavior to be imposed on PCE initiated policies.
To enter impose-behavior configuration level:

**Command syntax: impose-behavior**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)#


**Removing Configuration**

To revert all sr-te pcep pce-initiated configuration to default:
::

    dnRouter(cfg-sr-pcep-init)# no impose-behavior

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/seamless-bfd/admin-state.rst

protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd admin-state
-------------------------------------------------------------------------------------

**Minimum user role:** operator

When disabled, the S-BFD session(s) is not initiated on the paths of the Segment Routing Policy.

To enable/disable the S-BFD session(s):

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd

**Parameter table**

+-------------+------------------------------+--------------+---------+
| Parameter   | Description                  | Range        | Default |
+=============+==============================+==============+=========+
| admin-state | S-BFD Session(s) admin state | | enabled    | \-      |
|             |                              | | disabled   |         |
+-------------+------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# seamless-bfd
    dnRouter(cfg-init-impose-sbfd)# admin-state enabled


**Removing Configuration**

To return the admin-state to its default value:
::

    dnRouter(cfg-init-impose-sbfd) no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/seamless-bfd/failure-action.rst

protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd failure-action
----------------------------------------------------------------------------------------

**Minimum user role:** operator

Configure the failure-action to be performed when the S-BFD session fails. If 'down' - then the SR-TE policy state is set to down if the S-BFD session fails. If it is 'none' then the SR-TE state is not affected by the S-BFD state.

**Command syntax: failure-action [failure-action]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd

**Parameter table**

+----------------+----------------------------------------------------------------------------------+----------+---------+
| Parameter      | Description                                                                      | Range    | Default |
+================+==================================================================================+==========+=========+
| failure-action | Define whether failure of the S-BFD session will bring the SR-TE state 'down' or | | down   | \-      |
|                | not affect it                                                                    | | none   |         |
+----------------+----------------------------------------------------------------------------------+----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# seamless-bfd
    dnRouter(cfg-init-impose-sbfd)# failure-action none


**Removing Configuration**

To return the failure-action to its default value:
::

    dnRouter(cfg-init-impose-sbfd) no failure-action

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/seamless-bfd/interval.rst

protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd interval
----------------------------------------------------------------------------------

**Minimum user role:** operator

Configure the interval value for the S-BFD session.

**Command syntax: interval [interval]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd

**Parameter table**

+-----------+---------------------------------------------------+--------+---------+
| Parameter | Description                                       | Range  | Default |
+===========+===================================================+========+=========+
| interval  | set desired interval (msec) for the S-BFD session | 5-1700 | \-      |
+-----------+---------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# seamless-bfd
    dnRouter(cfg-init-impose-sbfd)# interval 6


**Removing Configuration**

To remove the interval and return to its default value:
::

    dnRouter(cfg-init-impose-sbfd) no interval

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/seamless-bfd/multiplier.rst

protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd multiplier
------------------------------------------------------------------------------------

**Minimum user role:** operator

Configure a multiplier value which will be used for the S-BFD session.

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd

**Parameter table**

+------------+----------------------------+-------+---------+
| Parameter  | Description                | Range | Default |
+============+============================+=======+=========+
| multiplier | set local S-BFD multiplier | 2-16  | \-      |
+------------+----------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# seamless-bfd
    dnRouter(cfg-init-impose-sbfd)# multiplier 5


**Removing Configuration**

To remove the multiplier value:
::

    dnRouter(cfg-init-impose-sbfd) no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/impose-behavior/seamless-bfd/seamless-bfd.rst

protocols segment-routing pcep pce-initiated impose-behavior seamless-bfd
-------------------------------------------------------------------------

**Minimum user role:** operator

To configure the seamless-BFD session that will be applied on the path(s) of the policy.

**Command syntax: seamless-bfd**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated impose-behavior

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# impose-behavior
    dnRouter(cfg-pcep-init-impose)# seamless-bfd
    dnRouter(cfg-init-impose-sbfd)#


**Removing Configuration**

To remove the seamless-bfd sessions on the SR policy:
::

    dnRouter(cfg-pcep-init-impose)# no seamless-bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/maximum-initiated-policies.rst

protocols segment-routing pcep pce-initiated maximum-initiated-policies threshold
---------------------------------------------------------------------------------

**Minimum user role:** operator

Control the number of PCE initiated policies created over the PCC.
When the configured threshold is crossed, a single system-event notification is generated, PCC will accept initiated policies behind this point as long as number is not crossed.
If number of initiated LSPs goes below the configured threshold, a single system-event notification is generated.
When the total number of initiated LSPs reach configured maximum,  a single system-event notification is generated, from that point PCC will not accept additional (new) PCE initiated LSPs. Upon such PCInit request, PCC will reply with PCErr message
When the total number of initiated LSPs goes below configured maximum, a single system-event notification is generated.

To configure maximum-initiated-policies:

**Command syntax: maximum-initiated-policies [maximum-policies] threshold [threshold]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce-initiated

**Note**

- In case a user reconfigures the maximum to a lower value than already existing initiated policies, a single system-event notification is generated and any new initiation request will be rejected. A caution will be generated that the 70% threshold has been crossed. If you do nothing, you will not receive another notification until the number of sessions reaches 600.

**Parameter table**

+------------------+---------------------------------------------------------+--------+---------+
| Parameter        | Description                                             | Range  | Default |
+==================+=========================================================+========+=========+
| maximum-policies | maximum number of supported PCE initiated SR-TE polices | 1-2000 | 100     |
+------------------+---------------------------------------------------------+--------+---------+
| threshold        | threshold as a percentage of system maximum number      | 1-100  | 75      |
+------------------+---------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)# maximum-initiated-policies 400 threshold 85


**Removing Configuration**

To revert maximum and threshold to default values:
::

    dnRouter(cfg-sr-pcep-init)# no maximum-initiated-policies

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce-initiated/pce-initiated.rst

protocols segment-routing pcep pce-initiated
--------------------------------------------

**Minimum user role:** operator

Enter PCE initiated SR-TE policy configuration level:

**Command syntax: pce-initiated**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce-initiated
    dnRouter(cfg-sr-pcep-init)#


**Removing Configuration**

To revert all sr-te pcep pce-initiated configuration to default:
::

    dnRouter(cfg-protocols-sr-pcep)# no pce-initiated

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce/admin-state.rst

protocols segment-routing pcep pce priority address admin-state
---------------------------------------------------------------

**Minimum user role:** operator

To enable or disable the PCEP protocol:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce priority address

**Parameter table**

+-------------+---------------------------------------------------------------+--------------+----------------------------------+
| Parameter   | Description                                                   | Range        | Default                          |
+=============+===============================================================+==============+==================================+
| admin-state | set whether the pce server is available or not for delegation | | enabled    | segment routing pcep admin-state |
|             |                                                               | | disabled   |                                  |
+-------------+---------------------------------------------------------------+--------------+----------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce priority 1 address 1.1.1.1
    dnRouter(cfg-sr-pcep-pce)# admin-state enabled


**Removing Configuration**

To revert admin-state to its default value:
::

    dnRouter(cfg-sr-pcep-pce)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce/authentication.rst

protocols segment-routing pcep pce priority address authentication password
---------------------------------------------------------------------------

**Minimum user role:** operator

To protect PCEP TCP sessions between PCE and PCC using an MD5 authentication algorithm:

**Command syntax: authentication [admin-state] password [enc-password]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce priority address

**Parameter table**

+--------------+---------------------------------------------------------+--------------+---------+
| Parameter    | Description                                             | Range        | Default |
+==============+=========================================================+==============+=========+
| admin-state  | set whether authentication is enabled                   | | enabled    | \-      |
|              |                                                         | | disabled   |         |
+--------------+---------------------------------------------------------+--------------+---------+
| enc-password | pcep authentication password. saved Encypeted in the DB | \-           | \-      |
+--------------+---------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce priority 1 address 1.1.1.1
    dnRouter(cfg-sr-pcep-pce)# authentication enabled password
    Enter password
    Enter password for verifications
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)#  pce priority 1 address 1.1.1.1
    dnRouter(cfg-sr-pcep-pce)# authentication enabled password enc-gAAAAABduqxChJ4bui9rSfwefF6MglPHuX8clLpAbLjXAEdzVH-sJWVIkKxVx2ukbwSq6_T79AR8oXJfw5ugGjKE95gv3ggatw==


**Removing Configuration**

To remove authentication usage:
::

    dnRouter(cfg-sr-pcep-pce)# no authentication

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce/pce.rst

protocols segment-routing pcep pce priority address
---------------------------------------------------

**Minimum user role:** operator

A path computation element (PCE) is a network entity that can calculate a network path based on the network topology.
Only one PCE is operational at any given time. This is the primary PCE.
Any other PCE is a backup PCE that will only come into play if the primary PCE fails.
You can configure up to 5 PCE servers. The PCE with the higher priority (lower configured priority value) will serve as the primary PCE.
All other configured PCEs will serve as backups.

A backup PCE does not control policy lsps (whether locally initiated by the PCC or by the PCE), but is reported by the PCC on the PCC-initiated LSP status. Similarly, the PCC will not act upon receiving LSP paths from the backup PCE.
Following a switchover between primary and backup PCE (after session disconnection and timers expiry), there will be no preemption when the primary PCE becomes the backup PCE.
If the primary PCE returns to operation before redelegation of the backup PCE is established, the delegation of the primary PCE is preserved.

To configure the PCE server priority and address and enter its configuration mode:

**Command syntax: pce priority [priority] address [ip-address]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Note**

- Up to 5 pce servers can be configured

- All PCE servers of both segment-routing and mpls traffic-engineering must have different source+destination addresses.

**Parameter table**

+------------+------------------+---------+---------+
| Parameter  | Description      | Range   | Default |
+============+==================+=========+=========+
| priority   | pce priority     | 1-255   | \-      |
+------------+------------------+---------+---------+
| ip-address | pce ipv4-address | A.B.C.D | \-      |
+------------+------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce priority 1 address 1.1.1.1


**Removing Configuration**

To remove the PCE server configuration:
::

    dnRouter(cfg-protocols-sr-pcep)# no pce priority 1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce/timers/dead-timer.rst

protocols segment-routing pcep pce priority address timers dead-timer
---------------------------------------------------------------------

**Minimum user role:** operator

The dead-timer is another PCEP session maintenance timer that works in tandem with the keep-alive timer (see "segment-routing pcep pce timers keep-alive"). Both PCE and PCC run dead timers and restart them whenever a message is received on the session. If one session end does not receive a message before the dead timer expires, it declares the session dead.

The dead timer value is negotiated between the PCC and PCE during PCEP session establishment. If the two timers are not identical, then the timer that will be selected for the session is the maximum between the configured dead-timer and the dead-timer received from the PCE in the OPEN message.

To configure the dead-timer's timeout interval:

**Command syntax: dead-timer [dead-timer]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce priority address timers

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| dead-timer | timeout interval for PCC and PCE session if the PCC does not receive keep-alive  | 0-255 | \-      |
|            | messages from the PCE                                                            |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)#  pce priority 1 address 1.1.1.1
    dnRouter(cfg-sr-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# dead-timer 50


**Removing Configuration**

To revert dead-timer configuration to default:
::

    dnRouter(cfg-pcep-pce-timers)# no dead-timer

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce/timers/keep-alive.rst

protocols segment-routing pcep pce priority address timers keep-alive
---------------------------------------------------------------------

**Minimum user role:** operator

PCEP keep-alive messages are used to maintain PCEP sessions. Once a session is established, the PCE or PCC is periodically informed whether or not its PCEP peer is still available for use.

Each end of a PCEP session runs a keep-alive timer. When the timer expires, it sends a keep-alive message to its peer and restarts the timer. The Keep-alive timer value is negotiated between the PCC and PCE during PCEP session establishment. If the two timers are not identical, then the timer that will be selected for the session is the minimum between the configured keep-alive timer and the keep-alive received from the PCE in the OPEN message.

To configure the interval between keep-alive messages between PCC and PCE:

**Command syntax: keep-alive [keep-alive]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce priority address timers

**Parameter table**

+------------+----------------------------------------------------------+-------+---------+
| Parameter  | Description                                              | Range | Default |
+============+==========================================================+=======+=========+
| keep-alive | time interval to keep-alive messages between PCC and PCE | 0-255 | \-      |
+------------+----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# pce priority 1 address 1.1.1.1
    dnRouter(cfg-sr-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# keep-alive 10


**Removing Configuration**

To revert keep-alive configuration to default:
::

    dnRouter(cfg-pcep-pce-timers)# no keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce/timers/lsp-state-timeout.rst

protocols segment-routing pcep pce priority address timers lsp-state-timeout
----------------------------------------------------------------------------

**Minimum user role:** operator

When a PCEP session with a PCE disconnects, the PCC redelegates to an alternative PCE.
The LSP-state-timeout is the amount of time after redelegation that the PCC waits before flushing the LSP states associated with the disconnected PCEP session and reverting to the local default configurations.
This operation is performed in a make-before-break fashion.

To configure the lsp-state-timeout:

**Command syntax: lsp-state-timeout [timeout]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce priority address timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------------+--------------------------------------------------------------+
| Parameter | Description                                                                      | Range              | Default                                                      |
+===========+==================================================================================+====================+==============================================================+
| timeout   | time (in seconds) that a path computation client (PCC) must wait before removing | 0..3600 | infinity | Inherited from segment-routing pcep timers lsp-state-timeout |
|           | the LSPs associated with a PCEP session that is disconnected and reverting back  |                    |                                                              |
|           | to the local defaults attributes/configuration                                   |                    |                                                              |
+-----------+----------------------------------------------------------------------------------+--------------------+--------------------------------------------------------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)#  pce priority 1 address 1.1.1.1
    dnRouter(cfg-sr-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# lsp-state-timeout 20


**Removing Configuration**

To revert lsp-state-timeout configuration to default:
::

    dnRouter(cfg-pcep-pce-timers)# no lsp-state-timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce/timers/redelegation-timeout.rst

protocols segment-routing pcep pce priority address timers redelegation-timeout
-------------------------------------------------------------------------------

**Minimum user role:** operator

The redelegation-timeout interval is the amount of time that a PCC waits before revoking LSP delegations to a PCE with which the PCEP session has terminated unexpectedly, and attempting to redelegate the LSPs to an alternate PCE.
If the PCEP session with the original PCE is restored before the redelegation timer expires, the LSP delegations will not be revoked.

To configure the redelegation-timeout interval:

**Command syntax: redelegation-timeout [timeout]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce priority address timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------+---------+
| Parameter | Description                                                                      | Range  | Default |
+===========+==================================================================================+========+=========+
| timeout   | time (in seconds) that a path computation client (PCC) must wait before          | 0-3600 | \-      |
|           | re-delegating LSPs after a PCEP session with the active stateful PCE is          |        |         |
|           | disconnected                                                                     |        |         |
+-----------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)#  pce priority 1 address 1.1.1.1
    dnRouter(cfg-sr-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)# redelegation-timeout 2000


**Removing Configuration**

To revert redelegation-timeout configuration to default:
::

    dnRouter(cfg-pcep-pce-timers)# no redelegation-timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pce/timers/timers.rst

protocols segment-routing pcep pce priority address timers
----------------------------------------------------------

**Minimum user role:** operator

There are two sets of PCEP timers:
-  Session maintenance timers - used for message transmission between PCC and PCE to notify one another of their availability. The session maintenance timers are based on keep-alive timers (see "pcep timers keep-alive") and dead timers (see "pcep timers dead-timer").
-  Session disconnection timers - determining what to do when a session unexpectedly disconnects. These timers are for the redelegation of a new PCE (see "pcep timers redelegation-timeout") and for removal of the LSPs from the disconnected PCE (see "pcep timers lsp-state-timeout").

To set global timers for messaging between PCC and PCE:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep pce priority address

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)#  pce priority 1 address 1.1.1.1
    dnRouter(cfg-sr-pcep-pce)# timers
    dnRouter(cfg-pcep-pce-timers)#


**Removing Configuration**

To revert all sr-te pcep timers configuration to default:
::

    dnRouter(cfg-sr-pcep-pce)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pcep_delegation.rst

protocols segment-routing pcep delegation
-----------------------------------------

**Minimum user role:** operator

Enables delegating SR-TE to a remote PCE.
For a delegated policy, the local router (acting as a PCC) will comply with policy updates provided by the PCE.
A policy path provided by the PCE will be considered as the most preferred path.
Policy information is passed to the PCE even if it is not delegated to it.

To enable delegating SR-TE:

**Command syntax: delegation [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Parameter table**

+-------------+----------------------------------------------------------------------------------+------------+----------+
| Parameter   | Description                                                                      | Range      | Default  |
+=============+==================================================================================+============+==========+
| admin-state | Enable SR-TE policy delegation to a remote PCE. Configuration apply as default   | enabled    | disabled |
|             | behavior for any sr-te policy                                                    | disabled   |          |
+-------------+----------------------------------------------------------------------------------+------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# delegation enabeld


**Removing Configuration**

To revert the pcep delegation to its default value:
::

    dnRouter(cfg-protocols-sr-pcep)# no delegation

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/pcep.rst

protocols segment-routing pcep
------------------------------

**Minimum user role:** operator

A path computation element (PCE) is a network entity that can calculate a network path based on the network topology.
A path computation client (PCC) is a client application that requests a path computation from the PCE.
The path computation element protocol (PCEP) is a TCP-based protocol that enables communication between PCEs, and between PCE and PCC.

PCEP defines messages and objects for managing PCEP sessions, and for requesting and sending path calculations. This includes SR-TE policy LSP status reports sent by the PCC and updates on external LSPs sent by the PCE.
In PCEP configuration mode, you can optimize network SR-TE policy paths and provide control over PCC defined paths.
By default, all SR-TE policies are reported to the PCE. Delegated policies are also controlled by the PCE.

To configure pcep, enter pcep configuration mode:

**Command syntax: pcep**

**Command mode:** config

**Hierarchies**

- protocols segment-routing

**Note**

- PCEP sessions use TCP destination port 4189

- PCEP supports in-band connectivity only.

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)#


**Removing Configuration**

To revert all sr-te pcep configurations to default:
::

    dnRouter(cfg-protocols-sr)# no pcep

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/source_interface.rst

protocols segment-routing pcep source interface
-----------------------------------------------

**Minimum user role:** operator

To configure the PCEP source (either an IPv4 address or an interface):

**Command syntax: source interface [interface]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Parameter table**

+-----------+----------------------------------------------------------------------+------------------+---------+
| Parameter | Description                                                          | Range            | Default |
+===========+======================================================================+==================+=========+
| interface | interface from which the ipv4 address will be used as source address | | string         | \-      |
|           |                                                                      | | length 1-255   |         |
+-----------+----------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# source interface lo0


**Removing Configuration**

To revert to the default source address (the MPLS TE router-id):
::

    dnRouter(cfg-protocols-sr-pcep)# no source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/source_ipv4-address.rst

protocols segment-routing pcep source ipv4-address
--------------------------------------------------

**Minimum user role:** operator

To configure the PCEP source (either an IPv4 address or an interface):

**Command syntax: source ipv4-address [ipv4-address]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Parameter table**

+--------------+---------------------+---------+---------+
| Parameter    | Description         | Range   | Default |
+==============+=====================+=========+=========+
| ipv4-address | ipv4 source address | A.B.C.D | \-      |
+--------------+---------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# source ipv4-address 2.2.2.2


**Removing Configuration**

To revert to the default source address (the MPLS TE router-id):
::

    dnRouter(cfg-protocols-sr-pcep)# no source

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/timers/dead-timer.rst

protocols segment-routing pcep timers dead-timer
------------------------------------------------

**Minimum user role:** operator

The dead-timer is another PCEP session maintenance timer that works in tandem with the keep-alive timer (see "segment-routing pcep pce timers keep-alive"). Both PCE and PCC run dead timers and restart them whenever a message is received on the session. If one session end does not receive a message before the dead timer expires, it declares the session dead.
The dead timer value is negotiated between the PCC and PCE during PCEP session establishment.
If the two timers are not identical, then the timer that will be selected for the session is the maximum between the configured dead-timer and the dead-timer received from the PCE in the OPEN message.

To configure the dead-timer's timeout interval:

**Command syntax: dead-timer [dead-timer]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep timers

**Parameter table**

+------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter  | Description                                                                      | Range | Default |
+============+==================================================================================+=======+=========+
| dead-timer | timeout interval for PCC and PCE session if the PCC does not receive keep-alive  | 0-255 | 40      |
|            | messages from the PCE                                                            |       |         |
+------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# timers
    dnRouter(cfg-sr-pcep-timers)# dead-timer 50


**Removing Configuration**

To revert dead-timer configuration to default:
::

    dnRouter(cfg-sr-pcep-timers)# no dead-timer

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/timers/keep-alive.rst

protocols segment-routing pcep timers keep-alive
------------------------------------------------

**Minimum user role:** operator

PCEP keep-alive messages are used to maintain PCEP sessions. Once a session is established, the PCE or PCC is periodically informed whether or not its PCEP peer is still available for use.

Each end of a PCEP session runs a keep-alive timer.
When the timer expires, it sends a keep-alive message to its peer and restarts the timer.
The Keep-alive timer value is negotiated between the PCC and PCE during PCEP session establishment.
If the two timers are not identical, then the timer that will be selected for the session is the minimum between the configured keep-alive timer and the keep-alive received from the PCE in the OPEN message.

To configure the interval between keep-alive messages between PCC and PCE:

**Command syntax: keep-alive [keep-alive]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep timers

**Parameter table**

+------------+----------------------------------------------------------+-------+---------+
| Parameter  | Description                                              | Range | Default |
+============+==========================================================+=======+=========+
| keep-alive | time interval to keep-alive messages between PCC and PCE | 0-255 | 10      |
+------------+----------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# timers
    dnRouter(cfg-sr-pcep-timers)# keep-alive 10


**Removing Configuration**

To revert keep-alive configuration to default:
::

    dnRouter(cfg-sr-pcep-timers)# no keep-alive

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/timers/lsp-initiated-lifetime.rst

protocols segment-routing pcep timers lsp-initiated-lifetime
------------------------------------------------------------

**Minimum user role:** operator

The lsp-initiated-lifetime interval is the amount of time that a PCC waits before deleting PCE initiated LSPs.
The lifetime timer start ticking after the redelegation timer expires.
When the lifetime timer is ticking, the LSP is considered an "orphan" and once the interval expires the lsp will be purged from the system.

To configure the lsp-initiated-lifetime interval: 

**Command syntax: lsp-initiated-lifetime [timeout]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+---------+---------+
| Parameter | Description                                                                      | Range   | Default |
+===========+==================================================================================+=========+=========+
| timeout   | Time (in seconds) that the PCC must wait before deleting any non-delegated       | 0-86400 | 600     |
|           | PCE-initiated LSPs from the failed PCE after a PCEP session terminates           |         |         |
+-----------+----------------------------------------------------------------------------------+---------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# timers
    dnRouter(cfg-sr-pcep-timers)# lsp-initiated-lifetime 2000


**Removing Configuration**

To revert lsp-initiated-lifetime configuration to default:
::

    dnRouter(cfg-sr-pcep-timers)# no lsp-initiated-lifetime

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 19.2    | Command introduced |
+---------+--------------------+

---

### pcep/timers/lsp-state-timeout.rst

protocols segment-routing pcep timers lsp-state-timeout
-------------------------------------------------------

**Minimum user role:** operator

When a PCEP session with a PCE disconnects, the PCC redelegates to an alternative PCE.
The LSP-state-timeout is the amount of time after redelegation that the PCC waits before flushing the LSP states associated with the disconnected PCEP session and reverting to the local default configurations.
This operation is performed in a make-before-break fashion.

To configure the lsp-state-timeout:

**Command syntax: lsp-state-timeout [timeout]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------------------+---------+
| Parameter | Description                                                                      | Range              | Default |
+===========+==================================================================================+====================+=========+
| timeout   | time (in seconds) that a path computation client (PCC) must wait before removing | 0..3600 | infinity | 60      |
|           | the LSPs associated with a PCEP session that is disconnected and reverting back  |                    |         |
|           | to the local defaults attributes/configuration                                   |                    |         |
+-----------+----------------------------------------------------------------------------------+--------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# timers
    dnRouter(cfg-sr-pcep-timers)# lsp-state-timeout 20


**Removing Configuration**

To revert lsp-state-timeout configuration to default:
::

    dnRouter(cfg-sr-pcep-timers)# no lsp-state-timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/timers/redelegation-timeout.rst

protocols segment-routing pcep timers redelegation-timeout
----------------------------------------------------------

**Minimum user role:** operator

The redelegation-timeout interval is the amount of time that a PCC waits before revoking LSP delegations to a PCE with which the PCEP session has terminated unexpectedly and attempting to redelegate the LSPs to an alternate PCE.
If the PCEP session with the original PCE is restored before the redelegation timer expires, the LSP delegations will not be revoked.

To configure the redelegation-timeout interval:

**Command syntax: redelegation-timeout [timeout]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep timers

**Parameter table**

+-----------+----------------------------------------------------------------------------------+--------+---------+
| Parameter | Description                                                                      | Range  | Default |
+===========+==================================================================================+========+=========+
| timeout   | time (in seconds) that a path computation client (PCC) must wait before          | 0-3600 | 30      |
|           | re-delegating LSPs after a PCEP session with the active stateful PCE is          |        |         |
|           | disconnected                                                                     |        |         |
+-----------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# timers
    dnRouter(cfg-sr-pcep-timers)# redelegation-timeout 2000


**Removing Configuration**

To revert redelegation-timeout configuration to default:
::

    dnRouter(cfg-sr-pcep-timers)# no redelegation-timeout

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### pcep/timers/timers.rst

protocols segment-routing pcep timers
-------------------------------------

**Minimum user role:** operator

There are two sets of PCEP timers:
-  Session maintenance timers - used for message transmission between PCC and PCE to notify one another of their availability. The session maintenance timers are based on keep-alive timers (see "pcep timers keep-alive") and dead timers (see "pcep timers dead-timer").
-  Session disconnection timers - determining what to do when a session unexpectedly disconnects. These timers are for the redelegation of a new PCE (see "pcep timers redelegation-timeout") and for removal of the LSPs from the disconnected PCE (see "pcep timers lsp-state-timeout").

To set global timers for messaging between PCC and PCE:

**Command syntax: timers**

**Command mode:** config

**Hierarchies**

- protocols segment-routing pcep

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# pcep
    dnRouter(cfg-protocols-sr-pcep)# timers
    dnRouter(cfg-sr-pcep-timers)#


**Removing Configuration**

To revert all sr-te pcep timers configuration to default:
::

    dnRouter(cfg-protocols-sr-pcep)# no timers

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### segment-routing.rst

protocols segment-routing
-------------------------

**Minimum user role:** operator

To enter the segment-routing configuration hierarchy:

**Command syntax: segment-routing**

**Command mode:** config

**Hierarchies**

- protocols

**Note**
- no command remove all segment-routing configurations

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)#


**Removing Configuration**

To remove the segment-routing configuration:
::

    dnRouter(cfg-protocols)# no segment-routing

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 15.0    | Command introduced |
+---------+--------------------+

---

### srv6/locator/locator-prefix.rst

protocols segment-routing srv6 locator locator-prefix
-----------------------------------------------------

**Minimum user role:** operator

SRv6 locator is a fundamental construct for an SRv6 network. This is the first part of the SID and represents a specific SRv6 node.  
The locator is advertised to and used by remote nodes for reachability. A locator is identified by a name and has associated prefix and IGP algorithm.  
The locator prefix is built from 2 parts: 
1. The Locator-Base Address - which is expected to be the same for all locators in the SRv6 domain. It is the 32 most-significant bits of the locator subnet.
2. The NodeId - Designates a specific node. It is the 16 least-significant bits of the locator subnet.
The SID consists of the locator-prefix in the most significant 48 bits and a 16-bit Function value. The Function is the portion of the SID that is local to the owner node.
The END behavior has Function value of zero.
When the locator is defined the locator-prefix (/48) and the locator-prefix+END function (/64) are installed in the RIB and FIB.

To set the locator prefix value:


**Command syntax: locator-prefix [locator-prefix]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing srv6 locator

**Parameter table**

+----------------+----------------+------------+---------+
| Parameter      | Description    | Range      | Default |
+================+================+============+=========+
| locator-prefix | locator prefix | X:X::X:X/x | \-      |
+----------------+----------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# srv6
    dnRouter(cfg-protocols-sr-srv6)# locator LOCATOR_1
    dnRouter(cfg-sr-srv6-locator)# locator-prefix fc00:0:1::/48
    dnRouter(cfg-sr-srv6-locator)#


**Removing Configuration**

To remove the prefix
::

    dnRouter(cfg-sr-srv6-locator)# no locator-prefix

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### srv6/locator/locator.rst

protocols segment-routing srv6 locator
--------------------------------------

**Minimum user role:** operator

SRv6 locator is a fundamental construct for an SRv6 network. This is the first part of the SID and represents a specific SRv6 node. 
The locator is advertised to and used by remote nodes for reachability. A locator is identified by a name and has associated prefix and IGP algorithm.  
It is possible to have more than one locator on a node (e.g. locator per algorithm, etc.)
To configure the srv6 locator name:


**Command syntax: locator [locator]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing srv6

**Parameter table**

+-----------+-------------------+------------------+---------+
| Parameter | Description       | Range            | Default |
+===========+===================+==================+=========+
| locator   | SRv6 locator name | | string         | \-      |
|           |                   | | length 1-255   |         |
+-----------+-------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# srv6
    dnRouter(cfg-protocols-sr-srv6)# locator LOCATOR_1
    dnRouter(cfg-sr-srv6-locator)#


**Removing Configuration**

To remove a specific or all configured locators:
::

    dnRouter(cfg-protocols-sr-srv6)# no locator LOCATOR_1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### srv6/sid-format/sid-format.rst

protocols segment-routing srv6 sid-format
-----------------------------------------

**Minimum user role:** operator

To enter the sid-format configuration hierarchy:

**Command syntax: sid-format**

**Command mode:** config

**Hierarchies**

- protocols segment-routing srv6

**Note**
- no command removes all sid-format configurations

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# srv6
    dnRouter(cfg-protocols-sr-srv6)# sid-format
    dnRouter(cfg-sr-srv6-sidf)#


**Removing Configuration**

To remove the sid-format configurations:
::

    dnRouter(cfg-protocols-sr-srv6)# no sid-format

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### srv6/sid-format/usid/dynamic-function-range.rst

protocols segment-routing srv6 sid-format usid dynamic-function-range min max
-----------------------------------------------------------------------------

**Minimum user role:** operator

The default function range is 0xE000 to 0xFDFF. A range of values need to be left available for the Static Function IDs.


**Command syntax: dynamic-function-range min [min-value] max [max-value]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing srv6 sid-format usid

**Note**
- The minimum value must be less than the maximum value. Values are unsigned. 


**Parameter table**

+-----------+---------------------------------+----------------+---------+
| Parameter | Description                     | Range          | Default |
+===========+=================================+================+=========+
| min-value | the minimum dynamic function id | 0x0001..0xFDFF | 0xE000  |
+-----------+---------------------------------+----------------+---------+
| max-value | the maximum dynamic function id | 0x0001..0xFDFF | 0xFDFF  |
+-----------+---------------------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# srv6
    dnRouter(cfg-protocols-sr-srv6)# sid-format
    dnRouter(cfg-sr-srv6-sidf)# usid
    dnRouter(cfg-srv6-sidf-usid)# dynamic-function-range min 0xE100 max 0xF000


**Removing Configuration**

To return the node format setting to its default value:
::

    dnRouter(cfg-srv6-sidf-usid)# no dynamic-function-range

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### srv6/sid-format/usid/node-range.rst

protocols segment-routing srv6 sid-format usid node-range min max
-----------------------------------------------------------------

**Minimum user role:** operator

The default node range is 0x0001 to 0xFDFF. A range of values need to be left available for the Function IDs.


**Command syntax: node-range min [min-value] max [max-value]**

**Command mode:** config

**Hierarchies**

- protocols segment-routing srv6 sid-format usid

**Note**
- The minimum value must be less than the maximum value. Values are unsigned. 


**Parameter table**

+-----------+---------------------+----------------+---------+
| Parameter | Description         | Range          | Default |
+===========+=====================+================+=========+
| min-value | the minimum node Id | 0x0001..0xFDFF | 0x0001  |
+-----------+---------------------+----------------+---------+
| max-value | the maximum node Id | 0x0001..0xFDFF | 0xDFFF  |
+-----------+---------------------+----------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# srv6
    dnRouter(cfg-protocols-sr-srv6)# sid-format
    dnRouter(cfg-sr-srv6-sidf)# usid
    dnRouter(cfg-srv6-sidf-usid)# node-range min 0x010 max 0xD000


**Removing Configuration**

To return the node format setting to its default value:
::

    dnRouter(cfg-srv6-sidf-usid)# no node-range

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### srv6/sid-format/usid/usid.rst

protocols segment-routing srv6 sid-format usid
----------------------------------------------

**Minimum user role:** operator

To enter the micro-SID configuration hierarchy:

**Command syntax: usid**

**Command mode:** config

**Hierarchies**

- protocols segment-routing srv6 sid-format

**Note**
- no command remove all micro-SID configurations

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# srv6
    dnRouter(cfg-protocols-sr-srv6)# sid-format
    dnRouter(cfg-sr-srv6-sidf)# usid
    dnRouter(cfg-srv6-sidf-usid)#


**Removing Configuration**

To remove the micro-sid configurations:
::

    dnRouter(cfg-sr-srv6-sidf)# no usid

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---

### srv6/srv6.rst

protocols segment-routing srv6
------------------------------

**Minimum user role:** operator

To enter the srv6 configuration hierarchy:

**Command syntax: srv6**

**Command mode:** config

**Hierarchies**

- protocols segment-routing

**Note**
- no command remove all srv6 configurations

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# segment-routing
    dnRouter(cfg-protocols-sr)# srv6
    dnRouter(cfg-protocols-sr-srv6)#


**Removing Configuration**

To remove the srv6 configuration:
::

    dnRouter(cfg-protocols-sr)# no srv6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 25.2    | Command introduced |
+---------+--------------------+

---


## SECTION 2.P: STATIC

Files in this section: 35

### address-family_ipv4-unicast/address-family_ipv4-unicast.rst

protocols static address-family ipv4-unicast
--------------------------------------------

**Minimum user role:** operator

To enter static route configuration for an address-family:

**Command syntax: address-family ipv4-unicast**

**Command mode:** config

**Hierarchies**

- protocols static
- network-services vrf instance protocols static

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)#


**Removing Configuration**

To remove all address-family static routes:
::

    dnRouter(cfg-inst-protocols-static)# no address-family ipv4-unicast

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 6.0     | Command introduced                              |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv4-unicast/bfd/bfd.rst

protocols static address-family ipv4-unicast bfd
------------------------------------------------

**Minimum user role:** operator

You can use the following command to enter the BFD configuration level for BFD protection of a static route. A BFD session is created when bfd-nexthop is configured and enabled, and nexthop is used by at least one static route of the same type (single-hop/multi-hop). When a static route nexthop is protected by BFD, it is valid only when BFD is up.

 To configure BFD protection of a static route:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast
- network-services vrf instance protocols static address-family ipv4-unicast

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)#


**Removing Configuration**

To revert to the default configuration:
::

    dnRouter(cfg-protocols-static-ipv4)# no bfd

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 12.0    | Command introduced                              |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv4-unicast/bfd/next-hop/admin-state.rst

protocols static address-family ipv4-unicast bfd next-hop admin-state
---------------------------------------------------------------------

**Minimum user role:** operator

You can enable BFD for next-hop protection of a single hop static route. The static route will be valid for FIB installation only when BFD is UP.
When next-hop is used in any of the static routes, a BFD session will be formed to that address in order to protect the next-hop reachability. You can configure multiple BFD next-hops, each with its own BFD session parameters.
When admin-state is disabled, the bfd session is removed.
To enable/disable BFD for next-hop protection:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv4-unicast bfd next-hop

**Parameter table**

+-------------+--------------------------------------+--------------+---------+
| Parameter   | Description                          | Range        | Default |
+=============+======================================+==============+=========+
| admin-state | set whether bfd protection is in use | | enabled    | enabled |
|             |                                      | | disabled   |         |
+-------------+--------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv4-bfd-nh)# admin-state disabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv4-bfd-nh)# admin-state disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv4-bfd-nh)# no admin-state

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 12.0    | Command introduced                              |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv4-unicast/bfd/next-hop/min-rx.rst

protocols static address-family ipv4-unicast bfd next-hop min-rx
----------------------------------------------------------------

**Minimum user role:** operator

To set the bfd minimum receive interval (min-rx):

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv4-unicast bfd next-hop

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | 300     |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv4-bfd-nh)# min-rx 50
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv4-bfd-nh)# min-rx 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv4-bfd-nh)# no min-rx

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 12.0    | Command introduced                              |
+---------+-------------------------------------------------+
| 15.1    | Added support for 5 msec interval               |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv4-unicast/bfd/next-hop/min-tx.rst

protocols static address-family ipv4-unicast bfd next-hop min-tx
----------------------------------------------------------------

**Minimum user role:** operator

To set the bfd minimum transmit interval (min-tx):

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv4-unicast bfd next-hop

**Note**

- Due to a hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | 300     |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv4-bfd-nh)# min-tx 50
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv4-bfd-nh)# min-tx 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv4-bfd-nh)# no min-tx

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 12.0    | Command introduced                              |
+---------+-------------------------------------------------+
| 15.1    | Added support for 5 msec interval               |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv4-unicast/bfd/next-hop/multiplier.rst

protocols static address-family ipv4-unicast bfd next-hop multiplier
--------------------------------------------------------------------

**Minimum user role:** operator

To set the bfd multiplier:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv4-unicast bfd next-hop

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv4-bfd-nh)# multiplier 5
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv4-bfd-nh)# multiplier 5


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv4-bfd-nh)# no multiplier

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 12.0    | Command introduced                              |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv4-unicast/bfd/next-hop/next-hop.rst

protocols static address-family ipv4-unicast bfd next-hop
---------------------------------------------------------

**Minimum user role:** operator

To configure BFD for Static route next-hop neighbor. Once next-hop is used in any of the static routes a BFD session will be formed to that address in order to protect the next-hop reachability. You can configure multiple BFD next-hops, each with it's own bfd session parameters.

**Command syntax: next-hop [ip-address]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast bfd
- network-services vrf instance protocols static address-family ipv4-unicast bfd

**Parameter table**

+------------+-----------------+---------+---------+
| Parameter  | Description     | Range   | Default |
+============+=================+=========+=========+
| ip-address | nexthop address | A.B.C.D | \-      |
+------------+-----------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1
    dnRouter(cfg-static-ipv4-bfd-nh)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1
    dnRouter(cfg-static-ipv4-bfd-nh)#


**Removing Configuration**

To remove the BFD configuration of a specific next-hop:
::

    dnRouter(cfg-static-ipv4-bfd)# no next-hop 1::1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### address-family_ipv4-unicast/bfd/next-hop/single-hop.rst

protocols static address-family ipv4-unicast bfd next-hop single-hop
--------------------------------------------------------------------

**Minimum user role:** operator

To define the next-hop type for the required BFD session type. A single-hop type is for a directly connected next-hop.

**Command syntax: single-hop**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv4-unicast bfd next-hop

**Note**

- BFD type is a mandatory setting.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1
    dnRouter(cfg-static-ipv4-bfd-nh)# single-hop
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# bfd
    dnRouter(cfg-static-ipv4-bfd)# next-hop 1.1.1.1
    dnRouter(cfg-static-ipv4-bfd-nh)# single-hop


**Removing Configuration**

To revert to default:
::

    dnRouter(cfg-static-ipv4-bfd-nh)# no single-hop

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 12.0    | Command introduced                              |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv4-unicast/route/description.rst

protocols static address-family ipv4-unicast route description
--------------------------------------------------------------

**Minimum user role:** operator

Sets a description for the static route. The same route can have only one description, regardless of how many nexthop options it has. The description is visible under 'show config'. To enter a description for the static route:

**Command syntax: description [route-description]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast route
- network-services vrf instance protocols static address-family ipv4-unicast route

**Parameter table**

+-------------------+--------------------------------------+------------------+---------+
| Parameter         | Description                          | Range            | Default |
+===================+======================================+==================+=========+
| route-description | static-route destination description | | string         | \-      |
|                   |                                      | | length 1-255   |         |
+-------------------+--------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.0/24
    dnRouter(cfg-static-ipv4-route)# description "route to cluster 1"
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.0/24
    dnRouter(cfg-static-ipv4-route)# description "route to cluster 1"


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-static-ipv4-route)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family_ipv4-unicast/route/interface-next-hop.rst

protocols static address-family ipv4-unicast route next-hop interface
---------------------------------------------------------------------

**Minimum user role:** operator

Use this command to configure a static IP routing entry, matching an IP prefix to its designated gateway. The next-hop must be a connected address of the given interface. To set a static route entry:

**Command syntax: next-hop [ip-address] interface [interface]** admin-distance [admin-distance] icmp-echo-track [icmp-echo session name]

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast route
- network-services vrf instance protocols static address-family ipv4-unicast route

**Note**

- The interface must match an attached interface in the same VRF.

- A static route IP must match the address family. E.g., in address family "ipv4 unicast" you can only set IPv4 addresses for route target and route next-hop.

- The next-hop address must be different from the route address.

- When configuring a non /32 ip-prefix, the route installed will be the matching subnet network address. For example, when configuring a route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same rule applies for ipv6 prefixes.

- icmp-echo-track - Condition static-route next-hop reachability on an icmp-echo performance-monitoring session. Next-hop is considered reachable and valid to be used only if icmp-echo session test is completed successfully with no threshold crossed

- You can set multiple next-hops and interfaces for the same route. A route is unique through the next-hop and interface combination.

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter              | Description                                                                      | Range            | Default |
+========================+==================================================================================+==================+=========+
| ip-address             | target route destination                                                         | A.B.C.D          | \-      |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| interface              | target route destination                                                         | | string         | \-      |
|                        |                                                                                  | | length 1-255   |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| admin-distance         | administrative-distance for protocol preference when choosing a route for static | 1-255            | 1       |
|                        | ip route administrative distance if 1 by default                                 |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| icmp-echo session name | Enable icmp-echo-track to track next-hop reachability using                      | | string         | \-      |
|                        | performance-monitoring icmp-echo session                                         | | length 1-255   |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32
    dnRouter(cfg-static-ipv4-route)# next-hop 10.173.2.65 interface bundle-2 admin-distance 20
    dnRouter(cfg-static-ipv4-route)# next-hop 10.173.2.63 interface bundle-4 icmp-echo-track ICMP-ECHO-SESSION
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32
    dnRouter(cfg-static-ipv4-route)# next-hop 10.173.2.65 interface bundle-2 admin-distance 20
    dnRouter(cfg-static-ipv4-route)# next-hop 10.173.2.63 interface bundle-4 icmp-echo-track ICMP-ECHO-SESSION


**Removing Configuration**

To revert optional parameters to their default values:
::

    dnRouter(cfg-static-ipv4-route)# no next-hop 10.173.2.65 interface bundle-2

**Command History**

+---------+----------------------------+
| Release | Modification               |
+=========+============================+
| 6.0     | Command introduced         |
+---------+----------------------------+
| 25.2    | Add icmp-echo-track option |
+---------+----------------------------+

---

### address-family_ipv4-unicast/route/metric.rst

protocols static address-family ipv4-unicast route metric
---------------------------------------------------------

**Minimum user role:** operator

Specify a metric value that will be used for RIB route tie-break between routes with similar administrative-distance. Default metric value is 0.
To set route metric:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast route
- network-services vrf instance protocols static address-family ipv4-unicast route

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | A metric which is utilised to specify the preference of the route entry when it  | 0-16777215 | 0       |
|           | is installed into the RIB.Metric will be taken into account as RIB route         |            |         |
|           | tie-break between routers with similar administrative-distance                   |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.0/24
    dnRouter(cfg-static-ipv4-route)# metric 10


**Removing Configuration**

To revert metric to default value:
::

    dnRouter(cfg-static-ipv4-route)# no metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### address-family_ipv4-unicast/route/next-hop.rst

protocols static address-family ipv4-unicast route next-hop
-----------------------------------------------------------

**Minimum user role:** operator

To configure a static route matching an IP prefix to its designated gateway:

**Command syntax: next-hop [ip-address]** admin-distance [admin-distance] icmp-echo-track [icmp-echo session name]

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast route
- network-services vrf instance protocols static address-family ipv4-unicast route

**Note**

- An static route IP must match the address family. E.g, in address family 'ipv4 unicast' you can only set ipv4 addresses for route target and route next-hop.

- When a non /32 ip-prefix is configured, the installed route will be the matching subnet network address. For example, when configuring a route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same rule applies for ipv6 prefixes.

- The next-hop must be a unicast address.

- The nexthop address must be different from the route address.

- icmp-echo-track - Condition static-route next-hop reachability on an icmp-echo performance-monitoring session. Next-hop is considered reachable and valid to be used only if icmp-echo session test is completed successfully with no threshold crossed

- You can set multiple next-hops for the same route.

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter              | Description                                                                      | Range            | Default |
+========================+==================================================================================+==================+=========+
| ip-address             | target route destination                                                         | A.B.C.D          | \-      |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| admin-distance         | administrative-distance for protocol preference when choosing a route for static | 1-255            | 1       |
|                        | ip route administrative distance if 1 by default                                 |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| icmp-echo session name | Enable icmp-echo-track to track next-hop reachability using                      | | string         | \-      |
|                        | performance-monitoring icmp-echo session                                         | | length 1-255   |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32
    dnRouter(cfg-static-ipv4-route)# next-hop 10.173.2.65 admin-distance 20
    dnRouter(cfg-static-ipv4-route)# next-hop 10.173.2.64 icmp-echo-track ICMP-ECHO-SESSION
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32
    dnRouter(cfg-static-ipv4-route)# next-hop 10.173.2.65 admin-distance 20
    dnRouter(cfg-static-ipv4-route)# next-hop 10.173.2.64 icmp-echo-track ICMP-ECHO-SESSION


**Removing Configuration**

To remove a specific next-hop:
::

    dnRouter(cfg-static-ipv4-route)# no next-hop 10.173.2.65

**Command History**

+---------+----------------------------+
| Release | Modification               |
+=========+============================+
| 6.0     | Command introduced         |
+---------+----------------------------+
| 25.2    | Add icmp-echo-track option |
+---------+----------------------------+

---

### address-family_ipv4-unicast/route/next-table.rst

protocols static address-family ipv4-unicast route next-table
-------------------------------------------------------------

**Minimum user role:** operator

Sets a static IP routing entry, where the next-hop information is taken from another VRF (VRF Leakage). To configure the static IP entry:

**Command syntax: next-table [next-table]** admin-distance [admin-distance]

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast route
- network-services vrf instance protocols static address-family ipv4-unicast route

**Note**

- An IP static route must comply with its address family. e.g, in address family "ipv4-unicast" you can only set ipv4 addresses

- when user sets a non /32 ip-prefix, the route installed will be the matching subnet network address. For example if user set route 192.168.1.19  **7**/26 next-hop 10.173.2.65 the configured static route will be 192.168.1.19  **2**/26. The same rule applies for ipv6-prefix.

- the ip static route cannot be

- -  a limited broadcast address

- -  a multicast address

- route designated to next-table cannot have any other static route configuration that is not also configured to the same next-table vrf.

- no command removes the static route from RIB

**Parameter table**

+----------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter      | Description                                                                      | Range            | Default |
+================+==================================================================================+==================+=========+
| next-table     | next-hop target is a reference to another vrf - the next hop should be taken     | | string         | \-      |
|                | from that vrf                                                                    | | length 1-255   |         |
+----------------+----------------------------------------------------------------------------------+------------------+---------+
| admin-distance | administrative-distance for protocol preference when choosing a route for static | 1-255            | 1       |
|                | ip route administrative distance if 1 by default                                 |                  |         |
+----------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32
    dnRouter(cfg-static-ipv4-route)# next-table other-vrf admin-distance 20


**Removing Configuration**

::

    dnRouter(cfg-static-ipv4-route)# no next-table other-vrf

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### address-family_ipv4-unicast/route/null0.rst

protocols static address-family ipv4-unicast route null0
--------------------------------------------------------

**Minimum user role:** operator

Sets a static ip routing entry, matching an ip prefix to its designated gateway.

**Command syntax: null0** admin-distance [admin-distance]

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast route
- network-services vrf instance protocols static address-family ipv4-unicast route

**Note**

- A static route IP must match the address family. E.g., in address family "ipv4-unicast" you can only set ipv4 addresses.

- When configuring a non /32 ip-prefix, the route installed will be the matching subnet network address. For example, when configuring a route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same rule applies for ipv6 prefixes.

- The static route IP cannot be a limited broadcast address or a multicast address.

- A route designated to null0 cannot have any other static route configuration.

- tag - specifies a tag value that can be used as a match for controlling redistribution using route policies.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                                      | Range | Default |
+================+==================================================================================+=======+=========+
| admin-distance | administrative-distance for protocol preference when choosing a route for static | 1-255 | 1       |
|                | ip route administrative distance if 1 by default                                 |       |         |
+----------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32
    dnRouter(cfg-static-ipv4-route)# null0 admin-distance 20
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32
    dnRouter(cfg-static-ipv4-route)# null0 admin-distance 20


**Removing Configuration**

To revert the static route from RIB to default:
::

    dnRouter(cfg-static-ipv4-route)# no null0

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### address-family_ipv4-unicast/route/route.rst

protocols static address-family ipv4-unicast route
--------------------------------------------------

**Minimum user role:** operator

To configure a static route matching an IP prefix to its designated gateway:

**Command syntax: route [ip-prefix]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast
- network-services vrf instance protocols static address-family ipv4-unicast

**Note**

- An static route IP must match the address family. E.g, in address family 'ipv4 unicast' you can only set ipv4 addresses for route target and route next-hop.

- When a non /32 ip-prefix is configured, the installed route will be the matching subnet network address. For example, when configuring a route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same rule applies for ipv6 prefixes.

- The next-hop must be a unicast address.

- The nexthop address must be different from the route address.

- You can set multiple next-hops for the same route.

**Parameter table**

+-----------+--------------------------+-----------+---------+
| Parameter | Description              | Range     | Default |
+===========+==========================+===========+=========+
| ip-prefix | target route destination | A.B.C.D/x | \-      |
+-----------+--------------------------+-----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.16/32


**Removing Configuration**

To remove a specific next-hop:
::

    dnRouter(cfg-inst-protocols-static)# no route 172.16.172.16/32

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 6.0     | Command introduced                              |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv4-unicast/route/tag.rst

protocols static address-family ipv4-unicast route tag
------------------------------------------------------

**Minimum user role:** operator

Specify a tag value that can be used as a match for controlling static-route redistribution using route policies
Tag value may be signalled to network in IS-IS

**Command syntax: tag [tag]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv4-unicast route
- network-services vrf instance protocols static address-family ipv4-unicast route

**Parameter table**

+-----------+---------------+--------------+---------+
| Parameter | Description   | Range        | Default |
+===========+===============+==============+=========+
| tag       | add route tag | 1-4294967295 | \-      |
+-----------+---------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv4-unicast
    dnRouter(cfg-protocols-static-ipv4)# route 172.16.172.0/24
    dnRouter(cfg-static-ipv4-route)# tag 100


**Removing Configuration**

To remove tag:
::

    dnRouter(cfg-static-ipv4-route)# no tag

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/address-family_ipv6-unicast.rst

protocols static address-family ipv6-unicast
--------------------------------------------

**Minimum user role:** operator

To enter static route configuration for an address-family:

**Command syntax: address-family ipv6-unicast**

**Command mode:** config

**Hierarchies**

- protocols static
- network-services vrf instance protocols static

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)#


**Removing Configuration**

To remove all address-family static routes:
::

    dnRouter(cfg-inst-protocols-static)# no address-family ipv6-unicast

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/bfd/bfd.rst

protocols static address-family ipv6-unicast bfd
------------------------------------------------

**Minimum user role:** operator

You can use the following command to enter the BFD configuration level for BFD protection of a static route. A BFD session is created when bfd-nexthop is configured and enabled, and nexthop is used by at least one static route of the same type (single-hop/multi-hop). When a static route nexthop is protected by BFD, it is valid only when BFD is up.

To configure BFD protection of a static route:

**Command syntax: bfd**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast
- network-services vrf instance protocols static address-family ipv6-unicast

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)#


**Removing Configuration**

To remove all BFD configuration of the relevant address-family:
::

    dnRouter(cfg-protocols-static-ipv6)# no bfd

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/bfd/next-hop/admin-state.rst

protocols static address-family ipv6-unicast bfd next-hop admin-state
---------------------------------------------------------------------

**Minimum user role:** operator

You can enable BFD for next-hop protection of a single hop static route. The static route will be valid for FIB installation only when BFD is UP.

When next-hop is used in any of the static routes, a BFD session will be formed to that address in order to protect the next-hop reachability. You can configure multiple BFD next-hops, each with its own BFD session parameters.

When admin-state is disabled, the BFD session is removed.

To enable/disable BFD for next-hop protection:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv6-unicast bfd next-hop

**Parameter table**

+-------------+--------------------------------------+--------------+---------+
| Parameter   | Description                          | Range        | Default |
+=============+======================================+==============+=========+
| admin-state | set whether bfd protection is in use | | enabled    | enabled |
|             |                                      | | disabled   |         |
+-------------+--------------------------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1::1 single-hop
    dnRouter(cfg-static-ipv6-bfd-nh)# admin-state disabled
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv6-bfd-nh)# admin-state disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv6-bfd-nh)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/bfd/next-hop/min-rx.rst

protocols static address-family ipv6-unicast bfd next-hop min-rx
----------------------------------------------------------------

**Minimum user role:** operator

To set the bfd minimum receive interval (min-rx):

**Command syntax: min-rx [min-rx]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv6-unicast bfd next-hop

**Parameter table**

+-----------+------------------------------------------------------+--------+---------+
| Parameter | Description                                          | Range  | Default |
+===========+======================================================+========+=========+
| min-rx    | set desired minimum receive interval for BFD session | 5-1700 | 300     |
+-----------+------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1::1 single-hop
    dnRouter(cfg-static-ipv6-bfd-nh)# min-rx 50
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv6-bfd-nh)# min-rx 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv6-bfd-nh)# no min-rx

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 12.0    | Command introduced                |
+---------+-----------------------------------+
| 15.1    | Added support for 5 msec interval |
+---------+-----------------------------------+

---

### address-family_ipv6-unicast/bfd/next-hop/min-tx.rst

protocols static address-family ipv6-unicast bfd next-hop min-tx
----------------------------------------------------------------

**Minimum user role:** operator

To set the bfd minimum transmit interval (min-tx):

**Command syntax: min-tx [min-tx]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv6-unicast bfd next-hop

**Note**

- Due to a hardware limitation, the maximum supported transmit rate is 1700 msec. A negotiated transmit interval higher than 1700 msec will result in an actual transmit rate of 1700 msec.

**Parameter table**

+-----------+-------------------------------------------------------+--------+---------+
| Parameter | Description                                           | Range  | Default |
+===========+=======================================================+========+=========+
| min-tx    | set desired minimum transmit interval for BFD session | 5-1700 | 300     |
+-----------+-------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1::1 single-hop
    dnRouter(cfg-static-ipv6-bfd-nh)# min-tx 50
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv6-bfd-nh)# min-tx 50


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv6-bfd-nh)# no min-tx

**Command History**

+---------+-----------------------------------+
| Release | Modification                      |
+=========+===================================+
| 12.0    | Command introduced                |
+---------+-----------------------------------+
| 15.1    | Added support for 5 msec interval |
+---------+-----------------------------------+

---

### address-family_ipv6-unicast/bfd/next-hop/multiplier.rst

protocols static address-family ipv6-unicast bfd next-hop multiplier
--------------------------------------------------------------------

**Minimum user role:** operator

To set the bfd multiplier:

**Command syntax: multiplier [multiplier]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv6-unicast bfd next-hop

**Parameter table**

+------------+--------------------------+-------+---------+
| Parameter  | Description              | Range | Default |
+============+==========================+=======+=========+
| multiplier | set local BFD multiplier | 2-16  | 3       |
+------------+--------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1::1 single-hop
    dnRouter(cfg-static-ipv6-bfd-nh)# multiplier 5
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1.1.1.1 single-hop
    dnRouter(cfg-static-ipv6-bfd-nh)# multiplier 5


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv6-bfd-nh)# no multiplier

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/bfd/next-hop/next-hop.rst

protocols static address-family ipv6-unicast bfd next-hop
---------------------------------------------------------

**Minimum user role:** operator

To configure BFD for Static route next-hop neighbor. Once next-hop is used in any of the static routes a BFD session will be formed to that address in order to protect the next-hop reachability. You can configure multiple BFD next-hops, each with it's own bfd session parameters.

**Command syntax: next-hop [ip-address]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast bfd
- network-services vrf instance protocols static address-family ipv6-unicast bfd

**Parameter table**

+------------+-----------------+----------+---------+
| Parameter  | Description     | Range    | Default |
+============+=================+==========+=========+
| ip-address | nexthop address | X:X::X:X | \-      |
+------------+-----------------+----------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1::1
    dnRouter(cfg-static-ipv6-bfd-nh)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1::1
    dnRouter(cfg-static-ipv6-bfd-nh)#


**Removing Configuration**

To remove the BFD configuration of a specific next-hop:
::

    dnRouter(cfg-static-ipv6-bfd)# no next-hop 1::1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/bfd/next-hop/single-hop.rst

protocols static address-family ipv6-unicast bfd next-hop single-hop
--------------------------------------------------------------------

**Minimum user role:** operator

This command defines the next-hop type required for BFD. A single-hop type is for a directly-connected next-hop. To set the BFD type for BFD protecting a static route:

**Command syntax: single-hop**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast bfd next-hop
- network-services vrf instance protocols static address-family ipv6-unicast bfd next-hop

**Note**

- BFD type is a mandatory configuration.

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1::1
    dnRouter(cfg-static-ipv6-bfd-nh)# single-hop
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# bfd
    dnRouter(cfg-static-ipv6-bfd)# next-hop 1::1
    dnRouter(cfg-static-ipv6-bfd-nh)# single-hop


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-static-ipv6-bfd-nh)# no single-hop

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 12.0    | Command introduced                              |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv6-unicast/route/description.rst

protocols static address-family ipv6-unicast route description
--------------------------------------------------------------

**Minimum user role:** operator

Sets a description for the static route. The same route can have only one description, regardless of how many nexthop options it has. The description is visible under 'show config'. To enter a description for the static route:

**Command syntax: description [route-description]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast route
- network-services vrf instance protocols static address-family ipv6-unicast route

**Parameter table**

+-------------------+--------------------------------------+------------------+---------+
| Parameter         | Description                          | Range            | Default |
+===================+======================================+==================+=========+
| route-description | static-route destination description | | string         | \-      |
|                   |                                      | | length 1-255   |         |
+-------------------+--------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route 232:16::8:0/96
    dnRouter(cfg-static-ipv6-route)# description MY_DESCRIPTION
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route 232:16::8:0/96
    dnRouter(cfg-static-ipv6-route)# description MY_DESCRIPTION


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-static-ipv6-route)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 12.0    | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/route/interface-next-hop.rst

protocols static address-family ipv6-unicast route next-hop interface
---------------------------------------------------------------------

**Minimum user role:** operator

Use this command to configure a static IP routing entry, matching an IP prefix to its designated gateway. The next-hop must be a connected address of the given interface. To set a static route entry:

**Command syntax: next-hop [ip-address] interface [interface]** admin-distance [admin-distance] icmp-echo-track [icmp-echo session name]

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast route
- network-services vrf instance protocols static address-family ipv6-unicast route

**Note**

- The interface must match an attached interface in the same VRF.

- A static route IP must match the address family. E.g., in address family "ipv6 unicast" you can only set IPv6 addresses for route target and route next-hop.

- The next-hop address must be different from the route address.

- icmp-echo-track - Condition static-route next-hop reachability on an icmp-echo performance-monitoring session. Next-hop is considered reachable and valid to be used only if icmp-echo session test is completed successfully with no threshold crossed

- You can set multiple next-hops and interfaces for the same route. A route is unique through the next-hop and interface combination.

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter              | Description                                                                      | Range            | Default |
+========================+==================================================================================+==================+=========+
| ip-address             | target route destination                                                         | X:X::X:X         | \-      |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| interface              | target route destination                                                         | | string         | \-      |
|                        |                                                                                  | | length 1-255   |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| admin-distance         | administrative-distance for protocol preference when choosing a route for static | 1-255            | 1       |
|                        | ip route administrative distance if 1 by default                                 |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| icmp-echo session name | Enable icmp-echo-track to track next-hop reachability using                      | | string         | \-      |
|                        | performance-monitoring icmp-echo session                                         | | length 1-255   |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route ::ffff:172.16.172.16/128
    dnRouter(cfg-static-ipv6-route)# next-hop 2001:3::65 interface bundle-3 admin-distance 20
    dnRouter(cfg-static-ipv6-route)# next-hop 2001:3::66 interface bundle-4 icmp-echo-track ICMP-ECHO-SESSION
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route ::ffff:172.16.172.16/128
    dnRouter(cfg-static-ipv6-route)# next-hop 2001:3::65 interface bundle-3 admin-distance 20
    dnRouter(cfg-static-ipv6-route)# next-hop 2001:3::66 interface bundle-4 icmp-echo-track ICMP-ECHO-SESSION


**Removing Configuration**

To revert optional parameters to their default values:
::

    dnRouter(cfg-static-ipv6-route)# no next-hop 2001:3::65 interface bundle-2 admin-distance 20

**Command History**

+---------+----------------------------+
| Release | Modification               |
+=========+============================+
| 6.0     | Command introduced         |
+---------+----------------------------+
| 25.2    | Add icmp-echo-track option |
+---------+----------------------------+

---

### address-family_ipv6-unicast/route/metric.rst

protocols static address-family ipv6-unicast route metric
---------------------------------------------------------

**Minimum user role:** operator

Specify a metric value that will be used for RIB route tie-break between routes with similar administrative-distance. Default metric value is 0.
To set route metric:

**Command syntax: metric [metric]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast route
- network-services vrf instance protocols static address-family ipv6-unicast route

**Parameter table**

+-----------+----------------------------------------------------------------------------------+------------+---------+
| Parameter | Description                                                                      | Range      | Default |
+===========+==================================================================================+============+=========+
| metric    | A metric which is utilised to specify the preference of the route entry when it  | 0-16777215 | 0       |
|           | is installed into the RIB.Metric will be taken into account as RIB route         |            |         |
|           | tie-break between routers with similar administrative-distance                   |            |         |
+-----------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route 232:16::8:0/96
    dnRouter(cfg-static-ipv6-route)# metric 10


**Removing Configuration**

To revert metric to default value:
::

    dnRouter(cfg-static-ipv4-route)# no metric

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/route/next-hop.rst

protocols static address-family ipv6-unicast route next-hop
-----------------------------------------------------------

**Minimum user role:** operator

To configure a static route matching an IP prefix to its designated gateway:

**Command syntax: next-hop [ip-address]** admin-distance [admin-distance] icmp-echo-track [icmp-echo session name]

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast route
- network-services vrf instance protocols static address-family ipv6-unicast route

**Note**

- A static route IP must match the address family. E.g., in address family 'ipv6 unicast' you can only set ipv6 addresses for route target and route next-hop.

- When a non /128 ip-prefix is configured, the route installed will be the matching subnet network address.

- The next-hop must be a unicast address.

- The next-hop address must be different from the route address.

- icmp-echo-track - Condition static-route next-hop reachability on an icmp-echo performance-monitoring session. Next-hop is considered reachable and valid to be used only if icmp-echo session test is completed successfully with no threshold crossed

- You can set multiple next-hops for the same route.

**Parameter table**

+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter              | Description                                                                      | Range            | Default |
+========================+==================================================================================+==================+=========+
| ip-address             | target route destination                                                         | X:X::X:X         | \-      |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| admin-distance         | administrative-distance for protocol preference when choosing a route for static | 1-255            | 1       |
|                        | ip route administrative distance if 1 by default                                 |                  |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+
| icmp-echo session name | Enable icmp-echo-track to track next-hop reachability using                      | | string         | \-      |
|                        | performance-monitoring icmp-echo session                                         | | length 1-255   |         |
+------------------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route ::ffff:172.16.172.16/128
    dnRouter(cfg-static-ipv6-route)# next-hop 2001:3::65 admin-distance 20
    dnRouter(cfg-static-ipv4-route)# next-hop 2001:3::64 icmp-echo-track ICMP-ECHO-SESSION
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route ::ffff:172.16.172.16/128
    dnRouter(cfg-static-ipv6-route)# next-hop 2001:3::65 admin-distance 20
    dnRouter(cfg-static-ipv4-route)# next-hop 2001:3::64 icmp-echo-track ICMP-ECHO-SESSION


**Removing Configuration**

To remove a specific next-hop:
::

    dnRouter(cfg-static-ipv6-route)# no next-hop 2001:3::65 admin-distance 20

**Command History**

+---------+----------------------------+
| Release | Modification               |
+=========+============================+
| 6.0     | Command introduced         |
+---------+----------------------------+
| 25.2    | Add icmp-echo-track option |
+---------+----------------------------+

---

### address-family_ipv6-unicast/route/next-table.rst

protocols static address-family ipv6-unicast route next-table
-------------------------------------------------------------

**Minimum user role:** operator

Sets a static IP routing entry, where the next-hop information is taken from another VRF (VRF Leakage). To configure the static IP entry:

**Command syntax: next-table [next-table]** admin-distance [admin-distance]

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast route
- network-services vrf instance protocols static address-family ipv6-unicast route

**Note**

- An IP static route must comply with its address family. e.g, in address family "ipv6-unicast" you can only set ipv6 addresses

- when user sets a non /128 ip-prefix, the route installed will be the matching subnet network address. For example if user set route 2001:0db8::0000:0370:7334/112 next-table other-vrf the configured static route will be 2001:0db8::0000:0370:0000/112.

- the ip static route cannot be

- -  a limited broadcast address

- -  a multicast address

- route designated to next-table cannot have any other static route configuration that is not also configured to the same next-table vrf.

- no command removes the static route from RIB

**Parameter table**

+----------------+----------------------------------------------------------------------------------+------------------+---------+
| Parameter      | Description                                                                      | Range            | Default |
+================+==================================================================================+==================+=========+
| next-table     | next-hop target is a reference to another vrf - the next hop should be taken     | | string         | \-      |
|                | from that vrf                                                                    | | length 1-255   |         |
+----------------+----------------------------------------------------------------------------------+------------------+---------+
| admin-distance | administrative-distance for protocol preference when choosing a route for static | 1-255            | 1       |
|                | ip route administrative distance if 1 by default                                 |                  |         |
+----------------+----------------------------------------------------------------------------------+------------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route 2001:0db8:85a3:0000:0000:8a2e:0370:7334/128
    dnRouter(cfg-static-ipv6-route)# next-table other-vrf admin-distance 20


**Removing Configuration**

::

    dnRouter(cfg-static-ipv6-route)# no next-table other-vrf

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.2    | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/route/null0.rst

protocols static address-family ipv6-unicast route null0
--------------------------------------------------------

**Minimum user role:** operator

Sets a static ip routing entry, matching an ip prefix to its designated gateway.

**Command syntax: null0** admin-distance [admin-distance]

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast route
- network-services vrf instance protocols static address-family ipv6-unicast route

**Note**

- A static route IP must match the address family. E.g., in address family "ipv4-unicast" you can only set ipv4 addresses.

- When configuring a non /32 ip-prefix, the route installed will be the matching subnet network address. For example, when configuring a route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same rule applies for ipv6 prefixes.

- The static route IP cannot be a limited broadcast address or a multicast address.

- A route designated to null0 cannot have any other static route configuration.

- tag - specifies a tag value that can be used as a match for controlling redistribution using route policies.

**Parameter table**

+----------------+----------------------------------------------------------------------------------+-------+---------+
| Parameter      | Description                                                                      | Range | Default |
+================+==================================================================================+=======+=========+
| admin-distance | administrative-distance for protocol preference when choosing a route for static | 1-255 | 1       |
|                | ip route administrative distance if 1 by default                                 |       |         |
+----------------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route ::ffff:172.16.172.16/128
    dnRouter(cfg-static-ipv6-route)# null0 admin-distance 20
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route ::ffff:172.16.172.16/128
    dnRouter(cfg-static-ipv6-route)# null0 admin-distance 20


**Removing Configuration**

To revert the static route from RIB to default:
::

    dnRouter(cfg-static-ipv6-route)# no null0

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### address-family_ipv6-unicast/route/route.rst

protocols static address-family ipv6-unicast route
--------------------------------------------------

**Minimum user role:** operator

To configure a static route matching an IP prefix to its designated gateway:

**Command syntax: route [ip-prefix]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast
- network-services vrf instance protocols static address-family ipv6-unicast

**Note**

- An static route IP must match the address family. E.g, in address family 'ipv4 unicast' you can only set ipv4 addresses for route target and route next-hop.

- When a non /32 ip-prefix is configured, the installed route will be the matching subnet network address. For example, when configuring a route 192.168.1.197/26 next-hop 10.173.2.65, the configured static route will be 192.168.1.192/26. The same rule applies for ipv6 prefixes.

- The next-hop must be a unicast address.

- The nexthop address must be different from the route address.

- You can set multiple next-hops for the same route.

**Parameter table**

+-----------+--------------------------+------------+---------+
| Parameter | Description              | Range      | Default |
+===========+==========================+============+=========+
| ip-prefix | target route destination | X:X::X:X/x | \-      |
+-----------+--------------------------+------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route 1::/64
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route 1::/64


**Removing Configuration**

To remove a specific next-hop:
::

    dnRouter(cfg-inst-protocols-static)# no route route 1::/64

**Command History**

+---------+-------------------------------------------------+
| Release | Modification                                    |
+=========+=================================================+
| 6.0     | Command introduced                              |
+---------+-------------------------------------------------+
| 16.1    | Added command to the network services hierarchy |
+---------+-------------------------------------------------+

---

### address-family_ipv6-unicast/route/tag.rst

protocols static address-family ipv6-unicast route tag
------------------------------------------------------

**Minimum user role:** operator

Specify a tag value that can be used as a match for controlling static-route redistribution using route policies
Tag value may be signalled to network in IS-IS

**Command syntax: tag [tag]**

**Command mode:** config

**Hierarchies**

- protocols static address-family ipv6-unicast route
- network-services vrf instance protocols static address-family ipv6-unicast route

**Parameter table**

+-----------+---------------+--------------+---------+
| Parameter | Description   | Range        | Default |
+===========+===============+==============+=========+
| tag       | add route tag | 1-4294967295 | \-      |
+-----------+---------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# address-family ipv6-unicast
    dnRouter(cfg-protocols-static-ipv6)# route 232:16::8:0/96
    dnRouter(cfg-static-ipv6-route)# tag 100


**Removing Configuration**

To remove tag:
::

    dnRouter(cfg-static-ipv6-route)# no tag

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 16.1    | Command introduced |
+---------+--------------------+

---

### maximum-routes.rst

protocols static maximum-routes threshold
-----------------------------------------

**Minimum user role:** operator

To configure the system maximum static route limit and threshold: The parameters will be used to invoke a system-event when the limit and threshold are crossed.

**Command syntax: maximum-routes [maximum] threshold [threshold]**

**Command mode:** config

**Hierarchies**

- protocols static
- network-services vrf instance protocols static

**Note**

- The thresholds are for generating system-events only.

- The thresholds are for IPv4 and IPv6 routes combined.

- When the threshold is cleared, a single system-event notification is generated.

- There is no limitation on the number of static routes that you can configure.

**Parameter table**

+-----------+---------------------------------------+---------+---------+
| Parameter | Description                           | Range   | Default |
+===========+=======================================+=========+=========+
| maximum   | Maximum Number of Static Routes       | 1-65535 | 2000    |
+-----------+---------------------------------------+---------+---------+
| threshold | Threshold Percentage for Static Route | 1-100   | 75      |
+-----------+---------------------------------------+---------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)# maximum-routes 2000 threshold 70
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)# maximum-routes 2000 threshold 70


**Removing Configuration**

To revert maximum & threshold to default:
::

    dnRouter(cfg-inst-protocols-static)# no maximum-routes

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---

### static routes overview.rst

Static Routes Overview
----------------------
Routers forward packets using either route information from route table entries that you manually configure or the route information that is calculated using dynamic routing algorithms. You can supplement dynamic routes with static routes where appropriate. Static routes are useful in environments where network traffic is predictable and where the network design is simple and for specifying a gateway of last resort (a default router to which all unroutable packets are sent).

---

### static.rst

protocols static
----------------

**Minimum user role:** operator

Routers forward packets using either route information from route table entries that you manually configure or the route information that is calculated using dynamic routing algorithms. You can supplement dynamic routes with static routes where appropriate. Static routes are useful in environments where network traffic is predictable and where the network design is simple and for specifying a gateway of last resort (a default router to which all unroutable packets are sent).
To configure static routes, enter the static configuration hierarchy:

**Command syntax: static**

**Command mode:** config

**Hierarchies**

- protocols
- network-services vrf instance protocols

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# static
    dnRouter(cfg-protocols-static)#
    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# network-services
    dnRouter(cfg-network-services)# vrf
    dnRouter(cfg-network-services-vrf)# instance VRF_1
    dnRouter(cfg-network-services-vrf-inst)# protocols
    dnRouter(cfg-vrf-inst-protocols)# static
    dnRouter(cfg-inst-protocols-static)#


**Removing Configuration**

To remove all static config per vrf instance:
::

    dnRouter(cfg-vrf-inst-protocols)# no static

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 6.0     | Command introduced |
+---------+--------------------+

---


## SECTION 2.Q: VRRP

Files in this section: 27

### afi_ipv4/afi_ipv4.rst

protocols vrrp interface address-family ipv4
--------------------------------------------

**Minimum user role:** operator

To enter the VRRP IPv4 address-family configuration on the interface:

**Command syntax: address-family ipv4**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface
- network-services vrf instance protocols vrrp interface

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# no address-family ipv4

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/accept-mode.rst

protocols vrrp interface address-family ipv4 vrid accept-mode admin-state
-------------------------------------------------------------------------

**Minimum user role:** operator

To enable or disable accept mode for the VRRP group:

**Command syntax: accept-mode admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Note**
Enables a backup VRRP device to respond to ping, traceroute, and Telnet packets if the backup device becomes the master VRRP router.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Controls whether a virtual router in master state will accept packets addressed  | | enabled    | disabled |
|             | to the address owner's IPvX address as its own if it is not the IPvX address     | | disabled   |          |
|             | owner.  The default is 'false'.  Deployments that rely on, for example, pinging  |              |          |
|             | the address owner's IPvX address may wish to configure accept-mode to 'true'.    |              |          |
|             | Note: IPv6 Neighbor Solicitations and Neighbor Advertisements MUST NOT be        |              |          |
|             | dropped when accept-mode is 'false'.                                             |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# accept-mode admin-state enabled


**Removing Configuration**

To return the accept-mode admin-state to its default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no accept-mode

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/address.rst

protocols vrrp interface address-family ipv4 vrid address
---------------------------------------------------------

**Minimum user role:** operator

To configure virtual IP addresses for the VRRP group:

**Command syntax: address [ip-address]** [, ip-address, ip-address]

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Note**

- Both IPv4 and IPv6 prefixes are supported, but cannot be mixed in the same group.

- For IPv6 address family IPv6 link local address is auto-generated, configuration applies to IPv6 global unicast addresses

**Parameter table**

+------------+---------------------------------------------------+--------------+---------+
| Parameter  | Description                                       | Range        | Default |
+============+===================================================+==============+=========+
| ip-address | Configure virtual IP addresses for the VRRP group | | A.B.C.D    | \-      |
|            |                                                   | | X:X::X:X   |         |
+------------+---------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# address 200.10.10.6/32

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# address 200.10.10.6/32, 200.10.20.6/32


**Removing Configuration**

To remove all virtual IP addresses from the VRRP group:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no address

To remove a specific virtual IP address from the VRRP group:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no address 200.10.10.6/32

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/admin-state.rst

protocols vrrp interface address-family ipv4 vrid admin-state
-------------------------------------------------------------

**Minimum user role:** operator

To set the administrative state of the VRRP group:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Parameter table**

+-------------+------------------------+--------------+---------+
| Parameter   | Description            | Range        | Default |
+=============+========================+==============+=========+
| admin-state | VRRP group admin-state | | enabled    | enabled |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# admin-state enabled


**Removing Configuration**

To return the admin-state to its default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/advertisement-timer.rst

protocols vrrp interface address-family ipv4 vrid advertisement-timer
---------------------------------------------------------------------

**Minimum user role:** operator

To set the VRRP announcemenets advertiseement timer value for the VRRP group:

**Command syntax: advertisement-timer [advertisement-interval] [units]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Parameter table**

+------------------------+----------------------------------------------------------+------------------+--------------+
| Parameter              | Description                                              | Range            | Default      |
+========================+==========================================================+==================+==============+
| advertisement-interval | Sets the interval between successive VRRP advertisements | 10-40950         | 1000         |
+------------------------+----------------------------------------------------------+------------------+--------------+
| units                  |                                                          | | milliseconds   | milliseconds |
|                        |                                                          | | centiseconds   |              |
|                        |                                                          | | seconds        |              |
+------------------------+----------------------------------------------------------+------------------+--------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# advertisement-timer 1000 milliseconds


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no advertisement-timer

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/description.rst

protocols vrrp interface address-family ipv4 vrid description
-------------------------------------------------------------

**Minimum user role:** operator

To set a description for the VRRP group:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Parameter table**

+-------------+------------------------+------------------+---------+
| Parameter   | Description            | Range            | Default |
+=============+========================+==================+=========+
| description | VRRP group description | | string         | \-      |
|             |                        | | length 1-255   |         |
+-------------+------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# description MyFirstVirtual_Router-1


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/preempt-mode_admin_state.rst

protocols vrrp interface address-family ipv4 vrid preempt-mode admin-state
--------------------------------------------------------------------------

**Minimum user role:** operator

To enable or disable preeempt mode for the VRRP group:

**Command syntax: preempt-mode admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | When activated enables preemption by a higher priority backup router of a lower  | | enabled    | enabled |
|             | priority master router                                                           | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# preempt-mode admin-state enabled


**Removing Configuration**

To return the preempt-mode admin-state to its default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no preempt-mode admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/preempt-mode_delay.rst

protocols vrrp interface address-family ipv4 vrid preempt-mode delay
--------------------------------------------------------------------

**Minimum user role:** operator

To set the preeempt delay to wait before a backup router will attempt preempting the master for the VRRP group:

**Command syntax: preempt-mode delay [preempt-delay]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Parameter table**

+---------------+------------------------------------------------------------------+--------+---------+
| Parameter     | Description                                                      | Range  | Default |
+===============+==================================================================+========+=========+
| preempt-delay | Set the delay the higher priority router waits before preempting | 0-3600 | 1       |
+---------------+------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# preempt-mode delay 3


**Removing Configuration**

To return the preempt-mode delay to its default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no preempt-mode delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/priority.rst

protocols vrrp interface address-family ipv4 vrid priority
----------------------------------------------------------

**Minimum user role:** operator

To set the priority level for the VRRP group:

**Command syntax: priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| priority  | Specifies the sending VRRP interface's priority for the virtual router.  Higher  | 1-254 | 100     |
|           | values equal higher priority                                                     |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# priority 240


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no priority

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/tracking/interface.rst

protocols vrrp interface address-family ipv4 vrid tracking interface
--------------------------------------------------------------------

**Minimum user role:** operator

To configure tracking of interface's operational status and reduce priority if it goes down:

**Command syntax: interface [tracked-interface]** priority-decrement [priority-decrement]

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid tracking
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid tracking

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+----------------------------------------+---------+
| Parameter          | Description                                                                      | Range                                  | Default |
+====================+==================================================================================+========================================+=========+
| tracked-interface  | Track an interface                                                               | | geX-<f>/<n>/<p>                      | \-      |
|                    |                                                                                  | | geX-<f>/<n>/<p>.<sub-interface-id>   |         |
|                    |                                                                                  | | bundle-<bundle-id>                   |         |
|                    |                                                                                  | | bundle-<bundle-id.sub-bundle-id>     |         |
|                    |                                                                                  | | loX                                  |         |
|                    |                                                                                  | | irb<0-65535>                         |         |
+--------------------+----------------------------------------------------------------------------------+----------------------------------------+---------+
| priority-decrement | Specifies how much to decrement the priority of the VRRP instance if the         | 1-254                                  | 10      |
|                    | interface goes down                                                              |                                        |         |
+--------------------+----------------------------------------------------------------------------------+----------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# tracking
    dnRouter(cfg-afi-vrid-tracking)# interface bundle-2 priority-decrement 25


**Removing Configuration**

To remove a specific interface tracked for the VRRP group:
::

    dnRouter(cfg-afi-vrid-tracking)# no interface bundle-2

To revert the priority-decrement back to its default value for the specified tracked interface:
::

    dnRouter(cfg-afi-vrid-tracking)# no interface bundle-2 priority-decrement 30

**Command History**

+---------+----------------------------------------+
| Release | Modification                           |
+=========+========================================+
| 17.2    | Command introduced                     |
+---------+----------------------------------------+
| 18.0    | Added IRB support to tracked-interface |
+---------+----------------------------------------+

---

### afi_ipv4/vrid/tracking/route.rst

protocols vrrp interface address-family ipv4 vrid tracking route vrf
--------------------------------------------------------------------

**Minimum user role:** operator

To configure tracking of route's reachability and reduce priority if it becomes unreachable:

**Command syntax: route [prefix] vrf [vrf-name]** priority-decrement [priority-decrement]

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid tracking
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid tracking

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+-----------+---------+
| Parameter          | Description                                                                      | Range     | Default |
+====================+==================================================================================+===========+=========+
| prefix             | The IPv4 prefix of the network to track.                                         | A.B.C.D/x | \-      |
+--------------------+----------------------------------------------------------------------------------+-----------+---------+
| vrf-name           | Routing instance to which the route belongs, or 'default'                        | \-        | \-      |
+--------------------+----------------------------------------------------------------------------------+-----------+---------+
| priority-decrement | Specifies how much to decrement the priority of the VRRP router if there is a    | 1-254     | 10      |
|                    | failure in the IPv4 network.                                                     |           |         |
+--------------------+----------------------------------------------------------------------------------+-----------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# tracking
    dnRouter(cfg-afi-vrid-tracking)# route 1.1.1.1/24 vrf default priority-decrement 35


**Removing Configuration**

To remove a specific route tracked for the VRRP group:
::

    dnRouter(cfg-afi-vrid-tracking)# no route 1.1.1.1/24 vrf default

To revert the priority-decrement back to its default value for the specified tracked route:
::

    dnRouter(cfg-afi-vrid-tracking)# no route 1.1.1.1/24 vrf default priority-decrement 30

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/tracking/tracking.rst

protocols vrrp interface address-family ipv4 vrid tracking
----------------------------------------------------------

**Minimum user role:** operator

To enter VRRP objects tracking configuration hierarchy:

**Command syntax: tracking**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4 vrid
- network-services vrf instance protocols vrrp interface address-family ipv4 vrid

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# tracking
    dnRouter(cfg-afi-vrid-tracking)#


**Removing Configuration**

To remove the objects tracking configuration from the VRRP group:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no tracking

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv4/vrid/vrid.rst

protocols vrrp interface address-family ipv4 vrid
-------------------------------------------------

**Minimum user role:** operator

To configure a VRRP group and enter its configuration hierarchy:

**Command syntax: vrid [virtual-router-id]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv4
- network-services vrf instance protocols vrrp interface address-family ipv4

**Parameter table**

+-------------------+-----------------------------------------------------------------+-------+---------+
| Parameter         | Description                                                     | Range | Default |
+===================+=================================================================+=======+=========+
| virtual-router-id | References the configured virtual router id for this VRRP group | 1-255 | \-      |
+-------------------+-----------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv4
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)#

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)#


**Removing Configuration**

To remove the VRRP group configuration:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# no vrid 1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/afi_ipv6.rst

protocols vrrp interface address-family ipv6
--------------------------------------------

**Minimum user role:** operator

To enter the VRRP IPv6 address-family configuration on the interface:

**Command syntax: address-family ipv6**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface
- network-services vrf instance protocols vrrp interface

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols vrrp
    dnRouter(cfg-protocols-vrrp)# interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)#


**Removing Configuration**

To remove the address-family configuration:
::

    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# no address-family ipv6

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/accept-mode.rst

protocols vrrp interface address-family ipv6 vrid accept-mode admin-state
-------------------------------------------------------------------------

**Minimum user role:** operator

To enable or disable accept mode for the VRRP group:

**Command syntax: accept-mode admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Note**
Enables a backup VRRP device to respond to ping, traceroute, and Telnet packets if the backup device becomes the master VRRP router.

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+----------+
| Parameter   | Description                                                                      | Range        | Default  |
+=============+==================================================================================+==============+==========+
| admin-state | Controls whether a virtual router in master state will accept packets addressed  | | enabled    | disabled |
|             | to the address owner's IPvX address as its own if it is not the IPvX address     | | disabled   |          |
|             | owner.  The default is 'false'.  Deployments that rely on, for example, pinging  |              |          |
|             | the address owner's IPvX address may wish to configure accept-mode to 'true'.    |              |          |
|             | Note: IPv6 Neighbor Solicitations and Neighbor Advertisements MUST NOT be        |              |          |
|             | dropped when accept-mode is 'false'.                                             |              |          |
+-------------+----------------------------------------------------------------------------------+--------------+----------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# accept-mode admin-state disabled


**Removing Configuration**

To return the accept-mode admin-state to its default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no accept-mode

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/address.rst

protocols vrrp interface address-family ipv6 vrid address
---------------------------------------------------------

**Minimum user role:** operator

To configure virtual IP addresses for the VRRP group:

**Command syntax: address [ip-address]** [, ip-address, ip-address]

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Note**

- Both IPv4 and IPv6 prefixes are supported, but cannot be mixed in the same group.

- For IPv6 address family IPv6 link local address is auto-generated, configuration applies to IPv6 global unicast addresses

**Parameter table**

+------------+---------------------------------------------------+--------------+---------+
| Parameter  | Description                                       | Range        | Default |
+============+===================================================+==============+=========+
| ip-address | Configure virtual IP addresses for the VRRP group | | A.B.C.D    | \-      |
|            |                                                   | | X:X::X:X   |         |
+------------+---------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# address 2001:608::/32

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# address 2001:608::/32, 2001:604::/32


**Removing Configuration**

To remove all virtual IP addresses from the VRRP group:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no address

To remove a specific virtual IP address from the VRRP group:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no address 2001:608::/32

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/admin-state.rst

protocols vrrp interface address-family ipv6 vrid admin-state
-------------------------------------------------------------

**Minimum user role:** operator

To set the administrative state of the VRRP group:

**Command syntax: admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Parameter table**

+-------------+------------------------+--------------+---------+
| Parameter   | Description            | Range        | Default |
+=============+========================+==============+=========+
| admin-state | VRRP group admin-state | | enabled    | enabled |
|             |                        | | disabled   |         |
+-------------+------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# admin-state disabled


**Removing Configuration**

To return the admin-state to its default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/advertisement-timer.rst

protocols vrrp interface address-family ipv6 vrid advertisement-timer
---------------------------------------------------------------------

**Minimum user role:** operator

To set the VRRP announcemenets advertiseement timer value for the VRRP group:

**Command syntax: advertisement-timer [advertisement-interval] [units]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Parameter table**

+------------------------+----------------------------------------------------------+------------------+--------------+
| Parameter              | Description                                              | Range            | Default      |
+========================+==========================================================+==================+==============+
| advertisement-interval | Sets the interval between successive VRRP advertisements | 10-40950         | 1000         |
+------------------------+----------------------------------------------------------+------------------+--------------+
| units                  |                                                          | | milliseconds   | milliseconds |
|                        |                                                          | | centiseconds   |              |
|                        |                                                          | | seconds        |              |
+------------------------+----------------------------------------------------------+------------------+--------------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# advertisement-timer 5 seconds


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no advertisement-timer

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/description.rst

protocols vrrp interface address-family ipv6 vrid description
-------------------------------------------------------------

**Minimum user role:** operator

To set a description for the VRRP group:

**Command syntax: description [description]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Parameter table**

+-------------+------------------------+------------------+---------+
| Parameter   | Description            | Range            | Default |
+=============+========================+==================+=========+
| description | VRRP group description | | string         | \-      |
|             |                        | | length 1-255   |         |
+-------------+------------------------+------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# description MyFirstVirtual_Router-1


**Removing Configuration**

To remove the description:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no description

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/preempt-mode_admin_state.rst

protocols vrrp interface address-family ipv6 vrid preempt-mode admin-state
--------------------------------------------------------------------------

**Minimum user role:** operator

To enable or disable preeempt mode for the VRRP group:

**Command syntax: preempt-mode admin-state [admin-state]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Parameter table**

+-------------+----------------------------------------------------------------------------------+--------------+---------+
| Parameter   | Description                                                                      | Range        | Default |
+=============+==================================================================================+==============+=========+
| admin-state | When activated enables preemption by a higher priority backup router of a lower  | | enabled    | enabled |
|             | priority master router                                                           | | disabled   |         |
+-------------+----------------------------------------------------------------------------------+--------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# preempt-mode admin-state disabled


**Removing Configuration**

To return the preempt-mode admin-state to its default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no preempt-mode admin-state

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/preempt-mode_delay.rst

protocols vrrp interface address-family ipv6 vrid preempt-mode delay
--------------------------------------------------------------------

**Minimum user role:** operator

To set the preeempt delay to wait before a backup router will attempt preempting the master for the VRRP group:

**Command syntax: preempt-mode delay [preempt-delay]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Parameter table**

+---------------+------------------------------------------------------------------+--------+---------+
| Parameter     | Description                                                      | Range  | Default |
+===============+==================================================================+========+=========+
| preempt-delay | Set the delay the higher priority router waits before preempting | 0-3600 | 1       |
+---------------+------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# preempt-mode delay 1


**Removing Configuration**

To return the preempt-mode delay to its default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no preempt-mode delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/priority.rst

protocols vrrp interface address-family ipv6 vrid priority
----------------------------------------------------------

**Minimum user role:** operator

To set the priority level for the VRRP group:

**Command syntax: priority [priority]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Parameter table**

+-----------+----------------------------------------------------------------------------------+-------+---------+
| Parameter | Description                                                                      | Range | Default |
+===========+==================================================================================+=======+=========+
| priority  | Specifies the sending VRRP interface's priority for the virtual router.  Higher  | 1-254 | 100     |
|           | values equal higher priority                                                     |       |         |
+-----------+----------------------------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# priority 240


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no priority

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/tracking/interface.rst

protocols vrrp interface address-family ipv6 vrid tracking interface
--------------------------------------------------------------------

**Minimum user role:** operator

To configure tracking of interface's operational status and reduce priority if it goes down:

**Command syntax: interface [tracked-interface]** priority-decrement [priority-decrement]

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid tracking
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid tracking

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+----------------------------------------+---------+
| Parameter          | Description                                                                      | Range                                  | Default |
+====================+==================================================================================+========================================+=========+
| tracked-interface  | Track an interface                                                               | | geX-<f>/<n>/<p>                      | \-      |
|                    |                                                                                  | | geX-<f>/<n>/<p>.<sub-interface-id>   |         |
|                    |                                                                                  | | bundle-<bundle-id>                   |         |
|                    |                                                                                  | | bundle-<bundle-id.sub-bundle-id>     |         |
|                    |                                                                                  | | loX                                  |         |
|                    |                                                                                  | | irb<0-65535>                         |         |
+--------------------+----------------------------------------------------------------------------------+----------------------------------------+---------+
| priority-decrement | Specifies how much to decrement the priority of the VRRP instance if the         | 1-254                                  | 10      |
|                    | interface goes down                                                              |                                        |         |
+--------------------+----------------------------------------------------------------------------------+----------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# tracking
    dnRouter(cfg-afi-vrid-tracking)# interface bundle-2 priority-decrement 40


**Removing Configuration**

To remove a specific interface tracked for the VRRP group:
::

    dnRouter(cfg-afi-vrid-tracking)# no interface bundle-2

To revert the priority-decrement back to its default value for the specified tracked interface:
::

    dnRouter(cfg-afi-vrid-tracking)# no interface bundle-2 priority-decrement 30

**Command History**

+---------+----------------------------------------+
| Release | Modification                           |
+=========+========================================+
| 17.2    | Command introduced                     |
+---------+----------------------------------------+
| 18.0    | Added IRB support to tracked-interface |
+---------+----------------------------------------+

---

### afi_ipv6/vrid/tracking/route.rst

protocols vrrp interface address-family ipv6 vrid tracking route vrf
--------------------------------------------------------------------

**Minimum user role:** operator

To configure tracking of route's reachability and reduce priority if it becomes unreachable:

**Command syntax: route [prefix] vrf [vrf-name]** priority-decrement [priority-decrement]

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid tracking
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid tracking

**Parameter table**

+--------------------+----------------------------------------------------------------------------------+------------+---------+
| Parameter          | Description                                                                      | Range      | Default |
+====================+==================================================================================+============+=========+
| prefix             | The IPv6 prefix of the network to track.                                         | X:X::X:X/x | \-      |
+--------------------+----------------------------------------------------------------------------------+------------+---------+
| vrf-name           | Routing instance to which the route belongs, or 'default'                        | \-         | \-      |
+--------------------+----------------------------------------------------------------------------------+------------+---------+
| priority-decrement | Specifies how much to decrement the priority of the VRRP router if there is a    | 1-254      | 10      |
|                    | failure in the IPv6 network.                                                     |            |         |
+--------------------+----------------------------------------------------------------------------------+------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# tracking
    dnRouter(cfg-afi-vrid-tracking)# route 2000:76CC::12/64 vrf default priority-decrement 100


**Removing Configuration**

To remove a specific route tracked for the VRRP group:
::

    dnRouter(cfg-afi-vrid-tracking)# no route 2000:76CC::12/64 vrf default

To revert the priority-decrement back to its default value for the specified tracked route:
::

    dnRouter(cfg-afi-vrid-tracking)# no route 2000:76CC::12/64 vrf default priority-decrement 30

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/tracking/tracking.rst

protocols vrrp interface address-family ipv6 vrid tracking
----------------------------------------------------------

**Minimum user role:** operator

To enter VRRP objects tracking configuration hierarchy:

**Command syntax: tracking**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6 vrid
- network-services vrf instance protocols vrrp interface address-family ipv6 vrid

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# tracking
    dnRouter(cfg-afi-vrid-tracking)#


**Removing Configuration**

To remove the objects tracking configuration from the VRRP group:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)# no tracking

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### afi_ipv6/vrid/vrid.rst

protocols vrrp interface address-family ipv6 vrid
-------------------------------------------------

**Minimum user role:** operator

To configure a VRRP group and enter its configuration hierarchy:

**Command syntax: vrid [virtual-router-id]**

**Command mode:** config

**Hierarchies**

- protocols vrrp interface address-family ipv6
- network-services vrf instance protocols vrrp interface address-family ipv6

**Parameter table**

+-------------------+-----------------------------------------------------------------+-------+---------+
| Parameter         | Description                                                     | Range | Default |
+===================+=================================================================+=======+=========+
| virtual-router-id | References the configured virtual router id for this VRRP group | 1-255 | \-      |
+-------------------+-----------------------------------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)# address-family ipv6
    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# vrid 1
    dnRouter(cfg-vrrp-ge100-0/0/0-afi-vrid)#


**Removing Configuration**

To remove the VRRP group configuration:
::

    dnRouter(cfg-vrrp-ge100-0/0/0-afi)# no vrid 1

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### vrrp.rst

protocols vrrp interface
------------------------

**Minimum user role:** operator

To enable VRRP on an interface and enter interface configuration mode:


**Command syntax: vrrp interface [interface-name]**

**Command mode:** config

**Hierarchies**

- protocols
- network-services vrf instance protocols

**Parameter table**

+----------------+-----------------------------------------------------+----------------------------------------+---------+
| Parameter      | Description                                         | Range                                  | Default |
+================+=====================================================+========================================+=========+
| interface-name | The name of the interface on which VRRP is enabled. | | geX-<f>/<n>/<p>                      | \-      |
|                |                                                     | | geX-<f>/<n>/<p>.<sub-interface-id>   |         |
|                |                                                     | | bundle-<bundle-id>                   |         |
|                |                                                     | | bundle-<bundle-id.sub-bundle-id>     |         |
|                |                                                     | | irb<0-65535>                         |         |
+----------------+-----------------------------------------------------+----------------------------------------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp interface ge100-0/0/0
    dnRouter(cfg-protocols-vrrp-ge100-0/0/0)#

    dnRouter(cfg-protocols)# vrrp interface bundle-2.1012
    dnRouter(cfg-protocols-vrrp-bundle-2.1012)#


**Removing Configuration**

To disable the VRRP process on an interface:
::

    dnRouter(cfg-protocols)# no vrrp interface ge100-0/0/0

To remove all VRRP configuration:
::

    dnRouter(cfg-protocols)# no vrrp

**Command History**

+---------+----------------------------------------+
| Release | Modification                           |
+=========+========================================+
| 17.2    | Command introduced                     |
+---------+----------------------------------------+
| 18.0    | Added IRB support to tracked-interface |
+---------+----------------------------------------+
| 19.3    | Add no vrrp command                    |
+---------+----------------------------------------+

---


## SECTION 2.Z: PROTOCOLS (ROOT LEVEL FILES)

Files in this section: 8

### address resultion protocol overview.rst

Address Resolution Protocol (ARP)
---------------------------------

Address resolution is the process of mapping network addresses (IPs) to Media Access Control (MAC) addresses. This process is accomplished using the Address Resolution Protocol (ARP).

Within a single LAN, if an end system A broadcasts an ARP request to learn the MAC address of an end system B, the broadcast is received by all devices on the LAN, but only B replies to the ARP request. The ARP reply contains B's MAC address. A receives the reply and saves B's MAC address in its ARP table. (The ARP table is where network addresses are associated with MAC addresses.) Whenever A needs to communicate with B, it checks the ARP table, finds the MAC address of B, and sends the frame directly, without needing to first use another ARP request.

When the source and destination devices are on different LANs that are interconnected by a router, the source system Y broadcasts an ARP request to learn the MAC address of the destination system Z. The broadcast is received by all devices on the LAN, but it cannot reach Z. To reach Z, we need to manually add it to Y's ARP table.

A dynamically learned record of each mapping between network address and MAC address is kept in the ARP table for a predetermined amount of time (5 min) and then discarded.

You can also add static entries to the ARP table. When IS-IS is available, DNOS takes the IP and MAC addresses from the IS-IS hello messages and periodic messages and pre-installs them in the ARP table.

For ARP-related commands, see:

- interfaces arp
- show arp
- clear arp

For dynamic ARP/NDP synchronization, see:

- Dynamic ARP
---

### bgp_class-of-service.rst

protocols bgp class-of-service
------------------------------

**Minimum user role:** operator

With class of service (CoS) you can classify traffic to provide different service levels to different traffic so that when congestion occurs, you can control which packets receive priority.

To configure a CoS for all outgoing BGP packets:

**Command syntax: bgp class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols

**Parameter table**

+------------------+-------------------------------------+-------+---------+
| Parameter        | Description                         | Range | Default |
+==================+=====================================+=======+=========+
| class-of-service | dscp value for outgoing BGP packets | 0-56  | 48      |
+------------------+-------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp class-of-service 48


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols)# no bgp class-of-service 48

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### bgp_maximum-sessions.rst

protocols bgp maximum-sessions threshold
----------------------------------------

**Minimum user role:** operator

You can control the maximum number of concurrent BGP sessions by setting thresholds to generate system event notifications. Only established sessions are counted. When a threshold is crossed, a system-event notification is generated allowing you to take action, if necessary.

- This is a global setting where the thresholds apply to all BGP session types (iBGP and eBGP) and are for all BGP instances combined.

- The thresholds are for generating system-events only. There is no limitation for how many bgp neighbors/groups user can configure. A session will open for every configured peer.

To configure thresholds for BGP sessions:

**Command syntax: bgp maximum-sessions [maximum] threshold [threshold]**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- When the number of sessions drops below a threshold, a system-event notification is generated.

- In the above example, the maximum number of sessions is set to 600 and the threshold is set to 70%. This means that when the number of sessions reaches 420 (600x70%), a system-event notification will be generated that the 70% threshold has been crossed. If you do nothing, you will not receive another notification until the number of sessions reaches 600.

**Parameter table**

+-----------+---------------------------------------------------------+--------+---------+
| Parameter | Description                                             | Range  | Default |
+===========+=========================================================+========+=========+
| maximum   | maximum session scale, covers all types of bgp sessions | 1-5000 | 2000    |
+-----------+---------------------------------------------------------+--------+---------+
| threshold | threshold as a percentage of system maximum bgp session | 1-100  | 75      |
+-----------+---------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp maximum-sessions 600 threshold 70


**Removing Configuration**

To revert to the default values:
::

    dnRouter(cfg-protocols)# no bgp maximum-sessions

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 11.0    | Command introduced |
+---------+--------------------+

---

### bgp_nsr.rst

protocols bgp nsr
-----------------

**Minimum user role:** operator

BGP nonstop routing (NSR) enables a BGP speaker to maintain the BGP session's state while undergoing switchover at the CPU level (e.g. NCC switchover).
Unlike BGP graceful-restart (GR), which requires both BGP ends to support the GR capability and logic, NSR is transparent, and the other end of the BGP session is unaware of the NSR process.
BGP NSR provides a high availability (HA) solution where the neighbor router does not support BGP GR.

The BGP process (bgpd) running on the active NCC, saves all the information required to recover from a BGP failure and provide nonstop routing (including BGP session information for both iBGP and eBGP neighbors, and TCP session information) in the NSR DB (including all BGP acknowledged and unacknowledged packets).
The NSR DBs, located on both active and standby NCC, are regularly synchronized. In the event of a switchover/failover, bgpd starts on the standby NCC and recovers the TCP and BGP session parameters from the NSR-DB in the standby NCC.
BGP NSR does not require the neighbor router to be NSF-capable or NSF-aware, however, it relies on the "route-refresh" capability in order to re-converge after the BGP process recovers.

BGP NSR is applicable to the following address families:

* IPv4-unicast, IPv6-unicast
* IPv4-labeled-unicast, IPv6-labeled-unicast
* IPv4-vpn, IPv6-vpn
* IPv4-rt-constrains
* IPv4-multicast

BGP NSR is supported only on NCEs with external NCCs (i.e. cluster topology).

To enable/disable the BGP NSR feature:

**Command syntax: bgp nsr [nsr]**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- This is a global BGP configuration that applies to all BGP instances and VRFs.

**Parameter table**

+-----------+---------------------+--------------+---------+
| Parameter | Description         | Range        | Default |
+===========+=====================+==============+=========+
| nsr       | bgp nsr admin-state | | enabled    | enabled |
|           |                     | | disabled   |         |
+-----------+---------------------+--------------+---------+

**Example**
::

    dnRouter#
    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# bgp nsr enabled

    dnRouter(cfg-protocols)# bgp nsr disabled


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols)# no bgp nsr

**Command History**

+---------+-----------------------------------------------------------------+
| Release | Modification                                                    |
+=========+=================================================================+
| 13.0    | Command introduced                                              |
+---------+-----------------------------------------------------------------+
| 16.1    | Changed hierarchy for the command to apply to all BGP instances |
+---------+-----------------------------------------------------------------+

---

### neighbor discovery protocol overview.rst

Neighbor Discovery Protocol Overview
------------------------------------
In IPv6 networks, the neighbor discovery protocol (NDP) is responsible for:

- Router discovery - locating the routers that reside on an attached link
- Prefix discovery - discovering the set of address prefixes that define which destinations are on-link
- Parameter discovery - learning parameters (MTU, hop limit value) to place in outgoing packets
- Address auto-configuration - nodes automatically configure addresses for interfaces
- Neighbor address resolution - determining the link-layer address of an on-link destination given only the destination's IP address
- Next-hop determination - mapping an IP destination address to the IP address of the neighbor to which traffic for the destination should be sent (i.e. the next hop).
- Neighbor reachability verification - determining if the neighbor is reachable
- Duplicate address detection - determining if an address it wants to use is in use by another node
- Redirect - informing a host of a better next-hop node for reaching a specific destination

NDP uses the following ICMPv6 message types to carry out its tasks:

- Router solicitation (type 133) - When an interface becomes enabled, hosts may send out Router Solicitations that request routers to generate Router Advertisements immediately rather than at their next scheduled time.
- Router advertisement (type 134) - IPv6 routers send router advertisement messages periodically or in response to a Router Solicitation message, to inform hosts about the IPv6 prefixes used on the link.
- Neighbor solicitation (type 135) - Sent by a node to determine the link-layer address of a neighbor, or to verify that the neighbor is still reachable. Neighbor solicitation messages are also used for duplicate address detection.
- Neighbor advertisement (type 136) - A response to a Neighbor Solicitation message, or to announce a link-layer address change.
- Redirect (type 137) - Used by routers to inform hosts of a better next hop for a destination.

When IS-IS is available, DNOS takes the IP and MAC addresses from the IS-IS hello messages and periodic messages and pre-installs them entries in the NDP table.

For NDP-related commands, see:

- interfaces ndp

- show ndp

- clear ndp

For dynamic ARP/NDP synchronization, see:

- Dynamic ARP

---

### protocols.rst

protocols
---------

**Minimum user role:** operator

Enter protocols configuration mode

**Command syntax: protocols**

**Command mode:** config

**Note:**

'no protocols' - remove all protocols configuration

**Example**
::

	dnRouter# configure
	dnRouter(cfg)# protocols
	dnRouter(cfg-protocols)#

	dnRouter(cfg)# no protocols

**Command History**

+---------+-----------------------------------------------------------------+
| Release | Modification                                                    |
+=========+=================================================================+
| 11.0    | Command introduced                                              |
+---------+-----------------------------------------------------------------+

---

### vrrp_class-of-service.rst

protocols vrrp class-of-service
-------------------------------

**Minimum user role:** operator

With class of service (CoS) you can classify traffic to provide different service levels to different traffic so that when congestion occurs, you can control which packets receive priority.

To configure a CoS for all outgoing VRRP packets:

**Command syntax: vrrp class-of-service [class-of-service]**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- The class-of-service configuration is global and applies to all VRRP instances in any VRF.

**Parameter table**

+------------------+--------------------------------------+-------+---------+
| Parameter        | Description                          | Range | Default |
+==================+======================================+=======+=========+
| class-of-service | DSCP value for outgoing VRRP packets | 0-56  | 48      |
+------------------+--------------------------------------+-------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp class-of-service 48


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols)# no vrrp class-of-service

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 17.2    | Command introduced |
+---------+--------------------+

---

### vrrp_startup-delay.rst

protocols vrrp startup-delay
----------------------------

**Minimum user role:** operator

To set the startup delay to wait before a backup router will attempt preempting the master for the VRRP groups after an interface becomes operational:

**Command syntax: vrrp startup-delay [startup-delay]**

**Command mode:** config

**Hierarchies**

- protocols

**Note**

- The startup-delay configuration is global and applies to all VRRP instances in any VRF.

**Parameter table**

+---------------+----------------------------------------------------------------------------------+--------+---------+
| Parameter     | Description                                                                      | Range  | Default |
+===============+==================================================================================+========+=========+
| startup-delay | Set the delay the higher priority backup router waits before preempting the      | 0-3600 | 30      |
|               | master router after the interfaces becomes operational                           |        |         |
+---------------+----------------------------------------------------------------------------------+--------+---------+

**Example**
::

    dnRouter# configure
    dnRouter(cfg)# protocols
    dnRouter(cfg-protocols)# vrrp startup-delay 600


**Removing Configuration**

To revert to the default value:
::

    dnRouter(cfg-protocols)# no vrrp startup-delay

**Command History**

+---------+--------------------+
| Release | Modification       |
+=========+====================+
| 18.1    | Command introduced |
+---------+--------------------+

---

