show qos interfaces queues
--------------------------

**Minimum user role:** viewer

To display the VoQ queue statistics for a specific interface, use the following command:



**Command syntax: show qos interfaces queues [interface-name]** qos-tag [qos-tag] ncp [ncp-id] ths-crossed

**Command mode:** operational



.. **Note**

    - Rows are not showed if not used by policy

    - Disconnected NCP do not respond and are not shown

    - Average queue size prints N/A if wred is not enabled (average queue is not calculated)

    - The threshold flags should be compared against the actual configured FADT max for Tail Drop (G/Y) and against WRED configured thresholds (G/Y)

    - The thresholds for WRED and Tail Drop can be read from CGM_VOQ_WORDS_RJCT_PRMS registers.

    - The FADT flags should be calculated through the configured alpha per DP, the minimal FADT threshold, and the current DRAM values

    - Below is the relevant print

    (WDY1977V0001D-P1)root@datapath:/# wbox-cli bcm diag tm ingress queue info id=136

     Running: tm ingress queue info id=136
     +-----------------------------------+
     | Queue 136 Mapping info for Core=0 |
     +==================+================+
     | Type             | ID             |
     +------------------+----------------+
     | Rate Class       | 2              |
     | Connection Class | 0              |
     | Traffic Class    | 0              |
     +------------------+----------------+
     +-----------------------+
     |      Rate class Info  |
     +===============+=======+
     | Param         | value |
     +---------------+-------+
     | rate class id | 2     |
     | OCB_ONLY      | False |
     +---------------+-------+

     +-------------------------------------+
     |    Rate class 2 Guaranteed Info     |
     +========================+============+
     | Resource               | Guaranteed |
     +------------------------+------------+
     | Bytes                  | 0          |
     | OCB Buffers            | 0          |
     | OCB Packet Descriptors | 0          |
     +------------------------+------------+
     
     +-------------------------------------------------------------------------------+
     |                          Rate class 2 FADT Drop Info                          |
     +========================+====+====================+====================+=======+
     | Resource               | DP | FADT Min threshold | FADT Max threshold | Alpha |
     +========================+====+====================+====================+=======+
     | Bytes                  | 0  | 0                  | 268435456          | 0     |
     | Bytes                  | 1  | 0                  | 268435456          | 0     |
     | Bytes                  | 2  | 0                  | 268435456          | 0     |
     | Bytes                  | 3  | 0                  | 268435456          | 0     |
     +------------------------+----+--------------------+--------------------+-------+
     | OCB Buffers            | 0  | 0                  | 32752              | 0     |
     | OCB Buffers            | 1  | 0                  | 32752              | 0     |
     | OCB Buffers            | 2  | 0                  | 32752              | 0     |
     | OCB Buffers            | 3  | 0                  | 32752              | 0     |
     +------------------------+----+--------------------+--------------------+-------+
     | OCB Packet Descriptors | 0  | 0                  | 65520              | 0     |
     | OCB Packet Descriptors | 1  | 0                  | 65520              | 0     |
     | OCB Packet Descriptors | 2  | 0                  | 65520              | 0     |
     | OCB Packet Descriptors | 3  | 0                  | 65520              | 0     |
     +------------------------+----+--------------------+--------------------+-------+
     
     +---------------------------------------------------------------------------+
     |                          Rate class 2 WRED Info                           |
     +----------+----+--------+---------------+---------------+------------------+
     | Resource | DP | Enable | Min Threshold | Max Threshold | Drop Probability |
     +----------+----+--------+---------------+---------------+------------------+
     | Bytes    | 0  | False  | 0             | 0             | 0                |
     | Bytes    | 1  | False  | 0             | 0             | 0                |
     | Bytes    | 2  | False  | 0             | 0             | 0                |
     | Bytes    | 3  | False  | 0             | 0             | 0                |
     +----------+----+--------+---------------+---------------+------------------+

     +---------------------------------------------------------------------------------+
     |                              Rate class 2 ECN Info                              |
     +----------+----------+--------+---------------+---------------+------------------+
     | Resource | Max Size | Enable | Min Threshold | Max Threshold | Drop Probability |
     +----------+----------+--------+---------------+---------------+------------------+
     | Bytes    | 524288   | False  | 0             | 0             | 0                |
     +----------+----------+--------+---------------+---------------+------------------+


     +----------------------------------------------------------------------------------------------------------------------------------------+
     |                                                     Rate class 2 DRAM Bounds Info                                                      |
     +=============================+========================+===============+===============+====================+====================+=======+
     | Threshold Type              | Resource               | Min Threshold | Max Threshold | Min Free Threshold | Max Free Threshold | Alpha |
     +-----------------------------+------------------------+---------------+---------------+--------------------+--------------------+-------+
     | DRAM Bound                  | OCB Bytes              | 409600        | 409600        | 0                  | 0                  | 0     |
     | DRAM Bound                  | OCB Buffers            | 0             | 32752         | 0                  | 65520              | 0     |
     | DRAM Bound                  | OCB Packet Descriptors | 0             | 65520         | 0                  | 131056             | 0     |
     +-----------------------------+------------------------+---------------+---------------+--------------------+--------------------+-------+
     | DRAM Bound Recovery Failure | OCB Bytes              | 409600        | 409600        | 0                  | 0                  | 0     |
     | DRAM Bound Recovery Failure | OCB Buffers            | 0             | 32752         | 0                  | 65520              | 0     |
     | DRAM Bound Recovery Failure | OCB Packet Descriptors | 0             | 65520         | 0                  | 131056             | 0     |
     +-----------------------------+------------------------+---------------+---------------+--------------------+--------------------+-------+
     
     +----------------------------------+
     | Rate class 2 DRAM Bound Recovery |
     +==========+=======================+
     | Resource | Recovery Threshold    |
     +----------+-----------------------+  
     | Bytes    | 60672                 |
     +----------+-----------------------+

     +----------------------------------------------------------------+
     |           Rate class 2 Congestion Notification Info            |
     +========================+===============+===============+=======+
     | Resource               | Min Threshold | Max Threshold | Alpha |
     +------------------------+---------------+---------------+-------+
     | Bytes                  | 4294967040    | 4294967040    | 0     |
     | OCB Buffers            | 65520         | 65520         | 0     |
     | OCB Packet Descriptors | 131056        | 131056        | 0     |
     +------------------------+---------------+---------------+-------+

     +------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
     | Rate class 2 VOQ Latency Admission Test    Info                                                                                                                                                                           |
     +=======+========+===============+======================+======================+======================+======================+======================+======================+======================+==== ==== ==============+
     | Color | Enable | Min Threshold | Drop Probability - 0 | Drop Probability - 1 | Drop Probability - 2 | Drop Probability - 3 | Drop Probability - 4 | Drop Probability - 5 | Drop Probability - 6 |  Drop    Probability - 7 |
     +-------+--------+---------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---- ---- --------------+
     | 0     | False  | 0             | 102                  | 102                  | 102                  | 102                  | 102                  | 102                  | 102                   |     102                  |
     +-------+--------+---------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---- ---- --------------+
     | 1     | False  | 0             | 102                  | 102                  | 102                  | 102                  | 102                  | 102                  | 102                   |     102                  |
     +-------+--------+---------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---- ---- --------------+
     | 2     | False  | 0             | 102                  | 102                  | 102                  | 102                  | 102                  | 102                  | 102                   |     102                  |
     +-------+--------+---------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---- ---- --------------+
     | 3     | False  | 0             | 102                  | 102                  | 102                  | 102                  | 102                  | 102                  | 102                   |     102                  |
     +-------+--------+---------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+---- ---- --------------+
     
     
     +------------------------------------------------+
     | Queue 136 on core 0 --> compensation profile 0 |
     +=======+========================================+
     | Name  | Value                                  |
     +-------+----------------------------------------+
     | DELTA | 24                                     |
     +-------+----------------------------------------+

     +--------------------------------------------------------+
     |    Queue 136 on core 0 --> credit request profile 7    |
     +==================================+=====================+
     | Name                             | Value               |
     +----------------------------------+---------------------+
     | HIGH PRIORITY                    | 0                   |
     | HIGH BANDWIDTH                   | 0                   |
     | LOW LATENCY                      | 1                   |
     | OCB ONLY                         | 0                   |
     | BACKOFF (bytes)                  | 65536-65536         |
     | BACKLOG (bytes)                  | 20480-20480         |
     | BACKSLOW (bytes)                 | 90112-90112         |
     | HUNGRY NORMAL->SLOW (bytes)      | -20480              |
     | HUNGRY SLOW->NORMAL (bytes)      | -20480              |
     | HUNGRY OFF->NORMAL (bytes)       | -20480              |
     | HUNGRY OFF->SLOW (bytes)         | -20480              |
     | HUNGRY MULTIPLIER (bytes)        | 2048                |
     | EMPTY (TH, EXCEED, MAX)  (bytes) | 20480, 1, 45056     |
     | SLOW_LEVELS_UP (bytes)           | 0->0->0->0->0->0->0 |
     | SLOW_LEVELS_DOWN (bytes)         | 0<-0<-0<-0<-0<-0<-0 |
     | BW LEVEL                         | 1                   |
     | WATCHDOG DELETE TH (milisec)     | 10000               |
     +----------------------------------+---------------------+
     
     +------------------------------------------------------+
     |                Queue 136 credits info                |
     +======+======================+========================+
     | Core | Credit Request State | Credit Balance [Bytes] |
     +------+----------------------+------------------------+
     | 0    | OFF                  | 22816                  |
     +------+----------------------+------------------------+
     | 1    | OFF                  | 0                      |
     +------+----------------------+------------------------+

     +----------------------------------------------------------------------------------------------------------------------+
     |                                                       Queue 136 size                                                 |
     +======+====================+========================+======================+=============+============================+
     | Core | Queue Size [Bytes] | OCB Queue Size [Bytes] | Average size [Bytes] | OCB Buffers | OCB NOF Packet Descriptors |
     +------+--------------------+------------------------+----------------------+-------------+----------------------------+
     | 0    | 0                  | 0                      | 0                    | 0           | 0                          |
     +------+--------------------+------------------------+----------------------+-------------+----------------------------+
     | 1    | 0                  | 0                      | 0                    | 0           | 0                          |
     +------+--------------------+------------------------+----------------------+-------------+----------------------------+


**Parameter table**

+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------+---------+
|    Parameter   |                                                                  Description                                                                  |                Range                               | Default |
+================+===============================================================================================================================================+====================================================+=========+
| interface-name | The name of the interface for which you want to display the QoS policy. If you do not specify an interface, all interfaces will be displayed. | ge<interface speed>-<A>/<B>/<C>                    | \-      |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               | bundle-<bundle-id>                                 |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               | ge<interface speed>-<A>/<B>/<C>.<sub-interface-id> |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               | fabm-<f>/<n>/<p>                                   |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               | cputx-<f>/<n>/<p>                                  |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               |                                                    |         |
|                |                                                                                                                                               | cpurx-<f>/<n>/<p>                                  |         |
+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------+---------+
| direction      | Filter the displayed information to the specified direction                                                                                   | in out                                             | \-      |
+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------+---------+
| ncp-id         | The id of the NCP                                                                                                                             | 0..195                                             | \-      |
+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------+---------+
| qos-tag        | The value of the qos-tag                                                                                                                      | 0..7                                               | \-      |
+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------+---------+
| ths-crossed    | The admission threshold crossed flags                                                                                                         | \-                                                 | \-      |
+----------------+-----------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------+---------+

The Admission Thresholds are:

+-----------+---------------------------------------------------------------------------------+
| Parameter | Description                                                                     |
+===========+=================================================================================+
| TDG       | The queue size is bigger than the configured Tail-Drop threshold.               |
+-----------+---------------------------------------------------------------------------------+
| TDY       | The queue size is bigger than the configured Yellow Tail Drop threshold.        |
+-----------+---------------------------------------------------------------------------------+
| WRGm      | The average queue size is bigger than the configured Green WRED min threshold.  |
+-----------+---------------------------------------------------------------------------------+
| WRGx      | The average queue size is bigger than the configured Green WRED max threshold.  |
+-----------+---------------------------------------------------------------------------------+
| WRYm      | The average queue size is bigger than the configured Yellow WRED min threshold. |
+-----------+---------------------------------------------------------------------------------+
| WRYx      | The average queue size is bigger than the configured Yellow WRED max threshold. |
+-----------+---------------------------------------------------------------------------------+
| FAG       | The queue size is bigger than the current Green FADT threshold.                 |
+-----------+---------------------------------------------------------------------------------+
| FAY       | The queue size is bigger than the current Yellow FADT threshold.                |
+-----------+---------------------------------------------------------------------------------+
| ECNGm     | The average queue size is bigger than the configured ECN min threshold.         |
+-----------+---------------------------------------------------------------------------------+
| ECNGx     | The average queue size is bigger than the configured ECN max threshold.         |
+-----------+---------------------------------------------------------------------------------+

**Example**
::

    dnRouter# show qos interfaces queues ge100-1/0/1

    Egress Policy:       My-egress-policy
    Interface:           ge100-1/0/1
    Voq base:            10240

    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | NCP    | Core   | Voq    | Class             | Current Queue Size [Bytes] | WRED Average Queue Size [Bytes] | Admission Thresholds Crossed        |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 0      | 0      | my-sef            | 324230                     | 324230                          | ECNGm                               |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 0      | 1      | my-ef             | 0                          | N/A                             |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 0      | 4      | my-af1            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 0      | 5      | my-af2            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 0      | 6      | my-af3            | 324234222                  | 324230222                       | WRGm TDY WRYm                       |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 0      | 7      |                   | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 1      | 0      | my-sef            | 32420                      | 32420                           |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 1      | 1      | my-ef             | 0                          | N/A                             |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 1      | 4      | my-af1            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 1      | 5      | my-af2            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 1      | 6      | my-af3            | 32423                      | 32420                           |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 1      | 7      |                   | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 0      | 0      | my-sef            | 32420                      | 32420                           |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 0      | 1      | my-ef             | 0                          | N/A                             |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 0      | 4      | my-af1            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 0      | 5      | my-af2            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 0      | 6      | my-af3            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 0      | 7      |                   | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 1      | 0      | my-sef            | 32420                      | 32420                           |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 1      | 1      | my-ef             | 0                          | N/A                             |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 1      | 4      | my-af1            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 1      | 5      | my-af2            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 1      | 6      | my-af3            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 1      | 7      |                   | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+


    dnRouter# show qos interfaces queues ge100-1/0/1 qos-tag 3

    Egress Policy:       My-egress-policy
    Interface:           ge100-3/0/1
    Voq base:            10240

    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | NCP    | Core   | Voq    | Class             | Current Queue Size [Bytes] | WRED Average Queue Size [Bytes] | Admission Thresholds Crossed        |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 0      | 6      | my-af3            | 324234222                  | 324230222                       | WRGm TDY WRYm                       |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 1      | 6      | my-af3            | 32423                      | 32420                           |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 0      | 6      | my-af3            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 1      | 6      | my-af3            | 0                          | 0                               |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+


    dnRouter# show qos interfaces queues bundle-3 ths-crossed

    Egress Policy:       My-egress-policy
    Interface:           ge100-0/0/1
    Voq base:            10240

    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | NCP    | Core   | Voq    | Class             | Current Queue Size [Bytes] | WRED Average Queue Size [Bytes] | Admission Thresholds Crossed        |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 0      | 6      | my-af3            | 324234222                  | 324230222                       | WRGm TDY WRYm                       |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+

    Egress Policy:       My-egress-policy
    Interface:           ge100-1/0/4
    Voq base:            20230

    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | NCP    | Core   | Voq    | Class             | Current Queue Size [Bytes] | WRED Average Queue Size [Bytes] | Admission Thresholds Crossed        |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 0      | 1      | 5      | my-af2            | 32423222                   | 32422220                        | FAY                                 |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+


    dnRouter# show qos interfaces queues fabm-1/0/0

    Egress Policy:       _ncp-to-fab
    Interface:           fabm-1/0/0
    Voq base:            0

    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | NCP    | Core   | Voq    | Class             | Current Queue Size [Bytes] | WRED Average Queue Size [Bytes] | Admission Thresholds Crossed        |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 0      | 0      |                   | 32333220                   | 32333220                        | TDY TDG                             |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+
    | 1      | 1      | 0      |                   | 32220                      | 32220                           |                                     |
    +--------+--------+--------+-------------------+----------------------------+---------------------------------+-------------------------------------+

.. **Help line:** show summary of all fabric-multicast policies attached to interfaces including counters

**Command History**

+---------+----------------------+
| Release | Modification         |
+=========+======================+
| 15.0    | Command introduced   |
+---------+----------------------+
| 19.10   | Added ECN parameters |
+---------+----------------------+
